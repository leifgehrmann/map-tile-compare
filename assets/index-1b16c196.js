(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const T of document.querySelectorAll('link[rel="modulepreload"]'))b(T);new MutationObserver(T=>{for(const P of T)if(P.type==="childList")for(const l of P.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&b(l)}).observe(document,{childList:!0,subtree:!0});function _(T){const P={};return T.integrity&&(P.integrity=T.integrity),T.referrerPolicy&&(P.referrerPolicy=T.referrerPolicy),T.crossOrigin==="use-credentials"?P.credentials="include":T.crossOrigin==="anonymous"?P.credentials="omit":P.credentials="same-origin",P}function b(T){if(T.ep)return;T.ep=!0;const P=_(T);fetch(T.href,P)}})();/**
* @vue/shared v3.4.35
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Jh(c,d){const _=new Set(c.split(","));return d?b=>_.has(b.toLowerCase()):b=>_.has(b)}const Jr={},kl=[],zn=()=>{},w_=()=>!1,yp=c=>c.charCodeAt(0)===111&&c.charCodeAt(1)===110&&(c.charCodeAt(2)>122||c.charCodeAt(2)<97),Yh=c=>c.startsWith("onUpdate:"),ki=Object.assign,Qh=(c,d)=>{const _=c.indexOf(d);_>-1&&c.splice(_,1)},S_=Object.prototype.hasOwnProperty,nr=(c,d)=>S_.call(c,d),Ct=Array.isArray,Ll=c=>gp(c)==="[object Map]",Im=c=>gp(c)==="[object Set]",Lt=c=>typeof c=="function",wi=c=>typeof c=="string",ja=c=>typeof c=="symbol",jr=c=>c!==null&&typeof c=="object",Cm=c=>(jr(c)||Lt(c))&&Lt(c.then)&&Lt(c.catch),Am=Object.prototype.toString,gp=c=>Am.call(c),E_=c=>gp(c).slice(8,-1),Pm=c=>gp(c)==="[object Object]",ef=c=>wi(c)&&c!=="NaN"&&c[0]!=="-"&&""+parseInt(c,10)===c,Ou=Jh(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),_p=c=>{const d=Object.create(null);return _=>d[_]||(d[_]=c(_))},T_=/-(\w)/g,uo=_p(c=>c.replace(T_,(d,_)=>_?_.toUpperCase():"")),I_=/\B([A-Z])/g,qa=_p(c=>c.replace(I_,"-$1").toLowerCase()),vp=_p(c=>c.charAt(0).toUpperCase()+c.slice(1)),wh=_p(c=>c?`on${vp(c)}`:""),zs=(c,d)=>!Object.is(c,d),Sh=(c,...d)=>{for(let _=0;_<c.length;_++)c[_](...d)},zm=(c,d,_,b=!1)=>{Object.defineProperty(c,d,{configurable:!0,enumerable:!1,writable:b,value:_})},C_=c=>{const d=parseFloat(c);return isNaN(d)?c:d},A_=c=>{const d=wi(c)?Number(c):NaN;return isNaN(d)?c:d};let Nd;const tf=()=>Nd||(Nd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function rf(c){if(Ct(c)){const d={};for(let _=0;_<c.length;_++){const b=c[_],T=wi(b)?k_(b):rf(b);if(T)for(const P in T)d[P]=T[P]}return d}else if(wi(c)||jr(c))return c}const P_=/;(?![^(]*\))/g,z_=/:([^]+)/,M_=/\/\*[^]*?\*\//g;function k_(c){const d={};return c.replace(M_,"").split(P_).forEach(_=>{if(_){const b=_.split(z_);b.length>1&&(d[b[0].trim()]=b[1].trim())}}),d}function Xu(c){let d="";if(wi(c))d=c;else if(Ct(c))for(let _=0;_<c.length;_++){const b=Xu(c[_]);b&&(d+=b+" ")}else if(jr(c))for(const _ in c)c[_]&&(d+=_+" ");return d.trim()}const L_="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",D_=Jh(L_);function Mm(c){return!!c||c===""}const km=c=>!!(c&&c.__v_isRef===!0),Lm=c=>wi(c)?c:c==null?"":Ct(c)||jr(c)&&(c.toString===Am||!Lt(c.toString))?km(c)?Lm(c.value):JSON.stringify(c,Dm,2):String(c),Dm=(c,d)=>km(d)?Dm(c,d.value):Ll(d)?{[`Map(${d.size})`]:[...d.entries()].reduce((_,[b,T],P)=>(_[Eh(b,P)+" =>"]=T,_),{})}:Im(d)?{[`Set(${d.size})`]:[...d.values()].map(_=>Eh(_))}:ja(d)?Eh(d):jr(d)&&!Ct(d)&&!Pm(d)?String(d):d,Eh=(c,d="")=>{var _;return ja(c)?`Symbol(${(_=c.description)!=null?_:d})`:c};/**
* @vue/reactivity v3.4.35
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let so;class R_{constructor(d=!1){this.detached=d,this._active=!0,this.effects=[],this.cleanups=[],this.parent=so,!d&&so&&(this.index=(so.scopes||(so.scopes=[])).push(this)-1)}get active(){return this._active}run(d){if(this._active){const _=so;try{return so=this,d()}finally{so=_}}}on(){so=this}off(){so=this.parent}stop(d){if(this._active){let _,b;for(_=0,b=this.effects.length;_<b;_++)this.effects[_].stop();for(_=0,b=this.cleanups.length;_<b;_++)this.cleanups[_]();if(this.scopes)for(_=0,b=this.scopes.length;_<b;_++)this.scopes[_].stop(!0);if(!this.detached&&this.parent&&!d){const T=this.parent.scopes.pop();T&&T!==this&&(this.parent.scopes[this.index]=T,T.index=this.index)}this.parent=void 0,this._active=!1}}}function B_(c,d=so){d&&d.active&&d.effects.push(c)}function O_(){return so}let As;class nf{constructor(d,_,b,T){this.fn=d,this.trigger=_,this.scheduler=b,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,B_(this,T)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,Za();for(let d=0;d<this._depsLength;d++){const _=this.deps[d];if(_.computed&&(F_(_.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),Ga()}return this._dirtyLevel>=4}set dirty(d){this._dirtyLevel=d?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let d=Ua,_=As;try{return Ua=!0,As=this,this._runnings++,jd(this),this.fn()}finally{qd(this),this._runnings--,As=_,Ua=d}}stop(){this.active&&(jd(this),qd(this),this.onStop&&this.onStop(),this.active=!1)}}function F_(c){return c.value}function jd(c){c._trackId++,c._depsLength=0}function qd(c){if(c.deps.length>c._depsLength){for(let d=c._depsLength;d<c.deps.length;d++)Rm(c.deps[d],c);c.deps.length=c._depsLength}}function Rm(c,d){const _=c.get(d);_!==void 0&&d._trackId!==_&&(c.delete(d),c.size===0&&c.cleanup())}let Ua=!0,Oh=0;const Bm=[];function Za(){Bm.push(Ua),Ua=!1}function Ga(){const c=Bm.pop();Ua=c===void 0?!0:c}function of(){Oh++}function af(){for(Oh--;!Oh&&Fh.length;)Fh.shift()()}function Om(c,d,_){if(d.get(c)!==c._trackId){d.set(c,c._trackId);const b=c.deps[c._depsLength];b!==d?(b&&Rm(b,c),c.deps[c._depsLength++]=d):c._depsLength++}}const Fh=[];function Fm(c,d,_){of();for(const b of c.keys()){let T;b._dirtyLevel<d&&(T??(T=c.get(b)===b._trackId))&&(b._shouldSchedule||(b._shouldSchedule=b._dirtyLevel===0),b._dirtyLevel=d),b._shouldSchedule&&(T??(T=c.get(b)===b._trackId))&&(b.trigger(),(!b._runnings||b.allowRecurse)&&b._dirtyLevel!==2&&(b._shouldSchedule=!1,b.scheduler&&Fh.push(b.scheduler)))}af()}const Um=(c,d)=>{const _=new Map;return _.cleanup=c,_.computed=d,_},Uh=new WeakMap,Ps=Symbol(""),Vh=Symbol("");function wn(c,d,_){if(Ua&&As){let b=Uh.get(c);b||Uh.set(c,b=new Map);let T=b.get(_);T||b.set(_,T=Um(()=>b.delete(_))),Om(As,T)}}function ha(c,d,_,b,T,P){const l=Uh.get(c);if(!l)return;let J=[];if(d==="clear")J=[...l.values()];else if(_==="length"&&Ct(c)){const U=Number(b);l.forEach((he,se)=>{(se==="length"||!ja(se)&&se>=U)&&J.push(he)})}else switch(_!==void 0&&J.push(l.get(_)),d){case"add":Ct(c)?ef(_)&&J.push(l.get("length")):(J.push(l.get(Ps)),Ll(c)&&J.push(l.get(Vh)));break;case"delete":Ct(c)||(J.push(l.get(Ps)),Ll(c)&&J.push(l.get(Vh)));break;case"set":Ll(c)&&J.push(l.get(Ps));break}of();for(const U of J)U&&Fm(U,4);af()}const U_=Jh("__proto__,__v_isRef,__isVue"),Vm=new Set(Object.getOwnPropertyNames(Symbol).filter(c=>c!=="arguments"&&c!=="caller").map(c=>Symbol[c]).filter(ja)),Zd=V_();function V_(){const c={};return["includes","indexOf","lastIndexOf"].forEach(d=>{c[d]=function(..._){const b=Sr(this);for(let P=0,l=this.length;P<l;P++)wn(b,"get",P+"");const T=b[d](..._);return T===-1||T===!1?b[d](..._.map(Sr)):T}}),["push","pop","shift","unshift","splice"].forEach(d=>{c[d]=function(..._){Za(),of();const b=Sr(this)[d].apply(this,_);return af(),Ga(),b}}),c}function N_(c){ja(c)||(c=String(c));const d=Sr(this);return wn(d,"has",c),d.hasOwnProperty(c)}class Nm{constructor(d=!1,_=!1){this._isReadonly=d,this._isShallow=_}get(d,_,b){const T=this._isReadonly,P=this._isShallow;if(_==="__v_isReactive")return!T;if(_==="__v_isReadonly")return T;if(_==="__v_isShallow")return P;if(_==="__v_raw")return b===(T?P?ev:Gm:P?Zm:qm).get(d)||Object.getPrototypeOf(d)===Object.getPrototypeOf(b)?d:void 0;const l=Ct(d);if(!T){if(l&&nr(Zd,_))return Reflect.get(Zd,_,b);if(_==="hasOwnProperty")return N_}const J=Reflect.get(d,_,b);return(ja(_)?Vm.has(_):U_(_))||(T||wn(d,"get",_),P)?J:kn(J)?l&&ef(_)?J:J.value:jr(J)?T?Hm(J):uf(J):J}}class jm extends Nm{constructor(d=!1){super(!1,d)}set(d,_,b,T){let P=d[_];if(!this._isShallow){const U=Bl(P);if(!ju(b)&&!Bl(b)&&(P=Sr(P),b=Sr(b)),!Ct(d)&&kn(P)&&!kn(b))return U?!1:(P.value=b,!0)}const l=Ct(d)&&ef(_)?Number(_)<d.length:nr(d,_),J=Reflect.set(d,_,b,T);return d===Sr(T)&&(l?zs(b,P)&&ha(d,"set",_,b):ha(d,"add",_,b)),J}deleteProperty(d,_){const b=nr(d,_);d[_];const T=Reflect.deleteProperty(d,_);return T&&b&&ha(d,"delete",_,void 0),T}has(d,_){const b=Reflect.has(d,_);return(!ja(_)||!Vm.has(_))&&wn(d,"has",_),b}ownKeys(d){return wn(d,"iterate",Ct(d)?"length":Ps),Reflect.ownKeys(d)}}class j_ extends Nm{constructor(d=!1){super(!0,d)}set(d,_){return!0}deleteProperty(d,_){return!0}}const q_=new jm,Z_=new j_,G_=new jm(!0);const sf=c=>c,xp=c=>Reflect.getPrototypeOf(c);function Qc(c,d,_=!1,b=!1){c=c.__v_raw;const T=Sr(c),P=Sr(d);_||(zs(d,P)&&wn(T,"get",d),wn(T,"get",P));const{has:l}=xp(T),J=b?sf:_?hf:pf;if(l.call(T,d))return J(c.get(d));if(l.call(T,P))return J(c.get(P));c!==T&&c.get(d)}function ep(c,d=!1){const _=this.__v_raw,b=Sr(_),T=Sr(c);return d||(zs(c,T)&&wn(b,"has",c),wn(b,"has",T)),c===T?_.has(c):_.has(c)||_.has(T)}function tp(c,d=!1){return c=c.__v_raw,!d&&wn(Sr(c),"iterate",Ps),Reflect.get(c,"size",c)}function Gd(c,d=!1){!d&&!ju(c)&&!Bl(c)&&(c=Sr(c));const _=Sr(this);return xp(_).has.call(_,c)||(_.add(c),ha(_,"add",c,c)),this}function Hd(c,d,_=!1){!_&&!ju(d)&&!Bl(d)&&(d=Sr(d));const b=Sr(this),{has:T,get:P}=xp(b);let l=T.call(b,c);l||(c=Sr(c),l=T.call(b,c));const J=P.call(b,c);return b.set(c,d),l?zs(d,J)&&ha(b,"set",c,d):ha(b,"add",c,d),this}function Xd(c){const d=Sr(this),{has:_,get:b}=xp(d);let T=_.call(d,c);T||(c=Sr(c),T=_.call(d,c)),b&&b.call(d,c);const P=d.delete(c);return T&&ha(d,"delete",c,void 0),P}function Wd(){const c=Sr(this),d=c.size!==0,_=c.clear();return d&&ha(c,"clear",void 0,void 0),_}function rp(c,d){return function(b,T){const P=this,l=P.__v_raw,J=Sr(l),U=d?sf:c?hf:pf;return!c&&wn(J,"iterate",Ps),l.forEach((he,se)=>b.call(T,U(he),U(se),P))}}function ip(c,d,_){return function(...b){const T=this.__v_raw,P=Sr(T),l=Ll(P),J=c==="entries"||c===Symbol.iterator&&l,U=c==="keys"&&l,he=T[c](...b),se=_?sf:d?hf:pf;return!d&&wn(P,"iterate",U?Vh:Ps),{next(){const{value:Ee,done:fe}=he.next();return fe?{value:Ee,done:fe}:{value:J?[se(Ee[0]),se(Ee[1])]:se(Ee),done:fe}},[Symbol.iterator](){return this}}}}function La(c){return function(...d){return c==="delete"?!1:c==="clear"?void 0:this}}function H_(){const c={get(P){return Qc(this,P)},get size(){return tp(this)},has:ep,add:Gd,set:Hd,delete:Xd,clear:Wd,forEach:rp(!1,!1)},d={get(P){return Qc(this,P,!1,!0)},get size(){return tp(this)},has:ep,add(P){return Gd.call(this,P,!0)},set(P,l){return Hd.call(this,P,l,!0)},delete:Xd,clear:Wd,forEach:rp(!1,!0)},_={get(P){return Qc(this,P,!0)},get size(){return tp(this,!0)},has(P){return ep.call(this,P,!0)},add:La("add"),set:La("set"),delete:La("delete"),clear:La("clear"),forEach:rp(!0,!1)},b={get(P){return Qc(this,P,!0,!0)},get size(){return tp(this,!0)},has(P){return ep.call(this,P,!0)},add:La("add"),set:La("set"),delete:La("delete"),clear:La("clear"),forEach:rp(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(P=>{c[P]=ip(P,!1,!1),_[P]=ip(P,!0,!1),d[P]=ip(P,!1,!0),b[P]=ip(P,!0,!0)}),[c,_,d,b]}const[X_,W_,K_,$_]=H_();function lf(c,d){const _=d?c?$_:K_:c?W_:X_;return(b,T,P)=>T==="__v_isReactive"?!c:T==="__v_isReadonly"?c:T==="__v_raw"?b:Reflect.get(nr(_,T)&&T in b?_:b,T,P)}const J_={get:lf(!1,!1)},Y_={get:lf(!1,!0)},Q_={get:lf(!0,!1)};const qm=new WeakMap,Zm=new WeakMap,Gm=new WeakMap,ev=new WeakMap;function tv(c){switch(c){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function rv(c){return c.__v_skip||!Object.isExtensible(c)?0:tv(E_(c))}function uf(c){return Bl(c)?c:cf(c,!1,q_,J_,qm)}function iv(c){return cf(c,!1,G_,Y_,Zm)}function Hm(c){return cf(c,!0,Z_,Q_,Gm)}function cf(c,d,_,b,T){if(!jr(c)||c.__v_raw&&!(d&&c.__v_isReactive))return c;const P=T.get(c);if(P)return P;const l=rv(c);if(l===0)return c;const J=new Proxy(c,l===2?b:_);return T.set(c,J),J}function Fu(c){return Bl(c)?Fu(c.__v_raw):!!(c&&c.__v_isReactive)}function Bl(c){return!!(c&&c.__v_isReadonly)}function ju(c){return!!(c&&c.__v_isShallow)}function Xm(c){return c?!!c.__v_raw:!1}function Sr(c){const d=c&&c.__v_raw;return d?Sr(d):c}function nv(c){return Object.isExtensible(c)&&zm(c,"__v_skip",!0),c}const pf=c=>jr(c)?uf(c):c,hf=c=>jr(c)?Hm(c):c;class Wm{constructor(d,_,b,T){this.getter=d,this._setter=_,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new nf(()=>d(this._value),()=>Th(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!T,this.__v_isReadonly=b}get value(){const d=Sr(this);return(!d._cacheable||d.effect.dirty)&&zs(d._value,d._value=d.effect.run())&&Th(d,4),av(d),d.effect._dirtyLevel>=2&&Th(d,2),d._value}set value(d){this._setter(d)}get _dirty(){return this.effect.dirty}set _dirty(d){this.effect.dirty=d}}function ov(c,d,_=!1){let b,T;const P=Lt(c);return P?(b=c,T=zn):(b=c.get,T=c.set),new Wm(b,T,P||!T,_)}function av(c){var d;Ua&&As&&(c=Sr(c),Om(As,(d=c.dep)!=null?d:c.dep=Um(()=>c.dep=void 0,c instanceof Wm?c:void 0)))}function Th(c,d=4,_,b){c=Sr(c);const T=c.dep;T&&Fm(T,d)}function kn(c){return!!(c&&c.__v_isRef===!0)}function sv(c){return kn(c)?c.value:c}const lv={get:(c,d,_)=>sv(Reflect.get(c,d,_)),set:(c,d,_,b)=>{const T=c[d];return kn(T)&&!kn(_)?(T.value=_,!0):Reflect.set(c,d,_,b)}};function Km(c){return Fu(c)?c:new Proxy(c,lv)}/**
* @vue/runtime-core v3.4.35
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Va(c,d,_,b){try{return b?c(...b):c()}catch(T){bp(T,d,_)}}function Hn(c,d,_,b){if(Lt(c)){const T=Va(c,d,_,b);return T&&Cm(T)&&T.catch(P=>{bp(P,d,_)}),T}if(Ct(c)){const T=[];for(let P=0;P<c.length;P++)T.push(Hn(c[P],d,_,b));return T}}function bp(c,d,_,b=!0){const T=d?d.vnode:null;if(d){let P=d.parent;const l=d.proxy,J=`https://vuejs.org/error-reference/#runtime-${_}`;for(;P;){const he=P.ec;if(he){for(let se=0;se<he.length;se++)if(he[se](c,l,J)===!1)return}P=P.parent}const U=d.appContext.config.errorHandler;if(U){Za(),Va(U,null,10,[c,l,J]),Ga();return}}uv(c,_,T,b)}function uv(c,d,_,b=!0){console.error(c)}let qu=!1,Nh=!1;const Yi=[];let Ro=0;const Dl=[];let Ba=null,Ts=0;const $m=Promise.resolve();let ff=null;function cv(c){const d=ff||$m;return c?d.then(this?c.bind(this):c):d}function pv(c){let d=Ro+1,_=Yi.length;for(;d<_;){const b=d+_>>>1,T=Yi[b],P=Zu(T);P<c||P===c&&T.pre?d=b+1:_=b}return d}function df(c){(!Yi.length||!Yi.includes(c,qu&&c.allowRecurse?Ro+1:Ro))&&(c.id==null?Yi.push(c):Yi.splice(pv(c.id),0,c),Jm())}function Jm(){!qu&&!Nh&&(Nh=!0,ff=$m.then(Qm))}function hv(c){const d=Yi.indexOf(c);d>Ro&&Yi.splice(d,1)}function fv(c){Ct(c)?Dl.push(...c):(!Ba||!Ba.includes(c,c.allowRecurse?Ts+1:Ts))&&Dl.push(c),Jm()}function Kd(c,d,_=qu?Ro+1:0){for(;_<Yi.length;_++){const b=Yi[_];if(b&&b.pre){if(c&&b.id!==c.uid)continue;Yi.splice(_,1),_--,b()}}}function Ym(c){if(Dl.length){const d=[...new Set(Dl)].sort((_,b)=>Zu(_)-Zu(b));if(Dl.length=0,Ba){Ba.push(...d);return}for(Ba=d,Ts=0;Ts<Ba.length;Ts++){const _=Ba[Ts];_.active!==!1&&_()}Ba=null,Ts=0}}const Zu=c=>c.id==null?1/0:c.id,dv=(c,d)=>{const _=Zu(c)-Zu(d);if(_===0){if(c.pre&&!d.pre)return-1;if(d.pre&&!c.pre)return 1}return _};function Qm(c){Nh=!1,qu=!0,Yi.sort(dv);const d=zn;try{for(Ro=0;Ro<Yi.length;Ro++){const _=Yi[Ro];_&&_.active!==!1&&Va(_,_.i,_.i?15:14)}}finally{Ro=0,Yi.length=0,Ym(),qu=!1,ff=null,(Yi.length||Dl.length)&&Qm()}}let Gn=null,ey=null;function pp(c){const d=Gn;return Gn=c,ey=c&&c.type.__scopeId||null,d}function jh(c,d=Gn,_){if(!d||c._n)return c;const b=(...T)=>{b._d&&om(-1);const P=pp(d);let l;try{l=c(...T)}finally{pp(P),b._d&&om(1)}return l};return b._n=!0,b._c=!0,b._d=!0,b}function bs(c,d,_,b){const T=c.dirs,P=d&&d.dirs;for(let l=0;l<T.length;l++){const J=T[l];P&&(J.oldValue=P[l].value);let U=J.dir[b];U&&(Za(),Hn(U,_,8,[c.el,J,c,d]),Ga())}}const Oa=Symbol("_leaveCb"),np=Symbol("_enterCb");function mv(){const c={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return ay(()=>{c.isMounted=!0}),sy(()=>{c.isUnmounting=!0}),c}const Zn=[Function,Array],ty={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Zn,onEnter:Zn,onAfterEnter:Zn,onEnterCancelled:Zn,onBeforeLeave:Zn,onLeave:Zn,onAfterLeave:Zn,onLeaveCancelled:Zn,onBeforeAppear:Zn,onAppear:Zn,onAfterAppear:Zn,onAppearCancelled:Zn},ry=c=>{const d=c.subTree;return d.component?ry(d.component):d},yv={name:"BaseTransition",props:ty,setup(c,{slots:d}){const _=y0(),b=mv();return()=>{const T=d.default&&ny(d.default(),!0);if(!T||!T.length)return;let P=T[0];if(T.length>1){for(const fe of T)if(fe.type!==Pn){P=fe;break}}const l=Sr(c),{mode:J}=l;if(b.isLeaving)return Ih(P);const U=$d(P);if(!U)return Ih(P);let he=qh(U,l,b,_,fe=>he=fe);hp(U,he);const se=_.subTree,Ee=se&&$d(se);if(Ee&&Ee.type!==Pn&&!Cs(U,Ee)&&ry(_).type!==Pn){const fe=qh(Ee,l,b,_);if(hp(Ee,fe),J==="out-in"&&U.type!==Pn)return b.isLeaving=!0,fe.afterLeave=()=>{b.isLeaving=!1,_.update.active!==!1&&(_.effect.dirty=!0,_.update())},Ih(P);J==="in-out"&&U.type!==Pn&&(fe.delayLeave=(ft,wt,Et)=>{const Nt=iy(b,Ee);Nt[String(Ee.key)]=Ee,ft[Oa]=()=>{wt(),ft[Oa]=void 0,delete he.delayedLeave},he.delayedLeave=Et})}return P}}},gv=yv;function iy(c,d){const{leavingVNodes:_}=c;let b=_.get(d.type);return b||(b=Object.create(null),_.set(d.type,b)),b}function qh(c,d,_,b,T){const{appear:P,mode:l,persisted:J=!1,onBeforeEnter:U,onEnter:he,onAfterEnter:se,onEnterCancelled:Ee,onBeforeLeave:fe,onLeave:ft,onAfterLeave:wt,onLeaveCancelled:Et,onBeforeAppear:Nt,onAppear:Wt,onAfterAppear:Pt,onAppearCancelled:Rt}=d,or=String(c.key),pr=iy(_,c),xt=(ht,Vt)=>{ht&&Hn(ht,b,9,Vt)},qr=(ht,Vt)=>{const Gt=Vt[1];xt(ht,Vt),Ct(ht)?ht.every(ot=>ot.length<=1)&&Gt():ht.length<=1&&Gt()},Pr={mode:l,persisted:J,beforeEnter(ht){let Vt=U;if(!_.isMounted)if(P)Vt=Nt||U;else return;ht[Oa]&&ht[Oa](!0);const Gt=pr[or];Gt&&Cs(c,Gt)&&Gt.el[Oa]&&Gt.el[Oa](),xt(Vt,[ht])},enter(ht){let Vt=he,Gt=se,ot=Ee;if(!_.isMounted)if(P)Vt=Wt||he,Gt=Pt||se,ot=Rt||Ee;else return;let vt=!1;const er=ht[np]=cn=>{vt||(vt=!0,cn?xt(ot,[ht]):xt(Gt,[ht]),Pr.delayedLeave&&Pr.delayedLeave(),ht[np]=void 0)};Vt?qr(Vt,[ht,er]):er()},leave(ht,Vt){const Gt=String(c.key);if(ht[np]&&ht[np](!0),_.isUnmounting)return Vt();xt(fe,[ht]);let ot=!1;const vt=ht[Oa]=er=>{ot||(ot=!0,Vt(),er?xt(Et,[ht]):xt(wt,[ht]),ht[Oa]=void 0,pr[Gt]===c&&delete pr[Gt])};pr[Gt]=c,ft?qr(ft,[ht,vt]):vt()},clone(ht){const Vt=qh(ht,d,_,b,T);return T&&T(Vt),Vt}};return Pr}function Ih(c){if(Sp(c))return c=Na(c),c.children=null,c}function $d(c){if(!Sp(c))return c;const{shapeFlag:d,children:_}=c;if(_){if(d&16)return _[0];if(d&32&&Lt(_.default))return _.default()}}function hp(c,d){c.shapeFlag&6&&c.component?hp(c.component.subTree,d):c.shapeFlag&128?(c.ssContent.transition=d.clone(c.ssContent),c.ssFallback.transition=d.clone(c.ssFallback)):c.transition=d}function ny(c,d=!1,_){let b=[],T=0;for(let P=0;P<c.length;P++){let l=c[P];const J=_==null?l.key:String(_)+String(l.key!=null?l.key:P);l.type===lo?(l.patchFlag&128&&T++,b=b.concat(ny(l.children,d,J))):(d||l.type!==Pn)&&b.push(J!=null?Na(l,{key:J}):l)}if(T>1)for(let P=0;P<b.length;P++)b[P].patchFlag=-2;return b}/*! #__NO_SIDE_EFFECTS__ */function wp(c,d){return Lt(c)?(()=>ki({name:c.name},d,{setup:c}))():c}const ap=c=>!!c.type.__asyncLoader,Sp=c=>c.type.__isKeepAlive;function _v(c,d){oy(c,"a",d)}function vv(c,d){oy(c,"da",d)}function oy(c,d,_=ji){const b=c.__wdc||(c.__wdc=()=>{let T=_;for(;T;){if(T.isDeactivated)return;T=T.parent}return c()});if(Ep(d,b,_),_){let T=_.parent;for(;T&&T.parent;)Sp(T.parent.vnode)&&xv(b,d,_,T),T=T.parent}}function xv(c,d,_,b){const T=Ep(d,c,b,!0);ly(()=>{Qh(b[d],T)},_)}function Ep(c,d,_=ji,b=!1){if(_){const T=_[c]||(_[c]=[]),P=d.__weh||(d.__weh=(...l)=>{Za();const J=Wu(_),U=Hn(d,_,c,l);return J(),Ga(),U});return b?T.unshift(P):T.push(P),P}}const fa=c=>(d,_=ji)=>{(!Cp||c==="sp")&&Ep(c,(...b)=>d(...b),_)},bv=fa("bm"),ay=fa("m"),wv=fa("bu"),Sv=fa("u"),sy=fa("bum"),ly=fa("um"),Ev=fa("sp"),Tv=fa("rtg"),Iv=fa("rtc");function Cv(c,d=ji){Ep("ec",c,d)}const uy="components";function Ch(c,d){return Pv(uy,c,!0,d)||c}const Av=Symbol.for("v-ndc");function Pv(c,d,_=!0,b=!1){const T=Gn||ji;if(T){const P=T.type;if(c===uy){const J=b0(P,!1);if(J&&(J===d||J===uo(d)||J===vp(uo(d))))return P}const l=Jd(T[c]||P[c],d)||Jd(T.appContext[c],d);return!l&&b?P:l}}function Jd(c,d){return c&&(c[d]||c[uo(d)]||c[vp(uo(d))])}const Zh=c=>c?zy(c)?_f(c):Zh(c.parent):null,Uu=ki(Object.create(null),{$:c=>c,$el:c=>c.vnode.el,$data:c=>c.data,$props:c=>c.props,$attrs:c=>c.attrs,$slots:c=>c.slots,$refs:c=>c.refs,$parent:c=>Zh(c.parent),$root:c=>Zh(c.root),$emit:c=>c.emit,$options:c=>mf(c),$forceUpdate:c=>c.f||(c.f=()=>{c.effect.dirty=!0,df(c.update)}),$nextTick:c=>c.n||(c.n=cv.bind(c.proxy)),$watch:c=>e0.bind(c)}),Ah=(c,d)=>c!==Jr&&!c.__isScriptSetup&&nr(c,d),zv={get({_:c},d){if(d==="__v_skip")return!0;const{ctx:_,setupState:b,data:T,props:P,accessCache:l,type:J,appContext:U}=c;let he;if(d[0]!=="$"){const ft=l[d];if(ft!==void 0)switch(ft){case 1:return b[d];case 2:return T[d];case 4:return _[d];case 3:return P[d]}else{if(Ah(b,d))return l[d]=1,b[d];if(T!==Jr&&nr(T,d))return l[d]=2,T[d];if((he=c.propsOptions[0])&&nr(he,d))return l[d]=3,P[d];if(_!==Jr&&nr(_,d))return l[d]=4,_[d];Gh&&(l[d]=0)}}const se=Uu[d];let Ee,fe;if(se)return d==="$attrs"&&wn(c.attrs,"get",""),se(c);if((Ee=J.__cssModules)&&(Ee=Ee[d]))return Ee;if(_!==Jr&&nr(_,d))return l[d]=4,_[d];if(fe=U.config.globalProperties,nr(fe,d))return fe[d]},set({_:c},d,_){const{data:b,setupState:T,ctx:P}=c;return Ah(T,d)?(T[d]=_,!0):b!==Jr&&nr(b,d)?(b[d]=_,!0):nr(c.props,d)||d[0]==="$"&&d.slice(1)in c?!1:(P[d]=_,!0)},has({_:{data:c,setupState:d,accessCache:_,ctx:b,appContext:T,propsOptions:P}},l){let J;return!!_[l]||c!==Jr&&nr(c,l)||Ah(d,l)||(J=P[0])&&nr(J,l)||nr(b,l)||nr(Uu,l)||nr(T.config.globalProperties,l)},defineProperty(c,d,_){return _.get!=null?c._.accessCache[d]=0:nr(_,"value")&&this.set(c,d,_.value,null),Reflect.defineProperty(c,d,_)}};function Yd(c){return Ct(c)?c.reduce((d,_)=>(d[_]=null,d),{}):c}let Gh=!0;function Mv(c){const d=mf(c),_=c.proxy,b=c.ctx;Gh=!1,d.beforeCreate&&Qd(d.beforeCreate,c,"bc");const{data:T,computed:P,methods:l,watch:J,provide:U,inject:he,created:se,beforeMount:Ee,mounted:fe,beforeUpdate:ft,updated:wt,activated:Et,deactivated:Nt,beforeDestroy:Wt,beforeUnmount:Pt,destroyed:Rt,unmounted:or,render:pr,renderTracked:xt,renderTriggered:qr,errorCaptured:Pr,serverPrefetch:ht,expose:Vt,inheritAttrs:Gt,components:ot,directives:vt,filters:er}=d;if(he&&kv(he,b,null),l)for(const ar in l){const Kt=l[ar];Lt(Kt)&&(b[ar]=Kt.bind(_))}if(T){const ar=T.call(_,_);jr(ar)&&(c.data=uf(ar))}if(Gh=!0,P)for(const ar in P){const Kt=P[ar],pn=Lt(Kt)?Kt.bind(_,_):Lt(Kt.get)?Kt.get.bind(_,_):zn,Qi=!Lt(Kt)&&Lt(Kt.set)?Kt.set.bind(_):zn,ii=S0({get:pn,set:Qi});Object.defineProperty(b,ar,{enumerable:!0,configurable:!0,get:()=>ii.value,set:Zr=>ii.value=Zr})}if(J)for(const ar in J)cy(J[ar],b,_,ar);if(U){const ar=Lt(U)?U.call(_):U;Reflect.ownKeys(ar).forEach(Kt=>{Fv(Kt,ar[Kt])})}se&&Qd(se,c,"c");function Jt(ar,Kt){Ct(Kt)?Kt.forEach(pn=>ar(pn.bind(_))):Kt&&ar(Kt.bind(_))}if(Jt(bv,Ee),Jt(ay,fe),Jt(wv,ft),Jt(Sv,wt),Jt(_v,Et),Jt(vv,Nt),Jt(Cv,Pr),Jt(Iv,xt),Jt(Tv,qr),Jt(sy,Pt),Jt(ly,or),Jt(Ev,ht),Ct(Vt))if(Vt.length){const ar=c.exposed||(c.exposed={});Vt.forEach(Kt=>{Object.defineProperty(ar,Kt,{get:()=>_[Kt],set:pn=>_[Kt]=pn})})}else c.exposed||(c.exposed={});pr&&c.render===zn&&(c.render=pr),Gt!=null&&(c.inheritAttrs=Gt),ot&&(c.components=ot),vt&&(c.directives=vt)}function kv(c,d,_=zn){Ct(c)&&(c=Hh(c));for(const b in c){const T=c[b];let P;jr(T)?"default"in T?P=sp(T.from||b,T.default,!0):P=sp(T.from||b):P=sp(T),kn(P)?Object.defineProperty(d,b,{enumerable:!0,configurable:!0,get:()=>P.value,set:l=>P.value=l}):d[b]=P}}function Qd(c,d,_){Hn(Ct(c)?c.map(b=>b.bind(d.proxy)):c.bind(d.proxy),d,_)}function cy(c,d,_,b){const T=b.includes(".")?Ey(_,b):()=>_[b];if(wi(c)){const P=d[c];Lt(P)&&zh(T,P)}else if(Lt(c))zh(T,c.bind(_));else if(jr(c))if(Ct(c))c.forEach(P=>cy(P,d,_,b));else{const P=Lt(c.handler)?c.handler.bind(_):d[c.handler];Lt(P)&&zh(T,P,c)}}function mf(c){const d=c.type,{mixins:_,extends:b}=d,{mixins:T,optionsCache:P,config:{optionMergeStrategies:l}}=c.appContext,J=P.get(d);let U;return J?U=J:!T.length&&!_&&!b?U=d:(U={},T.length&&T.forEach(he=>fp(U,he,l,!0)),fp(U,d,l)),jr(d)&&P.set(d,U),U}function fp(c,d,_,b=!1){const{mixins:T,extends:P}=d;P&&fp(c,P,_,!0),T&&T.forEach(l=>fp(c,l,_,!0));for(const l in d)if(!(b&&l==="expose")){const J=Lv[l]||_&&_[l];c[l]=J?J(c[l],d[l]):d[l]}return c}const Lv={data:em,props:tm,emits:tm,methods:Bu,computed:Bu,beforeCreate:un,created:un,beforeMount:un,mounted:un,beforeUpdate:un,updated:un,beforeDestroy:un,beforeUnmount:un,destroyed:un,unmounted:un,activated:un,deactivated:un,errorCaptured:un,serverPrefetch:un,components:Bu,directives:Bu,watch:Rv,provide:em,inject:Dv};function em(c,d){return d?c?function(){return ki(Lt(c)?c.call(this,this):c,Lt(d)?d.call(this,this):d)}:d:c}function Dv(c,d){return Bu(Hh(c),Hh(d))}function Hh(c){if(Ct(c)){const d={};for(let _=0;_<c.length;_++)d[c[_]]=c[_];return d}return c}function un(c,d){return c?[...new Set([].concat(c,d))]:d}function Bu(c,d){return c?ki(Object.create(null),c,d):d}function tm(c,d){return c?Ct(c)&&Ct(d)?[...new Set([...c,...d])]:ki(Object.create(null),Yd(c),Yd(d??{})):d}function Rv(c,d){if(!c)return d;if(!d)return c;const _=ki(Object.create(null),c);for(const b in d)_[b]=un(c[b],d[b]);return _}function py(){return{app:null,config:{isNativeTag:w_,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Bv=0;function Ov(c,d){return function(b,T=null){Lt(b)||(b=ki({},b)),T!=null&&!jr(T)&&(T=null);const P=py(),l=new WeakSet;let J=!1;const U=P.app={_uid:Bv++,_component:b,_props:T,_container:null,_context:P,_instance:null,version:T0,get config(){return P.config},set config(he){},use(he,...se){return l.has(he)||(he&&Lt(he.install)?(l.add(he),he.install(U,...se)):Lt(he)&&(l.add(he),he(U,...se))),U},mixin(he){return P.mixins.includes(he)||P.mixins.push(he),U},component(he,se){return se?(P.components[he]=se,U):P.components[he]},directive(he,se){return se?(P.directives[he]=se,U):P.directives[he]},mount(he,se,Ee){if(!J){const fe=qi(b,T);return fe.appContext=P,Ee===!0?Ee="svg":Ee===!1&&(Ee=void 0),se&&d?d(fe,he):c(fe,he,Ee),J=!0,U._container=he,he.__vue_app__=U,_f(fe.component)}},unmount(){J&&(c(null,U._container),delete U._container.__vue_app__)},provide(he,se){return P.provides[he]=se,U},runWithContext(he){const se=Vu;Vu=U;try{return he()}finally{Vu=se}}};return U}}let Vu=null;function Fv(c,d){if(ji){let _=ji.provides;const b=ji.parent&&ji.parent.provides;b===_&&(_=ji.provides=Object.create(b)),_[c]=d}}function sp(c,d,_=!1){const b=ji||Gn;if(b||Vu){const T=b?b.parent==null?b.vnode.appContext&&b.vnode.appContext.provides:b.parent.provides:Vu._context.provides;if(T&&c in T)return T[c];if(arguments.length>1)return _&&Lt(d)?d.call(b&&b.proxy):d}}const hy={},fy=()=>Object.create(hy),dy=c=>Object.getPrototypeOf(c)===hy;function Uv(c,d,_,b=!1){const T={},P=fy();c.propsDefaults=Object.create(null),my(c,d,T,P);for(const l in c.propsOptions[0])l in T||(T[l]=void 0);_?c.props=b?T:iv(T):c.type.props?c.props=T:c.props=P,c.attrs=P}function Vv(c,d,_,b){const{props:T,attrs:P,vnode:{patchFlag:l}}=c,J=Sr(T),[U]=c.propsOptions;let he=!1;if((b||l>0)&&!(l&16)){if(l&8){const se=c.vnode.dynamicProps;for(let Ee=0;Ee<se.length;Ee++){let fe=se[Ee];if(Tp(c.emitsOptions,fe))continue;const ft=d[fe];if(U)if(nr(P,fe))ft!==P[fe]&&(P[fe]=ft,he=!0);else{const wt=uo(fe);T[wt]=Xh(U,J,wt,ft,c,!1)}else ft!==P[fe]&&(P[fe]=ft,he=!0)}}}else{my(c,d,T,P)&&(he=!0);let se;for(const Ee in J)(!d||!nr(d,Ee)&&((se=qa(Ee))===Ee||!nr(d,se)))&&(U?_&&(_[Ee]!==void 0||_[se]!==void 0)&&(T[Ee]=Xh(U,J,Ee,void 0,c,!0)):delete T[Ee]);if(P!==J)for(const Ee in P)(!d||!nr(d,Ee))&&(delete P[Ee],he=!0)}he&&ha(c.attrs,"set","")}function my(c,d,_,b){const[T,P]=c.propsOptions;let l=!1,J;if(d)for(let U in d){if(Ou(U))continue;const he=d[U];let se;T&&nr(T,se=uo(U))?!P||!P.includes(se)?_[se]=he:(J||(J={}))[se]=he:Tp(c.emitsOptions,U)||(!(U in b)||he!==b[U])&&(b[U]=he,l=!0)}if(P){const U=Sr(_),he=J||Jr;for(let se=0;se<P.length;se++){const Ee=P[se];_[Ee]=Xh(T,U,Ee,he[Ee],c,!nr(he,Ee))}}return l}function Xh(c,d,_,b,T,P){const l=c[_];if(l!=null){const J=nr(l,"default");if(J&&b===void 0){const U=l.default;if(l.type!==Function&&!l.skipFactory&&Lt(U)){const{propsDefaults:he}=T;if(_ in he)b=he[_];else{const se=Wu(T);b=he[_]=U.call(null,d),se()}}else b=U}l[0]&&(P&&!J?b=!1:l[1]&&(b===""||b===qa(_))&&(b=!0))}return b}const Nv=new WeakMap;function yy(c,d,_=!1){const b=_?Nv:d.propsCache,T=b.get(c);if(T)return T;const P=c.props,l={},J=[];let U=!1;if(!Lt(c)){const se=Ee=>{U=!0;const[fe,ft]=yy(Ee,d,!0);ki(l,fe),ft&&J.push(...ft)};!_&&d.mixins.length&&d.mixins.forEach(se),c.extends&&se(c.extends),c.mixins&&c.mixins.forEach(se)}if(!P&&!U)return jr(c)&&b.set(c,kl),kl;if(Ct(P))for(let se=0;se<P.length;se++){const Ee=uo(P[se]);rm(Ee)&&(l[Ee]=Jr)}else if(P)for(const se in P){const Ee=uo(se);if(rm(Ee)){const fe=P[se],ft=l[Ee]=Ct(fe)||Lt(fe)?{type:fe}:ki({},fe),wt=ft.type;let Et=!1,Nt=!0;if(Ct(wt))for(let Wt=0;Wt<wt.length;++Wt){const Pt=wt[Wt],Rt=Lt(Pt)&&Pt.name;if(Rt==="Boolean"){Et=!0;break}else Rt==="String"&&(Nt=!1)}else Et=Lt(wt)&&wt.name==="Boolean";ft[0]=Et,ft[1]=Nt,(Et||nr(ft,"default"))&&J.push(Ee)}}const he=[l,J];return jr(c)&&b.set(c,he),he}function rm(c){return c[0]!=="$"&&!Ou(c)}const gy=c=>c[0]==="_"||c==="$stable",yf=c=>Ct(c)?c.map(Do):[Do(c)],jv=(c,d,_)=>{if(d._n)return d;const b=jh((...T)=>yf(d(...T)),_);return b._c=!1,b},_y=(c,d,_)=>{const b=c._ctx;for(const T in c){if(gy(T))continue;const P=c[T];if(Lt(P))d[T]=jv(T,P,b);else if(P!=null){const l=yf(P);d[T]=()=>l}}},vy=(c,d)=>{const _=yf(d);c.slots.default=()=>_},xy=(c,d,_)=>{for(const b in d)(_||b!=="_")&&(c[b]=d[b])},qv=(c,d,_)=>{const b=c.slots=fy();if(c.vnode.shapeFlag&32){const T=d._;T?(xy(b,d,_),_&&zm(b,"_",T,!0)):_y(d,b)}else d&&vy(c,d)},Zv=(c,d,_)=>{const{vnode:b,slots:T}=c;let P=!0,l=Jr;if(b.shapeFlag&32){const J=d._;J?_&&J===1?P=!1:xy(T,d,_):(P=!d.$stable,_y(d,T)),l=d}else d&&(vy(c,d),l={default:1});if(P)for(const J in T)!gy(J)&&l[J]==null&&delete T[J]};function Wh(c,d,_,b,T=!1){if(Ct(c)){c.forEach((fe,ft)=>Wh(fe,d&&(Ct(d)?d[ft]:d),_,b,T));return}if(ap(b)&&!T)return;const P=b.shapeFlag&4?_f(b.component):b.el,l=T?null:P,{i:J,r:U}=c,he=d&&d.r,se=J.refs===Jr?J.refs={}:J.refs,Ee=J.setupState;if(he!=null&&he!==U&&(wi(he)?(se[he]=null,nr(Ee,he)&&(Ee[he]=null)):kn(he)&&(he.value=null)),Lt(U))Va(U,J,12,[l,se]);else{const fe=wi(U),ft=kn(U);if(fe||ft){const wt=()=>{if(c.f){const Et=fe?nr(Ee,U)?Ee[U]:se[U]:U.value;T?Ct(Et)&&Qh(Et,P):Ct(Et)?Et.includes(P)||Et.push(P):fe?(se[U]=[P],nr(Ee,U)&&(Ee[U]=se[U])):(U.value=[P],c.k&&(se[c.k]=U.value))}else fe?(se[U]=l,nr(Ee,U)&&(Ee[U]=l)):ft&&(U.value=l,c.k&&(se[c.k]=l))};l?(wt.id=-1,bn(wt,_)):wt()}}}const Gv=Symbol("_vte"),Hv=c=>c.__isTeleport;function Xv(){typeof __VUE_PROD_HYDRATION_MISMATCH_DETAILS__!="boolean"&&(tf().__VUE_PROD_HYDRATION_MISMATCH_DETAILS__=!1)}const bn=l0;function Wv(c){return Kv(c)}function Kv(c,d){Xv();const _=tf();_.__VUE__=!0;const{insert:b,remove:T,patchProp:P,createElement:l,createText:J,createComment:U,setText:he,setElementText:se,parentNode:Ee,nextSibling:fe,setScopeId:ft=zn,insertStaticContent:wt}=c,Et=(H,ie,ye,Te=null,Ie=null,Ce=null,Ge=void 0,Le=null,Oe=!!ie.dynamicChildren)=>{if(H===ie)return;H&&!Cs(H,ie)&&(Te=Gr(H),Zr(H,Ie,Ce,!0),H=null),ie.patchFlag===-2&&(Oe=!1,ie.dynamicChildren=null);const{type:Pe,ref:He,shapeFlag:Ye}=ie;switch(Pe){case Ip:Nt(H,ie,ye,Te);break;case Pn:Wt(H,ie,ye,Te);break;case kh:H==null&&Pt(ie,ye,Te,Ge);break;case lo:ot(H,ie,ye,Te,Ie,Ce,Ge,Le,Oe);break;default:Ye&1?pr(H,ie,ye,Te,Ie,Ce,Ge,Le,Oe):Ye&6?vt(H,ie,ye,Te,Ie,Ce,Ge,Le,Oe):(Ye&64||Ye&128)&&Pe.process(H,ie,ye,Te,Ie,Ce,Ge,Le,Oe,yi)}He!=null&&Ie&&Wh(He,H&&H.ref,Ce,ie||H,!ie)},Nt=(H,ie,ye,Te)=>{if(H==null)b(ie.el=J(ie.children),ye,Te);else{const Ie=ie.el=H.el;ie.children!==H.children&&he(Ie,ie.children)}},Wt=(H,ie,ye,Te)=>{H==null?b(ie.el=U(ie.children||""),ye,Te):ie.el=H.el},Pt=(H,ie,ye,Te)=>{[H.el,H.anchor]=wt(H.children,ie,ye,Te,H.el,H.anchor)},Rt=({el:H,anchor:ie},ye,Te)=>{let Ie;for(;H&&H!==ie;)Ie=fe(H),b(H,ye,Te),H=Ie;b(ie,ye,Te)},or=({el:H,anchor:ie})=>{let ye;for(;H&&H!==ie;)ye=fe(H),T(H),H=ye;T(ie)},pr=(H,ie,ye,Te,Ie,Ce,Ge,Le,Oe)=>{ie.type==="svg"?Ge="svg":ie.type==="math"&&(Ge="mathml"),H==null?xt(ie,ye,Te,Ie,Ce,Ge,Le,Oe):ht(H,ie,Ie,Ce,Ge,Le,Oe)},xt=(H,ie,ye,Te,Ie,Ce,Ge,Le)=>{let Oe,Pe;const{props:He,shapeFlag:Ye,transition:it,dirs:ut}=H;if(Oe=H.el=l(H.type,Ce,He&&He.is,He),Ye&8?se(Oe,H.children):Ye&16&&Pr(H.children,Oe,null,Te,Ie,Ph(H,Ce),Ge,Le),ut&&bs(H,null,Te,"created"),qr(Oe,H,H.scopeId,Ge,Te),He){for(const sr in He)sr!=="value"&&!Ou(sr)&&P(Oe,sr,null,He[sr],Ce,Te);"value"in He&&P(Oe,"value",null,He.value,Ce),(Pe=He.onVnodeBeforeMount)&&Lo(Pe,Te,H)}ut&&bs(H,null,Te,"beforeMount");const Mt=$v(Ie,it);Mt&&it.beforeEnter(Oe),b(Oe,ie,ye),((Pe=He&&He.onVnodeMounted)||Mt||ut)&&bn(()=>{Pe&&Lo(Pe,Te,H),Mt&&it.enter(Oe),ut&&bs(H,null,Te,"mounted")},Ie)},qr=(H,ie,ye,Te,Ie)=>{if(ye&&ft(H,ye),Te)for(let Ce=0;Ce<Te.length;Ce++)ft(H,Te[Ce]);if(Ie){let Ce=Ie.subTree;if(ie===Ce){const Ge=Ie.vnode;qr(H,Ge,Ge.scopeId,Ge.slotScopeIds,Ie.parent)}}},Pr=(H,ie,ye,Te,Ie,Ce,Ge,Le,Oe=0)=>{for(let Pe=Oe;Pe<H.length;Pe++){const He=H[Pe]=Le?Fa(H[Pe]):Do(H[Pe]);Et(null,He,ie,ye,Te,Ie,Ce,Ge,Le)}},ht=(H,ie,ye,Te,Ie,Ce,Ge)=>{const Le=ie.el=H.el;let{patchFlag:Oe,dynamicChildren:Pe,dirs:He}=ie;Oe|=H.patchFlag&16;const Ye=H.props||Jr,it=ie.props||Jr;let ut;if(ye&&ws(ye,!1),(ut=it.onVnodeBeforeUpdate)&&Lo(ut,ye,ie,H),He&&bs(ie,H,ye,"beforeUpdate"),ye&&ws(ye,!0),(Ye.innerHTML&&it.innerHTML==null||Ye.textContent&&it.textContent==null)&&se(Le,""),Pe?Vt(H.dynamicChildren,Pe,Le,ye,Te,Ph(ie,Ie),Ce):Ge||Kt(H,ie,Le,null,ye,Te,Ph(ie,Ie),Ce,!1),Oe>0){if(Oe&16)Gt(Le,Ye,it,ye,Ie);else if(Oe&2&&Ye.class!==it.class&&P(Le,"class",null,it.class,Ie),Oe&4&&P(Le,"style",Ye.style,it.style,Ie),Oe&8){const Mt=ie.dynamicProps;for(let sr=0;sr<Mt.length;sr++){const Zt=Mt[sr],zr=Ye[Zt],hi=it[Zt];(hi!==zr||Zt==="value")&&P(Le,Zt,zr,hi,Ie,ye)}}Oe&1&&H.children!==ie.children&&se(Le,ie.children)}else!Ge&&Pe==null&&Gt(Le,Ye,it,ye,Ie);((ut=it.onVnodeUpdated)||He)&&bn(()=>{ut&&Lo(ut,ye,ie,H),He&&bs(ie,H,ye,"updated")},Te)},Vt=(H,ie,ye,Te,Ie,Ce,Ge)=>{for(let Le=0;Le<ie.length;Le++){const Oe=H[Le],Pe=ie[Le],He=Oe.el&&(Oe.type===lo||!Cs(Oe,Pe)||Oe.shapeFlag&70)?Ee(Oe.el):ye;Et(Oe,Pe,He,null,Te,Ie,Ce,Ge,!0)}},Gt=(H,ie,ye,Te,Ie)=>{if(ie!==ye){if(ie!==Jr)for(const Ce in ie)!Ou(Ce)&&!(Ce in ye)&&P(H,Ce,ie[Ce],null,Ie,Te);for(const Ce in ye){if(Ou(Ce))continue;const Ge=ye[Ce],Le=ie[Ce];Ge!==Le&&Ce!=="value"&&P(H,Ce,Le,Ge,Ie,Te)}"value"in ye&&P(H,"value",ie.value,ye.value,Ie)}},ot=(H,ie,ye,Te,Ie,Ce,Ge,Le,Oe)=>{const Pe=ie.el=H?H.el:J(""),He=ie.anchor=H?H.anchor:J("");let{patchFlag:Ye,dynamicChildren:it,slotScopeIds:ut}=ie;ut&&(Le=Le?Le.concat(ut):ut),H==null?(b(Pe,ye,Te),b(He,ye,Te),Pr(ie.children||[],ye,He,Ie,Ce,Ge,Le,Oe)):Ye>0&&Ye&64&&it&&H.dynamicChildren?(Vt(H.dynamicChildren,it,ye,Ie,Ce,Ge,Le),(ie.key!=null||Ie&&ie===Ie.subTree)&&by(H,ie,!0)):Kt(H,ie,ye,He,Ie,Ce,Ge,Le,Oe)},vt=(H,ie,ye,Te,Ie,Ce,Ge,Le,Oe)=>{ie.slotScopeIds=Le,H==null?ie.shapeFlag&512?Ie.ctx.activate(ie,ye,Te,Ge,Oe):er(ie,ye,Te,Ie,Ce,Ge,Oe):cn(H,ie,Oe)},er=(H,ie,ye,Te,Ie,Ce,Ge)=>{const Le=H.component=m0(H,Te,Ie);if(Sp(H)&&(Le.ctx.renderer=yi),g0(Le,!1,Ge),Le.asyncDep){if(Ie&&Ie.registerDep(Le,Jt,Ge),!H.el){const Oe=Le.subTree=qi(Pn);Wt(null,Oe,ie,ye)}}else Jt(Le,H,ie,ye,Ie,Ce,Ge)},cn=(H,ie,ye)=>{const Te=ie.component=H.component;if(o0(H,ie,ye))if(Te.asyncDep&&!Te.asyncResolved){ar(Te,ie,ye);return}else Te.next=ie,hv(Te.update),Te.effect.dirty=!0,Te.update();else ie.el=H.el,Te.vnode=ie},Jt=(H,ie,ye,Te,Ie,Ce,Ge)=>{const Le=()=>{if(H.isMounted){let{next:He,bu:Ye,u:it,parent:ut,vnode:Mt}=H;{const Sn=wy(H);if(Sn){He&&(He.el=Mt.el,ar(H,He,Ge)),Sn.asyncDep.then(()=>{H.isUnmounted||Le()});return}}let sr=He,Zt;ws(H,!1),He?(He.el=Mt.el,ar(H,He,Ge)):He=Mt,Ye&&Sh(Ye),(Zt=He.props&&He.props.onVnodeBeforeUpdate)&&Lo(Zt,ut,He,Mt),ws(H,!0);const zr=Mh(H),hi=H.subTree;H.subTree=zr,Et(hi,zr,Ee(hi.el),Gr(hi),H,Ie,Ce),He.el=zr.el,sr===null&&a0(H,zr.el),it&&bn(it,Ie),(Zt=He.props&&He.props.onVnodeUpdated)&&bn(()=>Lo(Zt,ut,He,Mt),Ie)}else{let He;const{el:Ye,props:it}=ie,{bm:ut,m:Mt,parent:sr}=H,Zt=ap(ie);if(ws(H,!1),ut&&Sh(ut),!Zt&&(He=it&&it.onVnodeBeforeMount)&&Lo(He,sr,ie),ws(H,!0),Ye&&Li){const zr=()=>{H.subTree=Mh(H),Li(Ye,H.subTree,H,Ie,null)};Zt?ie.type.__asyncLoader().then(()=>!H.isUnmounted&&zr()):zr()}else{const zr=H.subTree=Mh(H);Et(null,zr,ye,Te,H,Ie,Ce),ie.el=zr.el}if(Mt&&bn(Mt,Ie),!Zt&&(He=it&&it.onVnodeMounted)){const zr=ie;bn(()=>Lo(He,sr,zr),Ie)}(ie.shapeFlag&256||sr&&ap(sr.vnode)&&sr.vnode.shapeFlag&256)&&H.a&&bn(H.a,Ie),H.isMounted=!0,ie=ye=Te=null}},Oe=H.effect=new nf(Le,zn,()=>df(Pe),H.scope),Pe=H.update=()=>{Oe.dirty&&Oe.run()};Pe.i=H,Pe.id=H.uid,ws(H,!0),Pe()},ar=(H,ie,ye)=>{ie.component=H;const Te=H.vnode.props;H.vnode=ie,H.next=null,Vv(H,ie.props,Te,ye),Zv(H,ie.children,ye),Za(),Kd(H),Ga()},Kt=(H,ie,ye,Te,Ie,Ce,Ge,Le,Oe=!1)=>{const Pe=H&&H.children,He=H?H.shapeFlag:0,Ye=ie.children,{patchFlag:it,shapeFlag:ut}=ie;if(it>0){if(it&128){Qi(Pe,Ye,ye,Te,Ie,Ce,Ge,Le,Oe);return}else if(it&256){pn(Pe,Ye,ye,Te,Ie,Ce,Ge,Le,Oe);return}}ut&8?(He&16&&Wn(Pe,Ie,Ce),Ye!==Pe&&se(ye,Ye)):He&16?ut&16?Qi(Pe,Ye,ye,Te,Ie,Ce,Ge,Le,Oe):Wn(Pe,Ie,Ce,!0):(He&8&&se(ye,""),ut&16&&Pr(Ye,ye,Te,Ie,Ce,Ge,Le,Oe))},pn=(H,ie,ye,Te,Ie,Ce,Ge,Le,Oe)=>{H=H||kl,ie=ie||kl;const Pe=H.length,He=ie.length,Ye=Math.min(Pe,He);let it;for(it=0;it<Ye;it++){const ut=ie[it]=Oe?Fa(ie[it]):Do(ie[it]);Et(H[it],ut,ye,null,Ie,Ce,Ge,Le,Oe)}Pe>He?Wn(H,Ie,Ce,!0,!1,Ye):Pr(ie,ye,Te,Ie,Ce,Ge,Le,Oe,Ye)},Qi=(H,ie,ye,Te,Ie,Ce,Ge,Le,Oe)=>{let Pe=0;const He=ie.length;let Ye=H.length-1,it=He-1;for(;Pe<=Ye&&Pe<=it;){const ut=H[Pe],Mt=ie[Pe]=Oe?Fa(ie[Pe]):Do(ie[Pe]);if(Cs(ut,Mt))Et(ut,Mt,ye,null,Ie,Ce,Ge,Le,Oe);else break;Pe++}for(;Pe<=Ye&&Pe<=it;){const ut=H[Ye],Mt=ie[it]=Oe?Fa(ie[it]):Do(ie[it]);if(Cs(ut,Mt))Et(ut,Mt,ye,null,Ie,Ce,Ge,Le,Oe);else break;Ye--,it--}if(Pe>Ye){if(Pe<=it){const ut=it+1,Mt=ut<He?ie[ut].el:Te;for(;Pe<=it;)Et(null,ie[Pe]=Oe?Fa(ie[Pe]):Do(ie[Pe]),ye,Mt,Ie,Ce,Ge,Le,Oe),Pe++}}else if(Pe>it)for(;Pe<=Ye;)Zr(H[Pe],Ie,Ce,!0),Pe++;else{const ut=Pe,Mt=Pe,sr=new Map;for(Pe=Mt;Pe<=it;Pe++){const ni=ie[Pe]=Oe?Fa(ie[Pe]):Do(ie[Pe]);ni.key!=null&&sr.set(ni.key,Pe)}let Zt,zr=0;const hi=it-Mt+1;let Sn=!1,Kn=0;const En=new Array(hi);for(Pe=0;Pe<hi;Pe++)En[Pe]=0;for(Pe=ut;Pe<=Ye;Pe++){const ni=H[Pe];if(zr>=hi){Zr(ni,Ie,Ce,!0);continue}let Si;if(ni.key!=null)Si=sr.get(ni.key);else for(Zt=Mt;Zt<=it;Zt++)if(En[Zt-Mt]===0&&Cs(ni,ie[Zt])){Si=Zt;break}Si===void 0?Zr(ni,Ie,Ce,!0):(En[Si-Mt]=Pe+1,Si>=Kn?Kn=Si:Sn=!0,Et(ni,ie[Si],ye,null,Ie,Ce,Ge,Le,Oe),zr++)}const Bn=Sn?Jv(En):kl;for(Zt=Bn.length-1,Pe=hi-1;Pe>=0;Pe--){const ni=Mt+Pe,Si=ie[ni],Bo=ni+1<He?ie[ni+1].el:Te;En[Pe]===0?Et(null,Si,ye,Bo,Ie,Ce,Ge,Le,Oe):Sn&&(Zt<0||Pe!==Bn[Zt]?ii(Si,ye,Bo,2):Zt--)}}},ii=(H,ie,ye,Te,Ie=null)=>{const{el:Ce,type:Ge,transition:Le,children:Oe,shapeFlag:Pe}=H;if(Pe&6){ii(H.component.subTree,ie,ye,Te);return}if(Pe&128){H.suspense.move(ie,ye,Te);return}if(Pe&64){Ge.move(H,ie,ye,yi);return}if(Ge===lo){b(Ce,ie,ye);for(let Ye=0;Ye<Oe.length;Ye++)ii(Oe[Ye],ie,ye,Te);b(H.anchor,ie,ye);return}if(Ge===kh){Rt(H,ie,ye);return}if(Te!==2&&Pe&1&&Le)if(Te===0)Le.beforeEnter(Ce),b(Ce,ie,ye),bn(()=>Le.enter(Ce),Ie);else{const{leave:Ye,delayLeave:it,afterLeave:ut}=Le,Mt=()=>b(Ce,ie,ye),sr=()=>{Ye(Ce,()=>{Mt(),ut&&ut()})};it?it(Ce,Mt,sr):sr()}else b(Ce,ie,ye)},Zr=(H,ie,ye,Te=!1,Ie=!1)=>{const{type:Ce,props:Ge,ref:Le,children:Oe,dynamicChildren:Pe,shapeFlag:He,patchFlag:Ye,dirs:it,cacheIndex:ut}=H;if(Ye===-2&&(Ie=!1),Le!=null&&Wh(Le,null,ye,H,!0),ut!=null&&(ie.renderCache[ut]=void 0),He&256){ie.ctx.deactivate(H);return}const Mt=He&1&&it,sr=!ap(H);let Zt;if(sr&&(Zt=Ge&&Ge.onVnodeBeforeUnmount)&&Lo(Zt,ie,H),He&6)Dn(H.component,ye,Te);else{if(He&128){H.suspense.unmount(ye,Te);return}Mt&&bs(H,null,ie,"beforeUnmount"),He&64?H.type.remove(H,ie,ye,yi,Te):Pe&&!Pe.hasOnce&&(Ce!==lo||Ye>0&&Ye&64)?Wn(Pe,ie,ye,!1,!0):(Ce===lo&&Ye&384||!Ie&&He&16)&&Wn(Oe,ie,ye),Te&&Ln(H)}(sr&&(Zt=Ge&&Ge.onVnodeUnmounted)||Mt)&&bn(()=>{Zt&&Lo(Zt,ie,H),Mt&&bs(H,null,ie,"unmounted")},ye)},Ln=H=>{const{type:ie,el:ye,anchor:Te,transition:Ie}=H;if(ie===lo){Xn(ye,Te);return}if(ie===kh){or(H);return}const Ce=()=>{T(ye),Ie&&!Ie.persisted&&Ie.afterLeave&&Ie.afterLeave()};if(H.shapeFlag&1&&Ie&&!Ie.persisted){const{leave:Ge,delayLeave:Le}=Ie,Oe=()=>Ge(ye,Ce);Le?Le(H.el,Ce,Oe):Oe()}else Ce()},Xn=(H,ie)=>{let ye;for(;H!==ie;)ye=fe(H),T(H),H=ye;T(ie)},Dn=(H,ie,ye)=>{const{bum:Te,scope:Ie,update:Ce,subTree:Ge,um:Le,m:Oe,a:Pe}=H;im(Oe),im(Pe),Te&&Sh(Te),Ie.stop(),Ce&&(Ce.active=!1,Zr(Ge,H,ie,ye)),Le&&bn(Le,ie),bn(()=>{H.isUnmounted=!0},ie),ie&&ie.pendingBranch&&!ie.isUnmounted&&H.asyncDep&&!H.asyncResolved&&H.suspenseId===ie.pendingId&&(ie.deps--,ie.deps===0&&ie.resolve())},Wn=(H,ie,ye,Te=!1,Ie=!1,Ce=0)=>{for(let Ge=Ce;Ge<H.length;Ge++)Zr(H[Ge],ie,ye,Te,Ie)},Gr=H=>{if(H.shapeFlag&6)return Gr(H.component.subTree);if(H.shapeFlag&128)return H.suspense.next();const ie=fe(H.anchor||H.el),ye=ie&&ie[Gv];return ye?fe(ye):ie};let en=!1;const Ht=(H,ie,ye)=>{H==null?ie._vnode&&Zr(ie._vnode,null,null,!0):Et(ie._vnode||null,H,ie,null,null,null,ye),en||(en=!0,Kd(),Ym(),en=!1),ie._vnode=H},yi={p:Et,um:Zr,m:ii,r:Ln,mt:er,mc:Pr,pc:Kt,pbc:Vt,n:Gr,o:c};let Rn,Li;return d&&([Rn,Li]=d(yi)),{render:Ht,hydrate:Rn,createApp:Ov(Ht,Rn)}}function Ph({type:c,props:d},_){return _==="svg"&&c==="foreignObject"||_==="mathml"&&c==="annotation-xml"&&d&&d.encoding&&d.encoding.includes("html")?void 0:_}function ws({effect:c,update:d},_){c.allowRecurse=d.allowRecurse=_}function $v(c,d){return(!c||c&&!c.pendingBranch)&&d&&!d.persisted}function by(c,d,_=!1){const b=c.children,T=d.children;if(Ct(b)&&Ct(T))for(let P=0;P<b.length;P++){const l=b[P];let J=T[P];J.shapeFlag&1&&!J.dynamicChildren&&((J.patchFlag<=0||J.patchFlag===32)&&(J=T[P]=Fa(T[P]),J.el=l.el),!_&&J.patchFlag!==-2&&by(l,J)),J.type===Ip&&(J.el=l.el)}}function Jv(c){const d=c.slice(),_=[0];let b,T,P,l,J;const U=c.length;for(b=0;b<U;b++){const he=c[b];if(he!==0){if(T=_[_.length-1],c[T]<he){d[b]=T,_.push(b);continue}for(P=0,l=_.length-1;P<l;)J=P+l>>1,c[_[J]]<he?P=J+1:l=J;he<c[_[P]]&&(P>0&&(d[b]=_[P-1]),_[P]=b)}}for(P=_.length,l=_[P-1];P-- >0;)_[P]=l,l=d[l];return _}function wy(c){const d=c.subTree.component;if(d)return d.asyncDep&&!d.asyncResolved?d:wy(d)}function im(c){if(c)for(let d=0;d<c.length;d++)c[d].active=!1}const Yv=Symbol.for("v-scx"),Qv=()=>sp(Yv),op={};function zh(c,d,_){return Sy(c,d,_)}function Sy(c,d,{immediate:_,deep:b,flush:T,once:P,onTrack:l,onTrigger:J}=Jr){if(d&&P){const xt=d;d=(...qr)=>{xt(...qr),pr()}}const U=ji,he=xt=>b===!0?xt:Is(xt,b===!1?1:void 0);let se,Ee=!1,fe=!1;if(kn(c)?(se=()=>c.value,Ee=ju(c)):Fu(c)?(se=()=>he(c),Ee=!0):Ct(c)?(fe=!0,Ee=c.some(xt=>Fu(xt)||ju(xt)),se=()=>c.map(xt=>{if(kn(xt))return xt.value;if(Fu(xt))return he(xt);if(Lt(xt))return Va(xt,U,2)})):Lt(c)?d?se=()=>Va(c,U,2):se=()=>(ft&&ft(),Hn(c,U,3,[wt])):se=zn,d&&b){const xt=se;se=()=>Is(xt())}let ft,wt=xt=>{ft=Rt.onStop=()=>{Va(xt,U,4),ft=Rt.onStop=void 0}},Et;if(Cp)if(wt=zn,d?_&&Hn(d,U,3,[se(),fe?[]:void 0,wt]):se(),T==="sync"){const xt=Qv();Et=xt.__watcherHandles||(xt.__watcherHandles=[])}else return zn;let Nt=fe?new Array(c.length).fill(op):op;const Wt=()=>{if(!(!Rt.active||!Rt.dirty))if(d){const xt=Rt.run();(b||Ee||(fe?xt.some((qr,Pr)=>zs(qr,Nt[Pr])):zs(xt,Nt)))&&(ft&&ft(),Hn(d,U,3,[xt,Nt===op?void 0:fe&&Nt[0]===op?[]:Nt,wt]),Nt=xt)}else Rt.run()};Wt.allowRecurse=!!d;let Pt;T==="sync"?Pt=Wt:T==="post"?Pt=()=>bn(Wt,U&&U.suspense):(Wt.pre=!0,U&&(Wt.id=U.uid),Pt=()=>df(Wt));const Rt=new nf(se,zn,Pt),or=O_(),pr=()=>{Rt.stop(),or&&Qh(or.effects,Rt)};return d?_?Wt():Nt=Rt.run():T==="post"?bn(Rt.run.bind(Rt),U&&U.suspense):Rt.run(),Et&&Et.push(pr),pr}function e0(c,d,_){const b=this.proxy,T=wi(c)?c.includes(".")?Ey(b,c):()=>b[c]:c.bind(b,b);let P;Lt(d)?P=d:(P=d.handler,_=d);const l=Wu(this),J=Sy(T,P.bind(b),_);return l(),J}function Ey(c,d){const _=d.split(".");return()=>{let b=c;for(let T=0;T<_.length&&b;T++)b=b[_[T]];return b}}function Is(c,d=1/0,_){if(d<=0||!jr(c)||c.__v_skip||(_=_||new Set,_.has(c)))return c;if(_.add(c),d--,kn(c))Is(c.value,d,_);else if(Ct(c))for(let b=0;b<c.length;b++)Is(c[b],d,_);else if(Im(c)||Ll(c))c.forEach(b=>{Is(b,d,_)});else if(Pm(c)){for(const b in c)Is(c[b],d,_);for(const b of Object.getOwnPropertySymbols(c))Object.prototype.propertyIsEnumerable.call(c,b)&&Is(c[b],d,_)}return c}const t0=(c,d)=>d==="modelValue"||d==="model-value"?c.modelModifiers:c[`${d}Modifiers`]||c[`${uo(d)}Modifiers`]||c[`${qa(d)}Modifiers`];function r0(c,d,..._){if(c.isUnmounted)return;const b=c.vnode.props||Jr;let T=_;const P=d.startsWith("update:"),l=P&&t0(b,d.slice(7));l&&(l.trim&&(T=_.map(se=>wi(se)?se.trim():se)),l.number&&(T=_.map(C_)));let J,U=b[J=wh(d)]||b[J=wh(uo(d))];!U&&P&&(U=b[J=wh(qa(d))]),U&&Hn(U,c,6,T);const he=b[J+"Once"];if(he){if(!c.emitted)c.emitted={};else if(c.emitted[J])return;c.emitted[J]=!0,Hn(he,c,6,T)}}function Ty(c,d,_=!1){const b=d.emitsCache,T=b.get(c);if(T!==void 0)return T;const P=c.emits;let l={},J=!1;if(!Lt(c)){const U=he=>{const se=Ty(he,d,!0);se&&(J=!0,ki(l,se))};!_&&d.mixins.length&&d.mixins.forEach(U),c.extends&&U(c.extends),c.mixins&&c.mixins.forEach(U)}return!P&&!J?(jr(c)&&b.set(c,null),null):(Ct(P)?P.forEach(U=>l[U]=null):ki(l,P),jr(c)&&b.set(c,l),l)}function Tp(c,d){return!c||!yp(d)?!1:(d=d.slice(2).replace(/Once$/,""),nr(c,d[0].toLowerCase()+d.slice(1))||nr(c,qa(d))||nr(c,d))}function Mh(c){const{type:d,vnode:_,proxy:b,withProxy:T,propsOptions:[P],slots:l,attrs:J,emit:U,render:he,renderCache:se,props:Ee,data:fe,setupState:ft,ctx:wt,inheritAttrs:Et}=c,Nt=pp(c);let Wt,Pt;try{if(_.shapeFlag&4){const or=T||b,pr=or;Wt=Do(he.call(pr,or,se,Ee,ft,fe,wt)),Pt=J}else{const or=d;Wt=Do(or.length>1?or(Ee,{attrs:J,slots:l,emit:U}):or(Ee,null)),Pt=d.props?J:i0(J)}}catch(or){Nu.length=0,bp(or,c,1),Wt=qi(Pn)}let Rt=Wt;if(Pt&&Et!==!1){const or=Object.keys(Pt),{shapeFlag:pr}=Rt;or.length&&pr&7&&(P&&or.some(Yh)&&(Pt=n0(Pt,P)),Rt=Na(Rt,Pt,!1,!0))}return _.dirs&&(Rt=Na(Rt,null,!1,!0),Rt.dirs=Rt.dirs?Rt.dirs.concat(_.dirs):_.dirs),_.transition&&(Rt.transition=_.transition),Wt=Rt,pp(Nt),Wt}const i0=c=>{let d;for(const _ in c)(_==="class"||_==="style"||yp(_))&&((d||(d={}))[_]=c[_]);return d},n0=(c,d)=>{const _={};for(const b in c)(!Yh(b)||!(b.slice(9)in d))&&(_[b]=c[b]);return _};function o0(c,d,_){const{props:b,children:T,component:P}=c,{props:l,children:J,patchFlag:U}=d,he=P.emitsOptions;if(d.dirs||d.transition)return!0;if(_&&U>=0){if(U&1024)return!0;if(U&16)return b?nm(b,l,he):!!l;if(U&8){const se=d.dynamicProps;for(let Ee=0;Ee<se.length;Ee++){const fe=se[Ee];if(l[fe]!==b[fe]&&!Tp(he,fe))return!0}}}else return(T||J)&&(!J||!J.$stable)?!0:b===l?!1:b?l?nm(b,l,he):!0:!!l;return!1}function nm(c,d,_){const b=Object.keys(d);if(b.length!==Object.keys(c).length)return!0;for(let T=0;T<b.length;T++){const P=b[T];if(d[P]!==c[P]&&!Tp(_,P))return!0}return!1}function a0({vnode:c,parent:d},_){for(;d;){const b=d.subTree;if(b.suspense&&b.suspense.activeBranch===c&&(b.el=c.el),b===c)(c=d.vnode).el=_,d=d.parent;else break}}const s0=c=>c.__isSuspense;function l0(c,d){d&&d.pendingBranch?Ct(c)?d.effects.push(...c):d.effects.push(c):fv(c)}const lo=Symbol.for("v-fgt"),Ip=Symbol.for("v-txt"),Pn=Symbol.for("v-cmt"),kh=Symbol.for("v-stc"),Nu=[];let Mn=null;function di(c=!1){Nu.push(Mn=c?null:[])}function u0(){Nu.pop(),Mn=Nu[Nu.length-1]||null}let Gu=1;function om(c){Gu+=c,c<0&&Mn&&(Mn.hasOnce=!0)}function Iy(c){return c.dynamicChildren=Gu>0?Mn||kl:null,u0(),Gu>0&&Mn&&Mn.push(c),c}function Mi(c,d,_,b,T,P){return Iy(mi(c,d,_,b,T,P,!0))}function Cy(c,d,_,b,T){return Iy(qi(c,d,_,b,T,!0))}function Kh(c){return c?c.__v_isVNode===!0:!1}function Cs(c,d){return c.type===d.type&&c.key===d.key}const Ay=({key:c})=>c??null,lp=({ref:c,ref_key:d,ref_for:_})=>(typeof c=="number"&&(c=""+c),c!=null?wi(c)||kn(c)||Lt(c)?{i:Gn,r:c,k:d,f:!!_}:c:null);function mi(c,d=null,_=null,b=0,T=null,P=c===lo?0:1,l=!1,J=!1){const U={__v_isVNode:!0,__v_skip:!0,type:c,props:d,key:d&&Ay(d),ref:d&&lp(d),scopeId:ey,slotScopeIds:null,children:_,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:P,patchFlag:b,dynamicProps:T,dynamicChildren:null,appContext:null,ctx:Gn};return J?(gf(U,_),P&128&&c.normalize(U)):_&&(U.shapeFlag|=wi(_)?8:16),Gu>0&&!l&&Mn&&(U.patchFlag>0||P&6)&&U.patchFlag!==32&&Mn.push(U),U}const qi=c0;function c0(c,d=null,_=null,b=0,T=null,P=!1){if((!c||c===Av)&&(c=Pn),Kh(c)){const J=Na(c,d,!0);return _&&gf(J,_),Gu>0&&!P&&Mn&&(J.shapeFlag&6?Mn[Mn.indexOf(c)]=J:Mn.push(J)),J.patchFlag=-2,J}if(w0(c)&&(c=c.__vccOpts),d){d=p0(d);let{class:J,style:U}=d;J&&!wi(J)&&(d.class=Xu(J)),jr(U)&&(Xm(U)&&!Ct(U)&&(U=ki({},U)),d.style=rf(U))}const l=wi(c)?1:s0(c)?128:Hv(c)?64:jr(c)?4:Lt(c)?2:0;return mi(c,d,_,b,T,l,P,!0)}function p0(c){return c?Xm(c)||dy(c)?ki({},c):c:null}function Na(c,d,_=!1,b=!1){const{props:T,ref:P,patchFlag:l,children:J,transition:U}=c,he=d?h0(T||{},d):T,se={__v_isVNode:!0,__v_skip:!0,type:c.type,props:he,key:he&&Ay(he),ref:d&&d.ref?_&&P?Ct(P)?P.concat(lp(d)):[P,lp(d)]:lp(d):P,scopeId:c.scopeId,slotScopeIds:c.slotScopeIds,children:J,target:c.target,targetStart:c.targetStart,targetAnchor:c.targetAnchor,staticCount:c.staticCount,shapeFlag:c.shapeFlag,patchFlag:d&&c.type!==lo?l===-1?16:l|16:l,dynamicProps:c.dynamicProps,dynamicChildren:c.dynamicChildren,appContext:c.appContext,dirs:c.dirs,transition:U,component:c.component,suspense:c.suspense,ssContent:c.ssContent&&Na(c.ssContent),ssFallback:c.ssFallback&&Na(c.ssFallback),el:c.el,anchor:c.anchor,ctx:c.ctx,ce:c.ce};return U&&b&&hp(se,U.clone(se)),se}function Py(c=" ",d=0){return qi(Ip,null,c,d)}function pa(c="",d=!1){return d?(di(),Cy(Pn,null,c)):qi(Pn,null,c)}function Do(c){return c==null||typeof c=="boolean"?qi(Pn):Ct(c)?qi(lo,null,c.slice()):typeof c=="object"?Fa(c):qi(Ip,null,String(c))}function Fa(c){return c.el===null&&c.patchFlag!==-1||c.memo?c:Na(c)}function gf(c,d){let _=0;const{shapeFlag:b}=c;if(d==null)d=null;else if(Ct(d))_=16;else if(typeof d=="object")if(b&65){const T=d.default;T&&(T._c&&(T._d=!1),gf(c,T()),T._c&&(T._d=!0));return}else{_=32;const T=d._;!T&&!dy(d)?d._ctx=Gn:T===3&&Gn&&(Gn.slots._===1?d._=1:(d._=2,c.patchFlag|=1024))}else Lt(d)?(d={default:d,_ctx:Gn},_=32):(d=String(d),b&64?(_=16,d=[Py(d)]):_=8);c.children=d,c.shapeFlag|=_}function h0(...c){const d={};for(let _=0;_<c.length;_++){const b=c[_];for(const T in b)if(T==="class")d.class!==b.class&&(d.class=Xu([d.class,b.class]));else if(T==="style")d.style=rf([d.style,b.style]);else if(yp(T)){const P=d[T],l=b[T];l&&P!==l&&!(Ct(P)&&P.includes(l))&&(d[T]=P?[].concat(P,l):l)}else T!==""&&(d[T]=b[T])}return d}function Lo(c,d,_,b=null){Hn(c,d,7,[_,b])}const f0=py();let d0=0;function m0(c,d,_){const b=c.type,T=(d?d.appContext:c.appContext)||f0,P={uid:d0++,vnode:c,type:b,parent:d,appContext:T,root:null,next:null,subTree:null,effect:null,update:null,scope:new R_(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:d?d.provides:Object.create(T.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:yy(b,T),emitsOptions:Ty(b,T),emit:null,emitted:null,propsDefaults:Jr,inheritAttrs:b.inheritAttrs,ctx:Jr,data:Jr,props:Jr,attrs:Jr,slots:Jr,refs:Jr,setupState:Jr,setupContext:null,suspense:_,suspenseId:_?_.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return P.ctx={_:P},P.root=d?d.root:P,P.emit=r0.bind(null,P),c.ce&&c.ce(P),P}let ji=null;const y0=()=>ji||Gn;let dp,$h;{const c=tf(),d=(_,b)=>{let T;return(T=c[_])||(T=c[_]=[]),T.push(b),P=>{T.length>1?T.forEach(l=>l(P)):T[0](P)}};dp=d("__VUE_INSTANCE_SETTERS__",_=>ji=_),$h=d("__VUE_SSR_SETTERS__",_=>Cp=_)}const Wu=c=>{const d=ji;return dp(c),c.scope.on(),()=>{c.scope.off(),dp(d)}},am=()=>{ji&&ji.scope.off(),dp(null)};function zy(c){return c.vnode.shapeFlag&4}let Cp=!1;function g0(c,d=!1,_=!1){d&&$h(d);const{props:b,children:T}=c.vnode,P=zy(c);Uv(c,b,P,d),qv(c,T,_);const l=P?_0(c,d):void 0;return d&&$h(!1),l}function _0(c,d){const _=c.type;c.accessCache=Object.create(null),c.proxy=new Proxy(c.ctx,zv);const{setup:b}=_;if(b){const T=c.setupContext=b.length>1?x0(c):null,P=Wu(c);Za();const l=Va(b,c,0,[c.props,T]);if(Ga(),P(),Cm(l)){if(l.then(am,am),d)return l.then(J=>{sm(c,J,d)}).catch(J=>{bp(J,c,0)});c.asyncDep=l}else sm(c,l,d)}else My(c,d)}function sm(c,d,_){Lt(d)?c.type.__ssrInlineRender?c.ssrRender=d:c.render=d:jr(d)&&(c.setupState=Km(d)),My(c,_)}let lm;function My(c,d,_){const b=c.type;if(!c.render){if(!d&&lm&&!b.render){const T=b.template||mf(c).template;if(T){const{isCustomElement:P,compilerOptions:l}=c.appContext.config,{delimiters:J,compilerOptions:U}=b,he=ki(ki({isCustomElement:P,delimiters:J},l),U);b.render=lm(T,he)}}c.render=b.render||zn}{const T=Wu(c);Za();try{Mv(c)}finally{Ga(),T()}}}const v0={get(c,d){return wn(c,"get",""),c[d]}};function x0(c){const d=_=>{c.exposed=_||{}};return{attrs:new Proxy(c.attrs,v0),slots:c.slots,emit:c.emit,expose:d}}function _f(c){return c.exposed?c.exposeProxy||(c.exposeProxy=new Proxy(Km(nv(c.exposed)),{get(d,_){if(_ in d)return d[_];if(_ in Uu)return Uu[_](c)},has(d,_){return _ in d||_ in Uu}})):c.proxy}function b0(c,d=!0){return Lt(c)?c.displayName||c.name:c.name||d&&c.__name}function w0(c){return Lt(c)&&"__vccOpts"in c}const S0=(c,d)=>ov(c,d,Cp);function E0(c,d,_){const b=arguments.length;return b===2?jr(d)&&!Ct(d)?Kh(d)?qi(c,null,[d]):qi(c,d):qi(c,null,d):(b>3?_=Array.prototype.slice.call(arguments,2):b===3&&Kh(_)&&(_=[_]),qi(c,d,_))}const T0="3.4.35";/**
* @vue/runtime-dom v3.4.35
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const I0="http://www.w3.org/2000/svg",C0="http://www.w3.org/1998/Math/MathML",ca=typeof document<"u"?document:null,um=ca&&ca.createElement("template"),A0={insert:(c,d,_)=>{d.insertBefore(c,_||null)},remove:c=>{const d=c.parentNode;d&&d.removeChild(c)},createElement:(c,d,_,b)=>{const T=d==="svg"?ca.createElementNS(I0,c):d==="mathml"?ca.createElementNS(C0,c):_?ca.createElement(c,{is:_}):ca.createElement(c);return c==="select"&&b&&b.multiple!=null&&T.setAttribute("multiple",b.multiple),T},createText:c=>ca.createTextNode(c),createComment:c=>ca.createComment(c),setText:(c,d)=>{c.nodeValue=d},setElementText:(c,d)=>{c.textContent=d},parentNode:c=>c.parentNode,nextSibling:c=>c.nextSibling,querySelector:c=>ca.querySelector(c),setScopeId(c,d){c.setAttribute(d,"")},insertStaticContent(c,d,_,b,T,P){const l=_?_.previousSibling:d.lastChild;if(T&&(T===P||T.nextSibling))for(;d.insertBefore(T.cloneNode(!0),_),!(T===P||!(T=T.nextSibling)););else{um.innerHTML=b==="svg"?`<svg>${c}</svg>`:b==="mathml"?`<math>${c}</math>`:c;const J=um.content;if(b==="svg"||b==="mathml"){const U=J.firstChild;for(;U.firstChild;)J.appendChild(U.firstChild);J.removeChild(U)}d.insertBefore(J,_)}return[l?l.nextSibling:d.firstChild,_?_.previousSibling:d.lastChild]}},Da="transition",Ru="animation",Hu=Symbol("_vtc"),mp=(c,{slots:d})=>E0(gv,P0(c),d);mp.displayName="Transition";const ky={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};mp.props=ki({},ty,ky);const Ss=(c,d=[])=>{Ct(c)?c.forEach(_=>_(...d)):c&&c(...d)},cm=c=>c?Ct(c)?c.some(d=>d.length>1):c.length>1:!1;function P0(c){const d={};for(const ot in c)ot in ky||(d[ot]=c[ot]);if(c.css===!1)return d;const{name:_="v",type:b,duration:T,enterFromClass:P=`${_}-enter-from`,enterActiveClass:l=`${_}-enter-active`,enterToClass:J=`${_}-enter-to`,appearFromClass:U=P,appearActiveClass:he=l,appearToClass:se=J,leaveFromClass:Ee=`${_}-leave-from`,leaveActiveClass:fe=`${_}-leave-active`,leaveToClass:ft=`${_}-leave-to`}=c,wt=z0(T),Et=wt&&wt[0],Nt=wt&&wt[1],{onBeforeEnter:Wt,onEnter:Pt,onEnterCancelled:Rt,onLeave:or,onLeaveCancelled:pr,onBeforeAppear:xt=Wt,onAppear:qr=Pt,onAppearCancelled:Pr=Rt}=d,ht=(ot,vt,er)=>{Es(ot,vt?se:J),Es(ot,vt?he:l),er&&er()},Vt=(ot,vt)=>{ot._isLeaving=!1,Es(ot,Ee),Es(ot,ft),Es(ot,fe),vt&&vt()},Gt=ot=>(vt,er)=>{const cn=ot?qr:Pt,Jt=()=>ht(vt,ot,er);Ss(cn,[vt,Jt]),pm(()=>{Es(vt,ot?U:P),Ra(vt,ot?se:J),cm(cn)||hm(vt,b,Et,Jt)})};return ki(d,{onBeforeEnter(ot){Ss(Wt,[ot]),Ra(ot,P),Ra(ot,l)},onBeforeAppear(ot){Ss(xt,[ot]),Ra(ot,U),Ra(ot,he)},onEnter:Gt(!1),onAppear:Gt(!0),onLeave(ot,vt){ot._isLeaving=!0;const er=()=>Vt(ot,vt);Ra(ot,Ee),Ra(ot,fe),L0(),pm(()=>{ot._isLeaving&&(Es(ot,Ee),Ra(ot,ft),cm(or)||hm(ot,b,Nt,er))}),Ss(or,[ot,er])},onEnterCancelled(ot){ht(ot,!1),Ss(Rt,[ot])},onAppearCancelled(ot){ht(ot,!0),Ss(Pr,[ot])},onLeaveCancelled(ot){Vt(ot),Ss(pr,[ot])}})}function z0(c){if(c==null)return null;if(jr(c))return[Lh(c.enter),Lh(c.leave)];{const d=Lh(c);return[d,d]}}function Lh(c){return A_(c)}function Ra(c,d){d.split(/\s+/).forEach(_=>_&&c.classList.add(_)),(c[Hu]||(c[Hu]=new Set)).add(d)}function Es(c,d){d.split(/\s+/).forEach(b=>b&&c.classList.remove(b));const _=c[Hu];_&&(_.delete(d),_.size||(c[Hu]=void 0))}function pm(c){requestAnimationFrame(()=>{requestAnimationFrame(c)})}let M0=0;function hm(c,d,_,b){const T=c._endId=++M0,P=()=>{T===c._endId&&b()};if(_)return setTimeout(P,_);const{type:l,timeout:J,propCount:U}=k0(c,d);if(!l)return b();const he=l+"end";let se=0;const Ee=()=>{c.removeEventListener(he,fe),P()},fe=ft=>{ft.target===c&&++se>=U&&Ee()};setTimeout(()=>{se<U&&Ee()},J+1),c.addEventListener(he,fe)}function k0(c,d){const _=window.getComputedStyle(c),b=wt=>(_[wt]||"").split(", "),T=b(`${Da}Delay`),P=b(`${Da}Duration`),l=fm(T,P),J=b(`${Ru}Delay`),U=b(`${Ru}Duration`),he=fm(J,U);let se=null,Ee=0,fe=0;d===Da?l>0&&(se=Da,Ee=l,fe=P.length):d===Ru?he>0&&(se=Ru,Ee=he,fe=U.length):(Ee=Math.max(l,he),se=Ee>0?l>he?Da:Ru:null,fe=se?se===Da?P.length:U.length:0);const ft=se===Da&&/\b(transform|all)(,|$)/.test(b(`${Da}Property`).toString());return{type:se,timeout:Ee,propCount:fe,hasTransform:ft}}function fm(c,d){for(;c.length<d.length;)c=c.concat(c);return Math.max(...d.map((_,b)=>dm(_)+dm(c[b])))}function dm(c){return c==="auto"?0:Number(c.slice(0,-1).replace(",","."))*1e3}function L0(){return document.body.offsetHeight}function D0(c,d,_){const b=c[Hu];b&&(d=(d?[d,...b]:[...b]).join(" ")),d==null?c.removeAttribute("class"):_?c.setAttribute("class",d):c.className=d}const mm=Symbol("_vod"),R0=Symbol("_vsh"),B0=Symbol(""),O0=/(^|;)\s*display\s*:/;function F0(c,d,_){const b=c.style,T=wi(_);let P=!1;if(_&&!T){if(d)if(wi(d))for(const l of d.split(";")){const J=l.slice(0,l.indexOf(":")).trim();_[J]==null&&up(b,J,"")}else for(const l in d)_[l]==null&&up(b,l,"");for(const l in _)l==="display"&&(P=!0),up(b,l,_[l])}else if(T){if(d!==_){const l=b[B0];l&&(_+=";"+l),b.cssText=_,P=O0.test(_)}}else d&&c.removeAttribute("style");mm in c&&(c[mm]=P?b.display:"",c[R0]&&(b.display="none"))}const ym=/\s*!important$/;function up(c,d,_){if(Ct(_))_.forEach(b=>up(c,d,b));else if(_==null&&(_=""),d.startsWith("--"))c.setProperty(d,_);else{const b=U0(c,d);ym.test(_)?c.setProperty(qa(b),_.replace(ym,""),"important"):c[b]=_}}const gm=["Webkit","Moz","ms"],Dh={};function U0(c,d){const _=Dh[d];if(_)return _;let b=uo(d);if(b!=="filter"&&b in c)return Dh[d]=b;b=vp(b);for(let T=0;T<gm.length;T++){const P=gm[T]+b;if(P in c)return Dh[d]=P}return d}const _m="http://www.w3.org/1999/xlink";function vm(c,d,_,b,T,P=D_(d)){b&&d.startsWith("xlink:")?_==null?c.removeAttributeNS(_m,d.slice(6,d.length)):c.setAttributeNS(_m,d,_):_==null||P&&!Mm(_)?c.removeAttribute(d):c.setAttribute(d,P?"":ja(_)?String(_):_)}function V0(c,d,_,b){if(d==="innerHTML"||d==="textContent"){if(_==null)return;c[d]=_;return}const T=c.tagName;if(d==="value"&&T!=="PROGRESS"&&!T.includes("-")){const l=T==="OPTION"?c.getAttribute("value")||"":c.value,J=_==null?"":String(_);(l!==J||!("_value"in c))&&(c.value=J),_==null&&c.removeAttribute(d),c._value=_;return}let P=!1;if(_===""||_==null){const l=typeof c[d];l==="boolean"?_=Mm(_):_==null&&l==="string"?(_="",P=!0):l==="number"&&(_=0,P=!0)}try{c[d]=_}catch{}P&&c.removeAttribute(d)}function N0(c,d,_,b){c.addEventListener(d,_,b)}function j0(c,d,_,b){c.removeEventListener(d,_,b)}const xm=Symbol("_vei");function q0(c,d,_,b,T=null){const P=c[xm]||(c[xm]={}),l=P[d];if(b&&l)l.value=b;else{const[J,U]=Z0(d);if(b){const he=P[d]=X0(b,T);N0(c,J,he,U)}else l&&(j0(c,J,l,U),P[d]=void 0)}}const bm=/(?:Once|Passive|Capture)$/;function Z0(c){let d;if(bm.test(c)){d={};let b;for(;b=c.match(bm);)c=c.slice(0,c.length-b[0].length),d[b[0].toLowerCase()]=!0}return[c[2]===":"?c.slice(3):qa(c.slice(2)),d]}let Rh=0;const G0=Promise.resolve(),H0=()=>Rh||(G0.then(()=>Rh=0),Rh=Date.now());function X0(c,d){const _=b=>{if(!b._vts)b._vts=Date.now();else if(b._vts<=_.attached)return;Hn(W0(b,_.value),d,5,[b])};return _.value=c,_.attached=H0(),_}function W0(c,d){if(Ct(d)){const _=c.stopImmediatePropagation;return c.stopImmediatePropagation=()=>{_.call(c),c._stopped=!0},d.map(b=>T=>!T._stopped&&b&&b(T))}else return d}const wm=c=>c.charCodeAt(0)===111&&c.charCodeAt(1)===110&&c.charCodeAt(2)>96&&c.charCodeAt(2)<123,K0=(c,d,_,b,T,P)=>{const l=T==="svg";d==="class"?D0(c,b,l):d==="style"?F0(c,_,b):yp(d)?Yh(d)||q0(c,d,_,b,P):(d[0]==="."?(d=d.slice(1),!0):d[0]==="^"?(d=d.slice(1),!1):$0(c,d,b,l))?(V0(c,d,b),!c.tagName.includes("-")&&(d==="value"||d==="checked"||d==="selected")&&vm(c,d,b,l,P,d!=="value")):(d==="true-value"?c._trueValue=b:d==="false-value"&&(c._falseValue=b),vm(c,d,b,l))};function $0(c,d,_,b){if(b)return!!(d==="innerHTML"||d==="textContent"||d in c&&wm(d)&&Lt(_));if(d==="spellcheck"||d==="draggable"||d==="translate"||d==="form"||d==="list"&&c.tagName==="INPUT"||d==="type"&&c.tagName==="TEXTAREA")return!1;if(d==="width"||d==="height"){const T=c.tagName;if(T==="IMG"||T==="VIDEO"||T==="CANVAS"||T==="SOURCE")return!1}return wm(d)&&wi(_)?!1:d in c}const J0={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Y0=(c,d)=>{const _=c._withKeys||(c._withKeys={}),b=d.join(".");return _[b]||(_[b]=T=>{if(!("key"in T))return;const P=qa(T.key);if(d.some(l=>l===P||J0[l]===P))return c(T)})},Q0=ki({patchProp:K0},A0);let Sm;function ex(){return Sm||(Sm=Wv(Q0))}const tx=(...c)=>{const d=ex().createApp(...c),{mount:_}=d;return d.mount=b=>{const T=ix(b);if(!T)return;const P=d._component;!Lt(P)&&!P.render&&!P.template&&(P.template=T.innerHTML),T.innerHTML="";const l=_(T,!1,rx(T));return T instanceof Element&&(T.removeAttribute("v-cloak"),T.setAttribute("data-v-app","")),l},d};function rx(c){if(c instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&c instanceof MathMLElement)return"mathml"}function ix(c){return wi(c)?document.querySelector(c):c}var nx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ly(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var Dy={exports:{}};(function(c,d){(function(_,b){c.exports=b()})(nx,function(){var _,b,T;function P(l,J){if(!_)_=J;else if(!b)b=J;else{var U="var sharedChunk = {}; ("+_+")(sharedChunk); ("+b+")(sharedChunk);",he={};_(he),T=J(he),typeof window<"u"&&(T.workerUrl=window.URL.createObjectURL(new Blob([U],{type:"text/javascript"})))}}return P(["exports"],function(l){function J(e,t){return e(t={exports:{}},t.exports),t.exports}var U=he;function he(e,t,r,a){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(a-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=a,this.p2x=r,this.p2y=a}he.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},he.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},he.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},he.prototype.solveCurveX=function(e,t){var r,a,u,p,f;for(t===void 0&&(t=1e-6),u=e,f=0;f<8;f++){if(p=this.sampleCurveX(u)-e,Math.abs(p)<t)return u;var g=this.sampleCurveDerivativeX(u);if(Math.abs(g)<1e-6)break;u-=p/g}if((u=e)<(r=0))return r;if(u>(a=1))return a;for(;r<a;){if(p=this.sampleCurveX(u),Math.abs(p-e)<t)return u;e>p?r=u:a=u,u=.5*(a-r)+r}return u},he.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var se=Ee;function Ee(e,t){this.x=e,this.y=t}Ee.prototype={clone:function(){return new Ee(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),a=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=a,this},_rotateAround:function(e,t){var r=Math.cos(e),a=Math.sin(e),u=t.y+a*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-a*(this.y-t.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ee.convert=function(e){return e instanceof Ee?e:Array.isArray(e)?new Ee(e[0],e[1]):e};var fe=typeof self<"u"?self:{},ft=Math.pow(2,53)-1;function wt(e,t,r,a){var u=new U(e,t,r,a);return function(p){return u.solve(p)}}var Et=wt(.25,.1,.25,1);function Nt(e,t,r){return Math.min(r,Math.max(t,e))}function Wt(e,t,r){var a=r-t,u=((e-t)%a+a)%a+t;return u===t?r:u}function Pt(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var a=0,u=t;a<u.length;a+=1){var p=u[a];for(var f in p)e[f]=p[f]}return e}var Rt=1;function or(){return Rt++}function pr(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function xt(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function qr(e,t){e.forEach(function(r){t[r]&&(t[r]=t[r].bind(t))})}function Pr(e,t){return e.indexOf(t,e.length-t.length)!==-1}function ht(e,t,r){var a={};for(var u in e)a[u]=t.call(r||this,e[u],u,e);return a}function Vt(e,t,r){var a={};for(var u in e)t.call(r||this,e[u],u,e)&&(a[u]=e[u]);return a}function Gt(e){return Array.isArray(e)?e.map(Gt):typeof e=="object"&&e?ht(e,Gt):e}var ot={};function vt(e){ot[e]||(typeof console<"u"&&console.warn(e),ot[e]=!0)}function er(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function cn(e){for(var t=0,r=0,a=e.length,u=a-1,p=void 0,f=void 0;r<a;u=r++)t+=((f=e[u]).x-(p=e[r]).x)*(p.y+f.y);return t}function Jt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function ar(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(a,u,p,f){var g=p||f;return t[u]=!g||g.toLowerCase(),""}),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var Kt=null;function pn(e){if(Kt==null){var t=e.navigator?e.navigator.userAgent:null;Kt=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Kt}function Qi(e){try{var t=fe[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}var ii,Zr,Ln,Xn,Dn=fe.performance&&fe.performance.now?fe.performance.now.bind(fe.performance):Date.now.bind(Date),Wn=fe.requestAnimationFrame||fe.mozRequestAnimationFrame||fe.webkitRequestAnimationFrame||fe.msRequestAnimationFrame,Gr=fe.cancelAnimationFrame||fe.mozCancelAnimationFrame||fe.webkitCancelAnimationFrame||fe.msCancelAnimationFrame,en={now:Dn,frame:function(e){var t=Wn(e);return{cancel:function(){return Gr(t)}}},getImageData:function(e,t){t===void 0&&(t=0);var r=fe.document.createElement("canvas"),a=r.getContext("2d");if(!a)throw new Error("failed to create canvas 2d context");return r.width=e.width,r.height=e.height,a.drawImage(e,0,0,e.width,e.height),a.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return ii||(ii=fe.document.createElement("a")),ii.href=e,ii.href},hardwareConcurrency:fe.navigator&&fe.navigator.hardwareConcurrency||4,get devicePixelRatio(){return fe.devicePixelRatio},get prefersReducedMotion(){return!!fe.matchMedia&&(Zr==null&&(Zr=fe.matchMedia("(prefers-reduced-motion: reduce)")),Zr.matches)}},Ht={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},yi={supported:!1,testSupport:function(e){!Rn&&Xn&&(Li?H(e):Ln=e)}},Rn=!1,Li=!1;function H(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,Xn),e.isContextLost())return;yi.supported=!0}catch{}e.deleteTexture(t),Rn=!0}fe.document&&((Xn=fe.document.createElement("img")).onload=function(){Ln&&H(Ln),Ln=null,Li=!0},Xn.onerror=function(){Rn=!0,Ln=null},Xn.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var ie="01",ye=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function Te(e){return e.indexOf("mapbox:")===0}ye.prototype._createSkuToken=function(){var e=function(){for(var t="",r=0;r<10;r++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ie,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},ye.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},ye.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},ye.prototype.normalizeStyleURL=function(e,t){if(!Te(e))return e;var r=Le(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},ye.prototype.normalizeGlyphsURL=function(e,t){if(!Te(e))return e;var r=Le(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},ye.prototype.normalizeSourceURL=function(e,t){if(!Te(e))return e;var r=Le(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},ye.prototype.normalizeSpriteURL=function(e,t,r,a){var u=Le(e);return Te(e)?(u.path="/styles/v1"+u.path+"/sprite"+t+r,this._makeAPIURL(u,this._customAccessToken||a)):(u.path+=""+t+r,Oe(u))},ye.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!Te(e))return e;var r=Le(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(en.devicePixelRatio>=2||t===512?"@2x":"")+(yi.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var a=this._customAccessToken||function(u){for(var p=0,f=u;p<f.length;p+=1){var g=f[p].match(/^access_token=(.*)$/);if(g)return g[1]}return null}(r.params)||Ht.ACCESS_TOKEN;return Ht.REQUIRE_ACCESS_TOKEN&&a&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,a)},ye.prototype.canonicalizeTileURL=function(e,t){var r=Le(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var a="mapbox://tiles/";a+=r.path.replace("/v4/","");var u=r.params;return t&&(u=u.filter(function(p){return!p.match(/^access_token=/)})),u.length&&(a+="?"+u.join("&")),a},ye.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&Te(t),a=[],u=0,p=e.tiles||[];u<p.length;u+=1){var f=p[u];Ce(f)?a.push(this.canonicalizeTileURL(f,r)):a.push(f)}return a},ye.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",a=Le(Ht.API_URL);if(e.protocol=a.protocol,e.authority=a.authority,e.protocol==="http"){var u=e.params.indexOf("secure");u>=0&&e.params.splice(u,1)}if(a.path!=="/"&&(e.path=""+a.path+e.path),!Ht.REQUIRE_ACCESS_TOKEN)return Oe(e);if(!(t=t||Ht.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter(function(p){return p.indexOf("access_token")===-1}),e.params.push("access_token="+t),Oe(e)},ye.prototype.setTransformRequest=function(e){this._transformRequestFn=e};var Ie=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Ce(e){return Ie.test(e)}var Ge=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Le(e){var t=e.match(Ge);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Oe(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function Pe(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(fe.atob(t[1]).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var He=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};He.prototype.getStorageKey=function(e){var t,r=Pe(Ht.ACCESS_TOKEN);return t=r&&r.u?fe.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(a,u){return String.fromCharCode(+("0x"+u))})):Ht.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},He.prototype.fetchEventData=function(){var e=Qi("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var a=fe.localStorage.getItem(t);a&&(this.eventData=JSON.parse(a));var u=fe.localStorage.getItem(r);u&&(this.anonId=u)}catch{vt("Unable to read from LocalStorage")}},He.prototype.saveEventData=function(){var e=Qi("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{fe.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&fe.localStorage.setItem(t,JSON.stringify(this.eventData))}catch{vt("Unable to write to LocalStorage")}},He.prototype.processRequests=function(e){},He.prototype.postEvent=function(e,t,r,a){var u=this;if(Ht.EVENTS_URL){var p=Le(Ht.EVENTS_URL);p.params.push("access_token="+(a||Ht.ACCESS_TOKEN||""));var f={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.15.3",skuId:ie,userId:this.anonId},g=t?Pt(f,t):f,x={url:Oe(p),headers:{"Content-Type":"text/plain"},body:JSON.stringify([g])};this.pendingRequest=C(x,function(w){u.pendingRequest=null,r(w),u.saveEventData(),u.processRequests(a)})}},He.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var Ye,it,ut=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(r,a,u,p){this.skuToken=u,(Ht.EVENTS_URL&&p||Ht.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(f){return Te(f)||Ce(f)}))&&this.queueRequest({id:a,timestamp:Date.now()},p)},t.prototype.processRequests=function(r){var a=this;if(!this.pendingRequest&&this.queue.length!==0){var u=this.queue.shift(),p=u.id,f=u.timestamp;p&&this.success[p]||(this.anonId||this.fetchEventData(),xt(this.anonId)||(this.anonId=pr()),this.postEvent(f,{skuToken:this.skuToken},function(g){g||p&&(a.success[p]=!0)},r))}},t}(He),Mt=new(function(e){function t(r){e.call(this,"appUserTurnstile"),this._customAccessToken=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(r,a){Ht.EVENTS_URL&&Ht.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(u){return Te(u)||Ce(u)})&&this.queueRequest(Date.now(),a)},t.prototype.processRequests=function(r){var a=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var u=Pe(Ht.ACCESS_TOKEN),p=u?u.u:Ht.ACCESS_TOKEN,f=p!==this.eventData.tokenU;xt(this.anonId)||(this.anonId=pr(),f=!0);var g=this.queue.shift();if(this.eventData.lastSuccess){var x=new Date(this.eventData.lastSuccess),w=new Date(g),E=(g-this.eventData.lastSuccess)/864e5;f=f||E>=1||E<-1||x.getDate()!==w.getDate()}else f=!0;if(!f)return this.processRequests();this.postEvent(g,{"enabled.telemetry":!1},function(I){I||(a.eventData.lastSuccess=g,a.eventData.tokenU=p)},r)}},t}(He)),sr=Mt.postTurnstileEvent.bind(Mt),Zt=new ut,zr=Zt.postMapLoadEvent.bind(Zt),hi=500,Sn=50;function Kn(){fe.caches&&!Ye&&(Ye=fe.caches.open("mapbox-tiles"))}function En(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var Bn,ni=1/0;function Si(){return Bn==null&&(Bn=fe.OffscreenCanvas&&new fe.OffscreenCanvas(1,1).getContext("2d")&&typeof fe.createImageBitmap=="function"),Bn}var Bo={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Bo);var Ms=function(e){function t(r,a,u){a===401&&Ce(u)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,r),this.status=a,this.url=u,this.name=this.constructor.name,this.message=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),Oo=Jt()?function(){return self.worker&&self.worker.referrer}:function(){return(fe.location.protocol==="blob:"?fe.parent:fe).location.href};function Fo(e,t){var r,a=new fe.AbortController,u=new fe.Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,referrer:Oo(),signal:a.signal}),p=!1,f=!1,g=(r=u.url).indexOf("sku=")>0&&Ce(r);e.type==="json"&&u.headers.set("Accept","application/json");var x=function(E,I,z){if(!f){if(E&&E.message!=="SecurityError"&&vt(E),I&&z)return w(I);var L=Date.now();fe.fetch(u).then(function(V){if(V.ok){var N=g?V.clone():null;return w(V,N,L)}return t(new Ms(V.statusText,V.status,e.url))}).catch(function(V){V.code!==20&&t(new Error(V.message))})}},w=function(E,I,z){(e.type==="arrayBuffer"?E.arrayBuffer():e.type==="json"?E.json():E.text()).then(function(L){f||(I&&z&&function(V,N,Q){if(Kn(),Ye){var W={status:N.status,statusText:N.statusText,headers:new fe.Headers};N.headers.forEach(function(ae,ue){return W.headers.set(ue,ae)});var ne=ar(N.headers.get("Cache-Control")||"");ne["no-store"]||(ne["max-age"]&&W.headers.set("Expires",new Date(Q+1e3*ne["max-age"]).toUTCString()),new Date(W.headers.get("Expires")).getTime()-Q<42e4||function(ae,ue){if(it===void 0)try{new Response(new ReadableStream),it=!0}catch{it=!1}it?ue(ae.body):ae.blob().then(ue)}(N,function(ae){var ue=new fe.Response(ae,W);Kn(),Ye&&Ye.then(function(ce){return ce.put(En(V.url),ue)}).catch(function(ce){return vt(ce.message)})}))}}(u,I,z),p=!0,t(null,L,E.headers.get("Cache-Control"),E.headers.get("Expires")))}).catch(function(L){f||t(new Error(L.message))})};return g?function(E,I){if(Kn(),!Ye)return I(null);var z=En(E.url);Ye.then(function(L){L.match(z).then(function(V){var N=function(Q){if(!Q)return!1;var W=new Date(Q.headers.get("Expires")||0),ne=ar(Q.headers.get("Cache-Control")||"");return W>Date.now()&&!ne["no-cache"]}(V);L.delete(z),N&&L.put(z,V.clone()),I(null,V,N)}).catch(I)}).catch(I)}(u,x):x(null,null),{cancel:function(){f=!0,p||a.abort()}}}var co,Uo,da=function(e,t){if(/:\/\//.test(e.url)&&!/^https?:|^file:/.test(e.url)){if(Jt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t);if(!Jt()){var r=e.url.substring(0,e.url.indexOf("://"));return(Ht.REGISTERED_PROTOCOLS[r]||Fo)(e,t)}}if(!(/^file:/.test(a=e.url)||/^file:/.test(Oo())&&!/^\w+:/.test(a))){if(fe.fetch&&fe.Request&&fe.AbortController&&fe.Request.prototype.hasOwnProperty("signal"))return Fo(e,t);if(Jt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var a;return function(u,p){var f=new fe.XMLHttpRequest;for(var g in f.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(f.responseType="arraybuffer"),u.headers)f.setRequestHeader(g,u.headers[g]);return u.type==="json"&&(f.responseType="text",f.setRequestHeader("Accept","application/json")),f.withCredentials=u.credentials==="include",f.onerror=function(){p(new Error(f.statusText))},f.onload=function(){if((f.status>=200&&f.status<300||f.status===0)&&f.response!==null){var x=f.response;if(u.type==="json")try{x=JSON.parse(f.response)}catch(w){return p(w)}p(null,x,f.getResponseHeader("Cache-Control"),f.getResponseHeader("Expires"))}else p(new Ms(f.statusText,f.status,u.url))},f.send(u.body),{cancel:function(){return f.abort()}}}(e,t)},Ir=function(e,t){return da(Pt(e,{type:"arrayBuffer"}),t)},C=function(e,t){return da(Pt(e,{method:"POST"}),t)},M="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";co=[],Uo=0;var k=function(e,t){if(yi.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),Uo>=Ht.MAX_PARALLEL_IMAGE_REQUESTS){var r={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return co.push(r),r}Uo++;var a=!1,u=function(){if(!a)for(a=!0,Uo--;co.length&&Uo<Ht.MAX_PARALLEL_IMAGE_REQUESTS;){var f=co.shift();f.cancelled||(f.cancel=k(f.requestParameters,f.callback).cancel)}},p=Ir(e,function(f,g,x,w){u(),f?t(f):g&&(Si()?function(E,I){var z=new fe.Blob([new Uint8Array(E)],{type:"image/png"});fe.createImageBitmap(z).then(function(L){I(null,L)}).catch(function(L){I(new Error("Could not load image because of "+L.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(g,t):function(E,I,z,L){var V=new fe.Image,N=fe.URL;V.onload=function(){I(null,V),N.revokeObjectURL(V.src),V.onload=null,fe.requestAnimationFrame(function(){V.src=M})},V.onerror=function(){return I(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Q=new fe.Blob([new Uint8Array(E)],{type:"image/png"});V.cacheControl=z,V.expires=L,V.src=E.byteLength?N.createObjectURL(Q):M}(g,t,x,w))});return{cancel:function(){p.cancel(),u()}}};function O(e,t,r){r[e]&&r[e].indexOf(t)!==-1||(r[e]=r[e]||[],r[e].push(t))}function Z(e,t,r){if(r&&r[e]){var a=r[e].indexOf(t);a!==-1&&r[e].splice(a,1)}}var ee=function(e,t){t===void 0&&(t={}),Pt(this,t),this.type=e},re=function(e){function t(r,a){a===void 0&&(a={}),e.call(this,"error",Pt({error:r},a))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(ee),Y=function(){};Y.prototype.on=function(e,t){return this._listeners=this._listeners||{},O(e,t,this._listeners),this},Y.prototype.off=function(e,t){return Z(e,t,this._listeners),Z(e,t,this._oneTimeListeners),this},Y.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},O(e,t,this._oneTimeListeners),this},Y.prototype.fire=function(e,t){typeof e=="string"&&(e=new ee(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var a=0,u=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];a<u.length;a+=1)u[a].call(this,e);for(var p=0,f=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];p<f.length;p+=1){var g=f[p];Z(r,g,this._oneTimeListeners),g.call(this,e)}var x=this._eventedParent;x&&(Pt(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(e))}else e instanceof re&&console.error(e.error);return this},Y.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},Y.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var F={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},X=function(e,t,r,a){this.message=(e?e+": ":"")+r,a&&(this.identifier=a),t!=null&&t.__line__&&(this.line=t.__line__)};function be(e){var t=e.value;return t?[new X(e.key,t,"constants have been deprecated as of v8")]:[]}function Me(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var a=0,u=t;a<u.length;a+=1){var p=u[a];for(var f in p)e[f]=p[f]}return e}function le(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function we(e){if(Array.isArray(e))return e.map(we);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=we(e[r]);return t}return le(e)}var Ve=function(e){function t(r,a){e.call(this,a),this.message=a,this.key=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),je=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var r=0,a=t;r<a.length;r+=1){var u=a[r];this.bindings[u[0]]=u[1]}};je.prototype.concat=function(e){return new je(this,e)},je.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},je.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var $e={kind:"null"},ve={kind:"number"},De={kind:"string"},xe={kind:"boolean"},yt={kind:"color"},gt={kind:"object"},Xe={kind:"value"},lr={kind:"collator"},At={kind:"formatted"},hr={kind:"resolvedImage"};function yr(e,t){return{kind:"array",itemType:e,N:t}}function Bt(e){if(e.kind==="array"){var t=Bt(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var ur=[$e,ve,De,xe,yt,At,gt,yr(Xe),hr];function Cr(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Cr(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var r=0,a=ur;r<a.length;r+=1)if(!Cr(a[r],t))return null}}return"Expected "+Bt(e)+" but found "+Bt(t)+" instead."}function cr(e,t){return t.some(function(r){return r.kind===e.kind})}function Tt(e,t){return t.some(function(r){return r==="null"?e===null:r==="array"?Array.isArray(e):r==="object"?e&&!Array.isArray(e)&&typeof e=="object":r===typeof e})}var ma=J(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function a(g){return(g=Math.round(g))<0?0:g>255?255:g}function u(g){return a(g[g.length-1]==="%"?parseFloat(g)/100*255:parseInt(g))}function p(g){return(x=g[g.length-1]==="%"?parseFloat(g)/100:parseFloat(g))<0?0:x>1?1:x;var x}function f(g,x,w){return w<0?w+=1:w>1&&(w-=1),6*w<1?g+(x-g)*w*6:2*w<1?x:3*w<2?g+(x-g)*(2/3-w)*6:g}try{t.parseCSSColor=function(g){var x,w=g.replace(/ /g,"").toLowerCase();if(w in r)return r[w].slice();if(w[0]==="#")return w.length===4?(x=parseInt(w.substr(1),16))>=0&&x<=4095?[(3840&x)>>4|(3840&x)>>8,240&x|(240&x)>>4,15&x|(15&x)<<4,1]:null:w.length===7&&(x=parseInt(w.substr(1),16))>=0&&x<=16777215?[(16711680&x)>>16,(65280&x)>>8,255&x,1]:null;var E=w.indexOf("("),I=w.indexOf(")");if(E!==-1&&I+1===w.length){var z=w.substr(0,E),L=w.substr(E+1,I-(E+1)).split(","),V=1;switch(z){case"rgba":if(L.length!==4)return null;V=p(L.pop());case"rgb":return L.length!==3?null:[u(L[0]),u(L[1]),u(L[2]),V];case"hsla":if(L.length!==4)return null;V=p(L.pop());case"hsl":if(L.length!==3)return null;var N=(parseFloat(L[0])%360+360)%360/360,Q=p(L[1]),W=p(L[2]),ne=W<=.5?W*(Q+1):W+Q-W*Q,ae=2*W-ne;return[a(255*f(ae,ne,N+1/3)),a(255*f(ae,ne,N)),a(255*f(ae,ne,N-1/3)),V];default:return null}}return null}}catch{}}).parseCSSColor,kt=function(e,t,r,a){a===void 0&&(a=1),this.r=e,this.g=t,this.b=r,this.a=a};kt.parse=function(e){if(e){if(e instanceof kt)return e;if(typeof e=="string"){var t=ma(e);if(t)return new kt(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},kt.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],a=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+a+")"},kt.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},kt.black=new kt(0,0,0,1),kt.white=new kt(1,1,1,1),kt.transparent=new kt(0,0,0,0),kt.red=new kt(1,0,0,1);var Vo=function(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Vo.prototype.compare=function(e,t){return this.collator.compare(e,t)},Vo.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var ks=function(e,t,r,a,u){this.text=e,this.image=t,this.scale=r,this.fontStack=a,this.textColor=u},oi=function(e){this.sections=e};oi.fromString=function(e){return new oi([new ks(e,null,null,null,null)])},oi.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},oi.factory=function(e){return e instanceof oi?e:oi.fromString(e)},oi.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},oi.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var a=r[t];if(a.image)e.push(["image",a.image.name]);else{e.push(a.text);var u={};a.fontStack&&(u["text-font"]=["literal",a.fontStack.split(",")]),a.scale&&(u["font-scale"]=a.scale),a.textColor&&(u["text-color"]=["rgba"].concat(a.textColor.toArray())),e.push(u)}}return e};var Di=function(e){this.name=e.name,this.available=e.available};function Ol(e,t,r,a){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?a===void 0||typeof a=="number"&&a>=0&&a<=1?null:"Invalid rgba value ["+[e,t,r,a].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof a=="number"?[e,t,r,a]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function No(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof kt||e instanceof Vo||e instanceof oi||e instanceof Di)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!No(r[t]))return!1;return!0}if(typeof e=="object"){for(var a in e)if(!No(e[a]))return!1;return!0}return!1}function Yr(e){if(e===null)return $e;if(typeof e=="string")return De;if(typeof e=="boolean")return xe;if(typeof e=="number")return ve;if(e instanceof kt)return yt;if(e instanceof Vo)return lr;if(e instanceof oi)return At;if(e instanceof Di)return hr;if(Array.isArray(e)){for(var t,r=e.length,a=0,u=e;a<u.length;a+=1){var p=Yr(u[a]);if(t){if(t===p)continue;t=Xe;break}t=p}return yr(t||Xe,r)}return gt}function On(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof kt||e instanceof oi||e instanceof Di?e.toString():JSON.stringify(e)}Di.prototype.toString=function(){return this.name},Di.fromString=function(e){return e?new Di({name:e,available:!1}):null},Di.prototype.serialize=function(){return["image",this.name]};var hn=function(e,t){this.type=e,this.value=t};hn.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!No(e[1]))return t.error("invalid value");var r=e[1],a=Yr(r),u=t.expectedType;return a.kind!=="array"||a.N!==0||!u||u.kind!=="array"||typeof u.N=="number"&&u.N!==0||(a=u),new hn(a,r)},hn.prototype.evaluate=function(){return this.value},hn.prototype.eachChild=function(){},hn.prototype.outputDefined=function(){return!0},hn.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof kt?["rgba"].concat(this.value.toArray()):this.value instanceof oi?this.value.serialize():this.value};var _r=function(e){this.name="ExpressionEvaluationError",this.message=e};_r.prototype.toJSON=function(){return this.message};var Ri={string:De,number:ve,boolean:xe,object:gt},gi=function(e,t){this.type=e,this.args=t};gi.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,a=1,u=e[0];if(u==="array"){var p,f;if(e.length>2){var g=e[1];if(typeof g!="string"||!(g in Ri)||g==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);p=Ri[g],a++}else p=Xe;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);f=e[2],a++}r=yr(p,f)}else r=Ri[u];for(var x=[];a<e.length;a++){var w=t.parse(e[a],a,Xe);if(!w)return null;x.push(w)}return new gi(r,x)},gi.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!Cr(this.type,Yr(r)))return r;if(t===this.args.length-1)throw new _r("Expected value to be of type "+Bt(this.type)+", but found "+Bt(Yr(r))+" instead.")}return null},gi.prototype.eachChild=function(e){this.args.forEach(e)},gi.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},gi.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var r=e.itemType;if(r.kind==="string"||r.kind==="number"||r.kind==="boolean"){t.push(r.kind);var a=e.N;(typeof a=="number"||this.args.length>1)&&t.push(a)}}return t.concat(this.args.map(function(u){return u.serialize()}))};var Zi=function(e){this.type=At,this.sections=e};Zi.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&typeof r=="object")return t.error("First argument must be an image or text section.");for(var a=[],u=!1,p=1;p<=e.length-1;++p){var f=e[p];if(u&&typeof f=="object"&&!Array.isArray(f)){u=!1;var g=null;if(f["font-scale"]&&!(g=t.parse(f["font-scale"],1,ve)))return null;var x=null;if(f["text-font"]&&!(x=t.parse(f["text-font"],1,yr(De))))return null;var w=null;if(f["text-color"]&&!(w=t.parse(f["text-color"],1,yt)))return null;var E=a[a.length-1];E.scale=g,E.font=x,E.textColor=w}else{var I=t.parse(e[p],1,Xe);if(!I)return null;var z=I.type.kind;if(z!=="string"&&z!=="value"&&z!=="null"&&z!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");u=!0,a.push({content:I,scale:null,font:null,textColor:null})}}return new Zi(a)},Zi.prototype.evaluate=function(e){return new oi(this.sections.map(function(t){var r=t.content.evaluate(e);return Yr(r)===hr?new ks("",r,null,null,null):new ks(On(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},Zi.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var a=r[t];e(a.content),a.scale&&e(a.scale),a.font&&e(a.font),a.textColor&&e(a.textColor)}},Zi.prototype.outputDefined=function(){return!1},Zi.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var a=r[t];e.push(a.content.serialize());var u={};a.scale&&(u["font-scale"]=a.scale.serialize()),a.font&&(u["text-font"]=a.font.serialize()),a.textColor&&(u["text-color"]=a.textColor.serialize()),e.push(u)}return e};var $n=function(e){this.type=hr,this.input=e};$n.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var r=t.parse(e[1],1,De);return r?new $n(r):t.error("No image name provided.")},$n.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=Di.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r},$n.prototype.eachChild=function(e){e(this.input)},$n.prototype.outputDefined=function(){return!1},$n.prototype.serialize=function(){return["image",this.input.serialize()]};var zp={"to-boolean":xe,"to-color":yt,"to-number":ve,"to-string":De},fn=function(e,t){this.type=e,this.args=t};fn.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if((r==="to-boolean"||r==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var a=zp[r],u=[],p=1;p<e.length;p++){var f=t.parse(e[p],p,Xe);if(!f)return null;u.push(f)}return new fn(a,u)},fn.prototype.evaluate=function(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){for(var t,r,a=0,u=this.args;a<u.length;a+=1){if(r=null,(t=u[a].evaluate(e))instanceof kt)return t;if(typeof t=="string"){var p=e.parseColor(t);if(p)return p}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":Ol(t[0],t[1],t[2],t[3])))return new kt(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new _r(r||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var f=null,g=0,x=this.args;g<x.length;g+=1){if((f=x[g].evaluate(e))===null)return 0;var w=Number(f);if(!isNaN(w))return w}throw new _r("Could not convert "+JSON.stringify(f)+" to number.")}return this.type.kind==="formatted"?oi.fromString(On(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Di.fromString(On(this.args[0].evaluate(e))):On(this.args[0].evaluate(e))},fn.prototype.eachChild=function(e){this.args.forEach(e)},fn.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},fn.prototype.serialize=function(){if(this.type.kind==="formatted")return new Zi([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new $n(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ku=["Unknown","Point","LineString","Polygon"],Jn=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Jn.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Jn.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Ku[this.feature.type]:this.feature.type:null},Jn.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Jn.prototype.canonicalID=function(){return this.canonical},Jn.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Jn.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=kt.parse(e)),t};var ai=function(e,t,r,a){this.name=e,this.type=t,this._evaluate=r,this.args=a};ai.prototype.evaluate=function(e){return this._evaluate(e,this.args)},ai.prototype.eachChild=function(e){this.args.forEach(e)},ai.prototype.outputDefined=function(){return!1},ai.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},ai.parse=function(e,t){var r,a=e[0],u=ai.definitions[a];if(!u)return t.error('Unknown expression "'+a+'". If you wanted a literal array, use ["literal", [...]].',0);for(var p=Array.isArray(u)?u[0]:u.type,f=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,g=f.filter(function(Je){var Be=Je[0];return!Array.isArray(Be)||Be.length===e.length-1}),x=null,w=0,E=g;w<E.length;w+=1){var I=E[w],z=I[0],L=I[1];x=new fo(t.registry,t.path,null,t.scope);for(var V=[],N=!1,Q=1;Q<e.length;Q++){var W=e[Q],ne=Array.isArray(z)?z[Q-1]:z.type,ae=x.parse(W,1+V.length,ne);if(!ae){N=!0;break}V.push(ae)}if(!N)if(Array.isArray(z)&&z.length!==V.length)x.error("Expected "+z.length+" arguments, but found "+V.length+" instead.");else{for(var ue=0;ue<V.length;ue++){var ce=Array.isArray(z)?z[ue]:z.type,ge=V[ue];x.concat(ue+1).checkSubtype(ce,ge.type)}if(x.errors.length===0)return new ai(a,p,L,V)}}if(g.length===1)(r=t.errors).push.apply(r,x.errors);else{for(var Ae=(g.length?g:f).map(function(Je){var Be;return Be=Je[0],Array.isArray(Be)?"("+Be.map(Bt).join(", ")+")":"("+Bt(Be.type)+"...)"}).join(" | "),ke=[],Ke=1;Ke<e.length;Ke++){var Re=t.parse(e[Ke],1+ke.length);if(!Re)return null;ke.push(Bt(Re.type))}t.error("Expected arguments of type "+Ae+", but found ("+ke.join(", ")+") instead.")}return null},ai.register=function(e,t){for(var r in ai.definitions=t,t)e[r]=ai};var Hr=function(e,t,r){this.type=lr,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t};function ya(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Ls(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function Mp(e,t){var r=(180+e[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,u=Math.pow(2,t.z);return[Math.round(r*u*8192),Math.round(a*u*8192)]}function kp(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function Fl(e,t){for(var r,a,u,p,f,g,x,w=!1,E=0,I=t.length;E<I;E++)for(var z=t[E],L=0,V=z.length;L<V-1;L++){if((p=(r=e)[0]-(a=z[L])[0])*(x=r[1]-(u=z[L+1])[1])-(g=r[0]-u[0])*(f=r[1]-a[1])==0&&p*g<=0&&f*x<=0)return!1;kp(e,z[L],z[L+1])&&(w=!w)}return w}function Lp(e,t){for(var r=0;r<t.length;r++)if(Fl(e,t[r]))return!0;return!1}function $u(e,t,r,a){var u=a[0]-r[0],p=a[1]-r[1],f=(e[0]-r[0])*p-u*(e[1]-r[1]),g=(t[0]-r[0])*p-u*(t[1]-r[1]);return f>0&&g<0||f<0&&g>0}function Dp(e,t,r){for(var a=0,u=r;a<u.length;a+=1)for(var p=u[a],f=0;f<p.length-1;++f)if((I=[(E=p[f+1])[0]-(w=p[f])[0],E[1]-w[1]])[0]*(z=[(x=t)[0]-(g=e)[0],x[1]-g[1]])[1]-I[1]*z[0]!=0&&$u(g,x,w,E)&&$u(w,E,g,x))return!0;var g,x,w,E,I,z;return!1}function Ul(e,t){for(var r=0;r<e.length;++r)if(!Fl(e[r],t))return!1;for(var a=0;a<e.length-1;++a)if(Dp(e[a],e[a+1],t))return!1;return!0}function Ds(e,t){for(var r=0;r<t.length;r++)if(Ul(e,t[r]))return!0;return!1}function Rs(e,t,r){for(var a=[],u=0;u<e.length;u++){for(var p=[],f=0;f<e[u].length;f++){var g=Mp(e[u][f],r);ya(t,g),p.push(g)}a.push(p)}return a}function Ha(e,t,r){for(var a=[],u=0;u<e.length;u++){var p=Rs(e[u],t,r);a.push(p)}return a}function Ju(e,t,r,a){if(e[0]<r[0]||e[0]>r[2]){var u=.5*a,p=e[0]-r[0]>u?-a:r[0]-e[0]>u?a:0;p===0&&(p=e[0]-r[2]>u?-a:r[2]-e[0]>u?a:0),e[0]+=p}ya(t,e)}function Bs(e,t,r,a){for(var u=8192*Math.pow(2,a.z),p=[8192*a.x,8192*a.y],f=[],g=0,x=e;g<x.length;g+=1)for(var w=0,E=x[g];w<E.length;w+=1){var I=E[w],z=[I.x+p[0],I.y+p[1]];Ju(z,t,r,u),f.push(z)}return f}function Vl(e,t,r,a){for(var u,p=8192*Math.pow(2,a.z),f=[8192*a.x,8192*a.y],g=[],x=0,w=e;x<w.length;x+=1){for(var E=[],I=0,z=w[x];I<z.length;I+=1){var L=z[I],V=[L.x+f[0],L.y+f[1]];ya(t,V),E.push(V)}g.push(E)}if(t[2]-t[0]<=p/2){(u=t)[0]=u[1]=1/0,u[2]=u[3]=-1/0;for(var N=0,Q=g;N<Q.length;N+=1)for(var W=0,ne=Q[N];W<ne.length;W+=1)Ju(ne[W],t,r,p)}return g}Hr.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var r=e[1];if(typeof r!="object"||Array.isArray(r))return t.error("Collator options argument must be an object.");var a=t.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,xe);if(!a)return null;var u=t.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,xe);if(!u)return null;var p=null;return r.locale&&!(p=t.parse(r.locale,1,De))?null:new Hr(a,u,p)},Hr.prototype.evaluate=function(e){return new Vo(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Hr.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Hr.prototype.outputDefined=function(){return!1},Hr.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Bi=function(e,t){this.type=xe,this.geojson=e,this.geometries=t};function jo(e){if(e instanceof ai&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof Bi)return!1;var t=!0;return e.eachChild(function(r){t&&!jo(r)&&(t=!1)}),t}function po(e){if(e instanceof ai&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(r){t&&!po(r)&&(t=!1)}),t}function Os(e,t){if(e instanceof ai&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(a){r&&!Os(a,t)&&(r=!1)}),r}Bi.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(No(e[1])){var r=e[1];if(r.type==="FeatureCollection")for(var a=0;a<r.features.length;++a){var u=r.features[a].geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new Bi(r,r.features[a].geometry)}else if(r.type==="Feature"){var p=r.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Bi(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new Bi(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Bi.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,r){var a=[1/0,1/0,-1/0,-1/0],u=[1/0,1/0,-1/0,-1/0],p=t.canonicalID();if(r.type==="Polygon"){var f=Rs(r.coordinates,u,p),g=Bs(t.geometry(),a,u,p);if(!Ls(a,u))return!1;for(var x=0,w=g;x<w.length;x+=1)if(!Fl(w[x],f))return!1}if(r.type==="MultiPolygon"){var E=Ha(r.coordinates,u,p),I=Bs(t.geometry(),a,u,p);if(!Ls(a,u))return!1;for(var z=0,L=I;z<L.length;z+=1)if(!Lp(L[z],E))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,r){var a=[1/0,1/0,-1/0,-1/0],u=[1/0,1/0,-1/0,-1/0],p=t.canonicalID();if(r.type==="Polygon"){var f=Rs(r.coordinates,u,p),g=Vl(t.geometry(),a,u,p);if(!Ls(a,u))return!1;for(var x=0,w=g;x<w.length;x+=1)if(!Ul(w[x],f))return!1}if(r.type==="MultiPolygon"){var E=Ha(r.coordinates,u,p),I=Vl(t.geometry(),a,u,p);if(!Ls(a,u))return!1;for(var z=0,L=I;z<L.length;z+=1)if(!Ds(L[z],E))return!1}return!0}(e,this.geometries)}return!1},Bi.prototype.eachChild=function(){},Bi.prototype.outputDefined=function(){return!0},Bi.prototype.serialize=function(){return["within",this.geojson]};var ho=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};ho.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new ho(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},ho.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},ho.prototype.eachChild=function(){},ho.prototype.outputDefined=function(){return!1},ho.prototype.serialize=function(){return["var",this.name]};var fo=function(e,t,r,a,u){t===void 0&&(t=[]),a===void 0&&(a=new je),u===void 0&&(u=[]),this.registry=e,this.path=t,this.key=t.map(function(p){return"["+p+"]"}).join(""),this.scope=a,this.errors=u,this.expectedType=r};function Yn(e,t){for(var r,a=e.length-1,u=0,p=a,f=0;u<=p;)if((r=e[f=Math.floor((u+p)/2)])<=t){if(f===a||t<e[f+1])return f;u=f+1}else{if(!(r>t))throw new _r("Input is not a number.");p=f-1}return 0}fo.prototype.parse=function(e,t,r,a,u){return u===void 0&&(u={}),t?this.concat(t,r,a)._parse(e,u):this._parse(e,u)},fo.prototype._parse=function(e,t){function r(w,E,I){return I==="assert"?new gi(E,[w]):I==="coerce"?new fn(E,[w]):w}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var a=e[0];if(typeof a!="string")return this.error("Expression name must be a string, but found "+typeof a+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var u=this.registry[a];if(u){var p=u.parse(e,this);if(!p)return null;if(this.expectedType){var f=this.expectedType,g=p.type;if(f.kind!=="string"&&f.kind!=="number"&&f.kind!=="boolean"&&f.kind!=="object"&&f.kind!=="array"||g.kind!=="value")if(f.kind!=="color"&&f.kind!=="formatted"&&f.kind!=="resolvedImage"||g.kind!=="value"&&g.kind!=="string"){if(this.checkSubtype(f,g))return null}else p=r(p,f,t.typeAnnotation||"coerce");else p=r(p,f,t.typeAnnotation||"assert")}if(!(p instanceof hn)&&p.type.kind!=="resolvedImage"&&function w(E){if(E instanceof ho)return w(E.boundExpression);if(E instanceof ai&&E.name==="error"||E instanceof Hr||E instanceof Bi)return!1;var I=E instanceof fn||E instanceof gi,z=!0;return E.eachChild(function(L){z=I?z&&w(L):z&&L instanceof hn}),!!z&&jo(E)&&Os(E,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(p)){var x=new Jn;try{p=new hn(p.type,p.evaluate(x))}catch(w){return this.error(w.message),null}}return p}return this.error('Unknown expression "'+a+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},fo.prototype.concat=function(e,t,r){var a=typeof e=="number"?this.path.concat(e):this.path,u=r?this.scope.concat(r):this.scope;return new fo(this.registry,a,t||null,u,this.errors)},fo.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var a=""+this.key+t.map(function(u){return"["+u+"]"}).join("");this.errors.push(new Ve(a,e))},fo.prototype.checkSubtype=function(e,t){var r=Cr(e,t);return r&&this.error(r),r};var Tn=function(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var a=0,u=r;a<u.length;a+=1){var p=u[a],f=p[1];this.labels.push(p[0]),this.outputs.push(f)}};function Vr(e,t,r){return e*(1-r)+t*r}Tn.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,ve);if(!r)return null;var a=[],u=null;t.expectedType&&t.expectedType.kind!=="value"&&(u=t.expectedType);for(var p=1;p<e.length;p+=2){var f=p===1?-1/0:e[p],g=e[p+1],x=p,w=p+1;if(typeof f!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',x);if(a.length&&a[a.length-1][0]>=f)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',x);var E=t.parse(g,w,u);if(!E)return null;u=u||E.type,a.push([f,E])}return new Tn(u,r,a)},Tn.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var a=this.input.evaluate(e);if(a<=t[0])return r[0].evaluate(e);var u=t.length;return a>=t[u-1]?r[u-1].evaluate(e):r[Yn(t,a)].evaluate(e)},Tn.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},Tn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Tn.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Fs=Object.freeze({__proto__:null,number:Vr,color:function(e,t,r){return new kt(Vr(e.r,t.r,r),Vr(e.g,t.g,r),Vr(e.b,t.b,r),Vr(e.a,t.a,r))},array:function(e,t,r){return e.map(function(a,u){return Vr(a,t[u],r)})}}),Yu=6/29*3*(6/29),Rp=Math.PI/180,Bp=180/Math.PI;function Nl(e){return e>.008856451679035631?Math.pow(e,1/3):e/Yu+4/29}function jl(e){return e>6/29?e*e*e:Yu*(e-4/29)}function ql(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Zl(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Qu(e){var t=Zl(e.r),r=Zl(e.g),a=Zl(e.b),u=Nl((.4124564*t+.3575761*r+.1804375*a)/.95047),p=Nl((.2126729*t+.7151522*r+.072175*a)/1);return{l:116*p-16,a:500*(u-p),b:200*(p-Nl((.0193339*t+.119192*r+.9503041*a)/1.08883)),alpha:e.a}}function ec(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,a=isNaN(e.b)?t:t-e.b/200;return t=1*jl(t),r=.95047*jl(r),a=1.08883*jl(a),new kt(ql(3.2404542*r-1.5371385*t-.4985314*a),ql(-.969266*r+1.8760108*t+.041556*a),ql(.0556434*r-.2040259*t+1.0572252*a),e.alpha)}function Op(e,t,r){var a=t-e;return e+r*(a>180||a<-180?a-360*Math.round(a/360):a)}var Xa={forward:Qu,reverse:ec,interpolate:function(e,t,r){return{l:Vr(e.l,t.l,r),a:Vr(e.a,t.a,r),b:Vr(e.b,t.b,r),alpha:Vr(e.alpha,t.alpha,r)}}},Wa={forward:function(e){var t=Qu(e),r=t.l,a=t.a,u=t.b,p=Math.atan2(u,a)*Bp;return{h:p<0?p+360:p,c:Math.sqrt(a*a+u*u),l:r,alpha:e.a}},reverse:function(e){var t=e.h*Rp,r=e.c;return ec({l:e.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})},interpolate:function(e,t,r){return{h:Op(e.h,t.h,r),c:Vr(e.c,t.c,r),l:Vr(e.l,t.l,r),alpha:Vr(e.alpha,t.alpha,r)}}},tc=Object.freeze({__proto__:null,lab:Xa,hcl:Wa}),fi=function(e,t,r,a,u){this.type=e,this.operator=t,this.interpolation=r,this.input=a,this.labels=[],this.outputs=[];for(var p=0,f=u;p<f.length;p+=1){var g=f[p],x=g[1];this.labels.push(g[0]),this.outputs.push(x)}};function Gl(e,t,r,a){var u=a-r,p=e-r;return u===0?0:t===1?p/u:(Math.pow(t,p)-1)/(Math.pow(t,u)-1)}fi.interpolationFactor=function(e,t,r,a){var u=0;if(e.name==="exponential")u=Gl(t,e.base,r,a);else if(e.name==="linear")u=Gl(t,1,r,a);else if(e.name==="cubic-bezier"){var p=e.controlPoints;u=new U(p[0],p[1],p[2],p[3]).solve(Gl(t,1,r,a))}return u},fi.parse=function(e,t){var r=e[0],a=e[1],u=e[2],p=e.slice(3);if(!Array.isArray(a)||a.length===0)return t.error("Expected an interpolation type expression.",1);if(a[0]==="linear")a={name:"linear"};else if(a[0]==="exponential"){var f=a[1];if(typeof f!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);a={name:"exponential",base:f}}else{if(a[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(a[0]),1,0);var g=a.slice(1);if(g.length!==4||g.some(function(Q){return typeof Q!="number"||Q<0||Q>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);a={name:"cubic-bezier",controlPoints:g}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(u=t.parse(u,2,ve)))return null;var x=[],w=null;r==="interpolate-hcl"||r==="interpolate-lab"?w=yt:t.expectedType&&t.expectedType.kind!=="value"&&(w=t.expectedType);for(var E=0;E<p.length;E+=2){var I=p[E],z=p[E+1],L=E+3,V=E+4;if(typeof I!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(x.length&&x[x.length-1][0]>=I)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);var N=t.parse(z,V,w);if(!N)return null;w=w||N.type,x.push([I,N])}return w.kind==="number"||w.kind==="color"||w.kind==="array"&&w.itemType.kind==="number"&&typeof w.N=="number"?new fi(w,r,a,u,x):t.error("Type "+Bt(w)+" is not interpolatable.")},fi.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var a=this.input.evaluate(e);if(a<=t[0])return r[0].evaluate(e);var u=t.length;if(a>=t[u-1])return r[u-1].evaluate(e);var p=Yn(t,a),f=fi.interpolationFactor(this.interpolation,a,t[p],t[p+1]),g=r[p].evaluate(e),x=r[p+1].evaluate(e);return this.operator==="interpolate"?Fs[this.type.kind.toLowerCase()](g,x,f):this.operator==="interpolate-hcl"?Wa.reverse(Wa.interpolate(Wa.forward(g),Wa.forward(x),f)):Xa.reverse(Xa.interpolate(Xa.forward(g),Xa.forward(x),f))},fi.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},fi.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},fi.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var mo=function(e,t){this.type=e,this.args=t};mo.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,a=t.expectedType;a&&a.kind!=="value"&&(r=a);for(var u=[],p=0,f=e.slice(1);p<f.length;p+=1){var g=t.parse(f[p],1+u.length,r,void 0,{typeAnnotation:"omit"});if(!g)return null;r=r||g.type,u.push(g)}var x=a&&u.some(function(w){return Cr(a,w.type)});return new mo(x?Xe:r,u)},mo.prototype.evaluate=function(e){for(var t,r=null,a=0,u=0,p=this.args;u<p.length&&(a++,(r=p[u].evaluate(e))&&r instanceof Di&&!r.available&&(t||(t=r.name),r=null,a===this.args.length&&(r=t)),r===null);u+=1);return r},mo.prototype.eachChild=function(e){this.args.forEach(e)},mo.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},mo.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var yo=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};yo.prototype.evaluate=function(e){return this.result.evaluate(e)},yo.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},yo.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],a=1;a<e.length-1;a+=2){var u=e[a];if(typeof u!="string")return t.error("Expected string, but found "+typeof u+" instead.",a);if(/[^a-zA-Z0-9_]/.test(u))return t.error("Variable names must contain only alphanumeric characters or '_'.",a);var p=t.parse(e[a+1],a+1);if(!p)return null;r.push([u,p])}var f=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return f?new yo(r,f):null},yo.prototype.outputDefined=function(){return this.result.outputDefined()},yo.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var a=r[t];e.push(a[0],a[1].serialize())}return e.push(this.result.serialize()),e};var qo=function(e,t,r){this.type=e,this.index=t,this.input=r};qo.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,ve),a=t.parse(e[2],2,yr(t.expectedType||Xe));return r&&a?new qo(a.type.itemType,r,a):null},qo.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new _r("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new _r("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new _r("Array index must be an integer, but found "+t+" instead.");return r[t]},qo.prototype.eachChild=function(e){e(this.index),e(this.input)},qo.prototype.outputDefined=function(){return!1},qo.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Zo=function(e,t){this.type=xe,this.needle=e,this.haystack=t};Zo.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Xe),a=t.parse(e[2],2,Xe);return r&&a?cr(r.type,[xe,De,ve,$e,Xe])?new Zo(r,a):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Bt(r.type)+" instead"):null},Zo.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!Tt(t,["boolean","string","number","null"]))throw new _r("Expected first argument to be of type boolean, string, number or null, but found "+Bt(Yr(t))+" instead.");if(!Tt(r,["string","array"]))throw new _r("Expected second argument to be of type array or string, but found "+Bt(Yr(r))+" instead.");return r.indexOf(t)>=0},Zo.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},Zo.prototype.outputDefined=function(){return!0},Zo.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var go=function(e,t,r){this.type=ve,this.needle=e,this.haystack=t,this.fromIndex=r};go.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Xe),a=t.parse(e[2],2,Xe);if(!r||!a)return null;if(!cr(r.type,[xe,De,ve,$e,Xe]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Bt(r.type)+" instead");if(e.length===4){var u=t.parse(e[3],3,ve);return u?new go(r,a,u):null}return new go(r,a)},go.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!Tt(t,["boolean","string","number","null"]))throw new _r("Expected first argument to be of type boolean, string, number or null, but found "+Bt(Yr(t))+" instead.");if(!Tt(r,["string","array"]))throw new _r("Expected second argument to be of type array or string, but found "+Bt(Yr(r))+" instead.");if(this.fromIndex){var a=this.fromIndex.evaluate(e);return r.indexOf(t,a)}return r.indexOf(t)},go.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},go.prototype.outputDefined=function(){return!1},go.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Go=function(e,t,r,a,u,p){this.inputType=e,this.type=t,this.input=r,this.cases=a,this.outputs=u,this.otherwise=p};Go.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,a;t.expectedType&&t.expectedType.kind!=="value"&&(a=t.expectedType);for(var u={},p=[],f=2;f<e.length-1;f+=2){var g=e[f],x=e[f+1];Array.isArray(g)||(g=[g]);var w=t.concat(f);if(g.length===0)return w.error("Expected at least one branch label.");for(var E=0,I=g;E<I.length;E+=1){var z=I[E];if(typeof z!="number"&&typeof z!="string")return w.error("Branch labels must be numbers or strings.");if(typeof z=="number"&&Math.abs(z)>Number.MAX_SAFE_INTEGER)return w.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof z=="number"&&Math.floor(z)!==z)return w.error("Numeric branch labels must be integer values.");if(r){if(w.checkSubtype(r,Yr(z)))return null}else r=Yr(z);if(u[String(z)]!==void 0)return w.error("Branch labels must be unique.");u[String(z)]=p.length}var L=t.parse(x,f,a);if(!L)return null;a=a||L.type,p.push(L)}var V=t.parse(e[1],1,Xe);if(!V)return null;var N=t.parse(e[e.length-1],e.length-1,a);return N?V.type.kind!=="value"&&t.concat(1).checkSubtype(r,V.type)?null:new Go(r,a,V,u,p,N):null},Go.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Yr(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},Go.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},Go.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},Go.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],a={},u=0,p=Object.keys(this.cases).sort();u<p.length;u+=1){var f=p[u];(I=a[this.cases[f]])===void 0?(a[this.cases[f]]=r.length,r.push([this.cases[f],[f]])):r[I][1].push(f)}for(var g=function(L){return e.inputType.kind==="number"?Number(L):L},x=0,w=r;x<w.length;x+=1){var E=w[x],I=E[0],z=E[1];t.push(z.length===1?g(z[0]):z.map(g)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var Ho=function(e,t,r){this.type=e,this.branches=t,this.otherwise=r};Ho.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);for(var a=[],u=1;u<e.length-1;u+=2){var p=t.parse(e[u],u,xe);if(!p)return null;var f=t.parse(e[u+1],u+1,r);if(!f)return null;a.push([p,f]),r=r||f.type}var g=t.parse(e[e.length-1],e.length-1,r);return g?new Ho(r,a,g):null},Ho.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var a=r[t],u=a[1];if(a[0].evaluate(e))return u.evaluate(e)}return this.otherwise.evaluate(e)},Ho.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var a=r[t],u=a[1];e(a[0]),e(u)}e(this.otherwise)},Ho.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},Ho.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var _o=function(e,t,r,a){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=a};function rc(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function vr(e,t,r,a){return a.compare(t,r)===0}function ga(e,t,r){var a=e!=="=="&&e!=="!=";return function(){function u(p,f,g){this.type=xe,this.lhs=p,this.rhs=f,this.collator=g,this.hasUntypedArgument=p.type.kind==="value"||f.type.kind==="value"}return u.parse=function(p,f){if(p.length!==3&&p.length!==4)return f.error("Expected two or three arguments.");var g=p[0],x=f.parse(p[1],1,Xe);if(!x)return null;if(!rc(g,x.type))return f.concat(1).error('"'+g+`" comparisons are not supported for type '`+Bt(x.type)+"'.");var w=f.parse(p[2],2,Xe);if(!w)return null;if(!rc(g,w.type))return f.concat(2).error('"'+g+`" comparisons are not supported for type '`+Bt(w.type)+"'.");if(x.type.kind!==w.type.kind&&x.type.kind!=="value"&&w.type.kind!=="value")return f.error("Cannot compare types '"+Bt(x.type)+"' and '"+Bt(w.type)+"'.");a&&(x.type.kind==="value"&&w.type.kind!=="value"?x=new gi(w.type,[x]):x.type.kind!=="value"&&w.type.kind==="value"&&(w=new gi(x.type,[w])));var E=null;if(p.length===4){if(x.type.kind!=="string"&&w.type.kind!=="string"&&x.type.kind!=="value"&&w.type.kind!=="value")return f.error("Cannot use collator to compare non-string types.");if(!(E=f.parse(p[3],3,lr)))return null}return new u(x,w,E)},u.prototype.evaluate=function(p){var f=this.lhs.evaluate(p),g=this.rhs.evaluate(p);if(a&&this.hasUntypedArgument){var x=Yr(f),w=Yr(g);if(x.kind!==w.kind||x.kind!=="string"&&x.kind!=="number")throw new _r('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+x.kind+", "+w.kind+") instead.")}if(this.collator&&!a&&this.hasUntypedArgument){var E=Yr(f),I=Yr(g);if(E.kind!=="string"||I.kind!=="string")return t(p,f,g)}return this.collator?r(p,f,g,this.collator.evaluate(p)):t(p,f,g)},u.prototype.eachChild=function(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)},u.prototype.outputDefined=function(){return!0},u.prototype.serialize=function(){var p=[e];return this.eachChild(function(f){p.push(f.serialize())}),p},u}()}_o.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Xe),a=t.parse(e[2],2,ve);if(!r||!a)return null;if(!cr(r.type,[yr(Xe),De,Xe]))return t.error("Expected first argument to be of type array or string, but found "+Bt(r.type)+" instead");if(e.length===4){var u=t.parse(e[3],3,ve);return u?new _o(r.type,r,a,u):null}return new _o(r.type,r,a)},_o.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!Tt(t,["string","array"]))throw new _r("Expected first argument to be of type array or string, but found "+Bt(Yr(t))+" instead.");if(this.endIndex){var a=this.endIndex.evaluate(e);return t.slice(r,a)}return t.slice(r)},_o.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},_o.prototype.outputDefined=function(){return!1},_o.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Us=ga("==",function(e,t,r){return t===r},vr),ic=ga("!=",function(e,t,r){return t!==r},function(e,t,r,a){return!vr(0,t,r,a)}),nc=ga("<",function(e,t,r){return t<r},function(e,t,r,a){return a.compare(t,r)<0}),oc=ga(">",function(e,t,r){return t>r},function(e,t,r,a){return a.compare(t,r)>0}),ac=ga("<=",function(e,t,r){return t<=r},function(e,t,r,a){return a.compare(t,r)<=0}),Fp=ga(">=",function(e,t,r){return t>=r},function(e,t,r,a){return a.compare(t,r)>=0}),vo=function(e,t,r,a,u){this.type=De,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=a,this.maxFractionDigits=u};vo.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var r=t.parse(e[1],1,ve);if(!r)return null;var a=e[2];if(typeof a!="object"||Array.isArray(a))return t.error("NumberFormat options argument must be an object.");var u=null;if(a.locale&&!(u=t.parse(a.locale,1,De)))return null;var p=null;if(a.currency&&!(p=t.parse(a.currency,1,De)))return null;var f=null;if(a["min-fraction-digits"]&&!(f=t.parse(a["min-fraction-digits"],1,ve)))return null;var g=null;return a["max-fraction-digits"]&&!(g=t.parse(a["max-fraction-digits"],1,ve))?null:new vo(r,u,p,f,g)},vo.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},vo.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},vo.prototype.outputDefined=function(){return!1},vo.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var xo=function(e){this.type=ve,this.input=e};xo.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+Bt(r.type)+" instead."):new xo(r):null},xo.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new _r("Expected value to be of type string or array, but found "+Bt(Yr(t))+" instead.")},xo.prototype.eachChild=function(e){e(this.input)},xo.prototype.outputDefined=function(){return!1},xo.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var _a={"==":Us,"!=":ic,">":oc,"<":nc,">=":Fp,"<=":ac,array:gi,at:qo,boolean:gi,case:Ho,coalesce:mo,collator:Hr,format:Zi,image:$n,in:Zo,"index-of":go,interpolate:fi,"interpolate-hcl":fi,"interpolate-lab":fi,length:xo,let:yo,literal:hn,match:Go,number:gi,"number-format":vo,object:gi,slice:_o,step:Tn,string:gi,"to-boolean":fn,"to-color":fn,"to-number":fn,"to-string":fn,var:ho,within:Bi};function sc(e,t){var r=t[0],a=t[1],u=t[2],p=t[3];r=r.evaluate(e),a=a.evaluate(e),u=u.evaluate(e);var f=p?p.evaluate(e):1,g=Ol(r,a,u,f);if(g)throw new _r(g);return new kt(r/255*f,a/255*f,u/255*f,f)}function lc(e,t){return e in t}function Hl(e,t){var r=t[e];return r===void 0?null:r}function Xo(e){return{type:e}}function Xl(e){return{result:"success",value:e}}function Wo(e){return{result:"error",value:e}}function va(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function Vs(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Wl(e){return!!e.expression&&e.expression.interpolated}function fr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function Ns(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function uc(e){return e}function xa(e,t,r){return e!==void 0?e:t!==void 0?t:r!==void 0?r:void 0}function Up(e,t,r,a,u){return xa(typeof r===u?a[r]:void 0,e.default,t.default)}function Vp(e,t,r){if(fr(r)!=="number")return xa(e.default,t.default);var a=e.stops.length;if(a===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[a-1][0])return e.stops[a-1][1];var u=Yn(e.stops.map(function(p){return p[0]}),r);return e.stops[u][1]}function Ka(e,t,r){var a=e.base!==void 0?e.base:1;if(fr(r)!=="number")return xa(e.default,t.default);var u=e.stops.length;if(u===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[u-1][0])return e.stops[u-1][1];var p=Yn(e.stops.map(function(I){return I[0]}),r),f=function(I,z,L,V){var N=V-L,Q=I-L;return N===0?0:z===1?Q/N:(Math.pow(z,Q)-1)/(Math.pow(z,N)-1)}(r,a,e.stops[p][0],e.stops[p+1][0]),g=e.stops[p][1],x=e.stops[p+1][1],w=Fs[t.type]||uc;if(e.colorSpace&&e.colorSpace!=="rgb"){var E=tc[e.colorSpace];w=function(I,z){return E.reverse(E.interpolate(E.forward(I),E.forward(z),f))}}return typeof g.evaluate=="function"?{evaluate:function(){for(var I=[],z=arguments.length;z--;)I[z]=arguments[z];var L=g.evaluate.apply(void 0,I),V=x.evaluate.apply(void 0,I);if(L!==void 0&&V!==void 0)return w(L,V,f)}}:w(g,x,f)}function cc(e,t,r){return t.type==="color"?r=kt.parse(r):t.type==="formatted"?r=oi.fromString(r.toString()):t.type==="resolvedImage"?r=Di.fromString(r.toString()):fr(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0),xa(r,e.default,t.default)}ai.register(_a,{error:[{kind:"error"},[De],function(e,t){throw new _r(t[0].evaluate(e))}],typeof:[De,[Xe],function(e,t){return Bt(Yr(t[0].evaluate(e)))}],"to-rgba":[yr(ve,4),[yt],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[yt,[ve,ve,ve],sc],rgba:[yt,[ve,ve,ve,ve],sc],has:{type:xe,overloads:[[[De],function(e,t){return lc(t[0].evaluate(e),e.properties())}],[[De,gt],function(e,t){var r=t[1];return lc(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:Xe,overloads:[[[De],function(e,t){return Hl(t[0].evaluate(e),e.properties())}],[[De,gt],function(e,t){var r=t[1];return Hl(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[Xe,[De],function(e,t){return Hl(t[0].evaluate(e),e.featureState||{})}],properties:[gt,[],function(e){return e.properties()}],"geometry-type":[De,[],function(e){return e.geometryType()}],id:[Xe,[],function(e){return e.id()}],zoom:[ve,[],function(e){return e.globals.zoom}],"heatmap-density":[ve,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[ve,[],function(e){return e.globals.lineProgress||0}],accumulated:[Xe,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[ve,Xo(ve),function(e,t){for(var r=0,a=0,u=t;a<u.length;a+=1)r+=u[a].evaluate(e);return r}],"*":[ve,Xo(ve),function(e,t){for(var r=1,a=0,u=t;a<u.length;a+=1)r*=u[a].evaluate(e);return r}],"-":{type:ve,overloads:[[[ve,ve],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[ve],function(e,t){return-t[0].evaluate(e)}]]},"/":[ve,[ve,ve],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[ve,[ve,ve],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[ve,[],function(){return Math.LN2}],pi:[ve,[],function(){return Math.PI}],e:[ve,[],function(){return Math.E}],"^":[ve,[ve,ve],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[ve,[ve],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[ve,[ve],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[ve,[ve],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[ve,[ve],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[ve,[ve],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[ve,[ve],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[ve,[ve],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[ve,[ve],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[ve,[ve],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[ve,[ve],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[ve,Xo(ve),function(e,t){return Math.min.apply(Math,t.map(function(r){return r.evaluate(e)}))}],max:[ve,Xo(ve),function(e,t){return Math.max.apply(Math,t.map(function(r){return r.evaluate(e)}))}],abs:[ve,[ve],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[ve,[ve],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[ve,[ve],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[ve,[ve],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[xe,[De,Xe],function(e,t){var r=t[0],a=t[1];return e.properties()[r.value]===a.value}],"filter-id-==":[xe,[Xe],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[xe,[De],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[xe,[De,Xe],function(e,t){var r=t[0],a=t[1],u=e.properties()[r.value],p=a.value;return typeof u==typeof p&&u<p}],"filter-id-<":[xe,[Xe],function(e,t){var r=t[0],a=e.id(),u=r.value;return typeof a==typeof u&&a<u}],"filter->":[xe,[De,Xe],function(e,t){var r=t[0],a=t[1],u=e.properties()[r.value],p=a.value;return typeof u==typeof p&&u>p}],"filter-id->":[xe,[Xe],function(e,t){var r=t[0],a=e.id(),u=r.value;return typeof a==typeof u&&a>u}],"filter-<=":[xe,[De,Xe],function(e,t){var r=t[0],a=t[1],u=e.properties()[r.value],p=a.value;return typeof u==typeof p&&u<=p}],"filter-id-<=":[xe,[Xe],function(e,t){var r=t[0],a=e.id(),u=r.value;return typeof a==typeof u&&a<=u}],"filter->=":[xe,[De,Xe],function(e,t){var r=t[0],a=t[1],u=e.properties()[r.value],p=a.value;return typeof u==typeof p&&u>=p}],"filter-id->=":[xe,[Xe],function(e,t){var r=t[0],a=e.id(),u=r.value;return typeof a==typeof u&&a>=u}],"filter-has":[xe,[Xe],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[xe,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[xe,[yr(De)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[xe,[yr(Xe)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[xe,[De,yr(Xe)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[xe,[De,yr(Xe)],function(e,t){var r=t[0],a=t[1];return function(u,p,f,g){for(;f<=g;){var x=f+g>>1;if(p[x]===u)return!0;p[x]>u?g=x-1:f=x+1}return!1}(e.properties()[r.value],a.value,0,a.value.length-1)}],all:{type:xe,overloads:[[[xe,xe],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[Xo(xe),function(e,t){for(var r=0,a=t;r<a.length;r+=1)if(!a[r].evaluate(e))return!1;return!0}]]},any:{type:xe,overloads:[[[xe,xe],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[Xo(xe),function(e,t){for(var r=0,a=t;r<a.length;r+=1)if(a[r].evaluate(e))return!0;return!1}]]},"!":[xe,[xe],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[xe,[De],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[De,[De],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[De,[De],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[De,Xo(Xe),function(e,t){return t.map(function(r){return On(r.evaluate(e))}).join("")}],"resolved-locale":[De,[lr],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var ba=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new Jn,this._defaultValue=t?function(r){return r.type==="color"&&Ns(r.default)?new kt(0,0,0,0):r.type==="color"?kt.parse(r.default)||null:r.default===void 0?null:r.default}(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};function js(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in _a}function qs(e,t){var r=new fo(_a,[],t?function(u){var p={color:yt,string:De,number:ve,enum:De,boolean:xe,formatted:At,resolvedImage:hr};return u.type==="array"?yr(p[u.value]||Xe,u.length):p[u.type]}(t):void 0),a=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?Xl(new ba(a,t)):Wo(r.errors)}ba.prototype.evaluateWithoutErrorHandling=function(e,t,r,a,u,p){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=a,this._evaluator.availableImages=u||null,this._evaluator.formattedSection=p,this.expression.evaluate(this._evaluator)},ba.prototype.evaluate=function(e,t,r,a,u,p){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=a,this._evaluator.availableImages=u||null,this._evaluator.formattedSection=p||null;try{var f=this.expression.evaluate(this._evaluator);if(f==null||typeof f=="number"&&f!=f)return this._defaultValue;if(this._enumValues&&!(f in this._enumValues))throw new _r("Expected value to be one of "+Object.keys(this._enumValues).map(function(g){return JSON.stringify(g)}).join(", ")+", but found "+JSON.stringify(f)+" instead.");return f}catch(g){return this._warningHistory[g.message]||(this._warningHistory[g.message]=!0,typeof console<"u"&&console.warn(g.message)),this._defaultValue}};var $a=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!po(t.expression)};$a.prototype.evaluateWithoutErrorHandling=function(e,t,r,a,u,p){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,a,u,p)},$a.prototype.evaluate=function(e,t,r,a,u,p){return this._styleExpression.evaluate(e,t,r,a,u,p)};var wa=function(e,t,r,a){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!po(t.expression),this.interpolationType=a};function Kl(e,t){if((e=qs(e,t)).result==="error")return e;var r=e.value.expression,a=jo(r);if(!a&&!va(t))return Wo([new Ve("","data expressions not supported")]);var u=Os(r,["zoom"]);if(!u&&!Vs(t))return Wo([new Ve("","zoom expressions not supported")]);var p=function f(g){var x=null;if(g instanceof yo)x=f(g.result);else if(g instanceof mo)for(var w=0,E=g.args;w<E.length&&!(x=f(E[w]));w+=1);else(g instanceof Tn||g instanceof fi)&&g.input instanceof ai&&g.input.name==="zoom"&&(x=g);return x instanceof Ve||g.eachChild(function(I){var z=f(I);z instanceof Ve?x=z:!x&&z?x=new Ve("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):x&&z&&x!==z&&(x=new Ve("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),x}(r);return p||u?p instanceof Ve?Wo([p]):p instanceof fi&&!Wl(t)?Wo([new Ve("",'"interpolate" expressions cannot be used with this property')]):Xl(p?new wa(a?"camera":"composite",e.value,p.labels,p instanceof fi?p.interpolation:void 0):new $a(a?"constant":"source",e.value)):Wo([new Ve("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}wa.prototype.evaluateWithoutErrorHandling=function(e,t,r,a,u,p){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,a,u,p)},wa.prototype.evaluate=function(e,t,r,a,u,p){return this._styleExpression.evaluate(e,t,r,a,u,p)},wa.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?fi.interpolationFactor(this.interpolationType,e,t,r):0};var Ja=function(e,t){this._parameters=e,this._specification=t,Me(this,function r(a,u){var p,f,g,x=u.type==="color",w=a.stops&&typeof a.stops[0][0]=="object",E=w||!(w||a.property!==void 0),I=a.type||(Wl(u)?"exponential":"interval");if(x&&((a=Me({},a)).stops&&(a.stops=a.stops.map(function(Re){return[Re[0],kt.parse(Re[1])]})),a.default=kt.parse(a.default?a.default:u.default)),a.colorSpace&&a.colorSpace!=="rgb"&&!tc[a.colorSpace])throw new Error("Unknown color space: "+a.colorSpace);if(I==="exponential")p=Ka;else if(I==="interval")p=Vp;else if(I==="categorical"){p=Up,f=Object.create(null);for(var z=0,L=a.stops;z<L.length;z+=1){var V=L[z];f[V[0]]=V[1]}g=typeof a.stops[0][0]}else{if(I!=="identity")throw new Error('Unknown function type "'+I+'"');p=cc}if(w){for(var N={},Q=[],W=0;W<a.stops.length;W++){var ne=a.stops[W],ae=ne[0].zoom;N[ae]===void 0&&(N[ae]={zoom:ae,type:a.type,property:a.property,default:a.default,stops:[]},Q.push(ae)),N[ae].stops.push([ne[0].value,ne[1]])}for(var ue=[],ce=0,ge=Q;ce<ge.length;ce+=1){var Ae=ge[ce];ue.push([N[Ae].zoom,r(N[Ae],u)])}var ke={name:"linear"};return{kind:"composite",interpolationType:ke,interpolationFactor:fi.interpolationFactor.bind(void 0,ke),zoomStops:ue.map(function(Re){return Re[0]}),evaluate:function(Re,Je){var Be=Re.zoom;return Ka({stops:ue,base:a.base},u,Be).evaluate(Be,Je)}}}if(E){var Ke=I==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:Ke,interpolationFactor:fi.interpolationFactor.bind(void 0,Ke),zoomStops:a.stops.map(function(Re){return Re[0]}),evaluate:function(Re){return p(a,u,Re.zoom,f,g)}}}return{kind:"source",evaluate:function(Re,Je){var Be=Je&&Je.properties?Je.properties[a.property]:void 0;return Be===void 0?xa(a.default,u.default):p(a,u,Be,f,g)}}}(this._parameters,this._specification))};function In(e){var t=e.key,r=e.value,a=e.valueSpec||{},u=e.objectElementValidators||{},p=e.style,f=e.styleSpec,g=[],x=fr(r);if(x!=="object")return[new X(t,r,"object expected, "+x+" found")];for(var w in r){var E=w.split(".")[0],I=a[E]||a["*"],z=void 0;if(u[E])z=u[E];else if(a[E])z=Ot;else if(u["*"])z=u["*"];else{if(!a["*"]){g.push(new X(t,r[w],'unknown property "'+w+'"'));continue}z=Ot}g=g.concat(z({key:(t&&t+".")+w,value:r[w],valueSpec:I,style:p,styleSpec:f,object:r,objectKey:w},r))}for(var L in a)u[L]||a[L].required&&a[L].default===void 0&&r[L]===void 0&&g.push(new X(t,r,'missing required property "'+L+'"'));return g}function pc(e){var t=e.value,r=e.valueSpec,a=e.style,u=e.styleSpec,p=e.key,f=e.arrayElementValidator||Ot;if(fr(t)!=="array")return[new X(p,t,"array expected, "+fr(t)+" found")];if(r.length&&t.length!==r.length)return[new X(p,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new X(p,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var g={type:r.value,values:r.values};u.$version<7&&(g.function=r.function),fr(r.value)==="object"&&(g=r.value);for(var x=[],w=0;w<t.length;w++)x=x.concat(f({array:t,arrayIndex:w,value:t[w],valueSpec:g,style:a,styleSpec:u,key:p+"["+w+"]"}));return x}function hc(e){var t=e.key,r=e.value,a=e.valueSpec,u=fr(r);return u==="number"&&r!=r&&(u="NaN"),u!=="number"?[new X(t,r,"number expected, "+u+" found")]:"minimum"in a&&r<a.minimum?[new X(t,r,r+" is less than the minimum value "+a.minimum)]:"maximum"in a&&r>a.maximum?[new X(t,r,r+" is greater than the maximum value "+a.maximum)]:[]}function $l(e){var t,r,a,u=e.valueSpec,p=le(e.value.type),f={},g=p!=="categorical"&&e.value.property===void 0,x=!g,w=fr(e.value.stops)==="array"&&fr(e.value.stops[0])==="array"&&fr(e.value.stops[0][0])==="object",E=In({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(L){if(p==="identity")return[new X(L.key,L.value,'identity function may not have a "stops" property')];var V=[],N=L.value;return V=V.concat(pc({key:L.key,value:N,valueSpec:L.valueSpec,style:L.style,styleSpec:L.styleSpec,arrayElementValidator:I})),fr(N)==="array"&&N.length===0&&V.push(new X(L.key,N,"array must have at least one stop")),V},default:function(L){return Ot({key:L.key,value:L.value,valueSpec:u,style:L.style,styleSpec:L.styleSpec})}}});return p==="identity"&&g&&E.push(new X(e.key,e.value,'missing required property "property"')),p==="identity"||e.value.stops||E.push(new X(e.key,e.value,'missing required property "stops"')),p==="exponential"&&e.valueSpec.expression&&!Wl(e.valueSpec)&&E.push(new X(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(x&&!va(e.valueSpec)?E.push(new X(e.key,e.value,"property functions not supported")):g&&!Vs(e.valueSpec)&&E.push(new X(e.key,e.value,"zoom functions not supported"))),p!=="categorical"&&!w||e.value.property!==void 0||E.push(new X(e.key,e.value,'"property" property is required')),E;function I(L){var V=[],N=L.value,Q=L.key;if(fr(N)!=="array")return[new X(Q,N,"array expected, "+fr(N)+" found")];if(N.length!==2)return[new X(Q,N,"array length 2 expected, length "+N.length+" found")];if(w){if(fr(N[0])!=="object")return[new X(Q,N,"object expected, "+fr(N[0])+" found")];if(N[0].zoom===void 0)return[new X(Q,N,"object stop key must have zoom")];if(N[0].value===void 0)return[new X(Q,N,"object stop key must have value")];if(a&&a>le(N[0].zoom))return[new X(Q,N[0].zoom,"stop zoom values must appear in ascending order")];le(N[0].zoom)!==a&&(a=le(N[0].zoom),r=void 0,f={}),V=V.concat(In({key:Q+"[0]",value:N[0],valueSpec:{zoom:{}},style:L.style,styleSpec:L.styleSpec,objectElementValidators:{zoom:hc,value:z}}))}else V=V.concat(z({key:Q+"[0]",value:N[0],valueSpec:{},style:L.style,styleSpec:L.styleSpec},N));return js(we(N[1]))?V.concat([new X(Q+"[1]",N[1],"expressions are not allowed in function stops.")]):V.concat(Ot({key:Q+"[1]",value:N[1],valueSpec:u,style:L.style,styleSpec:L.styleSpec}))}function z(L,V){var N=fr(L.value),Q=le(L.value),W=L.value!==null?L.value:V;if(t){if(N!==t)return[new X(L.key,W,N+" stop domain type must match previous stop domain type "+t)]}else t=N;if(N!=="number"&&N!=="string"&&N!=="boolean")return[new X(L.key,W,"stop domain value must be a number, string, or boolean")];if(N!=="number"&&p!=="categorical"){var ne="number expected, "+N+" found";return va(u)&&p===void 0&&(ne+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new X(L.key,W,ne)]}return p!=="categorical"||N!=="number"||isFinite(Q)&&Math.floor(Q)===Q?p!=="categorical"&&N==="number"&&r!==void 0&&Q<r?[new X(L.key,W,"stop domain values must appear in ascending order")]:(r=Q,p==="categorical"&&Q in f?[new X(L.key,W,"stop domain values must be unique")]:(f[Q]=!0,[])):[new X(L.key,W,"integer expected, found "+Q)]}}function Ko(e){var t=(e.expressionContext==="property"?Kl:qs)(we(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(a){return new X(""+e.key+a.key,e.value,a.message)});var r=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!r.outputDefined())return[new X(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!po(r))return[new X(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!po(r))return[new X(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!Os(r,["zoom","feature-state"]))return[new X(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!jo(r))return[new X(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ya(e){var t=e.key,r=e.value,a=e.valueSpec,u=[];return Array.isArray(a.values)?a.values.indexOf(le(r))===-1&&u.push(new X(t,r,"expected one of ["+a.values.join(", ")+"], "+JSON.stringify(r)+" found")):Object.keys(a.values).indexOf(le(r))===-1&&u.push(new X(t,r,"expected one of ["+Object.keys(a.values).join(", ")+"], "+JSON.stringify(r)+" found")),u}function Qa(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var a=r[t];if(!Qa(a)&&typeof a!="boolean")return!1}return!0;default:return!0}}Ja.deserialize=function(e){return new Ja(e._parameters,e._specification)},Ja.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Np={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Zs(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};Qa(e)||(e=Gs(e));var t=qs(e,Np);if(t.result==="error")throw new Error(t.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(r,a,u){return t.value.evaluate(r,a,{},u)},needGeometry:function r(a){if(!Array.isArray(a))return!1;if(a[0]==="within")return!0;for(var u=1;u<a.length;u++)if(r(a[u]))return!0;return!1}(e)}}function jp(e,t){return e<t?-1:e>t?1:0}function Gs(e){if(!e)return!0;var t,r=e[0];return e.length<=1?r!=="any":r==="=="?Jl(e[1],e[2],"=="):r==="!="?Hs(Jl(e[1],e[2],"==")):r==="<"||r===">"||r==="<="||r===">="?Jl(e[1],e[2],r):r==="any"?(t=e.slice(1),["any"].concat(t.map(Gs))):r==="all"?["all"].concat(e.slice(1).map(Gs)):r==="none"?["all"].concat(e.slice(1).map(Gs).map(Hs)):r==="in"?fc(e[1],e.slice(2)):r==="!in"?Hs(fc(e[1],e.slice(2))):r==="has"?dc(e[1]):r==="!has"?Hs(dc(e[1])):r!=="within"||e}function Jl(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function fc(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(r){return typeof r!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(jp)]]:["filter-in-small",e,["literal",t]]}}function dc(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Hs(e){return["!",e]}function Xs(e){return Qa(we(e.value))?Ko(Me({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(r){var a=r.value,u=r.key;if(fr(a)!=="array")return[new X(u,a,"array expected, "+fr(a)+" found")];var p,f=r.styleSpec,g=[];if(a.length<1)return[new X(u,a,"filter array must have at least 1 element")];switch(g=g.concat(Ya({key:u+"[0]",value:a[0],valueSpec:f.filter_operator,style:r.style,styleSpec:r.styleSpec})),le(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&le(a[1])==="$type"&&g.push(new X(u,a,'"$type" cannot be use with operator "'+a[0]+'"'));case"==":case"!=":a.length!==3&&g.push(new X(u,a,'filter array for operator "'+a[0]+'" must have 3 elements'));case"in":case"!in":a.length>=2&&(p=fr(a[1]))!=="string"&&g.push(new X(u+"[1]",a[1],"string expected, "+p+" found"));for(var x=2;x<a.length;x++)p=fr(a[x]),le(a[1])==="$type"?g=g.concat(Ya({key:u+"["+x+"]",value:a[x],valueSpec:f.geometry_type,style:r.style,styleSpec:r.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&g.push(new X(u+"["+x+"]",a[x],"string, number, or boolean expected, "+p+" found"));break;case"any":case"all":case"none":for(var w=1;w<a.length;w++)g=g.concat(t({key:u+"["+w+"]",value:a[w],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":p=fr(a[1]),a.length!==2?g.push(new X(u,a,'filter array for "'+a[0]+'" operator must have 2 elements')):p!=="string"&&g.push(new X(u+"[1]",a[1],"string expected, "+p+" found"));break;case"within":p=fr(a[1]),a.length!==2?g.push(new X(u,a,'filter array for "'+a[0]+'" operator must have 2 elements')):p!=="object"&&g.push(new X(u+"[1]",a[1],"object expected, "+p+" found"))}return g}(e)}function Yl(e,t){var r=e.key,a=e.style,u=e.styleSpec,p=e.value,f=e.objectKey,g=u[t+"_"+e.layerType];if(!g)return[];var x=f.match(/^(.*)-transition$/);if(t==="paint"&&x&&g[x[1]]&&g[x[1]].transition)return Ot({key:r,value:p,valueSpec:u.transition,style:a,styleSpec:u});var w,E=e.valueSpec||g[f];if(!E)return[new X(r,p,'unknown property "'+f+'"')];if(fr(p)==="string"&&va(E)&&!E.tokens&&(w=/^{([^}]+)}$/.exec(p)))return[new X(r,p,'"'+f+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(w[1])+" }`.")];var I=[];return e.layerType==="symbol"&&(f==="text-field"&&a&&!a.glyphs&&I.push(new X(r,p,'use of "text-field" requires a style "glyphs" property')),f==="text-font"&&Ns(we(p))&&le(p.type)==="identity"&&I.push(new X(r,p,'"text-font" does not support identity functions'))),I.concat(Ot({key:e.key,value:p,valueSpec:E,style:a,styleSpec:u,expressionContext:"property",propertyType:t,propertyKey:f}))}function es(e){return Yl(e,"paint")}function mc(e){return Yl(e,"layout")}function Ql(e){var t=[],r=e.value,a=e.key,u=e.style,p=e.styleSpec;r.type||r.ref||t.push(new X(a,r,'either "type" or "ref" is required'));var f,g=le(r.type),x=le(r.ref);if(r.id)for(var w=le(r.id),E=0;E<e.arrayIndex;E++){var I=u.layers[E];le(I.id)===w&&t.push(new X(a,r.id,'duplicate layer id "'+r.id+'", previously used at line '+I.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(V){V in r&&t.push(new X(a,r[V],'"'+V+'" is prohibited for ref layers'))}),u.layers.forEach(function(V){le(V.id)===x&&(f=V)}),f?f.ref?t.push(new X(a,r.ref,"ref cannot reference another ref layer")):g=le(f.type):t.push(new X(a,r.ref,'ref layer "'+x+'" not found'));else if(g!=="background")if(r.source){var z=u.sources&&u.sources[r.source],L=z&&le(z.type);z?L==="vector"&&g==="raster"?t.push(new X(a,r.source,'layer "'+r.id+'" requires a raster source')):L==="raster"&&g!=="raster"?t.push(new X(a,r.source,'layer "'+r.id+'" requires a vector source')):L!=="vector"||r["source-layer"]?L==="raster-dem"&&g!=="hillshade"?t.push(new X(a,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):g!=="line"||!r.paint||!r.paint["line-gradient"]||L==="geojson"&&z.lineMetrics||t.push(new X(a,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new X(a,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new X(a,r.source,'source "'+r.source+'" not found'))}else t.push(new X(a,r,'missing required property "source"'));return t=t.concat(In({key:a,value:r,valueSpec:p.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Ot({key:a+".type",value:r.type,valueSpec:p.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:Xs,layout:function(V){return In({layer:r,key:V.key,value:V.value,style:V.style,styleSpec:V.styleSpec,objectElementValidators:{"*":function(N){return mc(Me({layerType:g},N))}}})},paint:function(V){return In({layer:r,key:V.key,value:V.value,style:V.style,styleSpec:V.styleSpec,objectElementValidators:{"*":function(N){return es(Me({layerType:g},N))}}})}}}))}function tr(e){var t=e.value,r=e.key,a=fr(t);return a!=="string"?[new X(r,t,"string expected, "+a+" found")]:[]}var Ws={promoteId:function(e){var t=e.key,r=e.value;if(fr(r)==="string")return tr({key:t,value:r});var a=[];for(var u in r)a.push.apply(a,tr({key:t+"."+u,value:r[u]}));return a}};function $o(e){var t=e.value,r=e.key,a=e.styleSpec,u=e.style;if(!t.type)return[new X(r,t,'"type" is required')];var p,f=le(t.type);switch(f){case"vector":case"raster":case"raster-dem":return In({key:r,value:t,valueSpec:a["source_"+f.replace("-","_")],style:e.style,styleSpec:a,objectElementValidators:Ws});case"geojson":if(p=In({key:r,value:t,valueSpec:a.source_geojson,style:u,styleSpec:a,objectElementValidators:Ws}),t.cluster)for(var g in t.clusterProperties){var x=t.clusterProperties[g],w=x[0],E=typeof w=="string"?[w,["accumulated"],["get",g]]:w;p.push.apply(p,Ko({key:r+"."+g+".map",value:x[1],expressionContext:"cluster-map"})),p.push.apply(p,Ko({key:r+"."+g+".reduce",value:E,expressionContext:"cluster-reduce"}))}return p;case"video":return In({key:r,value:t,valueSpec:a.source_video,style:u,styleSpec:a});case"image":return In({key:r,value:t,valueSpec:a.source_image,style:u,styleSpec:a});case"canvas":return[new X(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ya({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:u,styleSpec:a})}}function bo(e){var t=e.value,r=e.styleSpec,a=r.light,u=e.style,p=[],f=fr(t);if(t===void 0)return p;if(f!=="object")return p.concat([new X("light",t,"object expected, "+f+" found")]);for(var g in t){var x=g.match(/^(.*)-transition$/);p=p.concat(x&&a[x[1]]&&a[x[1]].transition?Ot({key:g,value:t[g],valueSpec:r.transition,style:u,styleSpec:r}):a[g]?Ot({key:g,value:t[g],valueSpec:a[g],style:u,styleSpec:r}):[new X(g,t[g],'unknown property "'+g+'"')])}return p}var Yt={"*":function(){return[]},array:pc,boolean:function(e){var t=e.value,r=e.key,a=fr(t);return a!=="boolean"?[new X(r,t,"boolean expected, "+a+" found")]:[]},number:hc,color:function(e){var t=e.key,r=e.value,a=fr(r);return a!=="string"?[new X(t,r,"color expected, "+a+" found")]:ma(r)===null?[new X(t,r,'color expected, "'+r+'" found')]:[]},constants:be,enum:Ya,filter:Xs,function:$l,layer:Ql,object:In,source:$o,light:bo,string:tr,formatted:function(e){return tr(e).length===0?[]:Ko(e)},resolvedImage:function(e){return tr(e).length===0?[]:Ko(e)}};function Ot(e){var t=e.value,r=e.valueSpec,a=e.styleSpec;return r.expression&&Ns(le(t))?$l(e):r.expression&&js(we(t))?Ko(e):r.type&&Yt[r.type]?Yt[r.type](e):In(Me({},e,{valueSpec:r.type?a[r.type]:r}))}function Jo(e){var t=e.value,r=e.key,a=tr(e);return a.length||(t.indexOf("{fontstack}")===-1&&a.push(new X(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&a.push(new X(r,t,'"glyphs" url must include a "{range}" token'))),a}function Fn(e,t){t===void 0&&(t=F);var r=[];return r=r.concat(Ot({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Jo,"*":function(){return[]}}})),e.constants&&(r=r.concat(be({key:"constants",value:e.constants,style:e,styleSpec:t}))),yc(r)}function yc(e){return[].concat(e).sort(function(t,r){return t.line-r.line})}function Sa(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return yc(e.apply(this,t))}}Fn.source=Sa($o),Fn.light=Sa(bo),Fn.layer=Sa(Ql),Fn.filter=Sa(Xs),Fn.paintProperty=Sa(es),Fn.layoutProperty=Sa(mc);var ts=Fn,qp=ts.light,rs=ts.paintProperty,Ks=ts.layoutProperty;function is(e,t){var r=!1;if(t&&t.length)for(var a=0,u=t;a<u.length;a+=1)e.fire(new re(new Error(u[a].message))),r=!0;return r}var _i=tn;function tn(e,t,r){var a=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var u=new Int32Array(this.arrayBuffer);e=u[0],this.d=(t=u[1])+2*(r=u[2]);for(var p=0;p<this.d*this.d;p++){var f=u[3+p],g=u[3+p+1];a.push(f===g?null:u.subarray(f,g))}var x=u[3+a.length+1];this.keys=u.subarray(u[3+a.length],x),this.bboxes=u.subarray(x),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var w=0;w<this.d*this.d;w++)a.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var E=r/t*e;this.min=-E,this.max=e+E}tn.prototype.insert=function(e,t,r,a,u){this._forEachCell(t,r,a,u,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(a),this.bboxes.push(u)},tn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},tn.prototype._insertCell=function(e,t,r,a,u,p){this.cells[u].push(p)},tn.prototype.query=function(e,t,r,a,u){var p=this.min,f=this.max;if(e<=p&&t<=p&&f<=r&&f<=a&&!u)return Array.prototype.slice.call(this.keys);var g=[];return this._forEachCell(e,t,r,a,this._queryCell,g,{},u),g},tn.prototype._queryCell=function(e,t,r,a,u,p,f,g){var x=this.cells[u];if(x!==null)for(var w=this.keys,E=this.bboxes,I=0;I<x.length;I++){var z=x[I];if(f[z]===void 0){var L=4*z;(g?g(E[L+0],E[L+1],E[L+2],E[L+3]):e<=E[L+2]&&t<=E[L+3]&&r>=E[L+0]&&a>=E[L+1])?(f[z]=!0,p.push(w[z])):f[z]=!1}}},tn.prototype._forEachCell=function(e,t,r,a,u,p,f,g){for(var x=this._convertToCellCoord(e),w=this._convertToCellCoord(t),E=this._convertToCellCoord(r),I=this._convertToCellCoord(a),z=x;z<=E;z++)for(var L=w;L<=I;L++){var V=this.d*L+z;if((!g||g(this._convertFromCellCoord(z),this._convertFromCellCoord(L),this._convertFromCellCoord(z+1),this._convertFromCellCoord(L+1)))&&u.call(this,e,t,r,a,V,p,f,g))return}},tn.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},tn.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},tn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,a=0;a<this.cells.length;a++)r+=this.cells[a].length;var u=new Int32Array(t+r+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var p=t,f=0;f<e.length;f++){var g=e[f];u[3+f]=p,u.set(g,p),p+=g.length}return u[3+e.length]=p,u.set(this.keys,p),u[3+e.length+1]=p+=this.keys.length,u.set(this.bboxes,p),p+=this.bboxes.length,u.buffer};var gc=fe.ImageData,si=fe.ImageBitmap,Gi={};function Ne(e,t,r){r===void 0&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Gi[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var ns in Ne("Object",Object),_i.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},_i.deserialize=function(e){return new _i(e.buffer)},Ne("Grid",_i),Ne("Color",kt),Ne("Error",Error),Ne("ResolvedImage",Di),Ne("StylePropertyFunction",Ja),Ne("StyleExpression",ba,{omit:["_evaluator"]}),Ne("ZoomDependentExpression",wa),Ne("ZoomConstantExpression",$a),Ne("CompoundExpression",ai,{omit:["_evaluate"]}),_a)_a[ns]._classRegistryKey||Ne("Expression_"+ns,_a[ns]);function Ea(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function wo(e){return si&&e instanceof si}function Hi(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Ea(e)||wo(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof gc)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var a=[],u=0,p=e;u<p.length;u+=1)a.push(Hi(p[u],t));return a}if(typeof e=="object"){var f=e.constructor,g=f._classRegistryKey;if(!g)throw new Error("can't serialize object of unregistered class");var x=f.serialize?f.serialize(e,t):{};if(!f.serialize){for(var w in e)if(e.hasOwnProperty(w)&&!(Gi[g].omit.indexOf(w)>=0)){var E=e[w];x[w]=Gi[g].shallow.indexOf(w)>=0?E:Hi(E,t)}e instanceof Error&&(x.message=e.message)}if(x.$name)throw new Error("$name property is reserved for worker serialization logic.");return g!=="Object"&&(x.$name=g),x}throw new Error("can't serialize object of type "+typeof e)}function os(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Ea(e)||wo(e)||ArrayBuffer.isView(e)||e instanceof gc)return e;if(Array.isArray(e))return e.map(os);if(typeof e=="object"){var t=e.$name||"Object",r=Gi[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var a=Object.create(r.prototype),u=0,p=Object.keys(e);u<p.length;u+=1){var f=p[u];if(f!=="$name"){var g=e[f];a[f]=Gi[t].shallow.indexOf(f)>=0?g:os(g)}}return a}throw new Error("can't deserialize object of type "+typeof e)}var Oi=function(){this.first=!0};Oi.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var qe={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function $s(e){for(var t=0,r=e;t<r.length;t+=1)if(Js(r[t].charCodeAt(0)))return!0;return!1}function Js(e){return!(e!==746&&e!==747&&(e<4352||!(qe["Bopomofo Extended"](e)||qe.Bopomofo(e)||qe["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||qe["CJK Compatibility Ideographs"](e)||qe["CJK Compatibility"](e)||qe["CJK Radicals Supplement"](e)||qe["CJK Strokes"](e)||!(!qe["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||qe["CJK Unified Ideographs Extension A"](e)||qe["CJK Unified Ideographs"](e)||qe["Enclosed CJK Letters and Months"](e)||qe["Hangul Compatibility Jamo"](e)||qe["Hangul Jamo Extended-A"](e)||qe["Hangul Jamo Extended-B"](e)||qe["Hangul Jamo"](e)||qe["Hangul Syllables"](e)||qe.Hiragana(e)||qe["Ideographic Description Characters"](e)||qe.Kanbun(e)||qe["Kangxi Radicals"](e)||qe["Katakana Phonetic Extensions"](e)||qe.Katakana(e)&&e!==12540||!(!qe["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!qe["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||qe["Unified Canadian Aboriginal Syllabics"](e)||qe["Unified Canadian Aboriginal Syllabics Extended"](e)||qe["Vertical Forms"](e)||qe["Yijing Hexagram Symbols"](e)||qe["Yi Syllables"](e)||qe["Yi Radicals"](e))))}function dn(e){return!(Js(e)||function(t){return!!(qe["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||qe["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||qe["Letterlike Symbols"](t)||qe["Number Forms"](t)||qe["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||qe["Control Pictures"](t)&&t!==9251||qe["Optical Character Recognition"](t)||qe["Enclosed Alphanumerics"](t)||qe["Geometric Shapes"](t)||qe["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||qe["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||qe["CJK Symbols and Punctuation"](t)||qe.Katakana(t)||qe["Private Use Area"](t)||qe["CJK Compatibility Forms"](t)||qe["Small Form Variants"](t)||qe["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function Fi(e){return e>=1424&&e<=2303||qe["Arabic Presentation Forms-A"](e)||qe["Arabic Presentation Forms-B"](e)}function Ys(e,t){return!(!t&&Fi(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||qe.Khmer(e))}function _c(e){for(var t=0,r=e;t<r.length;t+=1)if(Fi(r[t].charCodeAt(0)))return!0;return!1}var eu=null,Ui="unavailable",So=null,Qs=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(Ui="error"),eu&&eu(e)};function tu(){ru.fire(new ee("pluginStateChange",{pluginStatus:Ui,pluginURL:So}))}var ru=new Y,Cn=function(){return Ui},vc=function(){if(Ui!=="deferred"||!So)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ui="loading",tu(),So&&Ir({url:So},function(e){e?Qs(e):(Ui="loaded",tu())})},Er={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Ui==="loaded"||Er.applyArabicShaping!=null},isLoading:function(){return Ui==="loading"},setState:function(e){Ui=e.pluginStatus,So=e.pluginURL},isParsed:function(){return Er.applyArabicShaping!=null&&Er.processBidirectionalText!=null&&Er.processStyledBidirectionalText!=null},getPluginURL:function(){return So}},Xt=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Oi,this.transition={})};Xt.prototype.isSupportedScript=function(e){return function(t,r){for(var a=0,u=t;a<u.length;a+=1)if(!Ys(u[a].charCodeAt(0),r))return!1;return!0}(e,Er.isLoaded())},Xt.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Xt.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var mn=function(e,t){this.property=e,this.value=t,this.expression=function(r,a){if(Ns(r))return new Ja(r,a);if(js(r)){var u=Kl(r,a);if(u.result==="error")throw new Error(u.value.map(function(f){return f.key+": "+f.message}).join(", "));return u.value}var p=r;return typeof r=="string"&&a.type==="color"&&(p=kt.parse(r)),{kind:"constant",evaluate:function(){return p}}}(t===void 0?e.specification.default:t,e.specification)};mn.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},mn.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)};var Xi=function(e){this.property=e,this.value=new mn(e,void 0)};Xi.prototype.transitioned=function(e,t){return new Yo(this.property,this.value,t,Pt({},e.transition,this.transition),e.now)},Xi.prototype.untransitioned=function(){return new Yo(this.property,this.value,null,{},0)};var rn=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};rn.prototype.getValue=function(e){return Gt(this._values[e].value.value)},rn.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Xi(this._values[e].property)),this._values[e].value=new mn(this._values[e].property,t===null?void 0:Gt(t))},rn.prototype.getTransition=function(e){return Gt(this._values[e].transition)},rn.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Xi(this._values[e].property)),this._values[e].transition=Gt(t)||void 0},rn.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var a=r[t],u=this.getValue(a);u!==void 0&&(e[a]=u);var p=this.getTransition(a);p!==void 0&&(e[a+"-transition"]=p)}return e},rn.prototype.transitioned=function(e,t){for(var r=new Un(this._properties),a=0,u=Object.keys(this._values);a<u.length;a+=1){var p=u[a];r._values[p]=this._values[p].transitioned(e,t._values[p])}return r},rn.prototype.untransitioned=function(){for(var e=new Un(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var a=r[t];e._values[a]=this._values[a].untransitioned()}return e};var Yo=function(e,t,r,a,u){this.property=e,this.value=t,this.begin=u+a.delay||0,this.end=this.begin+a.duration||0,e.specification.transition&&(a.delay||a.duration)&&(this.prior=r)};Yo.prototype.possiblyEvaluate=function(e,t,r){var a=e.now||0,u=this.value.possiblyEvaluate(e,t,r),p=this.prior;if(p){if(a>this.end)return this.prior=null,u;if(this.value.isDataDriven())return this.prior=null,u;if(a<this.begin)return p.possiblyEvaluate(e,t,r);var f=(a-this.begin)/(this.end-this.begin);return this.property.interpolate(p.possiblyEvaluate(e,t,r),u,function(g){if(g<=0)return 0;if(g>=1)return 1;var x=g*g,w=x*g;return 4*(g<.5?w:3*(g-x)+w-.75)}(f))}return u};var Un=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Un.prototype.possiblyEvaluate=function(e,t,r){for(var a=new Qo(this._properties),u=0,p=Object.keys(this._values);u<p.length;u+=1){var f=p[u];a._values[f]=this._values[f].possiblyEvaluate(e,t,r)}return a},Un.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var Eo=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};Eo.prototype.getValue=function(e){return Gt(this._values[e].value)},Eo.prototype.setValue=function(e,t){this._values[e]=new mn(this._values[e].property,t===null?void 0:Gt(t))},Eo.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var a=r[t],u=this.getValue(a);u!==void 0&&(e[a]=u)}return e},Eo.prototype.possiblyEvaluate=function(e,t,r){for(var a=new Qo(this._properties),u=0,p=Object.keys(this._values);u<p.length;u+=1){var f=p[u];a._values[f]=this._values[f].possiblyEvaluate(e,t,r)}return a};var nn=function(e,t,r){this.property=e,this.value=t,this.parameters=r};nn.prototype.isConstant=function(){return this.value.kind==="constant"},nn.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},nn.prototype.evaluate=function(e,t,r,a){return this.property.evaluate(this.value,this.parameters,e,t,r,a)};var Qo=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};Qo.prototype.get=function(e){return this._values[e]};var Fe=function(e){this.specification=e};Fe.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},Fe.prototype.interpolate=function(e,t,r){var a=Fs[this.specification.type];return a?a(e,t,r):e};var st=function(e,t){this.specification=e,this.overrides=t};st.prototype.possiblyEvaluate=function(e,t,r,a){return new nn(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},r,a)}:e.expression,t)},st.prototype.interpolate=function(e,t,r){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new nn(this,{kind:"constant",value:void 0},e.parameters);var a=Fs[this.specification.type];return a?new nn(this,{kind:"constant",value:a(e.value.value,t.value.value,r)},e.parameters):e},st.prototype.evaluate=function(e,t,r,a,u,p){return e.kind==="constant"?e.value:e.evaluate(t,r,a,u,p)};var Wi=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,a,u,p){if(r.value===void 0)return new nn(this,{kind:"constant",value:void 0},a);if(r.expression.kind==="constant"){var f=r.expression.evaluate(a,null,{},u,p),g=r.property.specification.type==="resolvedImage"&&typeof f!="string"?f.name:f,x=this._calculate(g,g,g,a);return new nn(this,{kind:"constant",value:x},a)}if(r.expression.kind==="camera"){var w=this._calculate(r.expression.evaluate({zoom:a.zoom-1}),r.expression.evaluate({zoom:a.zoom}),r.expression.evaluate({zoom:a.zoom+1}),a);return new nn(this,{kind:"constant",value:w},a)}return new nn(this,r.expression,a)},t.prototype.evaluate=function(r,a,u,p,f,g){if(r.kind==="source"){var x=r.evaluate(a,u,p,f,g);return this._calculate(x,x,x,a)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(a.zoom)-1},u,p),r.evaluate({zoom:Math.floor(a.zoom)},u,p),r.evaluate({zoom:Math.floor(a.zoom)+1},u,p),a):r.value},t.prototype._calculate=function(r,a,u,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:r,to:a}:{from:u,to:a}},t.prototype.interpolate=function(r){return r},t}(st),yn=function(e){this.specification=e};yn.prototype.possiblyEvaluate=function(e,t,r,a){if(e.value!==void 0){if(e.expression.kind==="constant"){var u=e.expression.evaluate(t,null,{},r,a);return this._calculate(u,u,u,t)}return this._calculate(e.expression.evaluate(new Xt(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Xt(Math.floor(t.zoom),t)),e.expression.evaluate(new Xt(Math.floor(t.zoom+1),t)),t)}},yn.prototype._calculate=function(e,t,r,a){return a.zoom>a.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},yn.prototype.interpolate=function(e){return e};var Qn=function(e){this.specification=e};Qn.prototype.possiblyEvaluate=function(e,t,r,a){return!!e.expression.evaluate(t,null,{},r,a)},Qn.prototype.interpolate=function(){return!1};var Ki=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var r=e[t];r.specification.overridable&&this.overridableProperties.push(t);var a=this.defaultPropertyValues[t]=new mn(r,void 0),u=this.defaultTransitionablePropertyValues[t]=new Xi(r);this.defaultTransitioningPropertyValues[t]=u.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=a.possiblyEvaluate({})}};Ne("DataDrivenProperty",st),Ne("DataConstantProperty",Fe),Ne("CrossFadedDataDrivenProperty",Wi),Ne("CrossFadedProperty",yn),Ne("ColorRampProperty",Qn);var gn=function(e){function t(r,a){if(e.call(this),this.id=r.id,this.type=r.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},r.type!=="custom"&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),a.layout&&(this._unevaluatedLayout=new Eo(a.layout)),a.paint)){for(var u in this._transitionablePaint=new rn(a.paint),r.paint)this.setPaintProperty(u,r.paint[u],{validate:!1});for(var p in r.layout)this.setLayoutProperty(p,r.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Qo(a.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)},t.prototype.setLayoutProperty=function(r,a,u){u===void 0&&(u={}),a!=null&&this._validate(Ks,"layers."+this.id+".layout."+r,r,a,u)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,a):this.visibility=a)},t.prototype.getPaintProperty=function(r){return Pr(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)},t.prototype.setPaintProperty=function(r,a,u){if(u===void 0&&(u={}),a!=null&&this._validate(rs,"layers."+this.id+".paint."+r,r,a,u))return!1;if(Pr(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-11),a||void 0),!1;var p=this._transitionablePaint._values[r],f=p.property.specification["property-type"]==="cross-faded-data-driven",g=p.value.isDataDriven(),x=p.value;this._transitionablePaint.setValue(r,a),this._handleSpecialPaintPropertyUpdate(r);var w=this._transitionablePaint._values[r].value;return w.isDataDriven()||g||f||this._handleOverridablePaintPropertyUpdate(r,x,w)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){},t.prototype._handleOverridablePaintPropertyUpdate=function(r,a,u){return!1},t.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(r,a){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,a)},t.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Vt(r,function(a,u){return!(a===void 0||u==="layout"&&!Object.keys(a).length||u==="paint"&&!Object.keys(a).length)})},t.prototype._validate=function(r,a,u,p,f){return f===void 0&&(f={}),(!f||f.validate!==!1)&&is(this,r.call(ts,{key:a,layerType:this.type,objectKey:u,value:p,styleSpec:F,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var r in this.paint._values){var a=this.paint.get(r);if(a instanceof nn&&va(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1},t}(Y),Zp={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},eo=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},dr=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function li(e,t){t===void 0&&(t=1);var r=0,a=0;return{members:e.map(function(u){var p=Zp[u.type].BYTES_PER_ELEMENT,f=r=iu(r,Math.max(t,p)),g=u.components||1;return a=Math.max(a,p),r+=p*g,{name:u.name,type:u.type,components:g,offset:f}}),size:iu(r,Math.max(a,t)),alignment:t}}function iu(e,t){return Math.ceil(e/t)*t}dr.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},dr.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},dr.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},dr.prototype.clear=function(){this.length=0},dr.prototype.resize=function(e){this.reserve(e),this.length=e},dr.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},dr.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var as=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,a){var u=this.length;return this.resize(u+1),this.emplace(u,r,a)},t.prototype.emplace=function(r,a,u){var p=2*r;return this.int16[p+0]=a,this.int16[p+1]=u,r},t}(dr);as.prototype.bytesPerElement=4,Ne("StructArrayLayout2i4",as);var to=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,a,u,p){var f=this.length;return this.resize(f+1),this.emplace(f,r,a,u,p)},t.prototype.emplace=function(r,a,u,p,f){var g=4*r;return this.int16[g+0]=a,this.int16[g+1]=u,this.int16[g+2]=p,this.int16[g+3]=f,r},t}(dr);to.prototype.bytesPerElement=8,Ne("StructArrayLayout4i8",to);var $i=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,a,u,p,f,g){var x=this.length;return this.resize(x+1),this.emplace(x,r,a,u,p,f,g)},t.prototype.emplace=function(r,a,u,p,f,g,x){var w=6*r;return this.int16[w+0]=a,this.int16[w+1]=u,this.int16[w+2]=p,this.int16[w+3]=f,this.int16[w+4]=g,this.int16[w+5]=x,r},t}(dr);$i.prototype.bytesPerElement=12,Ne("StructArrayLayout2i4i12",$i);var el=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,a,u,p,f,g){var x=this.length;return this.resize(x+1),this.emplace(x,r,a,u,p,f,g)},t.prototype.emplace=function(r,a,u,p,f,g,x){var w=4*r,E=8*r;return this.int16[w+0]=a,this.int16[w+1]=u,this.uint8[E+4]=p,this.uint8[E+5]=f,this.uint8[E+6]=g,this.uint8[E+7]=x,r},t}(dr);el.prototype.bytesPerElement=8,Ne("StructArrayLayout2i4ub8",el);var ea=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,a){var u=this.length;return this.resize(u+1),this.emplace(u,r,a)},t.prototype.emplace=function(r,a,u){var p=2*r;return this.float32[p+0]=a,this.float32[p+1]=u,r},t}(dr);ea.prototype.bytesPerElement=8,Ne("StructArrayLayout2f8",ea);var ro=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,a,u,p,f,g,x,w,E,I){var z=this.length;return this.resize(z+1),this.emplace(z,r,a,u,p,f,g,x,w,E,I)},t.prototype.emplace=function(r,a,u,p,f,g,x,w,E,I,z){var L=10*r;return this.uint16[L+0]=a,this.uint16[L+1]=u,this.uint16[L+2]=p,this.uint16[L+3]=f,this.uint16[L+4]=g,this.uint16[L+5]=x,this.uint16[L+6]=w,this.uint16[L+7]=E,this.uint16[L+8]=I,this.uint16[L+9]=z,r},t}(dr);ro.prototype.bytesPerElement=20,Ne("StructArrayLayout10ui20",ro);var Ta=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,a,u,p,f,g,x,w,E,I,z,L){var V=this.length;return this.resize(V+1),this.emplace(V,r,a,u,p,f,g,x,w,E,I,z,L)},t.prototype.emplace=function(r,a,u,p,f,g,x,w,E,I,z,L,V){var N=12*r;return this.int16[N+0]=a,this.int16[N+1]=u,this.int16[N+2]=p,this.int16[N+3]=f,this.uint16[N+4]=g,this.uint16[N+5]=x,this.uint16[N+6]=w,this.uint16[N+7]=E,this.int16[N+8]=I,this.int16[N+9]=z,this.int16[N+10]=L,this.int16[N+11]=V,r},t}(dr);Ta.prototype.bytesPerElement=24,Ne("StructArrayLayout4i4ui4i24",Ta);var ss=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,a,u){var p=this.length;return this.resize(p+1),this.emplace(p,r,a,u)},t.prototype.emplace=function(r,a,u,p){var f=3*r;return this.float32[f+0]=a,this.float32[f+1]=u,this.float32[f+2]=p,r},t}(dr);ss.prototype.bytesPerElement=12,Ne("StructArrayLayout3f12",ss);var nu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var a=this.length;return this.resize(a+1),this.emplace(a,r)},t.prototype.emplace=function(r,a){return this.uint32[1*r+0]=a,r},t}(dr);nu.prototype.bytesPerElement=4,Ne("StructArrayLayout1ul4",nu);var ls=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,a,u,p,f,g,x,w,E){var I=this.length;return this.resize(I+1),this.emplace(I,r,a,u,p,f,g,x,w,E)},t.prototype.emplace=function(r,a,u,p,f,g,x,w,E,I){var z=10*r,L=5*r;return this.int16[z+0]=a,this.int16[z+1]=u,this.int16[z+2]=p,this.int16[z+3]=f,this.int16[z+4]=g,this.int16[z+5]=x,this.uint32[L+3]=w,this.uint16[z+8]=E,this.uint16[z+9]=I,r},t}(dr);ls.prototype.bytesPerElement=20,Ne("StructArrayLayout6i1ul2ui20",ls);var To=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,a,u,p,f,g){var x=this.length;return this.resize(x+1),this.emplace(x,r,a,u,p,f,g)},t.prototype.emplace=function(r,a,u,p,f,g,x){var w=6*r;return this.int16[w+0]=a,this.int16[w+1]=u,this.int16[w+2]=p,this.int16[w+3]=f,this.int16[w+4]=g,this.int16[w+5]=x,r},t}(dr);To.prototype.bytesPerElement=12,Ne("StructArrayLayout2i2i2i12",To);var ou=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,a,u,p,f){var g=this.length;return this.resize(g+1),this.emplace(g,r,a,u,p,f)},t.prototype.emplace=function(r,a,u,p,f,g){var x=4*r,w=8*r;return this.float32[x+0]=a,this.float32[x+1]=u,this.float32[x+2]=p,this.int16[w+6]=f,this.int16[w+7]=g,r},t}(dr);ou.prototype.bytesPerElement=16,Ne("StructArrayLayout2f1f2i16",ou);var au=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,a,u,p){var f=this.length;return this.resize(f+1),this.emplace(f,r,a,u,p)},t.prototype.emplace=function(r,a,u,p,f){var g=12*r,x=3*r;return this.uint8[g+0]=a,this.uint8[g+1]=u,this.float32[x+1]=p,this.float32[x+2]=f,r},t}(dr);au.prototype.bytesPerElement=12,Ne("StructArrayLayout2ub2f12",au);var on=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,a,u){var p=this.length;return this.resize(p+1),this.emplace(p,r,a,u)},t.prototype.emplace=function(r,a,u,p){var f=3*r;return this.uint16[f+0]=a,this.uint16[f+1]=u,this.uint16[f+2]=p,r},t}(dr);on.prototype.bytesPerElement=6,Ne("StructArrayLayout3ui6",on);var tl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,a,u,p,f,g,x,w,E,I,z,L,V,N,Q,W,ne){var ae=this.length;return this.resize(ae+1),this.emplace(ae,r,a,u,p,f,g,x,w,E,I,z,L,V,N,Q,W,ne)},t.prototype.emplace=function(r,a,u,p,f,g,x,w,E,I,z,L,V,N,Q,W,ne,ae){var ue=24*r,ce=12*r,ge=48*r;return this.int16[ue+0]=a,this.int16[ue+1]=u,this.uint16[ue+2]=p,this.uint16[ue+3]=f,this.uint32[ce+2]=g,this.uint32[ce+3]=x,this.uint32[ce+4]=w,this.uint16[ue+10]=E,this.uint16[ue+11]=I,this.uint16[ue+12]=z,this.float32[ce+7]=L,this.float32[ce+8]=V,this.uint8[ge+36]=N,this.uint8[ge+37]=Q,this.uint8[ge+38]=W,this.uint32[ce+10]=ne,this.int16[ue+22]=ae,r},t}(dr);tl.prototype.bytesPerElement=48,Ne("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",tl);var ta=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,a,u,p,f,g,x,w,E,I,z,L,V,N,Q,W,ne,ae,ue,ce,ge,Ae,ke,Ke,Re,Je,Be,bt){var at=this.length;return this.resize(at+1),this.emplace(at,r,a,u,p,f,g,x,w,E,I,z,L,V,N,Q,W,ne,ae,ue,ce,ge,Ae,ke,Ke,Re,Je,Be,bt)},t.prototype.emplace=function(r,a,u,p,f,g,x,w,E,I,z,L,V,N,Q,W,ne,ae,ue,ce,ge,Ae,ke,Ke,Re,Je,Be,bt,at){var We=34*r,It=17*r;return this.int16[We+0]=a,this.int16[We+1]=u,this.int16[We+2]=p,this.int16[We+3]=f,this.int16[We+4]=g,this.int16[We+5]=x,this.int16[We+6]=w,this.int16[We+7]=E,this.uint16[We+8]=I,this.uint16[We+9]=z,this.uint16[We+10]=L,this.uint16[We+11]=V,this.uint16[We+12]=N,this.uint16[We+13]=Q,this.uint16[We+14]=W,this.uint16[We+15]=ne,this.uint16[We+16]=ae,this.uint16[We+17]=ue,this.uint16[We+18]=ce,this.uint16[We+19]=ge,this.uint16[We+20]=Ae,this.uint16[We+21]=ke,this.uint16[We+22]=Ke,this.uint32[It+12]=Re,this.float32[It+13]=Je,this.float32[It+14]=Be,this.float32[It+15]=bt,this.float32[It+16]=at,r},t}(dr);ta.prototype.bytesPerElement=68,Ne("StructArrayLayout8i15ui1ul4f68",ta);var an=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var a=this.length;return this.resize(a+1),this.emplace(a,r)},t.prototype.emplace=function(r,a){return this.float32[1*r+0]=a,r},t}(dr);an.prototype.bytesPerElement=4,Ne("StructArrayLayout1f4",an);var su=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,a,u){var p=this.length;return this.resize(p+1),this.emplace(p,r,a,u)},t.prototype.emplace=function(r,a,u,p){var f=3*r;return this.int16[f+0]=a,this.int16[f+1]=u,this.int16[f+2]=p,r},t}(dr);su.prototype.bytesPerElement=6,Ne("StructArrayLayout3i6",su);var lu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,a,u){var p=this.length;return this.resize(p+1),this.emplace(p,r,a,u)},t.prototype.emplace=function(r,a,u,p){var f=4*r;return this.uint32[2*r+0]=a,this.uint16[f+2]=u,this.uint16[f+3]=p,r},t}(dr);lu.prototype.bytesPerElement=8,Ne("StructArrayLayout1ul2ui8",lu);var us=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,a){var u=this.length;return this.resize(u+1),this.emplace(u,r,a)},t.prototype.emplace=function(r,a,u){var p=2*r;return this.uint16[p+0]=a,this.uint16[p+1]=u,r},t}(dr);us.prototype.bytesPerElement=4,Ne("StructArrayLayout2ui4",us);var rl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var a=this.length;return this.resize(a+1),this.emplace(a,r)},t.prototype.emplace=function(r,a){return this.uint16[1*r+0]=a,r},t}(dr);rl.prototype.bytesPerElement=2,Ne("StructArrayLayout1ui2",rl);var i=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,a,u,p){var f=this.length;return this.resize(f+1),this.emplace(f,r,a,u,p)},t.prototype.emplace=function(r,a,u,p,f){var g=4*r;return this.float32[g+0]=a,this.float32[g+1]=u,this.float32[g+2]=p,this.float32[g+3]=f,r},t}(dr);i.prototype.bytesPerElement=16,Ne("StructArrayLayout4f16",i);var o=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new se(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(eo);o.prototype.size=20;var n=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new o(this,r)},t}(ls);Ne("CollisionBoxArray",n);var s=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(a){this._structArray.uint8[this._pos1+37]=a},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(a){this._structArray.uint8[this._pos1+38]=a},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(a){this._structArray.uint32[this._pos4+10]=a},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(eo);s.prototype.size=48;var h=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new s(this,r)},t}(tl);Ne("PlacedSymbolArray",h);var m=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(a){this._structArray.uint32[this._pos4+12]=a},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(eo);m.prototype.size=68;var y=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new m(this,r)},t}(ta);Ne("SymbolInstanceArray",y);var v=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(r){return this.float32[1*r+0]},t}(an);Ne("GlyphOffsetArray",v);var S=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(r){return this.int16[3*r+0]},t.prototype.gety=function(r){return this.int16[3*r+1]},t.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},t}(su);Ne("SymbolLineVertexArray",S);var A=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(eo);A.prototype.size=8;var D=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new A(this,r)},t}(lu);Ne("FeatureIndexArray",D);var B=li([{name:"a_pos",components:2,type:"Int16"}],4).members,R=function(e){e===void 0&&(e=[]),this.segments=e};function G(e,t){return 256*(e=Nt(Math.floor(e),0,255))+Nt(Math.floor(t),0,255)}R.prototype.prepareSegment=function(e,t,r,a){var u=this.segments[this.segments.length-1];return e>R.MAX_VERTEX_ARRAY_LENGTH&&vt("Max vertices per segment is "+R.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!u||u.vertexLength+e>R.MAX_VERTEX_ARRAY_LENGTH||u.sortKey!==a)&&(u={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},a!==void 0&&(u.sortKey=a),this.segments.push(u)),u},R.prototype.get=function(){return this.segments},R.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var a in r.vaos)r.vaos[a].destroy()}},R.simpleSegment=function(e,t,r,a){return new R([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:a,vaos:{},sortKey:0}])},R.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ne("SegmentVector",R);var q=li([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),$=J(function(e){e.exports=function(t,r){var a,u,p,f,g,x,w,E;for(u=t.length-(a=3&t.length),p=r,g=3432918353,x=461845907,E=0;E<u;)w=255&t.charCodeAt(E)|(255&t.charCodeAt(++E))<<8|(255&t.charCodeAt(++E))<<16|(255&t.charCodeAt(++E))<<24,++E,p=27492+(65535&(f=5*(65535&(p=(p^=w=(65535&(w=(w=(65535&w)*g+(((w>>>16)*g&65535)<<16)&4294967295)<<15|w>>>17))*x+(((w>>>16)*x&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(w=0,a){case 3:w^=(255&t.charCodeAt(E+2))<<16;case 2:w^=(255&t.charCodeAt(E+1))<<8;case 1:p^=w=(65535&(w=(w=(65535&(w^=255&t.charCodeAt(E)))*g+(((w>>>16)*g&65535)<<16)&4294967295)<<15|w>>>17))*x+(((w>>>16)*x&65535)<<16)&4294967295}return p^=t.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0}}),j=J(function(e){e.exports=function(t,r){for(var a,u=t.length,p=r^u,f=0;u>=4;)a=1540483477*(65535&(a=255&t.charCodeAt(f)|(255&t.charCodeAt(++f))<<8|(255&t.charCodeAt(++f))<<16|(255&t.charCodeAt(++f))<<24))+((1540483477*(a>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16)),u-=4,++f;switch(u){case 3:p^=(255&t.charCodeAt(f+2))<<16;case 2:p^=(255&t.charCodeAt(f+1))<<8;case 1:p=1540483477*(65535&(p^=255&t.charCodeAt(f)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0}}),K=$,te=j;K.murmur3=$,K.murmur2=te;var oe=function(){this.ids=[],this.positions=[],this.indexed=!1};oe.prototype.add=function(e,t,r,a){this.ids.push(pe(e)),this.positions.push(t,r,a)},oe.prototype.getPositions=function(e){for(var t=pe(e),r=0,a=this.ids.length-1;r<a;){var u=r+a>>1;this.ids[u]>=t?a=u:r=u+1}for(var p=[];this.ids[r]===t;)p.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return p},oe.serialize=function(e,t){var r=new Float64Array(e.ids),a=new Uint32Array(e.positions);return function u(p,f,g,x){for(;g<x;){for(var w=p[g+x>>1],E=g-1,I=x+1;;){do E++;while(p[E]<w);do I--;while(p[I]>w);if(E>=I)break;me(p,E,I),me(f,3*E,3*I),me(f,3*E+1,3*I+1),me(f,3*E+2,3*I+2)}I-g<x-I?(u(p,f,g,I),g=I+1):(u(p,f,I+1,x),x=I)}}(r,a,0,r.length-1),t&&t.push(r.buffer,a.buffer),{ids:r,positions:a}},oe.deserialize=function(e){var t=new oe;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var de=Math.pow(2,53)-1;function pe(e){var t=+e;return!isNaN(t)&&t<=de?t:K(String(e))}function me(e,t,r){var a=e[t];e[t]=e[r],e[r]=a}Ne("FeaturePositionMap",oe);var _e=function(e,t){this.gl=e.gl,this.location=t},ze=function(e){function t(r,a){e.call(this,r,a),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},t}(_e),Se=function(e){function t(r,a){e.call(this,r,a),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},t}(_e),Ue=function(e){function t(r,a){e.call(this,r,a),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},t}(_e),Qe=function(e){function t(r,a){e.call(this,r,a),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},t}(_e),rt=function(e){function t(r,a){e.call(this,r,a),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},t}(_e),et=function(e){function t(r,a){e.call(this,r,a),this.current=kt.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},t}(_e),Ft=new Float32Array(16),Ze=function(e){function t(r,a){e.call(this,r,a),this.current=Ft}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var a=1;a<16;a++)if(r[a]!==this.current[a]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},t}(_e);function dt(e){return[G(255*e.r,255*e.g),G(255*e.b,255*e.a)]}var St=function(e,t,r){this.value=e,this.uniformNames=t.map(function(a){return"u_"+a}),this.type=r};St.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},St.prototype.getBinding=function(e,t,r){return this.type==="color"?new et(e,t):new Se(e,t)};var mt=function(e,t){this.uniformNames=t.map(function(r){return"u_"+r}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};mt.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},mt.prototype.setUniform=function(e,t,r,a){var u=a==="u_pattern_to"?this.patternTo:a==="u_pattern_from"?this.patternFrom:a==="u_pixel_ratio_to"?this.pixelRatioTo:a==="u_pixel_ratio_from"?this.pixelRatioFrom:null;u&&e.set(u)},mt.prototype.getBinding=function(e,t,r){return r.substr(0,9)==="u_pattern"?new rt(e,t):new Se(e,t)};var pt=function(e,t,r,a){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map(function(u){return{name:"a_"+u,type:"Float32",components:r==="color"?2:1,offset:0}}),this.paintVertexArray=new a};pt.prototype.populatePaintArray=function(e,t,r,a,u){var p=this.paintVertexArray.length,f=this.expression.evaluate(new Xt(0),t,{},a,[],u);this.paintVertexArray.resize(e),this._setPaintValue(p,e,f)},pt.prototype.updatePaintArray=function(e,t,r,a){var u=this.expression.evaluate({zoom:0},r,a);this._setPaintValue(e,t,u)},pt.prototype._setPaintValue=function(e,t,r){if(this.type==="color")for(var a=dt(r),u=e;u<t;u++)this.paintVertexArray.emplace(u,a[0],a[1]);else{for(var p=e;p<t;p++)this.paintVertexArray.emplace(p,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},pt.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},pt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var ct=function(e,t,r,a,u,p){this.expression=e,this.uniformNames=t.map(function(f){return"u_"+f+"_t"}),this.type=r,this.useIntegerZoom=a,this.zoom=u,this.maxValue=0,this.paintVertexAttributes=t.map(function(f){return{name:"a_"+f,type:"Float32",components:r==="color"?4:2,offset:0}}),this.paintVertexArray=new p};ct.prototype.populatePaintArray=function(e,t,r,a,u){var p=this.expression.evaluate(new Xt(this.zoom),t,{},a,[],u),f=this.expression.evaluate(new Xt(this.zoom+1),t,{},a,[],u),g=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(g,e,p,f)},ct.prototype.updatePaintArray=function(e,t,r,a){var u=this.expression.evaluate({zoom:this.zoom},r,a),p=this.expression.evaluate({zoom:this.zoom+1},r,a);this._setPaintValue(e,t,u,p)},ct.prototype._setPaintValue=function(e,t,r,a){if(this.type==="color")for(var u=dt(r),p=dt(a),f=e;f<t;f++)this.paintVertexArray.emplace(f,u[0],u[1],p[0],p[1]);else{for(var g=e;g<t;g++)this.paintVertexArray.emplace(g,r,a);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(a))}},ct.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ct.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},ct.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,a=Nt(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(a)},ct.prototype.getBinding=function(e,t,r){return new Se(e,t)};var lt=function(e,t,r,a,u,p){this.expression=e,this.type=t,this.useIntegerZoom=r,this.zoom=a,this.layerId=p,this.zoomInPaintVertexArray=new u,this.zoomOutPaintVertexArray=new u};lt.prototype.populatePaintArray=function(e,t,r){var a=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(a,e,t.patterns&&t.patterns[this.layerId],r)},lt.prototype.updatePaintArray=function(e,t,r,a,u){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],u)},lt.prototype._setPaintValues=function(e,t,r,a){if(a&&r){var u=a[r.min],p=a[r.mid],f=a[r.max];if(u&&p&&f)for(var g=e;g<t;g++)this.zoomInPaintVertexArray.emplace(g,p.tl[0],p.tl[1],p.br[0],p.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],p.pixelRatio,u.pixelRatio),this.zoomOutPaintVertexArray.emplace(g,p.tl[0],p.tl[1],p.br[0],p.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],p.pixelRatio,f.pixelRatio)}},lt.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,q.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,q.members,this.expression.isStateDependent))},lt.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var nt=function(e,t,r){this.binders={},this._buffers=[];var a=[];for(var u in e.paint._values)if(r(u)){var p=e.paint.get(u);if(p instanceof nn&&va(p.property.specification)){var f=Dr(u,e.type),g=p.value,x=p.property.specification.type,w=p.property.useIntegerZoom,E=p.property.specification["property-type"],I=E==="cross-faded"||E==="cross-faded-data-driven";if(g.kind==="constant")this.binders[u]=I?new mt(g.value,f):new St(g.value,f,x),a.push("/u_"+u);else if(g.kind==="source"||I){var z=Ei(u,x,"source");this.binders[u]=I?new lt(g,x,w,t,z,e.id):new pt(g,f,x,z),a.push("/a_"+u)}else{var L=Ei(u,x,"composite");this.binders[u]=new ct(g,f,x,w,t,L),a.push("/z_"+u)}}}this.cacheKey=a.sort().join("")};nt.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof pt||t instanceof ct?t.maxValue:0},nt.prototype.populatePaintArrays=function(e,t,r,a,u){for(var p in this.binders){var f=this.binders[p];(f instanceof pt||f instanceof ct||f instanceof lt)&&f.populatePaintArray(e,t,r,a,u)}},nt.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var a=this.binders[r];a instanceof mt&&a.setConstantPatternPositions(e,t)}},nt.prototype.updatePaintArrays=function(e,t,r,a,u){var p=!1;for(var f in e)for(var g=0,x=t.getPositions(f);g<x.length;g+=1){var w=x[g],E=r.feature(w.index);for(var I in this.binders){var z=this.binders[I];if((z instanceof pt||z instanceof ct||z instanceof lt)&&z.expression.isStateDependent===!0){var L=a.paint.get(I);z.expression=L.value,z.updatePaintArray(w.start,w.end,E,e[f],u),p=!0}}}return p},nt.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof St||r instanceof mt)&&e.push.apply(e,r.uniformNames.map(function(a){return"#define HAS_UNIFORM_"+a}))}return e},nt.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof pt||r instanceof ct)for(var a=0;a<r.paintVertexAttributes.length;a++)e.push(r.paintVertexAttributes[a].name);else if(r instanceof lt)for(var u=0;u<q.members.length;u++)e.push(q.members[u].name)}return e},nt.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof St||r instanceof mt||r instanceof ct)for(var a=0,u=r.uniformNames;a<u.length;a+=1)e.push(u[a])}return e},nt.prototype.getPaintVertexBuffers=function(){return this._buffers},nt.prototype.getUniforms=function(e,t){var r=[];for(var a in this.binders){var u=this.binders[a];if(u instanceof St||u instanceof mt||u instanceof ct)for(var p=0,f=u.uniformNames;p<f.length;p+=1){var g=f[p];if(t[g]){var x=u.getBinding(e,t[g],g);r.push({name:g,property:a,binding:x})}}}return r},nt.prototype.setUniforms=function(e,t,r,a){for(var u=0,p=t;u<p.length;u+=1){var f=p[u],g=f.name,x=f.property;this.binders[x].setUniform(f.binding,a,r.get(x),g)}},nt.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof lt){var a=e.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;a&&this._buffers.push(a)}else(r instanceof pt||r instanceof ct)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},nt.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof pt||r instanceof ct||r instanceof lt)&&r.upload(e)}this.updatePaintBuffers()},nt.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof pt||t instanceof ct||t instanceof lt)&&t.destroy()}};var rr=function(e,t,r){r===void 0&&(r=function(){return!0}),this.programConfigurations={};for(var a=0,u=e;a<u.length;a+=1){var p=u[a];this.programConfigurations[p.id]=new nt(p,t,r)}this.needsUpload=!1,this._featureMap=new oe,this._bufferOffset=0};function Dr(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function Ei(e,t,r){var a={color:{source:ea,composite:i},number:{source:an,composite:ea}},u=function(p){return{"line-pattern":{source:ro,composite:ro},"fill-pattern":{source:ro,composite:ro},"fill-extrusion-pattern":{source:ro,composite:ro}}[p]}(e);return u&&u[r]||a[t][r]}rr.prototype.populatePaintArrays=function(e,t,r,a,u,p){for(var f in this.programConfigurations)this.programConfigurations[f].populatePaintArrays(e,t,a,u,p);t.id!==void 0&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},rr.prototype.updatePaintArrays=function(e,t,r,a){for(var u=0,p=r;u<p.length;u+=1){var f=p[u];this.needsUpload=this.programConfigurations[f.id].updatePaintArrays(e,this._featureMap,t,f,a)||this.needsUpload}},rr.prototype.get=function(e){return this.programConfigurations[e]},rr.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},rr.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},Ne("ConstantBinder",St),Ne("CrossFadedConstantBinder",mt),Ne("SourceExpressionBinder",pt),Ne("CrossFadedCompositeBinder",lt),Ne("CompositeExpressionBinder",ct),Ne("ProgramConfiguration",nt,{omit:["_buffers"]}),Ne("ProgramConfigurationSet",rr);var Qr=Math.pow(2,14)-1,ei=-Qr-1;function Rr(e){for(var t=8192/e.extent,r=e.loadGeometry(),a=0;a<r.length;a++)for(var u=r[a],p=0;p<u.length;p++){var f=u[p],g=Math.round(f.x*t),x=Math.round(f.y*t);f.x=Nt(g,ei,Qr),f.y=Nt(x,ei,Qr),(g<f.x||g>f.x+1||x<f.y||x>f.y+1)&&vt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function vi(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?Rr(e):[]}}function Vn(e,t,r,a,u){e.emplaceBack(2*t+(a+1)/2,2*r+(u+1)/2)}var Ti=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new as,this.indexArray=new on,this.segments=new R,this.programConfigurations=new rr(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function Ii(e,t){for(var r=0;r<e.length;r++)if(jn(t,e[r]))return!0;for(var a=0;a<t.length;a++)if(jn(e,t[a]))return!0;return!!Io(e,t)}function Nn(e,t,r){return!!jn(e,t)||!!ra(t,e,r)}function sn(e,t){if(e.length===1)return Ca(t,e[0]);for(var r=0;r<t.length;r++)for(var a=t[r],u=0;u<a.length;u++)if(jn(e,a[u]))return!0;for(var p=0;p<e.length;p++)if(Ca(t,e[p]))return!0;for(var f=0;f<t.length;f++)if(Io(e,t[f]))return!0;return!1}function uu(e,t,r){if(e.length>1){if(Io(e,t))return!0;for(var a=0;a<t.length;a++)if(ra(t[a],e,r))return!0}for(var u=0;u<e.length;u++)if(ra(e[u],t,r))return!0;return!1}function Io(e,t){if(e.length===0||t.length===0)return!1;for(var r=0;r<e.length-1;r++)for(var a=e[r],u=e[r+1],p=0;p<t.length-1;p++)if(Ia(a,u,t[p],t[p+1]))return!0;return!1}function Ia(e,t,r,a){return er(e,r,a)!==er(t,r,a)&&er(e,t,r)!==er(e,t,a)}function ra(e,t,r){var a=r*r;if(t.length===1)return e.distSqr(t[0])<a;for(var u=1;u<t.length;u++)if(cs(e,t[u-1],t[u])<a)return!0;return!1}function cs(e,t,r){var a=t.distSqr(r);if(a===0)return e.distSqr(t);var u=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/a;return e.distSqr(u<0?t:u>1?r:r.sub(t)._mult(u)._add(t))}function Ca(e,t){for(var r,a,u,p=!1,f=0;f<e.length;f++)for(var g=0,x=(r=e[f]).length-1;g<r.length;x=g++)(a=r[g]).y>t.y!=(u=r[x]).y>t.y&&t.x<(u.x-a.x)*(t.y-a.y)/(u.y-a.y)+a.x&&(p=!p);return p}function jn(e,t){for(var r=!1,a=0,u=e.length-1;a<e.length;u=a++){var p=e[a],f=e[u];p.y>t.y!=f.y>t.y&&t.x<(f.x-p.x)*(t.y-p.y)/(f.y-p.y)+p.x&&(r=!r)}return r}function Aa(e,t,r){var a=r[0],u=r[2];if(e.x<a.x&&t.x<a.x||e.x>u.x&&t.x>u.x||e.y<a.y&&t.y<a.y||e.y>u.y&&t.y>u.y)return!1;var p=er(e,t,r[0]);return p!==er(e,t,r[1])||p!==er(e,t,r[2])||p!==er(e,t,r[3])}function Xr(e,t,r){var a=t.paint.get(e).value;return a.kind==="constant"?a.value:r.programConfigurations.get(t.id).getMaxValue(e)}function io(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function An(e,t,r,a,u){if(!t[0]&&!t[1])return e;var p=se.convert(t)._mult(u);r==="viewport"&&p._rotate(-a);for(var f=[],g=0;g<e.length;g++)f.push(e[g].sub(p));return f}Ti.prototype.populate=function(e,t,r){var a=this.layers[0],u=[],p=null,f=!1;a.type==="circle"&&(f=!(p=a.layout.get("circle-sort-key")).isConstant());for(var g=0,x=e;g<x.length;g+=1){var w=x[g],E=w.feature,I=w.id,z=w.index,L=w.sourceLayerIndex,V=this.layers[0]._featureFilter.needGeometry,N=vi(E,V);if(this.layers[0]._featureFilter.filter(new Xt(this.zoom),N,r)){var Q=f?p.evaluate(N,{},r):void 0,W={id:I,properties:E.properties,type:E.type,sourceLayerIndex:L,index:z,geometry:V?N.geometry:Rr(E),patterns:{},sortKey:Q};u.push(W)}}f&&u.sort(function(Ke,Re){return Ke.sortKey-Re.sortKey});for(var ne=0,ae=u;ne<ae.length;ne+=1){var ue=ae[ne],ce=ue.geometry,ge=ue.index,Ae=ue.sourceLayerIndex,ke=e[ge].feature;this.addFeature(ue,ce,ge,r),t.featureIndex.insert(ke,ce,ge,Ae,this.index)}},Ti.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Ti.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ti.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ti.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,B),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ti.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ti.prototype.addFeature=function(e,t,r,a){for(var u=0,p=t;u<p.length;u+=1)for(var f=0,g=p[u];f<g.length;f+=1){var x=g[f],w=x.x,E=x.y;if(!(w<0||w>=8192||E<0||E>=8192)){var I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),z=I.vertexLength;Vn(this.layoutVertexArray,w,E,-1,-1),Vn(this.layoutVertexArray,w,E,1,-1),Vn(this.layoutVertexArray,w,E,1,1),Vn(this.layoutVertexArray,w,E,-1,1),this.indexArray.emplaceBack(z,z+1,z+2),this.indexArray.emplaceBack(z,z+3,z+2),I.vertexLength+=4,I.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},a)},Ne("CircleBucket",Ti,{omit:["layers"]});var ia=new Ki({"circle-sort-key":new st(F.layout_circle["circle-sort-key"])}),Br={paint:new Ki({"circle-radius":new st(F.paint_circle["circle-radius"]),"circle-color":new st(F.paint_circle["circle-color"]),"circle-blur":new st(F.paint_circle["circle-blur"]),"circle-opacity":new st(F.paint_circle["circle-opacity"]),"circle-translate":new Fe(F.paint_circle["circle-translate"]),"circle-translate-anchor":new Fe(F.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Fe(F.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Fe(F.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new st(F.paint_circle["circle-stroke-width"]),"circle-stroke-color":new st(F.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new st(F.paint_circle["circle-stroke-opacity"])}),layout:ia},Mr=typeof Float32Array<"u"?Float32Array:Array;function Ci(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ps(e,t,r){var a=t[0],u=t[1],p=t[2],f=t[3],g=t[4],x=t[5],w=t[6],E=t[7],I=t[8],z=t[9],L=t[10],V=t[11],N=t[12],Q=t[13],W=t[14],ne=t[15],ae=r[0],ue=r[1],ce=r[2],ge=r[3];return e[0]=ae*a+ue*g+ce*I+ge*N,e[1]=ae*u+ue*x+ce*z+ge*Q,e[2]=ae*p+ue*w+ce*L+ge*W,e[3]=ae*f+ue*E+ce*V+ge*ne,e[4]=(ae=r[4])*a+(ue=r[5])*g+(ce=r[6])*I+(ge=r[7])*N,e[5]=ae*u+ue*x+ce*z+ge*Q,e[6]=ae*p+ue*w+ce*L+ge*W,e[7]=ae*f+ue*E+ce*V+ge*ne,e[8]=(ae=r[8])*a+(ue=r[9])*g+(ce=r[10])*I+(ge=r[11])*N,e[9]=ae*u+ue*x+ce*z+ge*Q,e[10]=ae*p+ue*w+ce*L+ge*W,e[11]=ae*f+ue*E+ce*V+ge*ne,e[12]=(ae=r[12])*a+(ue=r[13])*g+(ce=r[14])*I+(ge=r[15])*N,e[13]=ae*u+ue*x+ce*z+ge*Q,e[14]=ae*p+ue*w+ce*L+ge*W,e[15]=ae*f+ue*E+ce*V+ge*ne,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var il,Gp=ps;function nl(e,t,r){var a=t[0],u=t[1],p=t[2],f=t[3];return e[0]=r[0]*a+r[4]*u+r[8]*p+r[12]*f,e[1]=r[1]*a+r[5]*u+r[9]*p+r[13]*f,e[2]=r[2]*a+r[6]*u+r[10]*p+r[14]*f,e[3]=r[3]*a+r[7]*u+r[11]*p+r[15]*f,e}il=new Mr(3),Mr!=Float32Array&&(il[0]=0,il[1]=0,il[2]=0),function(){var e=new Mr(4);Mr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var ol=(function(){var e=new Mr(2);Mr!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(r){e.call(this,r,Br)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Ti(r)},t.prototype.queryRadius=function(r){var a=r;return Xr("circle-radius",this,a)+Xr("circle-stroke-width",this,a)+io(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(r,a,u,p,f,g,x,w){for(var E=An(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,x),I=this.paint.get("circle-radius").evaluate(a,u)+this.paint.get("circle-stroke-width").evaluate(a,u),z=this.paint.get("circle-pitch-alignment")==="map",L=z?E:function(Ae,ke){return Ae.map(function(Ke){return xc(Ke,ke)})}(E,w),V=z?I*x:I,N=0,Q=p;N<Q.length;N+=1)for(var W=0,ne=Q[N];W<ne.length;W+=1){var ae=ne[W],ue=z?ae:xc(ae,w),ce=V,ge=nl([],[ae.x,ae.y,0,1],w);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ce*=ge[3]/g.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ce*=g.cameraToCenterDistance/ge[3]),Nn(L,ue,ce))return!0}return!1},t}(gn));function xc(e,t){var r=nl([],[e.x,e.y,0,1],t);return new se(r[0]/r[3],r[1]/r[3])}var hs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ti);function fs(e,t,r,a){var u=t.width,p=t.height;if(a){if(a instanceof Uint8ClampedArray)a=new Uint8Array(a.buffer);else if(a.length!==u*p*r)throw new RangeError("mismatched image size")}else a=new Uint8Array(u*p*r);return e.width=u,e.height=p,e.data=a,e}function xf(e,t,r){var a=t.width,u=t.height;if(a!==e.width||u!==e.height){var p=fs({},{width:a,height:u},r);Hp(e,p,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,a),height:Math.min(e.height,u)},r),e.width=a,e.height=u,e.data=p.data}}function Hp(e,t,r,a,u,p){if(u.width===0||u.height===0)return t;if(u.width>e.width||u.height>e.height||r.x>e.width-u.width||r.y>e.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>t.width||u.height>t.height||a.x>t.width-u.width||a.y>t.height-u.height)throw new RangeError("out of range destination coordinates for image copy");for(var f=e.data,g=t.data,x=0;x<u.height;x++)for(var w=((r.y+x)*e.width+r.x)*p,E=((a.y+x)*t.width+a.x)*p,I=0;I<u.width*p;I++)g[E+I]=f[w+I];return t}Ne("HeatmapBucket",hs,{omit:["layers"]});var ds=function(e,t){fs(this,e,1,t)};ds.prototype.resize=function(e){xf(this,e,1)},ds.prototype.clone=function(){return new ds({width:this.width,height:this.height},new Uint8Array(this.data))},ds.copy=function(e,t,r,a,u){Hp(e,t,r,a,u,1)};var Ji=function(e,t){fs(this,e,4,t)};Ji.prototype.resize=function(e){xf(this,e,4)},Ji.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Ji.prototype.clone=function(){return new Ji({width:this.width,height:this.height},new Uint8Array(this.data))},Ji.copy=function(e,t,r,a,u){Hp(e,t,r,a,u,4)},Ne("AlphaImage",ds),Ne("RGBAImage",Ji);var Zy={paint:new Ki({"heatmap-radius":new st(F.paint_heatmap["heatmap-radius"]),"heatmap-weight":new st(F.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Fe(F.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Qn(F.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Fe(F.paint_heatmap["heatmap-opacity"])})};function bf(e){var t={},r=e.resolution||256,a=e.clips?e.clips.length:1,u=e.image||new Ji({width:r,height:a}),p=function(V,N,Q){t[e.evaluationKey]=Q;var W=e.expression.evaluate(t);u.data[V+N+0]=Math.floor(255*W.r/W.a),u.data[V+N+1]=Math.floor(255*W.g/W.a),u.data[V+N+2]=Math.floor(255*W.b/W.a),u.data[V+N+3]=Math.floor(255*W.a)};if(e.clips)for(var f=0,g=0;f<a;++f,g+=4*r)for(var x=0,w=0;x<r;x++,w+=4){var E=x/(r-1),I=e.clips[f];p(g,w,I.start*(1-E)+I.end*E)}else for(var z=0,L=0;z<r;z++,L+=4)p(0,L,z/(r-1));return u}var Gy=function(e){function t(r){e.call(this,r,Zy),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new hs(r)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=bf({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(gn),Hy={paint:new Ki({"hillshade-illumination-direction":new Fe(F.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Fe(F.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Fe(F.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Fe(F.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Fe(F.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Fe(F.paint_hillshade["hillshade-accent-color"])})},Xy=function(e){function t(r){e.call(this,r,Hy)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(gn),Wy=li([{name:"a_pos",components:2,type:"Int16"}],4).members,Xp=bc,Ky=bc;function bc(e,t,r){r=r||2;var a,u,p,f,g,x,w,E=t&&t.length,I=E?t[0]*r:e.length,z=wf(e,0,I,r,!0),L=[];if(!z||z.next===z.prev)return L;if(E&&(z=function(N,Q,W,ne){var ae,ue,ce,ge=[];for(ae=0,ue=Q.length;ae<ue;ae++)(ce=wf(N,Q[ae]*ne,ae<ue-1?Q[ae+1]*ne:N.length,ne,!1))===ce.next&&(ce.steiner=!0),ge.push(ig(ce));for(ge.sort(eg),ae=0;ae<ge.length;ae++)tg(ge[ae],W),W=Pa(W,W.next);return W}(e,t,z,r)),e.length>80*r){a=p=e[0],u=f=e[1];for(var V=r;V<I;V+=r)(g=e[V])<a&&(a=g),(x=e[V+1])<u&&(u=x),g>p&&(p=g),x>f&&(f=x);w=(w=Math.max(p-a,f-u))!==0?1/w:0}return cu(z,L,r,a,u,w),L}function wf(e,t,r,a,u){var p,f;if(u===$p(e,t,r,a)>0)for(p=t;p<r;p+=a)f=Tf(p,e[p],e[p+1],f);else for(p=r-a;p>=t;p-=a)f=Tf(p,e[p],e[p+1],f);return f&&wc(f,f.next)&&(hu(f),f=f.next),f}function Pa(e,t){if(!e)return e;t||(t=e);var r,a=e;do if(r=!1,a.steiner||!wc(a,a.next)&&Wr(a.prev,a,a.next)!==0)a=a.next;else{if(hu(a),(a=t=a.prev)===a.next)break;r=!0}while(r||a!==t);return t}function cu(e,t,r,a,u,p,f){if(e){!f&&p&&function(E,I,z,L){var V=E;do V.z===null&&(V.z=Wp(V.x,V.y,I,z,L)),V.prevZ=V.prev,V.nextZ=V.next,V=V.next;while(V!==E);V.prevZ.nextZ=null,V.prevZ=null,function(N){var Q,W,ne,ae,ue,ce,ge,Ae,ke=1;do{for(W=N,N=null,ue=null,ce=0;W;){for(ce++,ne=W,ge=0,Q=0;Q<ke&&(ge++,ne=ne.nextZ);Q++);for(Ae=ke;ge>0||Ae>0&&ne;)ge!==0&&(Ae===0||!ne||W.z<=ne.z)?(ae=W,W=W.nextZ,ge--):(ae=ne,ne=ne.nextZ,Ae--),ue?ue.nextZ=ae:N=ae,ae.prevZ=ue,ue=ae;W=ne}ue.nextZ=null,ke*=2}while(ce>1)}(V)}(e,a,u,p);for(var g,x,w=e;e.prev!==e.next;)if(g=e.prev,x=e.next,p?Jy(e,a,u,p):$y(e))t.push(g.i/r),t.push(e.i/r),t.push(x.i/r),hu(e),e=x.next,w=x.next;else if((e=x)===w){f?f===1?cu(e=Yy(Pa(e),t,r),t,r,a,u,p,2):f===2&&Qy(e,t,r,a,u,p):cu(Pa(e),t,r,a,u,p,1);break}}}function $y(e){var t=e.prev,r=e,a=e.next;if(Wr(t,r,a)>=0)return!1;for(var u=e.next.next;u!==e.prev;){if(al(t.x,t.y,r.x,r.y,a.x,a.y,u.x,u.y)&&Wr(u.prev,u,u.next)>=0)return!1;u=u.next}return!0}function Jy(e,t,r,a){var u=e.prev,p=e,f=e.next;if(Wr(u,p,f)>=0)return!1;for(var g=u.x>p.x?u.x>f.x?u.x:f.x:p.x>f.x?p.x:f.x,x=u.y>p.y?u.y>f.y?u.y:f.y:p.y>f.y?p.y:f.y,w=Wp(u.x<p.x?u.x<f.x?u.x:f.x:p.x<f.x?p.x:f.x,u.y<p.y?u.y<f.y?u.y:f.y:p.y<f.y?p.y:f.y,t,r,a),E=Wp(g,x,t,r,a),I=e.prevZ,z=e.nextZ;I&&I.z>=w&&z&&z.z<=E;){if(I!==e.prev&&I!==e.next&&al(u.x,u.y,p.x,p.y,f.x,f.y,I.x,I.y)&&Wr(I.prev,I,I.next)>=0||(I=I.prevZ,z!==e.prev&&z!==e.next&&al(u.x,u.y,p.x,p.y,f.x,f.y,z.x,z.y)&&Wr(z.prev,z,z.next)>=0))return!1;z=z.nextZ}for(;I&&I.z>=w;){if(I!==e.prev&&I!==e.next&&al(u.x,u.y,p.x,p.y,f.x,f.y,I.x,I.y)&&Wr(I.prev,I,I.next)>=0)return!1;I=I.prevZ}for(;z&&z.z<=E;){if(z!==e.prev&&z!==e.next&&al(u.x,u.y,p.x,p.y,f.x,f.y,z.x,z.y)&&Wr(z.prev,z,z.next)>=0)return!1;z=z.nextZ}return!0}function Yy(e,t,r){var a=e;do{var u=a.prev,p=a.next.next;!wc(u,p)&&Sf(u,a,a.next,p)&&pu(u,p)&&pu(p,u)&&(t.push(u.i/r),t.push(a.i/r),t.push(p.i/r),hu(a),hu(a.next),a=e=p),a=a.next}while(a!==e);return Pa(a)}function Qy(e,t,r,a,u,p){var f=e;do{for(var g=f.next.next;g!==f.prev;){if(f.i!==g.i&&ng(f,g)){var x=Ef(f,g);return f=Pa(f,f.next),x=Pa(x,x.next),cu(f,t,r,a,u,p),void cu(x,t,r,a,u,p)}g=g.next}f=f.next}while(f!==e)}function eg(e,t){return e.x-t.x}function tg(e,t){if(t=function(a,u){var p,f=u,g=a.x,x=a.y,w=-1/0;do{if(x<=f.y&&x>=f.next.y&&f.next.y!==f.y){var E=f.x+(x-f.y)*(f.next.x-f.x)/(f.next.y-f.y);if(E<=g&&E>w){if(w=E,E===g){if(x===f.y)return f;if(x===f.next.y)return f.next}p=f.x<f.next.x?f:f.next}}f=f.next}while(f!==u);if(!p)return null;if(g===w)return p;var I,z=p,L=p.x,V=p.y,N=1/0;f=p;do g>=f.x&&f.x>=L&&g!==f.x&&al(x<V?g:w,x,L,V,x<V?w:g,x,f.x,f.y)&&(I=Math.abs(x-f.y)/(g-f.x),pu(f,a)&&(I<N||I===N&&(f.x>p.x||f.x===p.x&&rg(p,f)))&&(p=f,N=I)),f=f.next;while(f!==z);return p}(e,t)){var r=Ef(t,e);Pa(t,t.next),Pa(r,r.next)}}function rg(e,t){return Wr(e.prev,e,t.prev)<0&&Wr(t.next,e,e.next)<0}function Wp(e,t,r,a,u){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*u)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-a)*u)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function ig(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function al(e,t,r,a,u,p,f,g){return(u-f)*(t-g)-(e-f)*(p-g)>=0&&(e-f)*(a-g)-(r-f)*(t-g)>=0&&(r-f)*(p-g)-(u-f)*(a-g)>=0}function ng(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(r,a){var u=r;do{if(u.i!==r.i&&u.next.i!==r.i&&u.i!==a.i&&u.next.i!==a.i&&Sf(u,u.next,r,a))return!0;u=u.next}while(u!==r);return!1}(e,t)&&(pu(e,t)&&pu(t,e)&&function(r,a){var u=r,p=!1,f=(r.x+a.x)/2,g=(r.y+a.y)/2;do u.y>g!=u.next.y>g&&u.next.y!==u.y&&f<(u.next.x-u.x)*(g-u.y)/(u.next.y-u.y)+u.x&&(p=!p),u=u.next;while(u!==r);return p}(e,t)&&(Wr(e.prev,e,t.prev)||Wr(e,t.prev,t))||wc(e,t)&&Wr(e.prev,e,e.next)>0&&Wr(t.prev,t,t.next)>0)}function Wr(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function wc(e,t){return e.x===t.x&&e.y===t.y}function Sf(e,t,r,a){var u=Ec(Wr(e,t,r)),p=Ec(Wr(e,t,a)),f=Ec(Wr(r,a,e)),g=Ec(Wr(r,a,t));return u!==p&&f!==g||!(u!==0||!Sc(e,r,t))||!(p!==0||!Sc(e,a,t))||!(f!==0||!Sc(r,e,a))||!(g!==0||!Sc(r,t,a))}function Sc(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Ec(e){return e>0?1:e<0?-1:0}function pu(e,t){return Wr(e.prev,e,e.next)<0?Wr(e,t,e.next)>=0&&Wr(e,e.prev,t)>=0:Wr(e,t,e.prev)<0||Wr(e,e.next,t)<0}function Ef(e,t){var r=new Kp(e.i,e.x,e.y),a=new Kp(t.i,t.x,t.y),u=e.next,p=t.prev;return e.next=t,t.prev=e,r.next=u,u.prev=r,a.next=r,r.prev=a,p.next=a,a.prev=p,a}function Tf(e,t,r,a){var u=new Kp(e,t,r);return a?(u.next=a.next,u.prev=a,a.next.prev=u,a.next=u):(u.prev=u,u.next=u),u}function hu(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Kp(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function $p(e,t,r,a){for(var u=0,p=t,f=r-a;p<r;p+=a)u+=(e[f]-e[p])*(e[p+1]+e[f+1]),f=p;return u}function og(e,t,r,a,u){(function p(f,g,x,w,E){for(;w>x;){if(w-x>600){var I=w-x+1,z=g-x+1,L=Math.log(I),V=.5*Math.exp(2*L/3),N=.5*Math.sqrt(L*V*(I-V)/I)*(z-I/2<0?-1:1);p(f,g,Math.max(x,Math.floor(g-z*V/I+N)),Math.min(w,Math.floor(g+(I-z)*V/I+N)),E)}var Q=f[g],W=x,ne=w;for(fu(f,x,g),E(f[w],Q)>0&&fu(f,x,w);W<ne;){for(fu(f,W,ne),W++,ne--;E(f[W],Q)<0;)W++;for(;E(f[ne],Q)>0;)ne--}E(f[x],Q)===0?fu(f,x,ne):fu(f,++ne,w),ne<=g&&(x=ne+1),g<=ne&&(w=ne-1)}})(e,t,r||0,a||e.length-1,u||ag)}function fu(e,t,r){var a=e[t];e[t]=e[r],e[r]=a}function ag(e,t){return e<t?-1:e>t?1:0}function Jp(e,t){var r=e.length;if(r<=1)return[e];for(var a,u,p=[],f=0;f<r;f++){var g=cn(e[f]);g!==0&&(e[f].area=Math.abs(g),u===void 0&&(u=g<0),u===g<0?(a&&p.push(a),a=[e[f]]):a.push(e[f]))}if(a&&p.push(a),t>1)for(var x=0;x<p.length;x++)p[x].length<=t||(og(p[x],t,1,p[x].length-1,sg),p[x]=p[x].slice(0,t));return p}function sg(e,t){return t.area-e.area}function Yp(e,t,r){for(var a=r.patternDependencies,u=!1,p=0,f=t;p<f.length;p+=1){var g=f[p].paint.get(e+"-pattern");g.isConstant()||(u=!0);var x=g.constantOr(null);x&&(u=!0,a[x.to]=!0,a[x.from]=!0)}return u}function Qp(e,t,r,a,u){for(var p=u.patternDependencies,f=0,g=t;f<g.length;f+=1){var x=g[f],w=x.paint.get(e+"-pattern").value;if(w.kind!=="constant"){var E=w.evaluate({zoom:a-1},r,{},u.availableImages),I=w.evaluate({zoom:a},r,{},u.availableImages),z=w.evaluate({zoom:a+1},r,{},u.availableImages);I=I&&I.name?I.name:I,z=z&&z.name?z.name:z,p[E=E&&E.name?E.name:E]=!0,p[I]=!0,p[z]=!0,r.patterns[x.id]={min:E,mid:I,max:z}}}return r}bc.deviation=function(e,t,r,a){var u=t&&t.length,p=Math.abs($p(e,0,u?t[0]*r:e.length,r));if(u)for(var f=0,g=t.length;f<g;f++)p-=Math.abs($p(e,t[f]*r,f<g-1?t[f+1]*r:e.length,r));var x=0;for(f=0;f<a.length;f+=3){var w=a[f]*r,E=a[f+1]*r,I=a[f+2]*r;x+=Math.abs((e[w]-e[I])*(e[E+1]-e[w+1])-(e[w]-e[E])*(e[I+1]-e[w+1]))}return p===0&&x===0?0:Math.abs((x-p)/p)},bc.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},a=0,u=0;u<e.length;u++){for(var p=0;p<e[u].length;p++)for(var f=0;f<t;f++)r.vertices.push(e[u][p][f]);u>0&&r.holes.push(a+=e[u-1].length)}return r},Xp.default=Ky;var no=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new as,this.indexArray=new on,this.indexArray2=new us,this.programConfigurations=new rr(e.layers,e.zoom),this.segments=new R,this.segments2=new R,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};no.prototype.populate=function(e,t,r){this.hasPattern=Yp("fill",this.layers,t);for(var a=this.layers[0].layout.get("fill-sort-key"),u=!a.isConstant(),p=[],f=0,g=e;f<g.length;f+=1){var x=g[f],w=x.feature,E=x.id,I=x.index,z=x.sourceLayerIndex,L=this.layers[0]._featureFilter.needGeometry,V=vi(w,L);if(this.layers[0]._featureFilter.filter(new Xt(this.zoom),V,r)){var N=u?a.evaluate(V,{},r,t.availableImages):void 0,Q={id:E,properties:w.properties,type:w.type,sourceLayerIndex:z,index:I,geometry:L?V.geometry:Rr(w),patterns:{},sortKey:N};p.push(Q)}}u&&p.sort(function(ke,Ke){return ke.sortKey-Ke.sortKey});for(var W=0,ne=p;W<ne.length;W+=1){var ae=ne[W],ue=ae.geometry,ce=ae.index,ge=ae.sourceLayerIndex;if(this.hasPattern){var Ae=Qp("fill",this.layers,ae,this.zoom,t);this.patternFeatures.push(Ae)}else this.addFeature(ae,ue,ce,r,{});t.featureIndex.insert(e[ce].feature,ue,ce,ge,this.index)}},no.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},no.prototype.addFeatures=function(e,t,r){for(var a=0,u=this.patternFeatures;a<u.length;a+=1){var p=u[a];this.addFeature(p,p.geometry,p.index,t,r)}},no.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},no.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},no.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Wy),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},no.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},no.prototype.addFeature=function(e,t,r,a,u){for(var p=0,f=Jp(t,500);p<f.length;p+=1){for(var g=f[p],x=0,w=0,E=g;w<E.length;w+=1)x+=E[w].length;for(var I=this.segments.prepareSegment(x,this.layoutVertexArray,this.indexArray),z=I.vertexLength,L=[],V=[],N=0,Q=g;N<Q.length;N+=1){var W=Q[N];if(W.length!==0){W!==g[0]&&V.push(L.length/2);var ne=this.segments2.prepareSegment(W.length,this.layoutVertexArray,this.indexArray2),ae=ne.vertexLength;this.layoutVertexArray.emplaceBack(W[0].x,W[0].y),this.indexArray2.emplaceBack(ae+W.length-1,ae),L.push(W[0].x),L.push(W[0].y);for(var ue=1;ue<W.length;ue++)this.layoutVertexArray.emplaceBack(W[ue].x,W[ue].y),this.indexArray2.emplaceBack(ae+ue-1,ae+ue),L.push(W[ue].x),L.push(W[ue].y);ne.vertexLength+=W.length,ne.primitiveLength+=W.length}}for(var ce=Xp(L,V),ge=0;ge<ce.length;ge+=3)this.indexArray.emplaceBack(z+ce[ge],z+ce[ge+1],z+ce[ge+2]);I.vertexLength+=x,I.primitiveLength+=ce.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,u,a)},Ne("FillBucket",no,{omit:["layers","patternFeatures"]});var lg=new Ki({"fill-sort-key":new st(F.layout_fill["fill-sort-key"])}),ug={paint:new Ki({"fill-antialias":new Fe(F.paint_fill["fill-antialias"]),"fill-opacity":new st(F.paint_fill["fill-opacity"]),"fill-color":new st(F.paint_fill["fill-color"]),"fill-outline-color":new st(F.paint_fill["fill-outline-color"]),"fill-translate":new Fe(F.paint_fill["fill-translate"]),"fill-translate-anchor":new Fe(F.paint_fill["fill-translate-anchor"]),"fill-pattern":new Wi(F.paint_fill["fill-pattern"])}),layout:lg},cg=function(e){function t(r){e.call(this,r,ug)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,a){e.prototype.recalculate.call(this,r,a);var u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(r){return new no(r)},t.prototype.queryRadius=function(){return io(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(r,a,u,p,f,g,x){return sn(An(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,x),p)},t.prototype.isTileClipped=function(){return!0},t}(gn),pg=li([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,If=sl;function sl(e,t,r,a,u){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=a,this._values=u,e.readFields(hg,this,t)}function hg(e,t,r){e==1?t.id=r.readVarint():e==2?function(a,u){for(var p=a.readVarint()+a.pos;a.pos<p;){var f=u._keys[a.readVarint()],g=u._values[a.readVarint()];u.properties[f]=g}}(r,t):e==3?t.type=r.readVarint():e==4&&(t._geometry=r.pos)}function fg(e){for(var t,r,a=0,u=0,p=e.length,f=p-1;u<p;f=u++)a+=((r=e[f]).x-(t=e[u]).x)*(t.y+r.y);return a}sl.types=["Unknown","Point","LineString","Polygon"],sl.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,a=1,u=0,p=0,f=0,g=[];e.pos<r;){if(u<=0){var x=e.readVarint();a=7&x,u=x>>3}if(u--,a===1||a===2)p+=e.readSVarint(),f+=e.readSVarint(),a===1&&(t&&g.push(t),t=[]),t.push(new se(p,f));else{if(a!==7)throw new Error("unknown command "+a);t&&t.push(t[0].clone())}}return t&&g.push(t),g},sl.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,a=0,u=0,p=0,f=1/0,g=-1/0,x=1/0,w=-1/0;e.pos<t;){if(a<=0){var E=e.readVarint();r=7&E,a=E>>3}if(a--,r===1||r===2)(u+=e.readSVarint())<f&&(f=u),u>g&&(g=u),(p+=e.readSVarint())<x&&(x=p),p>w&&(w=p);else if(r!==7)throw new Error("unknown command "+r)}return[f,x,g,w]},sl.prototype.toGeoJSON=function(e,t,r){var a,u,p=this.extent*Math.pow(2,r),f=this.extent*e,g=this.extent*t,x=this.loadGeometry(),w=sl.types[this.type];function E(L){for(var V=0;V<L.length;V++){var N=L[V];L[V]=[360*(N.x+f)/p-180,360/Math.PI*Math.atan(Math.exp((180-360*(N.y+g)/p)*Math.PI/180))-90]}}switch(this.type){case 1:var I=[];for(a=0;a<x.length;a++)I[a]=x[a][0];E(x=I);break;case 2:for(a=0;a<x.length;a++)E(x[a]);break;case 3:for(x=function(L){var V=L.length;if(V<=1)return[L];for(var N,Q,W=[],ne=0;ne<V;ne++){var ae=fg(L[ne]);ae!==0&&(Q===void 0&&(Q=ae<0),Q===ae<0?(N&&W.push(N),N=[L[ne]]):N.push(L[ne]))}return N&&W.push(N),W}(x),a=0;a<x.length;a++)for(u=0;u<x[a].length;u++)E(x[a][u])}x.length===1?x=x[0]:w="Multi"+w;var z={type:"Feature",geometry:{type:w,coordinates:x},properties:this.properties};return"id"in this&&(z.id=this.id),z};var Cf=Af;function Af(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(dg,this,t),this.length=this._features.length}function dg(e,t,r){e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(function(a){for(var u=null,p=a.readVarint()+a.pos;a.pos<p;){var f=a.readVarint()>>3;u=f===1?a.readString():f===2?a.readFloat():f===3?a.readDouble():f===4?a.readVarint64():f===5?a.readVarint():f===6?a.readSVarint():f===7?a.readBoolean():null}return u}(r))}function mg(e,t,r){if(e===3){var a=new Cf(r,r.readVarint()+r.pos);a.length&&(t[a.name]=a)}}Af.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new If(this._pbf,t,this.extent,this._keys,this._values)};var ll={VectorTile:function(e,t){this.layers=e.readFields(mg,{},t)},VectorTileFeature:If,VectorTileLayer:Cf},yg=ll.VectorTileFeature.types,eh=Math.pow(2,13);function du(e,t,r,a,u,p,f,g){e.emplaceBack(t,r,2*Math.floor(a*eh)+f,u*eh*2,p*eh*2,Math.round(g))}var oo=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new $i,this.indexArray=new on,this.programConfigurations=new rr(e.layers,e.zoom),this.segments=new R,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function gg(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}oo.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=Yp("fill-extrusion",this.layers,t);for(var a=0,u=e;a<u.length;a+=1){var p=u[a],f=p.feature,g=p.id,x=p.index,w=p.sourceLayerIndex,E=this.layers[0]._featureFilter.needGeometry,I=vi(f,E);if(this.layers[0]._featureFilter.filter(new Xt(this.zoom),I,r)){var z={id:g,sourceLayerIndex:w,index:x,geometry:E?I.geometry:Rr(f),properties:f.properties,type:f.type,patterns:{}};this.hasPattern?this.features.push(Qp("fill-extrusion",this.layers,z,this.zoom,t)):this.addFeature(z,z.geometry,x,r,{}),t.featureIndex.insert(f,z.geometry,x,w,this.index,!0)}}},oo.prototype.addFeatures=function(e,t,r){for(var a=0,u=this.features;a<u.length;a+=1){var p=u[a];this.addFeature(p,p.geometry,p.index,t,r)}},oo.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},oo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},oo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},oo.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,pg),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},oo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},oo.prototype.addFeature=function(e,t,r,a,u){for(var p=0,f=Jp(t,500);p<f.length;p+=1){for(var g=f[p],x=0,w=0,E=g;w<E.length;w+=1)x+=E[w].length;for(var I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),z=0,L=g;z<L.length;z+=1){var V=L[z];if(V.length!==0&&!((It=V).every(function(_t){return _t.x<0})||It.every(function(_t){return _t.x>8192})||It.every(function(_t){return _t.y<0})||It.every(function(_t){return _t.y>8192})))for(var N=0,Q=0;Q<V.length;Q++){var W=V[Q];if(Q>=1){var ne=V[Q-1];if(!gg(W,ne)){I.vertexLength+4>R.MAX_VERTEX_ARRAY_LENGTH&&(I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var ae=W.sub(ne)._perp()._unit(),ue=ne.dist(W);N+ue>32768&&(N=0),du(this.layoutVertexArray,W.x,W.y,ae.x,ae.y,0,0,N),du(this.layoutVertexArray,W.x,W.y,ae.x,ae.y,0,1,N),du(this.layoutVertexArray,ne.x,ne.y,ae.x,ae.y,0,0,N+=ue),du(this.layoutVertexArray,ne.x,ne.y,ae.x,ae.y,0,1,N);var ce=I.vertexLength;this.indexArray.emplaceBack(ce,ce+2,ce+1),this.indexArray.emplaceBack(ce+1,ce+2,ce+3),I.vertexLength+=4,I.primitiveLength+=2}}}}if(I.vertexLength+x>R.MAX_VERTEX_ARRAY_LENGTH&&(I=this.segments.prepareSegment(x,this.layoutVertexArray,this.indexArray)),yg[e.type]==="Polygon"){for(var ge=[],Ae=[],ke=I.vertexLength,Ke=0,Re=g;Ke<Re.length;Ke+=1){var Je=Re[Ke];if(Je.length!==0){Je!==g[0]&&Ae.push(ge.length/2);for(var Be=0;Be<Je.length;Be++){var bt=Je[Be];du(this.layoutVertexArray,bt.x,bt.y,0,0,1,1,0),ge.push(bt.x),ge.push(bt.y)}}}for(var at=Xp(ge,Ae),We=0;We<at.length;We+=3)this.indexArray.emplaceBack(ke+at[We],ke+at[We+2],ke+at[We+1]);I.primitiveLength+=at.length/3,I.vertexLength+=x}}var It;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,u,a)},Ne("FillExtrusionBucket",oo,{omit:["layers","features"]});var _g={paint:new Ki({"fill-extrusion-opacity":new Fe(F["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new st(F["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Fe(F["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Fe(F["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Wi(F["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new st(F["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new st(F["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Fe(F["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},vg=function(e){function t(r){e.call(this,r,_g)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new oo(r)},t.prototype.queryRadius=function(){return io(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(r,a,u,p,f,g,x,w){var E=An(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,x),I=this.paint.get("fill-extrusion-height").evaluate(a,u),z=this.paint.get("fill-extrusion-base").evaluate(a,u),L=function(N,Q,W,ne){for(var ae=[],ue=0,ce=N;ue<ce.length;ue+=1){var ge=ce[ue],Ae=[ge.x,ge.y,0,1];nl(Ae,Ae,Q),ae.push(new se(Ae[0]/Ae[3],Ae[1]/Ae[3]))}return ae}(E,w),V=function(N,Q,W,ne){for(var ae=[],ue=[],ce=ne[8]*Q,ge=ne[9]*Q,Ae=ne[10]*Q,ke=ne[11]*Q,Ke=ne[8]*W,Re=ne[9]*W,Je=ne[10]*W,Be=ne[11]*W,bt=0,at=N;bt<at.length;bt+=1){for(var We=[],It=[],_t=0,Dt=at[bt];_t<Dt.length;_t+=1){var tt=Dt[_t],jt=tt.x,br=tt.y,kr=ne[0]*jt+ne[4]*br+ne[12],Ar=ne[1]*jt+ne[5]*br+ne[13],wr=ne[2]*jt+ne[6]*br+ne[14],Lr=ne[3]*jt+ne[7]*br+ne[15],ti=wr+Ae,ri=Lr+ke,Pi=kr+Ke,ci=Ar+Re,zi=wr+Je,Or=Lr+Be,pi=new se((kr+ce)/ri,(Ar+ge)/ri);pi.z=ti/ri,We.push(pi);var zt=new se(Pi/Or,ci/Or);zt.z=zi/Or,It.push(zt)}ae.push(We),ue.push(It)}return[ae,ue]}(p,z,I,w);return function(N,Q,W){var ne=1/0;sn(W,Q)&&(ne=Pf(W,Q[0]));for(var ae=0;ae<Q.length;ae++)for(var ue=Q[ae],ce=N[ae],ge=0;ge<ue.length-1;ge++){var Ae=ue[ge],ke=[Ae,ue[ge+1],ce[ge+1],ce[ge],Ae];Ii(W,ke)&&(ne=Math.min(ne,Pf(W,ke)))}return ne!==1/0&&ne}(V[0],V[1],L)},t}(gn);function mu(e,t){return e.x*t.x+e.y*t.y}function Pf(e,t){if(e.length===1){for(var r,a=0,u=t[a++];!r||u.equals(r);)if(!(r=t[a++]))return 1/0;for(;a<t.length;a++){var p=t[a],f=e[0],g=r.sub(u),x=p.sub(u),w=f.sub(u),E=mu(g,g),I=mu(g,x),z=mu(x,x),L=mu(w,g),V=mu(w,x),N=E*z-I*I,Q=(z*L-I*V)/N,W=(E*V-I*L)/N,ne=u.z*(1-Q-W)+r.z*Q+p.z*W;if(isFinite(ne))return ne}return 1/0}for(var ae=1/0,ue=0,ce=t;ue<ce.length;ue+=1)ae=Math.min(ae,ce[ue].z);return ae}var xg=li([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,bg=li([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,wg=ll.VectorTileFeature.types,Sg=Math.cos(Math.PI/180*37.5),zf=Math.pow(2,14)/.5,Vi=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(r){t.gradients[r.id]={}}),this.layoutVertexArray=new el,this.layoutVertexArray2=new ea,this.indexArray=new on,this.programConfigurations=new rr(e.layers,e.zoom),this.segments=new R,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};Vi.prototype.populate=function(e,t,r){this.hasPattern=Yp("line",this.layers,t);for(var a=this.layers[0].layout.get("line-sort-key"),u=!a.isConstant(),p=[],f=0,g=e;f<g.length;f+=1){var x=g[f],w=x.feature,E=x.id,I=x.index,z=x.sourceLayerIndex,L=this.layers[0]._featureFilter.needGeometry,V=vi(w,L);if(this.layers[0]._featureFilter.filter(new Xt(this.zoom),V,r)){var N=u?a.evaluate(V,{},r):void 0,Q={id:E,properties:w.properties,type:w.type,sourceLayerIndex:z,index:I,geometry:L?V.geometry:Rr(w),patterns:{},sortKey:N};p.push(Q)}}u&&p.sort(function(ke,Ke){return ke.sortKey-Ke.sortKey});for(var W=0,ne=p;W<ne.length;W+=1){var ae=ne[W],ue=ae.geometry,ce=ae.index,ge=ae.sourceLayerIndex;if(this.hasPattern){var Ae=Qp("line",this.layers,ae,this.zoom,t);this.patternFeatures.push(Ae)}else this.addFeature(ae,ue,ce,r,{});t.featureIndex.insert(e[ce].feature,ue,ce,ge,this.index)}},Vi.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Vi.prototype.addFeatures=function(e,t,r){for(var a=0,u=this.patternFeatures;a<u.length;a+=1){var p=u[a];this.addFeature(p,p.geometry,p.index,t,r)}},Vi.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Vi.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Vi.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,bg)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,xg),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Vi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Vi.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Vi.prototype.addFeature=function(e,t,r,a,u){var p=this.layers[0].layout,f=p.get("line-join").evaluate(e,{}),g=p.get("line-cap"),x=p.get("line-miter-limit"),w=p.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var E=0,I=t;E<I.length;E+=1)this.addLine(I[E],e,f,g,x,w);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,u,a)},Vi.prototype.addLine=function(e,t,r,a,u,p){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var f=0;f<e.length-1;f++)this.totalDistance+=e[f].dist(e[f+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var g=wg[t.type]==="Polygon",x=e.length;x>=2&&e[x-1].equals(e[x-2]);)x--;for(var w=0;w<x-1&&e[w].equals(e[w+1]);)w++;if(!(x<(g?3:2))){r==="bevel"&&(u=1.05);var E,I=this.overscaling<=16?122880/(512*this.overscaling):0,z=this.segments.prepareSegment(10*x,this.layoutVertexArray,this.indexArray),L=void 0,V=void 0,N=void 0,Q=void 0;this.e1=this.e2=-1,g&&(Q=e[w].sub(E=e[x-2])._unit()._perp());for(var W=w;W<x;W++)if(!(V=W===x-1?g?e[w+1]:void 0:e[W+1])||!e[W].equals(V)){Q&&(N=Q),E&&(L=E),E=e[W],Q=V?V.sub(E)._unit()._perp():N;var ne=(N=N||Q).add(Q);ne.x===0&&ne.y===0||ne._unit();var ae=N.x*Q.x+N.y*Q.y,ue=ne.x*Q.x+ne.y*Q.y,ce=ue!==0?1/ue:1/0,ge=2*Math.sqrt(2-2*ue),Ae=ue<Sg&&L&&V,ke=N.x*Q.y-N.y*Q.x>0;if(Ae&&W>w){var Ke=E.dist(L);if(Ke>2*I){var Re=E.sub(E.sub(L)._mult(I/Ke)._round());this.updateDistance(L,Re),this.addCurrentVertex(Re,N,0,0,z),L=Re}}var Je=L&&V,Be=Je?r:g?"butt":a;if(Je&&Be==="round"&&(ce<p?Be="miter":ce<=2&&(Be="fakeround")),Be==="miter"&&ce>u&&(Be="bevel"),Be==="bevel"&&(ce>2&&(Be="flipbevel"),ce<u&&(Be="miter")),L&&this.updateDistance(L,E),Be==="miter")ne._mult(ce),this.addCurrentVertex(E,ne,0,0,z);else if(Be==="flipbevel"){if(ce>100)ne=Q.mult(-1);else{var bt=ce*N.add(Q).mag()/N.sub(Q).mag();ne._perp()._mult(bt*(ke?-1:1))}this.addCurrentVertex(E,ne,0,0,z),this.addCurrentVertex(E,ne.mult(-1),0,0,z)}else if(Be==="bevel"||Be==="fakeround"){var at=-Math.sqrt(ce*ce-1),We=ke?at:0,It=ke?0:at;if(L&&this.addCurrentVertex(E,N,We,It,z),Be==="fakeround")for(var _t=Math.round(180*ge/Math.PI/20),Dt=1;Dt<_t;Dt++){var tt=Dt/_t;if(tt!==.5){var jt=tt-.5;tt+=tt*jt*(tt-1)*((1.0904+ae*(ae*(3.55645-1.43519*ae)-3.2452))*jt*jt+(.848013+ae*(.215638*ae-1.06021)))}var br=Q.sub(N)._mult(tt)._add(N)._unit()._mult(ke?-1:1);this.addHalfVertex(E,br.x,br.y,!1,ke,0,z)}V&&this.addCurrentVertex(E,Q,-We,-It,z)}else if(Be==="butt")this.addCurrentVertex(E,ne,0,0,z);else if(Be==="square"){var kr=L?1:-1;this.addCurrentVertex(E,ne,kr,kr,z)}else Be==="round"&&(L&&(this.addCurrentVertex(E,N,0,0,z),this.addCurrentVertex(E,N,1,1,z,!0)),V&&(this.addCurrentVertex(E,Q,-1,-1,z,!0),this.addCurrentVertex(E,Q,0,0,z)));if(Ae&&W<x-1){var Ar=E.dist(V);if(Ar>2*I){var wr=E.add(V.sub(E)._mult(I/Ar)._round());this.updateDistance(E,wr),this.addCurrentVertex(wr,Q,0,0,z),E=wr}}}}},Vi.prototype.addCurrentVertex=function(e,t,r,a,u,p){p===void 0&&(p=!1);var f=t.y*a-t.x,g=-t.y-t.x*a;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,p,!1,r,u),this.addHalfVertex(e,f,g,p,!0,-a,u),this.distance>zf/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,r,a,u,p))},Vi.prototype.addHalfVertex=function(e,t,r,a,u,p,f){var g=.5*(this.lineClips?this.scaledDistance*(zf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(a?1:0),(e.y<<1)+(u?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(p===0?0:p<0?-1:1)|(63&g)<<2,g>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var x=f.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,x),f.primitiveLength++),u?this.e2=x:this.e1=x},Vi.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Vi.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},Ne("LineBucket",Vi,{omit:["layers","patternFeatures"]});var Eg=new Ki({"line-cap":new Fe(F.layout_line["line-cap"]),"line-join":new st(F.layout_line["line-join"]),"line-miter-limit":new Fe(F.layout_line["line-miter-limit"]),"line-round-limit":new Fe(F.layout_line["line-round-limit"]),"line-sort-key":new st(F.layout_line["line-sort-key"])}),Mf={paint:new Ki({"line-opacity":new st(F.paint_line["line-opacity"]),"line-color":new st(F.paint_line["line-color"]),"line-translate":new Fe(F.paint_line["line-translate"]),"line-translate-anchor":new Fe(F.paint_line["line-translate-anchor"]),"line-width":new st(F.paint_line["line-width"]),"line-gap-width":new st(F.paint_line["line-gap-width"]),"line-offset":new st(F.paint_line["line-offset"]),"line-blur":new st(F.paint_line["line-blur"]),"line-dasharray":new yn(F.paint_line["line-dasharray"]),"line-pattern":new Wi(F.paint_line["line-pattern"]),"line-gradient":new Qn(F.paint_line["line-gradient"])}),layout:Eg},kf=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,a){return a=new Xt(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),e.prototype.possiblyEvaluate.call(this,r,a)},t.prototype.evaluate=function(r,a,u,p){return a=Pt({},a,{zoom:Math.floor(a.zoom)}),e.prototype.evaluate.call(this,r,a,u,p)},t}(st))(Mf.paint.properties["line-width"].specification);kf.useIntegerZoom=!0;var Tg=function(e){function t(r){e.call(this,r,Mf),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Tn,this.gradientVersion=(this.gradientVersion+1)%ft)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(r,a){e.prototype.recalculate.call(this,r,a),this.paint._values["line-floorwidth"]=kf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)},t.prototype.createBucket=function(r){return new Vi(r)},t.prototype.queryRadius=function(r){var a=r,u=Lf(Xr("line-width",this,a),Xr("line-gap-width",this,a)),p=Xr("line-offset",this,a);return u/2+Math.abs(p)+io(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(r,a,u,p,f,g,x){var w=An(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,x),E=x/2*Lf(this.paint.get("line-width").evaluate(a,u),this.paint.get("line-gap-width").evaluate(a,u)),I=this.paint.get("line-offset").evaluate(a,u);return I&&(p=function(z,L){for(var V=[],N=new se(0,0),Q=0;Q<z.length;Q++){for(var W=z[Q],ne=[],ae=0;ae<W.length;ae++){var ue=W[ae],ce=W[ae+1],ge=ae===0?N:ue.sub(W[ae-1])._unit()._perp(),Ae=ae===W.length-1?N:ce.sub(ue)._unit()._perp(),ke=ge._add(Ae)._unit();ke._mult(1/(ke.x*Ae.x+ke.y*Ae.y)),ne.push(ke._mult(L)._add(ue))}V.push(ne)}return V}(p,I*x)),function(z,L,V){for(var N=0;N<L.length;N++){var Q=L[N];if(z.length>=3){for(var W=0;W<Q.length;W++)if(jn(z,Q[W]))return!0}if(uu(z,Q,V))return!0}return!1}(w,p,E)},t.prototype.isTileClipped=function(){return!0},t}(gn);function Lf(e,t){return t>0?t+2*e:e}var Ig=li([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Cg=li([{name:"a_projected_pos",components:3,type:"Float32"}],4),Ag=(li([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),li([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Df=(li([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),li([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Pg=li([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function zg(e,t,r){return e.sections.forEach(function(a){a.text=function(u,p,f){var g=p.layout.get("text-transform").evaluate(f,{});return g==="uppercase"?u=u.toLocaleUpperCase():g==="lowercase"&&(u=u.toLocaleLowerCase()),Er.applyArabicShaping&&(u=Er.applyArabicShaping(u)),u}(a.text,t,r)}),e}li([{name:"triangle",components:3,type:"Uint16"}]),li([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),li([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),li([{type:"Float32",name:"offsetX"}]),li([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var yu={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},Rf=function(e,t,r,a,u){var p,f,g=8*u-a-1,x=(1<<g)-1,w=x>>1,E=-7,I=r?u-1:0,z=r?-1:1,L=e[t+I];for(I+=z,p=L&(1<<-E)-1,L>>=-E,E+=g;E>0;p=256*p+e[t+I],I+=z,E-=8);for(f=p&(1<<-E)-1,p>>=-E,E+=a;E>0;f=256*f+e[t+I],I+=z,E-=8);if(p===0)p=1-w;else{if(p===x)return f?NaN:1/0*(L?-1:1);f+=Math.pow(2,a),p-=w}return(L?-1:1)*f*Math.pow(2,p-a)},Bf=function(e,t,r,a,u,p){var f,g,x,w=8*p-u-1,E=(1<<w)-1,I=E>>1,z=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,L=a?0:p-1,V=a?1:-1,N=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(g=isNaN(t)?1:0,f=E):(f=Math.floor(Math.log(t)/Math.LN2),t*(x=Math.pow(2,-f))<1&&(f--,x*=2),(t+=f+I>=1?z/x:z*Math.pow(2,1-I))*x>=2&&(f++,x/=2),f+I>=E?(g=0,f=E):f+I>=1?(g=(t*x-1)*Math.pow(2,u),f+=I):(g=t*Math.pow(2,I-1)*Math.pow(2,u),f=0));u>=8;e[r+L]=255&g,L+=V,g/=256,u-=8);for(f=f<<u|g,w+=u;w>0;e[r+L]=255&f,L+=V,f/=256,w-=8);e[r+L-V]|=128*N},Tc=mr;function mr(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}mr.Varint=0,mr.Fixed64=1,mr.Bytes=2,mr.Fixed32=5;var Of=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function na(e){return e.type===mr.Bytes?e.readVarint()+e.pos:e.pos+1}function ul(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function Ff(e,t,r){var a=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(a);for(var u=r.pos-1;u>=e;u--)r.buf[u+a]=r.buf[u]}function Mg(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function kg(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function Lg(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function Dg(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function Rg(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function Bg(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function Og(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function Fg(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function Ug(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function Ic(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function cl(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function Uf(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Vg(e,t,r){e===1&&r.readMessage(Ng,t)}function Ng(e,t,r){if(e===3){var a=r.readMessage(jg,{}),u=a.width,p=a.height,f=a.left,g=a.top,x=a.advance;t.push({id:a.id,bitmap:new ds({width:u+6,height:p+6},a.bitmap),metrics:{width:u,height:p,left:f,top:g,advance:x}})}}function jg(e,t,r){e===1?t.id=r.readVarint():e===2?t.bitmap=r.readBytes():e===3?t.width=r.readVarint():e===4?t.height=r.readVarint():e===5?t.left=r.readSVarint():e===6?t.top=r.readSVarint():e===7&&(t.advance=r.readVarint())}function Vf(e){for(var t=0,r=0,a=0,u=e;a<u.length;a+=1){var p=u[a];t+=p.w*p.h,r=Math.max(r,p.w)}e.sort(function(N,Q){return Q.h-N.h});for(var f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],g=0,x=0,w=0,E=e;w<E.length;w+=1)for(var I=E[w],z=f.length-1;z>=0;z--){var L=f[z];if(!(I.w>L.w||I.h>L.h)){if(I.x=L.x,I.y=L.y,x=Math.max(x,I.y+I.h),g=Math.max(g,I.x+I.w),I.w===L.w&&I.h===L.h){var V=f.pop();z<f.length&&(f[z]=V)}else I.h===L.h?(L.x+=I.w,L.w-=I.w):I.w===L.w?(L.y+=I.h,L.h-=I.h):(f.push({x:L.x+I.w,y:L.y,w:L.w-I.w,h:I.h}),L.y+=I.h,L.h-=I.h);break}}return{w:g,h:x,fill:t/(g*x)||0}}mr.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var a=this.readVarint(),u=a>>3,p=this.pos;this.type=7&a,e(u,t,this),this.pos===p&&this.skip(a)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Ic(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=Uf(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Ic(this.buf,this.pos)+4294967296*Ic(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Ic(this.buf,this.pos)+4294967296*Uf(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=Rf(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=Rf(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,a=this.buf;return t=127&(r=a[this.pos++]),r<128?t:(t|=(127&(r=a[this.pos++]))<<7,r<128?t:(t|=(127&(r=a[this.pos++]))<<14,r<128?t:(t|=(127&(r=a[this.pos++]))<<21,r<128?t:function(u,p,f){var g,x,w=f.buf;if(g=(112&(x=w[f.pos++]))>>4,x<128||(g|=(127&(x=w[f.pos++]))<<3,x<128)||(g|=(127&(x=w[f.pos++]))<<10,x<128)||(g|=(127&(x=w[f.pos++]))<<17,x<128)||(g|=(127&(x=w[f.pos++]))<<24,x<128)||(g|=(1&(x=w[f.pos++]))<<31,x<128))return ul(u,g,p);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=a[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&Of?function(r,a,u){return Of.decode(r.subarray(a,u))}(this.buf,t,e):function(r,a,u){for(var p="",f=a;f<u;){var g,x,w,E=r[f],I=null,z=E>239?4:E>223?3:E>191?2:1;if(f+z>u)break;z===1?E<128&&(I=E):z===2?(192&(g=r[f+1]))==128&&(I=(31&E)<<6|63&g)<=127&&(I=null):z===3?(x=r[f+2],(192&(g=r[f+1]))==128&&(192&x)==128&&((I=(15&E)<<12|(63&g)<<6|63&x)<=2047||I>=55296&&I<=57343)&&(I=null)):z===4&&(x=r[f+2],w=r[f+3],(192&(g=r[f+1]))==128&&(192&x)==128&&(192&w)==128&&((I=(15&E)<<18|(63&g)<<12|(63&x)<<6|63&w)<=65535||I>=1114112)&&(I=null)),I===null?(I=65533,z=1):I>65535&&(I-=65536,p+=String.fromCharCode(I>>>10&1023|55296),I=56320|1023&I),p+=String.fromCharCode(I),f+=z}return p}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==mr.Bytes)return e.push(this.readVarint(t));var r=na(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==mr.Bytes)return e.push(this.readSVarint());var t=na(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==mr.Bytes)return e.push(this.readBoolean());var t=na(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==mr.Bytes)return e.push(this.readFloat());var t=na(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==mr.Bytes)return e.push(this.readDouble());var t=na(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==mr.Bytes)return e.push(this.readFixed32());var t=na(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==mr.Bytes)return e.push(this.readSFixed32());var t=na(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==mr.Bytes)return e.push(this.readFixed64());var t=na(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==mr.Bytes)return e.push(this.readSFixed64());var t=na(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===mr.Varint)for(;this.buf[this.pos++]>127;);else if(t===mr.Bytes)this.pos=this.readVarint()+this.pos;else if(t===mr.Fixed32)this.pos+=4;else{if(t!==mr.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),cl(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),cl(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),cl(this.buf,-1&e,this.pos),cl(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),cl(this.buf,-1&e,this.pos),cl(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,r){var a,u;if(t>=0?(a=t%4294967296|0,u=t/4294967296|0):(u=~(-t/4294967296),4294967295^(a=~(-t%4294967296))?a=a+1|0:(a=0,u=u+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),function(p,f,g){g.buf[g.pos++]=127&p|128,p>>>=7,g.buf[g.pos++]=127&p|128,p>>>=7,g.buf[g.pos++]=127&p|128,p>>>=7,g.buf[g.pos++]=127&p|128,g.buf[g.pos]=127&(p>>>=7)}(a,0,r),function(p,f){var g=(7&p)<<4;f.buf[f.pos++]|=g|((p>>>=3)?128:0),p&&(f.buf[f.pos++]=127&p|((p>>>=7)?128:0),p&&(f.buf[f.pos++]=127&p|((p>>>=7)?128:0),p&&(f.buf[f.pos++]=127&p|((p>>>=7)?128:0),p&&(f.buf[f.pos++]=127&p|((p>>>=7)?128:0),p&&(f.buf[f.pos++]=127&p)))))}(u,r)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(a,u,p){for(var f,g,x=0;x<u.length;x++){if((f=u.charCodeAt(x))>55295&&f<57344){if(!g){f>56319||x+1===u.length?(a[p++]=239,a[p++]=191,a[p++]=189):g=f;continue}if(f<56320){a[p++]=239,a[p++]=191,a[p++]=189,g=f;continue}f=g-55296<<10|f-56320|65536,g=null}else g&&(a[p++]=239,a[p++]=191,a[p++]=189,g=null);f<128?a[p++]=f:(f<2048?a[p++]=f>>6|192:(f<65536?a[p++]=f>>12|224:(a[p++]=f>>18|240,a[p++]=f>>12&63|128),a[p++]=f>>6&63|128),a[p++]=63&f|128)}return p}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&Ff(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),Bf(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Bf(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var a=this.pos-r;a>=128&&Ff(r,a,this),this.pos=r-1,this.writeVarint(a),this.pos+=a},writeMessage:function(e,t,r){this.writeTag(e,mr.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,Mg,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,kg,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,Rg,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,Lg,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,Dg,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,Bg,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Og,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,Fg,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,Ug,t)},writeBytesField:function(e,t){this.writeTag(e,mr.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,mr.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,mr.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,mr.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,mr.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,mr.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,mr.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,mr.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,mr.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,mr.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,!!t)}};var Cc=function(e,t){var r=t.pixelRatio,a=t.version,u=t.stretchX,p=t.stretchY,f=t.content;this.paddedRect=e,this.pixelRatio=r,this.stretchX=u,this.stretchY=p,this.content=f,this.version=a},gu={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};gu.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},gu.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},gu.tlbr.get=function(){return this.tl.concat(this.br)},gu.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Cc.prototype,gu);var _u=function(e,t){var r={},a={};this.haveRenderCallbacks=[];var u=[];this.addImages(e,r,u),this.addImages(t,a,u);var p=Vf(u),f=new Ji({width:p.w||1,height:p.h||1});for(var g in e){var x=e[g],w=r[g].paddedRect;Ji.copy(x.data,f,{x:0,y:0},{x:w.x+1,y:w.y+1},x.data)}for(var E in t){var I=t[E],z=a[E].paddedRect,L=z.x+1,V=z.y+1,N=I.data.width,Q=I.data.height;Ji.copy(I.data,f,{x:0,y:0},{x:L,y:V},I.data),Ji.copy(I.data,f,{x:0,y:Q-1},{x:L,y:V-1},{width:N,height:1}),Ji.copy(I.data,f,{x:0,y:0},{x:L,y:V+Q},{width:N,height:1}),Ji.copy(I.data,f,{x:N-1,y:0},{x:L-1,y:V},{width:1,height:Q}),Ji.copy(I.data,f,{x:0,y:0},{x:L+N,y:V},{width:1,height:Q})}this.image=f,this.iconPositions=r,this.patternPositions=a};_u.prototype.addImages=function(e,t,r){for(var a in e){var u=e[a],p={x:0,y:0,w:u.data.width+2,h:u.data.height+2};r.push(p),t[a]=new Cc(p,u),u.hasRenderCallback&&this.haveRenderCallbacks.push(a)}},_u.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},_u.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var a=e.tl;r.update(t.data,void 0,{x:a[0],y:a[1]})}},Ne("ImagePosition",Cc),Ne("ImageAtlas",_u);var _n={horizontal:1,vertical:2,horizontalOnly:3},pl=function(){this.scale=1,this.fontStack="",this.imageName=null};pl.forText=function(e,t){var r=new pl;return r.scale=e||1,r.fontStack=t,r},pl.forImage=function(e){var t=new pl;return t.imageName=e,t};var Ai=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Ac(e,t,r,a,u,p,f,g,x,w,E,I,z,L,V,N){var Q,W=Ai.fromFeature(e,u);I===_n.vertical&&W.verticalizePunctuation();var ne=Er.processBidirectionalText,ae=Er.processStyledBidirectionalText;if(ne&&W.sections.length===1){Q=[];for(var ue=0,ce=ne(W.toString(),th(W,w,p,t,a,L,V));ue<ce.length;ue+=1){var ge=ce[ue],Ae=new Ai;Ae.text=ge,Ae.sections=W.sections;for(var ke=0;ke<ge.length;ke++)Ae.sectionIndex.push(0);Q.push(Ae)}}else if(ae){Q=[];for(var Ke=0,Re=ae(W.text,W.sectionIndex,th(W,w,p,t,a,L,V));Ke<Re.length;Ke+=1){var Je=Re[Ke],Be=new Ai;Be.text=Je[0],Be.sectionIndex=Je[1],Be.sections=W.sections,Q.push(Be)}}else Q=function(We,It){for(var _t=[],Dt=We.text,tt=0,jt=0,br=It;jt<br.length;jt+=1){var kr=br[jt];_t.push(We.substring(tt,kr)),tt=kr}return tt<Dt.length&&_t.push(We.substring(tt,Dt.length)),_t}(W,th(W,w,p,t,a,L,V));var bt=[],at={positionedLines:bt,text:W.toString(),top:E[1],bottom:E[1],left:E[0],right:E[0],writingMode:I,iconsInText:!1,verticalizable:!1};return function(We,It,_t,Dt,tt,jt,br,kr,Ar,wr,Lr,ti){for(var ri=0,Pi=-17,ci=0,zi=0,Or=kr==="right"?1:kr==="left"?0:.5,pi=0,zt=0,ir=tt;zt<ir.length;zt+=1){var $t=ir[zt];$t.trim();var Ut=$t.getMaxScale(),Ni=24*(Ut-1),xi={positionedGlyphs:[],lineOffset:0};We.positionedLines[pi]=xi;var gr=xi.positionedGlyphs,Nr=0;if($t.length()){for(var bi=0;bi<$t.length();bi++){var qt=$t.getSection(bi),Co=$t.getSectionIndex(bi),vn=$t.getCharCode(bi),Ao=0,Fr=null,Po=null,qn=null,vl=24,_s=!(Ar===_n.horizontal||!Lr&&!Js(vn)||Lr&&(Pc[vn]||(la=vn,qe.Arabic(la)||qe["Arabic Supplement"](la)||qe["Arabic Extended-A"](la)||qe["Arabic Presentation Forms-A"](la)||qe["Arabic Presentation Forms-B"](la))));if(qt.imageName){var xl=Dt[qt.imageName];if(!xl)continue;qn=qt.imageName,We.iconsInText=We.iconsInText||!0,Po=xl.paddedRect;var sa=xl.displaySize;qt.scale=24*qt.scale/ti,Ao=Ni+(24-sa[1]*qt.scale),vl=(Fr={width:sa[0],height:sa[1],left:1,top:-3,advance:_s?sa[1]:sa[0]}).advance;var bl=_s?sa[0]*qt.scale-24*Ut:sa[1]*qt.scale-24*Ut;bl>0&&bl>Nr&&(Nr=bl)}else{var Fc=_t[qt.fontStack],wl=Fc&&Fc[vn];if(wl&&wl.rect)Po=wl.rect,Fr=wl.metrics;else{var bu=It[qt.fontStack],Uc=bu&&bu[vn];if(!Uc)continue;Fr=Uc.metrics}Ao=24*(Ut-qt.scale)}_s?(We.verticalizable=!0,gr.push({glyph:vn,imageName:qn,x:ri,y:Pi+Ao,vertical:_s,scale:qt.scale,fontStack:qt.fontStack,sectionIndex:Co,metrics:Fr,rect:Po}),ri+=vl*qt.scale+wr):(gr.push({glyph:vn,imageName:qn,x:ri,y:Pi+Ao,vertical:_s,scale:qt.scale,fontStack:qt.fontStack,sectionIndex:Co,metrics:Fr,rect:Po}),ri+=Fr.advance*qt.scale+wr)}gr.length!==0&&(ci=Math.max(ri-wr,ci),Zg(gr,0,gr.length-1,Or,Nr)),ri=0;var Vc=jt*Ut+Nr;xi.lineOffset=Math.max(Nr,Ni),Pi+=Vc,zi=Math.max(Vc,zi),++pi}else Pi+=jt,++pi}var la,wu=Pi- -17,Sl=rh(br),Ma=Sl.horizontalAlign,El=Sl.verticalAlign;(function(Nc,jc,Su,Eu,qc,Tu,Iu,Cu,Zc){var Tl,Gc=(jc-Su)*qc;Tl=Tu!==Iu?-Cu*Eu- -17:(-Eu*Zc+.5)*Iu;for(var Il=0,Au=Nc;Il<Au.length;Il+=1)for(var vs=0,Pu=Au[Il].positionedGlyphs;vs<Pu.length;vs+=1){var Cl=Pu[vs];Cl.x+=Gc,Cl.y+=Tl}})(We.positionedLines,Or,Ma,El,ci,zi,jt,wu,tt.length),We.top+=-El*wu,We.bottom=We.top+wu,We.left+=-Ma*ci,We.right=We.left+ci}(at,t,r,a,Q,f,g,x,I,w,z,N),!function(We){for(var It=0,_t=We;It<_t.length;It+=1)if(_t[It].positionedGlyphs.length!==0)return!1;return!0}(bt)&&at}Ai.fromFeature=function(e,t){for(var r=new Ai,a=0;a<e.sections.length;a++){var u=e.sections[a];u.image?r.addImageSection(u):r.addTextSection(u,t)}return r},Ai.prototype.length=function(){return this.text.length},Ai.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},Ai.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},Ai.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},Ai.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var a=e.charCodeAt(r+1)||null,u=e.charCodeAt(r-1)||null;t+=a&&dn(a)&&!yu[e[r+1]]||u&&dn(u)&&!yu[e[r-1]]||!yu[e[r]]?e[r]:yu[e[r]]}return t}(this.text)},Ai.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&Pc[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,a=this.text.length-1;a>=0&&a>=e&&Pc[this.text.charCodeAt(a)];a--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},Ai.prototype.substring=function(e,t){var r=new Ai;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},Ai.prototype.toString=function(){return this.text},Ai.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,r){return Math.max(t,e.sections[r].scale)},0)},Ai.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(pl.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,a=0;a<e.text.length;++a)this.sectionIndex.push(r)},Ai.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(pl.forImage(t)),this.sectionIndex.push(this.sections.length-1)):vt("Reached maximum number of images 6401")}else vt("Can't add FormattedSection with an empty image.")},Ai.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Pc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ln={};function Nf(e,t,r,a,u,p){if(t.imageName){var f=a[t.imageName];return f?f.displaySize[0]*t.scale*24/p+u:0}var g=r[t.fontStack],x=g&&g[e];return x?x.metrics.advance*t.scale+u:0}function jf(e,t,r,a){var u=Math.pow(e-t,2);return a?e<t?u/2:2*u:u+Math.abs(r)*r}function qg(e,t,r){var a=0;return e===10&&(a-=1e4),r&&(a+=150),e!==40&&e!==65288||(a+=50),t!==41&&t!==65289||(a+=50),a}function qf(e,t,r,a,u,p){for(var f=null,g=jf(t,r,u,p),x=0,w=a;x<w.length;x+=1){var E=w[x],I=jf(t-E.x,r,u,p)+E.badness;I<=g&&(f=E,g=I)}return{index:e,x:t,priorBreak:f,badness:g}}function th(e,t,r,a,u,p,f){if(p!=="point")return[];if(!e)return[];for(var g,x=[],w=function(Q,W,ne,ae,ue,ce){for(var ge=0,Ae=0;Ae<Q.length();Ae++){var ke=Q.getSection(Ae);ge+=Nf(Q.getCharCode(Ae),ke,ae,ue,W,ce)}return ge/Math.max(1,Math.ceil(ge/ne))}(e,t,r,a,u,f),E=e.text.indexOf("​")>=0,I=0,z=0;z<e.length();z++){var L=e.getSection(z),V=e.getCharCode(z);if(Pc[V]||(I+=Nf(V,L,a,u,t,f)),z<e.length()-1){var N=!((g=V)<11904||!(qe["Bopomofo Extended"](g)||qe.Bopomofo(g)||qe["CJK Compatibility Forms"](g)||qe["CJK Compatibility Ideographs"](g)||qe["CJK Compatibility"](g)||qe["CJK Radicals Supplement"](g)||qe["CJK Strokes"](g)||qe["CJK Symbols and Punctuation"](g)||qe["CJK Unified Ideographs Extension A"](g)||qe["CJK Unified Ideographs"](g)||qe["Enclosed CJK Letters and Months"](g)||qe["Halfwidth and Fullwidth Forms"](g)||qe.Hiragana(g)||qe["Ideographic Description Characters"](g)||qe["Kangxi Radicals"](g)||qe["Katakana Phonetic Extensions"](g)||qe.Katakana(g)||qe["Vertical Forms"](g)||qe["Yi Radicals"](g)||qe["Yi Syllables"](g)));(ln[V]||N||L.imageName)&&x.push(qf(z+1,I,w,x,qg(V,e.getCharCode(z+1),N&&E),!1))}}return function Q(W){return W?Q(W.priorBreak).concat(W.index):[]}(qf(e.length(),I,w,x,0,!0))}function rh(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Zg(e,t,r,a,u){if(a||u)for(var p=e[r],f=(e[r].x+p.metrics.advance*p.scale)*a,g=t;g<=r;g++)e[g].x-=f,e[g].y+=u}function Zf(e,t,r,a,u,p){var f,g=e.image;if(g.content){var x=g.content,w=g.pixelRatio||1;f=[x[0]/w,x[1]/w,g.displaySize[0]-x[2]/w,g.displaySize[1]-x[3]/w]}var E,I,z,L,V=t.left*p,N=t.right*p;r==="width"||r==="both"?(L=u[0]+V-a[3],I=u[0]+N+a[1]):I=(L=u[0]+(V+N-g.displaySize[0])/2)+g.displaySize[0];var Q=t.top*p,W=t.bottom*p;return r==="height"||r==="both"?(E=u[1]+Q-a[0],z=u[1]+W+a[2]):z=(E=u[1]+(Q+W-g.displaySize[1])/2)+g.displaySize[1],{image:g,top:E,right:I,bottom:z,left:L,collisionPadding:f}}ln[10]=!0,ln[32]=!0,ln[38]=!0,ln[40]=!0,ln[41]=!0,ln[43]=!0,ln[45]=!0,ln[47]=!0,ln[173]=!0,ln[183]=!0,ln[8203]=!0,ln[8208]=!0,ln[8211]=!0,ln[8231]=!0;var hl=function(e){function t(r,a,u,p){e.call(this,r,a),this.angle=u,p!==void 0&&(this.segment=p)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(se);function ih(e,t){var r=t.expression;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Xt(e+1))};if(r.kind==="source")return{kind:"source"};for(var a=r.zoomStops,u=r.interpolationType,p=0;p<a.length&&a[p]<=e;)p++;for(var f=p=Math.max(0,p-1);f<a.length&&a[f]<e+1;)f++;f=Math.min(a.length-1,f);var g=a[p],x=a[f];return r.kind==="composite"?{kind:"composite",minZoom:g,maxZoom:x,interpolationType:u}:{kind:"camera",minZoom:g,maxZoom:x,minSize:r.evaluate(new Xt(g)),maxSize:r.evaluate(new Xt(x)),interpolationType:u}}function Gf(e,t,r){var a=t.uSize,u=r.lowerSize;return e.kind==="source"?u/128:e.kind==="composite"?Vr(u/128,r.upperSize/128,t.uSizeT):a}function Hf(e,t){var r=0,a=0;if(e.kind==="constant")a=e.layoutSize;else if(e.kind!=="source"){var u=e.interpolationType,p=u?Nt(fi.interpolationFactor(u,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?a=Vr(e.minSize,e.maxSize,p):r=p}return{uSizeT:r,uSize:a}}Ne("Anchor",hl);var Gg=Object.freeze({__proto__:null,getSizeData:ih,evaluateSizeForFeature:Gf,evaluateSizeForZoom:Hf,SIZE_PACK_FACTOR:128});function Xf(e,t,r,a,u){if(t.segment===void 0)return!0;for(var p=t,f=t.segment+1,g=0;g>-r/2;){if(--f<0)return!1;g-=e[f].dist(p),p=e[f]}g+=e[f].dist(e[f+1]),f++;for(var x=[],w=0;g<r/2;){var E=e[f],I=e[f+1];if(!I)return!1;var z=e[f-1].angleTo(E)-E.angleTo(I);for(z=Math.abs((z+3*Math.PI)%(2*Math.PI)-Math.PI),x.push({distance:g,angleDelta:z}),w+=z;g-x[0].distance>a;)w-=x.shift().angleDelta;if(w>u)return!1;f++,g+=E.dist(I)}return!0}function Wf(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Kf(e,t,r){return e?.6*t*r:0}function $f(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Hg(e,t,r,a,u,p){for(var f=Kf(r,u,p),g=$f(r,a)*p,x=0,w=Wf(e)/2,E=0;E<e.length-1;E++){var I=e[E],z=e[E+1],L=I.dist(z);if(x+L>w){var V=(w-x)/L,N=Vr(I.x,z.x,V),Q=Vr(I.y,z.y,V),W=new hl(N,Q,z.angleTo(I),E);return W._round(),!f||Xf(e,W,g,f,t)?W:void 0}x+=L}}function Xg(e,t,r,a,u,p,f,g,x){var w=Kf(a,p,f),E=$f(a,u),I=E*f,z=e[0].x===0||e[0].x===x||e[0].y===0||e[0].y===x;return t-I<t/4&&(t=I+t/4),function L(V,N,Q,W,ne,ae,ue,ce,ge){for(var Ae=ae/2,ke=Wf(V),Ke=0,Re=N-Q,Je=[],Be=0;Be<V.length-1;Be++){for(var bt=V[Be],at=V[Be+1],We=bt.dist(at),It=at.angleTo(bt);Re+Q<Ke+We;){var _t=((Re+=Q)-Ke)/We,Dt=Vr(bt.x,at.x,_t),tt=Vr(bt.y,at.y,_t);if(Dt>=0&&Dt<ge&&tt>=0&&tt<ge&&Re-Ae>=0&&Re+Ae<=ke){var jt=new hl(Dt,tt,It,Be);jt._round(),W&&!Xf(V,jt,ae,W,ne)||Je.push(jt)}}Ke+=We}return ce||Je.length||ue||(Je=L(V,Ke/2,Q,W,ne,ae,ue,!0,ge)),Je}(e,z?t/2*g%t:(E/2+2*p)*f*g%t,t,w,r,I,z,!1,x)}function Jf(e,t,r,a,u){for(var p=[],f=0;f<e.length;f++)for(var g=e[f],x=void 0,w=0;w<g.length-1;w++){var E=g[w],I=g[w+1];E.x<t&&I.x<t||(E.x<t?E=new se(t,E.y+(t-E.x)/(I.x-E.x)*(I.y-E.y))._round():I.x<t&&(I=new se(t,E.y+(t-E.x)/(I.x-E.x)*(I.y-E.y))._round()),E.y<r&&I.y<r||(E.y<r?E=new se(E.x+(r-E.y)/(I.y-E.y)*(I.x-E.x),r)._round():I.y<r&&(I=new se(E.x+(r-E.y)/(I.y-E.y)*(I.x-E.x),r)._round()),E.x>=a&&I.x>=a||(E.x>=a?E=new se(a,E.y+(a-E.x)/(I.x-E.x)*(I.y-E.y))._round():I.x>=a&&(I=new se(a,E.y+(a-E.x)/(I.x-E.x)*(I.y-E.y))._round()),E.y>=u&&I.y>=u||(E.y>=u?E=new se(E.x+(u-E.y)/(I.y-E.y)*(I.x-E.x),u)._round():I.y>=u&&(I=new se(E.x+(u-E.y)/(I.y-E.y)*(I.x-E.x),u)._round()),x&&E.equals(x[x.length-1])||p.push(x=[E]),x.push(I)))))}return p}function Yf(e,t,r,a){var u=[],p=e.image,f=p.pixelRatio,g=p.paddedRect.w-2,x=p.paddedRect.h-2,w=e.right-e.left,E=e.bottom-e.top,I=p.stretchX||[[0,g]],z=p.stretchY||[[0,x]],L=function(Dt,tt){return Dt+tt[1]-tt[0]},V=I.reduce(L,0),N=z.reduce(L,0),Q=g-V,W=x-N,ne=0,ae=V,ue=0,ce=N,ge=0,Ae=Q,ke=0,Ke=W;if(p.content&&a){var Re=p.content;ne=zc(I,0,Re[0]),ue=zc(z,0,Re[1]),ae=zc(I,Re[0],Re[2]),ce=zc(z,Re[1],Re[3]),ge=Re[0]-ne,ke=Re[1]-ue,Ae=Re[2]-Re[0]-ae,Ke=Re[3]-Re[1]-ce}var Je=function(Dt,tt,jt,br){var kr=Mc(Dt.stretch-ne,ae,w,e.left),Ar=kc(Dt.fixed-ge,Ae,Dt.stretch,V),wr=Mc(tt.stretch-ue,ce,E,e.top),Lr=kc(tt.fixed-ke,Ke,tt.stretch,N),ti=Mc(jt.stretch-ne,ae,w,e.left),ri=kc(jt.fixed-ge,Ae,jt.stretch,V),Pi=Mc(br.stretch-ue,ce,E,e.top),ci=kc(br.fixed-ke,Ke,br.stretch,N),zi=new se(kr,wr),Or=new se(ti,wr),pi=new se(ti,Pi),zt=new se(kr,Pi),ir=new se(Ar/f,Lr/f),$t=new se(ri/f,ci/f),Ut=t*Math.PI/180;if(Ut){var Ni=Math.sin(Ut),xi=Math.cos(Ut),gr=[xi,-Ni,Ni,xi];zi._matMult(gr),Or._matMult(gr),zt._matMult(gr),pi._matMult(gr)}var Nr=Dt.stretch+Dt.fixed,bi=tt.stretch+tt.fixed;return{tl:zi,tr:Or,bl:zt,br:pi,tex:{x:p.paddedRect.x+1+Nr,y:p.paddedRect.y+1+bi,w:jt.stretch+jt.fixed-Nr,h:br.stretch+br.fixed-bi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ir,pixelOffsetBR:$t,minFontScaleX:Ae/f/w,minFontScaleY:Ke/f/E,isSDF:r}};if(a&&(p.stretchX||p.stretchY))for(var Be=Qf(I,Q,V),bt=Qf(z,W,N),at=0;at<Be.length-1;at++)for(var We=Be[at],It=Be[at+1],_t=0;_t<bt.length-1;_t++)u.push(Je(We,bt[_t],It,bt[_t+1]));else u.push(Je({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:g+1},{fixed:0,stretch:x+1}));return u}function zc(e,t,r){for(var a=0,u=0,p=e;u<p.length;u+=1){var f=p[u];a+=Math.max(t,Math.min(r,f[1]))-Math.max(t,Math.min(r,f[0]))}return a}function Qf(e,t,r){for(var a=[{fixed:-1,stretch:0}],u=0,p=e;u<p.length;u+=1){var f=p[u],g=f[0],x=f[1],w=a[a.length-1];a.push({fixed:g-w.stretch,stretch:w.stretch}),a.push({fixed:g-w.stretch,stretch:w.stretch+(x-g)})}return a.push({fixed:t+1,stretch:r}),a}function Mc(e,t,r,a){return e/t*r+a}function kc(e,t,r,a){return e-t*r/a}var Lc=function(e,t,r,a,u,p,f,g,x,w){if(this.boxStartIndex=e.length,x){var E=p.top,I=p.bottom,z=p.collisionPadding;z&&(E-=z[1],I+=z[3]);var L=I-E;L>0&&(L=Math.max(10,L),this.circleDiameter=L)}else{var V=p.top*f-g,N=p.bottom*f+g,Q=p.left*f-g,W=p.right*f+g,ne=p.collisionPadding;if(ne&&(Q-=ne[0]*f,V-=ne[1]*f,W+=ne[2]*f,N+=ne[3]*f),w){var ae=new se(Q,V),ue=new se(W,V),ce=new se(Q,N),ge=new se(W,N),Ae=w*Math.PI/180;ae._rotate(Ae),ue._rotate(Ae),ce._rotate(Ae),ge._rotate(Ae),Q=Math.min(ae.x,ue.x,ce.x,ge.x),W=Math.max(ae.x,ue.x,ce.x,ge.x),V=Math.min(ae.y,ue.y,ce.y,ge.y),N=Math.max(ae.y,ue.y,ce.y,ge.y)}e.emplaceBack(t.x,t.y,Q,V,W,N,r,a,u)}this.boxEndIndex=e.length},fl=function(e,t){if(e===void 0&&(e=[]),t===void 0&&(t=Wg),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)};function Wg(e,t){return e<t?-1:e>t?1:0}function Kg(e,t,r){t===void 0&&(t=1),r===void 0&&(r=!1);for(var a=1/0,u=1/0,p=-1/0,f=-1/0,g=e[0],x=0;x<g.length;x++){var w=g[x];(!x||w.x<a)&&(a=w.x),(!x||w.y<u)&&(u=w.y),(!x||w.x>p)&&(p=w.x),(!x||w.y>f)&&(f=w.y)}var E=Math.min(p-a,f-u),I=E/2,z=new fl([],$g);if(E===0)return new se(a,u);for(var L=a;L<p;L+=E)for(var V=u;V<f;V+=E)z.push(new dl(L+I,V+I,I,e));for(var N=function(ne){for(var ae=0,ue=0,ce=0,ge=ne[0],Ae=0,ke=ge.length,Ke=ke-1;Ae<ke;Ke=Ae++){var Re=ge[Ae],Je=ge[Ke],Be=Re.x*Je.y-Je.x*Re.y;ue+=(Re.x+Je.x)*Be,ce+=(Re.y+Je.y)*Be,ae+=3*Be}return new dl(ue/ae,ce/ae,0,ne)}(e),Q=z.length;z.length;){var W=z.pop();(W.d>N.d||!N.d)&&(N=W,r&&console.log("found best %d after %d probes",Math.round(1e4*W.d)/1e4,Q)),W.max-N.d<=t||(z.push(new dl(W.p.x-(I=W.h/2),W.p.y-I,I,e)),z.push(new dl(W.p.x+I,W.p.y-I,I,e)),z.push(new dl(W.p.x-I,W.p.y+I,I,e)),z.push(new dl(W.p.x+I,W.p.y+I,I,e)),Q+=4)}return r&&(console.log("num probes: "+Q),console.log("best distance: "+N.d)),N.p}function $g(e,t){return t.max-e.max}function dl(e,t,r,a){this.p=new se(e,t),this.h=r,this.d=function(u,p){for(var f=!1,g=1/0,x=0;x<p.length;x++)for(var w=p[x],E=0,I=w.length,z=I-1;E<I;z=E++){var L=w[E],V=w[z];L.y>u.y!=V.y>u.y&&u.x<(V.x-L.x)*(u.y-L.y)/(V.y-L.y)+L.x&&(f=!f),g=Math.min(g,cs(u,L,V))}return(f?1:-1)*Math.sqrt(g)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}fl.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},fl.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},fl.prototype.peek=function(){return this.data[0]},fl.prototype._up=function(e){for(var t=this.data,r=this.compare,a=t[e];e>0;){var u=e-1>>1,p=t[u];if(r(a,p)>=0)break;t[e]=p,e=u}t[e]=a},fl.prototype._down=function(e){for(var t=this.data,r=this.compare,a=this.length>>1,u=t[e];e<a;){var p=1+(e<<1),f=t[p],g=p+1;if(g<this.length&&r(t[g],f)<0&&(p=g,f=t[g]),r(f,u)>=0)break;t[e]=f,e=p}t[e]=u};var nh=Number.POSITIVE_INFINITY;function ed(e,t){return t[1]!==nh?function(r,a,u){var p=0,f=0;switch(a=Math.abs(a),u=Math.abs(u),r){case"top-right":case"top-left":case"top":f=u-7;break;case"bottom-right":case"bottom-left":case"bottom":f=7-u}switch(r){case"top-right":case"bottom-right":case"right":p=-a;break;case"top-left":case"bottom-left":case"left":p=a}return[p,f]}(e,t[0],t[1]):function(r,a){var u=0,p=0;a<0&&(a=0);var f=a/Math.sqrt(2);switch(r){case"top-right":case"top-left":p=f-7;break;case"bottom-right":case"bottom-left":p=7-f;break;case"bottom":p=7-a;break;case"top":p=a-7}switch(r){case"top-right":case"bottom-right":u=-f;break;case"top-left":case"bottom-left":u=f;break;case"left":u=a;break;case"right":u=-a}return[u,p]}(e,t[0])}function oh(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function td(e,t,r,a,u,p,f,g,x,w,E,I,z,L,V){var N=function(ue,ce,ge,Ae,ke,Ke,Re,Je){for(var Be=Ae.layout.get("text-rotate").evaluate(Ke,{})*Math.PI/180,bt=[],at=0,We=ce.positionedLines;at<We.length;at+=1)for(var It=We[at],_t=0,Dt=It.positionedGlyphs;_t<Dt.length;_t+=1){var tt=Dt[_t];if(tt.rect){var jt=tt.rect||{},br=4,kr=!0,Ar=1,wr=0,Lr=(ke||Je)&&tt.vertical,ti=tt.metrics.advance*tt.scale/2;if(Je&&ce.verticalizable&&(wr=It.lineOffset/2-(tt.imageName?-(24-tt.metrics.width*tt.scale)/2:24*(tt.scale-1))),tt.imageName){var ri=Re[tt.imageName];kr=ri.sdf,br=1/(Ar=ri.pixelRatio)}var Pi=ke?[tt.x+ti,tt.y]:[0,0],ci=ke?[0,0]:[tt.x+ti+ge[0],tt.y+ge[1]-wr],zi=[0,0];Lr&&(zi=ci,ci=[0,0]);var Or=(tt.metrics.left-br)*tt.scale-ti+ci[0],pi=(-tt.metrics.top-br)*tt.scale+ci[1],zt=Or+jt.w*tt.scale/Ar,ir=pi+jt.h*tt.scale/Ar,$t=new se(Or,pi),Ut=new se(zt,pi),Ni=new se(Or,ir),xi=new se(zt,ir);if(Lr){var gr=new se(-ti,ti- -17),Nr=-Math.PI/2,bi=12-ti,qt=new se(22-bi,-(tt.imageName?bi:0)),Co=new(Function.prototype.bind.apply(se,[null].concat(zi)));$t._rotateAround(Nr,gr)._add(qt)._add(Co),Ut._rotateAround(Nr,gr)._add(qt)._add(Co),Ni._rotateAround(Nr,gr)._add(qt)._add(Co),xi._rotateAround(Nr,gr)._add(qt)._add(Co)}if(Be){var vn=Math.sin(Be),Ao=Math.cos(Be),Fr=[Ao,-vn,vn,Ao];$t._matMult(Fr),Ut._matMult(Fr),Ni._matMult(Fr),xi._matMult(Fr)}var Po=new se(0,0),qn=new se(0,0);bt.push({tl:$t,tr:Ut,bl:Ni,br:xi,tex:jt,writingMode:ce.writingMode,glyphOffset:Pi,sectionIndex:tt.sectionIndex,isSDF:kr,pixelOffsetTL:Po,pixelOffsetBR:qn,minFontScaleX:0,minFontScaleY:0})}}return bt}(0,r,g,u,p,f,a,e.allowVerticalPlacement),Q=e.textSizeData,W=null;Q.kind==="source"?(W=[128*u.layout.get("text-size").evaluate(f,{})])[0]>32640&&vt(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Q.kind==="composite"&&((W=[128*L.compositeTextSizes[0].evaluate(f,{},V),128*L.compositeTextSizes[1].evaluate(f,{},V)])[0]>32640||W[1]>32640)&&vt(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,N,W,g,p,f,w,t,x.lineStartIndex,x.lineLength,z,V);for(var ne=0,ae=E;ne<ae.length;ne+=1)I[ae[ne]]=e.text.placedSymbolArray.length-1;return 4*N.length}function rd(e){for(var t in e)return e[t];return null}function Jg(e,t,r,a){var u=e.compareText;if(t in u){for(var p=u[t],f=p.length-1;f>=0;f--)if(a.dist(p[f])<r)return!0}else u[t]=[];return u[t].push(a),!1}var Yg=ll.VectorTileFeature.types,Qg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Dc(e,t,r,a,u,p,f,g,x,w,E,I,z){var L=g?Math.min(32640,Math.round(g[0])):0,V=g?Math.min(32640,Math.round(g[1])):0;e.emplaceBack(t,r,Math.round(32*a),Math.round(32*u),p,f,(L<<1)+(x?1:0),V,16*w,16*E,256*I,256*z)}function ah(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function e_(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(_c(r[t].text))return!0;return!1}var ml=function(e){this.layoutVertexArray=new Ta,this.indexArray=new on,this.programConfigurations=e,this.segments=new R,this.dynamicLayoutVertexArray=new ss,this.opacityVertexArray=new nu,this.placedSymbolArray=new h};ml.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},ml.prototype.upload=function(e,t,r,a){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ig.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Cg.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Qg,!0),this.opacityVertexBuffer.itemSize=1),(r||a)&&this.programConfigurations.upload(e))},ml.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Ne("SymbolBuffers",ml);var vu=function(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new R,this.collisionVertexArray=new au};vu.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Ag.members,!0)},vu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Ne("CollisionBuffers",vu);var Qt=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(p){return p.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ci([]),this.placementViewportMatrix=Ci([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ih(this.zoom,t["text-size"]),this.iconSizeData=ih(this.zoom,t["icon-size"]);var r=this.layers[0].layout,a=r.get("symbol-sort-key"),u=r.get("symbol-z-order");this.canOverlap=r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey=u!=="viewport-y"&&!a.isConstant(),this.sortFeaturesByY=(u==="viewport-y"||u==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,r.get("symbol-placement")==="point"&&(this.writingModes=r.get("text-writing-mode").map(function(p){return _n[p]})),this.stateDependentLayerIds=this.layers.filter(function(p){return p.isStateDependent()}).map(function(p){return p.id}),this.sourceID=e.sourceID};Qt.prototype.createArrays=function(){this.text=new ml(new rr(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new ml(new rr(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new v,this.lineVertexArray=new S,this.symbolInstances=new y},Qt.prototype.calculateGlyphDependencies=function(e,t,r,a,u){for(var p=0;p<e.length;p++)if(t[e.charCodeAt(p)]=!0,(r||a)&&u){var f=yu[e.charAt(p)];f&&(t[f.charCodeAt(0)]=!0)}},Qt.prototype.populate=function(e,t,r){var a=this.layers[0],u=a.layout,p=u.get("text-font"),f=u.get("text-field"),g=u.get("icon-image"),x=(f.value.kind!=="constant"||f.value.value instanceof oi&&!f.value.value.isEmpty()||f.value.value.toString().length>0)&&(p.value.kind!=="constant"||p.value.value.length>0),w=g.value.kind!=="constant"||!!g.value.value||Object.keys(g.parameters).length>0,E=u.get("symbol-sort-key");if(this.features=[],x||w){for(var I=t.iconDependencies,z=t.glyphDependencies,L=t.availableImages,V=new Xt(this.zoom),N=0,Q=e;N<Q.length;N+=1){var W=Q[N],ne=W.feature,ae=W.id,ue=W.index,ce=W.sourceLayerIndex,ge=a._featureFilter.needGeometry,Ae=vi(ne,ge);if(a._featureFilter.filter(V,Ae,r)){ge||(Ae.geometry=Rr(ne));var ke=void 0;if(x){var Ke=a.getValueAndResolveTokens("text-field",Ae,r,L),Re=oi.factory(Ke);e_(Re)&&(this.hasRTLText=!0),(!this.hasRTLText||Cn()==="unavailable"||this.hasRTLText&&Er.isParsed())&&(ke=zg(Re,a,Ae))}var Je=void 0;if(w){var Be=a.getValueAndResolveTokens("icon-image",Ae,r,L);Je=Be instanceof Di?Be:Di.fromString(Be)}if(ke||Je){var bt=this.sortFeaturesByKey?E.evaluate(Ae,{},r):void 0;if(this.features.push({id:ae,text:ke,icon:Je,index:ue,sourceLayerIndex:ce,geometry:Ae.geometry,properties:ne.properties,type:Yg[ne.type],sortKey:bt}),Je&&(I[Je.name]=!0),ke){var at=p.evaluate(Ae,{},r).join(","),We=u.get("text-rotation-alignment")==="map"&&u.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(_n.vertical)>=0;for(var It=0,_t=ke.sections;It<_t.length;It+=1){var Dt=_t[It];if(Dt.image)I[Dt.image.name]=!0;else{var tt=$s(ke.toString()),jt=Dt.fontStack||at,br=z[jt]=z[jt]||{};this.calculateGlyphDependencies(Dt.text,br,We,this.allowVerticalPlacement,tt)}}}}}}u.get("symbol-placement")==="line"&&(this.features=function(kr){var Ar={},wr={},Lr=[],ti=0;function ri(gr){Lr.push(kr[gr]),ti++}function Pi(gr,Nr,bi){var qt=wr[gr];return delete wr[gr],wr[Nr]=qt,Lr[qt].geometry[0].pop(),Lr[qt].geometry[0]=Lr[qt].geometry[0].concat(bi[0]),qt}function ci(gr,Nr,bi){var qt=Ar[Nr];return delete Ar[Nr],Ar[gr]=qt,Lr[qt].geometry[0].shift(),Lr[qt].geometry[0]=bi[0].concat(Lr[qt].geometry[0]),qt}function zi(gr,Nr,bi){var qt=bi?Nr[0][Nr[0].length-1]:Nr[0][0];return gr+":"+qt.x+":"+qt.y}for(var Or=0;Or<kr.length;Or++){var pi=kr[Or],zt=pi.geometry,ir=pi.text?pi.text.toString():null;if(ir){var $t=zi(ir,zt),Ut=zi(ir,zt,!0);if($t in wr&&Ut in Ar&&wr[$t]!==Ar[Ut]){var Ni=ci($t,Ut,zt),xi=Pi($t,Ut,Lr[Ni].geometry);delete Ar[$t],delete wr[Ut],wr[zi(ir,Lr[xi].geometry,!0)]=xi,Lr[Ni].geometry=null}else $t in wr?Pi($t,Ut,zt):Ut in Ar?ci($t,Ut,zt):(ri(Or),Ar[$t]=ti-1,wr[Ut]=ti-1)}else ri(Or)}return Lr.filter(function(gr){return gr.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(kr,Ar){return kr.sortKey-Ar.sortKey})}},Qt.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},Qt.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Qt.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Qt.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Qt.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Qt.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Qt.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(e.segment!==void 0){for(var a=e.dist(t[e.segment+1]),u=e.dist(t[e.segment]),p={},f=e.segment+1;f<t.length;f++)p[f]={x:t[f].x,y:t[f].y,tileUnitDistanceFromAnchor:a},f<t.length-1&&(a+=t[f+1].dist(t[f]));for(var g=e.segment||0;g>=0;g--)p[g]={x:t[g].x,y:t[g].y,tileUnitDistanceFromAnchor:u},g>0&&(u+=t[g-1].dist(t[g]));for(var x=0;x<t.length;x++){var w=p[x];this.lineVertexArray.emplaceBack(w.x,w.y,w.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},Qt.prototype.addSymbols=function(e,t,r,a,u,p,f,g,x,w,E,I){for(var z=e.indexArray,L=e.layoutVertexArray,V=e.segments.prepareSegment(4*t.length,L,z,this.canOverlap?p.sortKey:void 0),N=this.glyphOffsetArray.length,Q=V.vertexLength,W=this.allowVerticalPlacement&&f===_n.vertical?Math.PI/2:0,ne=p.text&&p.text.sections,ae=0;ae<t.length;ae++){var ue=t[ae],ce=ue.tl,ge=ue.tr,Ae=ue.bl,ke=ue.br,Ke=ue.tex,Re=ue.pixelOffsetTL,Je=ue.pixelOffsetBR,Be=ue.minFontScaleX,bt=ue.minFontScaleY,at=ue.glyphOffset,We=ue.isSDF,It=ue.sectionIndex,_t=V.vertexLength,Dt=at[1];Dc(L,g.x,g.y,ce.x,Dt+ce.y,Ke.x,Ke.y,r,We,Re.x,Re.y,Be,bt),Dc(L,g.x,g.y,ge.x,Dt+ge.y,Ke.x+Ke.w,Ke.y,r,We,Je.x,Re.y,Be,bt),Dc(L,g.x,g.y,Ae.x,Dt+Ae.y,Ke.x,Ke.y+Ke.h,r,We,Re.x,Je.y,Be,bt),Dc(L,g.x,g.y,ke.x,Dt+ke.y,Ke.x+Ke.w,Ke.y+Ke.h,r,We,Je.x,Je.y,Be,bt),ah(e.dynamicLayoutVertexArray,g,W),z.emplaceBack(_t,_t+1,_t+2),z.emplaceBack(_t+1,_t+2,_t+3),V.vertexLength+=4,V.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(at[0]),ae!==t.length-1&&It===t[ae+1].sectionIndex||e.programConfigurations.populatePaintArrays(L.length,p,p.index,{},I,ne&&ne[It])}e.placedSymbolArray.emplaceBack(g.x,g.y,N,this.glyphOffsetArray.length-N,Q,x,w,g.segment,r?r[0]:0,r?r[1]:0,a[0],a[1],f,0,!1,0,E)},Qt.prototype._addCollisionDebugVertex=function(e,t,r,a,u,p){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,a,u,Math.round(p.x),Math.round(p.y))},Qt.prototype.addCollisionDebugVertices=function(e,t,r,a,u,p,f){var g=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),x=g.vertexLength,w=u.layoutVertexArray,E=u.collisionVertexArray,I=f.anchorX,z=f.anchorY;this._addCollisionDebugVertex(w,E,p,I,z,new se(e,t)),this._addCollisionDebugVertex(w,E,p,I,z,new se(r,t)),this._addCollisionDebugVertex(w,E,p,I,z,new se(r,a)),this._addCollisionDebugVertex(w,E,p,I,z,new se(e,a)),g.vertexLength+=4;var L=u.indexArray;L.emplaceBack(x,x+1),L.emplaceBack(x+1,x+2),L.emplaceBack(x+2,x+3),L.emplaceBack(x+3,x),g.primitiveLength+=4},Qt.prototype.addDebugCollisionBoxes=function(e,t,r,a){for(var u=e;u<t;u++){var p=this.collisionBoxArray.get(u);this.addCollisionDebugVertices(p.x1,p.y1,p.x2,p.y2,a?this.textCollisionBox:this.iconCollisionBox,p.anchorPoint,r)}},Qt.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new vu(To,Df.members,us),this.iconCollisionBox=new vu(To,Df.members,us);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Qt.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,a,u,p,f,g,x){for(var w={},E=t;E<r;E++){var I=e.get(E);w.textBox={x1:I.x1,y1:I.y1,x2:I.x2,y2:I.y2,anchorPointX:I.anchorPointX,anchorPointY:I.anchorPointY},w.textFeatureIndex=I.featureIndex;break}for(var z=a;z<u;z++){var L=e.get(z);w.verticalTextBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},w.verticalTextFeatureIndex=L.featureIndex;break}for(var V=p;V<f;V++){var N=e.get(V);w.iconBox={x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,anchorPointX:N.anchorPointX,anchorPointY:N.anchorPointY},w.iconFeatureIndex=N.featureIndex;break}for(var Q=g;Q<x;Q++){var W=e.get(Q);w.verticalIconBox={x1:W.x1,y1:W.y1,x2:W.x2,y2:W.y2,anchorPointX:W.anchorPointX,anchorPointY:W.anchorPointY},w.verticalIconFeatureIndex=W.featureIndex;break}return w},Qt.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},Qt.prototype.hasTextData=function(){return this.text.segments.get().length>0},Qt.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Qt.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Qt.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Qt.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Qt.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),a=r.vertexStartIndex+4*r.numGlyphs,u=r.vertexStartIndex;u<a;u+=4)e.indexArray.emplaceBack(u,u+1,u+2),e.indexArray.emplaceBack(u+1,u+2,u+3)},Qt.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),a=[],u=[],p=[],f=0;f<this.symbolInstances.length;++f){p.push(f);var g=this.symbolInstances.get(f);a.push(0|Math.round(t*g.anchorX+r*g.anchorY)),u.push(g.featureIndex)}return p.sort(function(x,w){return a[x]-a[w]||u[w]-u[x]}),p},Qt.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Qt.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,a=this.symbolInstanceIndexes;r<a.length;r+=1){var u=this.symbolInstances.get(a[r]);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach(function(p,f,g){p>=0&&g.indexOf(p)===f&&t.addIndicesForPlacedSymbol(t.text,p)}),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Ne("SymbolBucket",Qt,{omit:["layers","collisionBoxArray","features","compareText"]}),Qt.MAX_GLYPHS=65535,Qt.addDynamicAttributes=ah;var t_=new Ki({"symbol-placement":new Fe(F.layout_symbol["symbol-placement"]),"symbol-spacing":new Fe(F.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Fe(F.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new st(F.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Fe(F.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Fe(F.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Fe(F.layout_symbol["icon-ignore-placement"]),"icon-optional":new Fe(F.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Fe(F.layout_symbol["icon-rotation-alignment"]),"icon-size":new st(F.layout_symbol["icon-size"]),"icon-text-fit":new Fe(F.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Fe(F.layout_symbol["icon-text-fit-padding"]),"icon-image":new st(F.layout_symbol["icon-image"]),"icon-rotate":new st(F.layout_symbol["icon-rotate"]),"icon-padding":new Fe(F.layout_symbol["icon-padding"]),"icon-keep-upright":new Fe(F.layout_symbol["icon-keep-upright"]),"icon-offset":new st(F.layout_symbol["icon-offset"]),"icon-anchor":new st(F.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Fe(F.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Fe(F.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Fe(F.layout_symbol["text-rotation-alignment"]),"text-field":new st(F.layout_symbol["text-field"]),"text-font":new st(F.layout_symbol["text-font"]),"text-size":new st(F.layout_symbol["text-size"]),"text-max-width":new st(F.layout_symbol["text-max-width"]),"text-line-height":new Fe(F.layout_symbol["text-line-height"]),"text-letter-spacing":new st(F.layout_symbol["text-letter-spacing"]),"text-justify":new st(F.layout_symbol["text-justify"]),"text-radial-offset":new st(F.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Fe(F.layout_symbol["text-variable-anchor"]),"text-anchor":new st(F.layout_symbol["text-anchor"]),"text-max-angle":new Fe(F.layout_symbol["text-max-angle"]),"text-writing-mode":new Fe(F.layout_symbol["text-writing-mode"]),"text-rotate":new st(F.layout_symbol["text-rotate"]),"text-padding":new Fe(F.layout_symbol["text-padding"]),"text-keep-upright":new Fe(F.layout_symbol["text-keep-upright"]),"text-transform":new st(F.layout_symbol["text-transform"]),"text-offset":new st(F.layout_symbol["text-offset"]),"text-allow-overlap":new Fe(F.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Fe(F.layout_symbol["text-ignore-placement"]),"text-optional":new Fe(F.layout_symbol["text-optional"])}),sh={paint:new Ki({"icon-opacity":new st(F.paint_symbol["icon-opacity"]),"icon-color":new st(F.paint_symbol["icon-color"]),"icon-halo-color":new st(F.paint_symbol["icon-halo-color"]),"icon-halo-width":new st(F.paint_symbol["icon-halo-width"]),"icon-halo-blur":new st(F.paint_symbol["icon-halo-blur"]),"icon-translate":new Fe(F.paint_symbol["icon-translate"]),"icon-translate-anchor":new Fe(F.paint_symbol["icon-translate-anchor"]),"text-opacity":new st(F.paint_symbol["text-opacity"]),"text-color":new st(F.paint_symbol["text-color"],{runtimeType:yt,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new st(F.paint_symbol["text-halo-color"]),"text-halo-width":new st(F.paint_symbol["text-halo-width"]),"text-halo-blur":new st(F.paint_symbol["text-halo-blur"]),"text-translate":new Fe(F.paint_symbol["text-translate"]),"text-translate-anchor":new Fe(F.paint_symbol["text-translate-anchor"])}),layout:t_},yl=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:$e,this.defaultValue=e};yl.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},yl.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},yl.prototype.outputDefined=function(){return!1},yl.prototype.serialize=function(){return null},Ne("FormatSectionOverride",yl,{omit:["defaultValue"]});var r_=function(e){function t(r){e.call(this,r,sh)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,a){if(e.prototype.recalculate.call(this,r,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var u=this.layout.get("text-writing-mode");if(u){for(var p=[],f=0,g=u;f<g.length;f+=1){var x=g[f];p.indexOf(x)<0&&p.push(x)}this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(r,a,u,p){var f=this.layout.get(r).evaluate(a,{},u,p),g=this._unevaluatedLayout._values[r];return g.isDataDriven()||js(g.value)||!f?f:function(x,w){return w.replace(/{([^{}]+)}/g,function(E,I){return I in x?String(x[I]):""})}(a.properties,f)},t.prototype.createBucket=function(r){return new Qt(r)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var r=0,a=sh.paint.overridableProperties;r<a.length;r+=1){var u=a[r];if(t.hasPaintOverride(this.layout,u)){var p,f=this.paint.get(u),g=new yl(f),x=new ba(g,f.property.specification);p=f.value.kind==="constant"||f.value.kind==="source"?new $a("source",x):new wa("composite",x,f.value.zoomStops,f.value._interpolationType),this.paint._values[u]=new nn(f.property,p,f.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(r,a,u){return!(!this.layout||a.isDataDriven()||u.isDataDriven())&&t.hasPaintOverride(this.layout,r)},t.hasPaintOverride=function(r,a){var u=r.get("text-field"),p=sh.paint.properties[a],f=!1,g=function(E){for(var I=0,z=E;I<z.length;I+=1)if(p.overrides&&p.overrides.hasOverride(z[I]))return void(f=!0)};if(u.value.kind==="constant"&&u.value.value instanceof oi)g(u.value.value.sections);else if(u.value.kind==="source"){var x=function(E){f||(E instanceof hn&&Yr(E.value)===At?g(E.value.sections):E instanceof Zi?g(E.sections):E.eachChild(x))},w=u.value;w._styleExpression&&x(w._styleExpression.expression)}return f},t}(gn),i_={paint:new Ki({"background-color":new Fe(F.paint_background["background-color"]),"background-pattern":new yn(F.paint_background["background-pattern"]),"background-opacity":new Fe(F.paint_background["background-opacity"])})},n_=function(e){function t(r){e.call(this,r,i_)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(gn),o_={paint:new Ki({"raster-opacity":new Fe(F.paint_raster["raster-opacity"]),"raster-hue-rotate":new Fe(F.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Fe(F.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Fe(F.paint_raster["raster-brightness-max"]),"raster-saturation":new Fe(F.paint_raster["raster-saturation"]),"raster-contrast":new Fe(F.paint_raster["raster-contrast"]),"raster-resampling":new Fe(F.paint_raster["raster-resampling"]),"raster-fade-duration":new Fe(F.paint_raster["raster-fade-duration"])})},a_=function(e){function t(r){e.call(this,r,o_)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(gn),s_=function(e){function t(r){e.call(this,r,{}),this.implementation=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},t.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},t}(gn),l_={circle:ol,heatmap:Gy,hillshade:Xy,fill:cg,"fill-extrusion":vg,line:Tg,symbol:r_,background:n_,raster:a_},id=fe.HTMLImageElement,nd=fe.HTMLCanvasElement,od=fe.HTMLVideoElement,ad=fe.ImageData,Rc=fe.ImageBitmap,ms=function(e,t,r,a){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(t,a)};ms.prototype.update=function(e,t,r){var a=e.width,u=e.height,p=!(this.size&&this.size[0]===a&&this.size[1]===u||r),f=this.context,g=f.gl;if(this.useMipmap=!!(t&&t.useMipmap),g.bindTexture(g.TEXTURE_2D,this.texture),f.pixelStoreUnpackFlipY.set(!1),f.pixelStoreUnpack.set(1),f.pixelStoreUnpackPremultiplyAlpha.set(this.format===g.RGBA&&(!t||t.premultiply!==!1)),p)this.size=[a,u],e instanceof id||e instanceof nd||e instanceof od||e instanceof ad||Rc&&e instanceof Rc?g.texImage2D(g.TEXTURE_2D,0,this.format,this.format,g.UNSIGNED_BYTE,e):g.texImage2D(g.TEXTURE_2D,0,this.format,a,u,0,this.format,g.UNSIGNED_BYTE,e.data);else{var x=r||{x:0,y:0},w=x.x,E=x.y;e instanceof id||e instanceof nd||e instanceof od||e instanceof ad||Rc&&e instanceof Rc?g.texSubImage2D(g.TEXTURE_2D,0,w,E,g.RGBA,g.UNSIGNED_BYTE,e):g.texSubImage2D(g.TEXTURE_2D,0,w,E,a,u,g.RGBA,g.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&g.generateMipmap(g.TEXTURE_2D)},ms.prototype.bind=function(e,t,r){var a=this.context.gl;a.bindTexture(a.TEXTURE_2D,this.texture),r!==a.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=a.LINEAR),e!==this.filter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,t),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,t),this.wrap=t)},ms.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},ms.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var lh=function(e){var t=this;this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};lh.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},lh.prototype.remove=function(){delete this._channel,this._callback=function(){}};var gl=function(e,t,r){this.target=e,this.parent=t,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},qr(["receive","process"],this),this.invoker=new lh(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Jt()?e:fe};function sd(e,t,r){var a=2*Math.PI*6378137/256/Math.pow(2,r);return[e*a-2*Math.PI*6378137/2,t*a-2*Math.PI*6378137/2]}gl.prototype.send=function(e,t,r,a,u){var p=this;u===void 0&&(u=!1);var f=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[f]=r);var g=pn(this.globalScope)?void 0:[];return this.target.postMessage({id:f,type:e,hasCallback:!!r,targetMapId:a,mustQueue:u,sourceMapId:this.mapId,data:Hi(t,g)},g),{cancel:function(){r&&delete p.callbacks[f],p.target.postMessage({id:f,type:"<cancel>",targetMapId:a,sourceMapId:p.mapId})}}},gl.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[r];var a=this.cancelCallbacks[r];delete this.cancelCallbacks[r],a&&a()}else Jt()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},gl.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},gl.prototype.processTask=function(e,t){var r=this;if(t.type==="<response>"){var a=this.callbacks[e];delete this.callbacks[e],a&&(t.error?a(os(t.error)):a(null,os(t.data)))}else{var u=!1,p=pn(this.globalScope)?void 0:[],f=t.hasCallback?function(E,I){u=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:E?Hi(E):null,data:Hi(I,p)},p)}:function(E){u=!0},g=null,x=os(t.data);if(this.parent[t.type])g=this.parent[t.type](t.sourceMapId,x,f);else if(this.parent.getWorkerSource){var w=t.type.split(".");g=this.parent.getWorkerSource(t.sourceMapId,w[0],x.source)[w[1]](x,f)}else f(new Error("Could not find function "+t.type));!u&&g&&g.cancel&&(this.cancelCallbacks[e]=g.cancel)}},gl.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Kr=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};Kr.prototype.setNorthEast=function(e){return this._ne=e instanceof xr?new xr(e.lng,e.lat):xr.convert(e),this},Kr.prototype.setSouthWest=function(e){return this._sw=e instanceof xr?new xr(e.lng,e.lat):xr.convert(e),this},Kr.prototype.extend=function(e){var t,r,a=this._sw,u=this._ne;if(e instanceof xr)t=e,r=e;else{if(!(e instanceof Kr))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Kr.convert(e)):this.extend(xr.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return a||u?(a.lng=Math.min(t.lng,a.lng),a.lat=Math.min(t.lat,a.lat),u.lng=Math.max(r.lng,u.lng),u.lat=Math.max(r.lat,u.lat)):(this._sw=new xr(t.lng,t.lat),this._ne=new xr(r.lng,r.lat)),this},Kr.prototype.getCenter=function(){return new xr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Kr.prototype.getSouthWest=function(){return this._sw},Kr.prototype.getNorthEast=function(){return this._ne},Kr.prototype.getNorthWest=function(){return new xr(this.getWest(),this.getNorth())},Kr.prototype.getSouthEast=function(){return new xr(this.getEast(),this.getSouth())},Kr.prototype.getWest=function(){return this._sw.lng},Kr.prototype.getSouth=function(){return this._sw.lat},Kr.prototype.getEast=function(){return this._ne.lng},Kr.prototype.getNorth=function(){return this._ne.lat},Kr.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Kr.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Kr.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Kr.prototype.contains=function(e){var t=xr.convert(e),r=t.lng,a=t.lat,u=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=a&&a<=this._ne.lat&&u},Kr.convert=function(e){return!e||e instanceof Kr?e:new Kr(e)};var xr=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};xr.prototype.wrap=function(){return new xr(Wt(this.lng,-180,180),this.lat)},xr.prototype.toArray=function(){return[this.lng,this.lat]},xr.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},xr.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,a=e.lat*t,u=Math.sin(r)*Math.sin(a)+Math.cos(r)*Math.cos(a)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(u,1))},xr.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new Kr(new xr(this.lng-r,this.lat-t),new xr(this.lng+r,this.lat+t))},xr.convert=function(e){if(e instanceof xr)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new xr(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new xr(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var ld=2*Math.PI*63710088e-1;function ud(e){return ld*Math.cos(e*Math.PI/180)}function cd(e){return(180+e)/360}function pd(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function hd(e,t){return e/ud(t)}function uh(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var ys=function(e,t,r){r===void 0&&(r=0),this.x=+e,this.y=+t,this.z=+r};ys.fromLngLat=function(e,t){t===void 0&&(t=0);var r=xr.convert(e);return new ys(cd(r.lng),pd(r.lat),hd(t,r.lat))},ys.prototype.toLngLat=function(){return new xr(360*this.x-180,uh(this.y))},ys.prototype.toAltitude=function(){return this.z*ud(uh(this.y))},ys.prototype.meterInMercatorCoordinateUnits=function(){return 1/ld*(e=uh(this.y),1/Math.cos(e*Math.PI/180));var e};var gs=function(e,t,r){this.z=e,this.x=t,this.y=r,this.key=xu(0,e,e,t,r)};gs.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},gs.prototype.url=function(e,t){var r,a,u,p,f,g=(a=this.y,u=this.z,p=sd(256*(r=this.x),256*(a=Math.pow(2,u)-a-1),u),f=sd(256*(r+1),256*(a+1),u),p[0]+","+p[1]+","+f[0]+","+f[1]),x=function(w,E,I){for(var z,L="",V=w;V>0;V--)L+=(E&(z=1<<V-1)?1:0)+(I&z?2:0);return L}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",x).replace("{bbox-epsg-3857}",g)},gs.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new se(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},gs.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var fd=function(e,t){this.wrap=e,this.canonical=t,this.key=xu(e,t.z,t.z,t.x,t.y)},$r=function(e,t,r,a,u){this.overscaledZ=e,this.wrap=t,this.canonical=new gs(r,+a,+u),this.key=xu(t,e,r,a,u)};function xu(e,t,r,a,u){(e*=2)<0&&(e=-1*e-1);var p=1<<r;return(p*p*e+p*u+a).toString(36)+r.toString(36)+t.toString(36)}$r.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},$r.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new $r(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new $r(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},$r.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?xu(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):xu(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)},$r.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},$r.prototype.children=function(e){if(this.overscaledZ>=e)return[new $r(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,a=2*this.canonical.y;return[new $r(t,this.wrap,t,r,a),new $r(t,this.wrap,t,r+1,a),new $r(t,this.wrap,t,r,a+1),new $r(t,this.wrap,t,r+1,a+1)]},$r.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},$r.prototype.wrapped=function(){return new $r(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},$r.prototype.unwrapTo=function(e){return new $r(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},$r.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},$r.prototype.toUnwrapped=function(){return new fd(this.wrap,this.canonical)},$r.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},$r.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new ys(e.x-this.wrap,e.y))},Ne("CanonicalTileID",gs),Ne("OverscaledTileID",$r,{omit:["posMatrix"]});var oa=function(e,t,r){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(r&&r!=="mapbox"&&r!=="terrarium")return vt('"'+r+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var a=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=r||"mapbox";for(var u=0;u<a;u++)this.data[this._idx(-1,u)]=this.data[this._idx(0,u)],this.data[this._idx(a,u)]=this.data[this._idx(a-1,u)],this.data[this._idx(u,-1)]=this.data[this._idx(u,0)],this.data[this._idx(u,a)]=this.data[this._idx(u,a-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(a,-1)]=this.data[this._idx(a-1,0)],this.data[this._idx(-1,a)]=this.data[this._idx(0,a-1)],this.data[this._idx(a,a)]=this.data[this._idx(a-1,a-1)]};oa.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),a=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(r[a],r[a+1],r[a+2])},oa.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},oa.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},oa.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},oa.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},oa.prototype.getPixels=function(){return new Ji({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},oa.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var a=t*this.dim,u=t*this.dim+this.dim,p=r*this.dim,f=r*this.dim+this.dim;switch(t){case-1:a=u-1;break;case 1:u=a+1}switch(r){case-1:p=f-1;break;case 1:f=p+1}for(var g=-t*this.dim,x=-r*this.dim,w=p;w<f;w++)for(var E=a;E<u;E++)this.data[this._idx(E,w)]=e.data[this._idx(E+g,w+x)]},Ne("DEMData",oa);var Bc=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}};Bc.prototype.encode=function(e){return this._stringToNumber[e]},Bc.prototype.decode=function(e){return this._numberToString[e]};var Oc=function(e,t,r,a,u){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=r,e._y=a,this.properties=e.properties,this.id=u},ch={geometry:{configurable:!0}};ch.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},ch.geometry.set=function(e){this._geometry=e},Oc.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(Oc.prototype,ch);var _l=function(){this.state={},this.stateChanges={},this.deletedStates={}};_l.prototype.updateState=function(e,t,r){var a=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][a]=this.stateChanges[e][a]||{},Pt(this.stateChanges[e][a],r),this.deletedStates[e]===null)for(var u in this.deletedStates[e]={},this.state[e])u!==a&&(this.deletedStates[e][u]=null);else if(this.deletedStates[e]&&this.deletedStates[e][a]===null)for(var p in this.deletedStates[e][a]={},this.state[e][a])r[p]||(this.deletedStates[e][a][p]=null);else for(var f in r)this.deletedStates[e]&&this.deletedStates[e][a]&&this.deletedStates[e][a][f]===null&&delete this.deletedStates[e][a][f]},_l.prototype.removeFeatureState=function(e,t,r){if(this.deletedStates[e]!==null){var a=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&t!==void 0)this.deletedStates[e][a]!==null&&(this.deletedStates[e][a]=this.deletedStates[e][a]||{},this.deletedStates[e][a][r]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][a])for(r in this.deletedStates[e][a]={},this.stateChanges[e][a])this.deletedStates[e][a][r]=null;else this.deletedStates[e][a]=null;else this.deletedStates[e]=null}},_l.prototype.getState=function(e,t){var r=String(t),a=Pt({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var u=this.deletedStates[e][t];if(u===null)return{};for(var p in u)delete a[p]}return a},_l.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},_l.prototype.coalesceChanges=function(e,t){var r={};for(var a in this.stateChanges){this.state[a]=this.state[a]||{};var u={};for(var p in this.stateChanges[a])this.state[a][p]||(this.state[a][p]={}),Pt(this.state[a][p],this.stateChanges[a][p]),u[p]=this.state[a][p];r[a]=u}for(var f in this.deletedStates){this.state[f]=this.state[f]||{};var g={};if(this.deletedStates[f]===null)for(var x in this.state[f])g[x]={},this.state[f][x]={};else for(var w in this.deletedStates[f]){if(this.deletedStates[f][w]===null)this.state[f][w]={};else for(var E=0,I=Object.keys(this.deletedStates[f][w]);E<I.length;E+=1)delete this.state[f][w][I[E]];g[w]=this.state[f][w]}r[f]=r[f]||{},Pt(r[f],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(var z in e)e[z].setFeatureState(r,t)};var aa=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new _i(8192,16,0),this.grid3D=new _i(8192,16,0),this.featureIndexArray=new D,this.promoteId=t};function dd(e,t,r,a,u){return ht(e,function(p,f){var g=t instanceof Qo?t.get(f):null;return g&&g.evaluate?g.evaluate(r,a,u):g})}function md(e){for(var t=1/0,r=1/0,a=-1/0,u=-1/0,p=0,f=e;p<f.length;p+=1){var g=f[p];t=Math.min(t,g.x),r=Math.min(r,g.y),a=Math.max(a,g.x),u=Math.max(u,g.y)}return{minX:t,minY:r,maxX:a,maxY:u}}function u_(e,t){return t-e}aa.prototype.insert=function(e,t,r,a,u,p){var f=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,a,u);for(var g=p?this.grid3D:this.grid,x=0;x<t.length;x++){for(var w=t[x],E=[1/0,1/0,-1/0,-1/0],I=0;I<w.length;I++){var z=w[I];E[0]=Math.min(E[0],z.x),E[1]=Math.min(E[1],z.y),E[2]=Math.max(E[2],z.x),E[3]=Math.max(E[3],z.y)}E[0]<8192&&E[1]<8192&&E[2]>=0&&E[3]>=0&&g.insert(f,E[0],E[1],E[2],E[3])}},aa.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new ll.VectorTile(new Tc(this.rawTileData)).layers,this.sourceLayerCoder=new Bc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},aa.prototype.query=function(e,t,r,a){var u=this;this.loadVTLayers();for(var p=e.params||{},f=8192/e.tileSize/e.scale,g=Zs(p.filter),x=e.queryGeometry,w=e.queryPadding*f,E=md(x),I=this.grid.query(E.minX-w,E.minY-w,E.maxX+w,E.maxY+w),z=md(e.cameraQueryGeometry),L=this.grid3D.query(z.minX-w,z.minY-w,z.maxX+w,z.maxY+w,function(ue,ce,ge,Ae){return function(ke,Ke,Re,Je,Be){for(var bt=0,at=ke;bt<at.length;bt+=1){var We=at[bt];if(Ke<=We.x&&Re<=We.y&&Je>=We.x&&Be>=We.y)return!0}var It=[new se(Ke,Re),new se(Ke,Be),new se(Je,Be),new se(Je,Re)];if(ke.length>2){for(var _t=0,Dt=It;_t<Dt.length;_t+=1)if(jn(ke,Dt[_t]))return!0}for(var tt=0;tt<ke.length-1;tt++)if(Aa(ke[tt],ke[tt+1],It))return!0;return!1}(e.cameraQueryGeometry,ue-w,ce-w,ge+w,Ae+w)}),V=0,N=L;V<N.length;V+=1)I.push(N[V]);I.sort(u_);for(var Q,W={},ne=function(ue){var ce=I[ue];if(ce!==Q){Q=ce;var ge=u.featureIndexArray.get(ce),Ae=null;u.loadMatchingFeature(W,ge.bucketIndex,ge.sourceLayerIndex,ge.featureIndex,g,p.layers,p.availableImages,t,r,a,function(ke,Ke,Re){return Ae||(Ae=Rr(ke)),Ke.queryIntersectsFeature(x,ke,Re,Ae,u.z,e.transform,f,e.pixelPosMatrix)})}},ae=0;ae<I.length;ae++)ne(ae);return W},aa.prototype.loadMatchingFeature=function(e,t,r,a,u,p,f,g,x,w,E){var I=this.bucketLayerIDs[t];if(!p||function(ke,Ke){for(var Re=0;Re<ke.length;Re++)if(Ke.indexOf(ke[Re])>=0)return!0;return!1}(p,I)){var z=this.sourceLayerCoder.decode(r),L=this.vtLayers[z].feature(a);if(u.needGeometry){var V=vi(L,!0);if(!u.filter(new Xt(this.tileID.overscaledZ),V,this.tileID.canonical))return}else if(!u.filter(new Xt(this.tileID.overscaledZ),L))return;for(var N=this.getId(L,z),Q=0;Q<I.length;Q++){var W=I[Q];if(!(p&&p.indexOf(W)<0)){var ne=g[W];if(ne){var ae={};N!==void 0&&w&&(ae=w.getState(ne.sourceLayer||"_geojsonTileLayer",N));var ue=Pt({},x[W]);ue.paint=dd(ue.paint,ne.paint,L,ae,f),ue.layout=dd(ue.layout,ne.layout,L,ae,f);var ce=!E||E(L,ne,ae);if(ce){var ge=new Oc(L,this.z,this.x,this.y,N);ge.layer=ue;var Ae=e[W];Ae===void 0&&(Ae=e[W]=[]),Ae.push({featureIndex:a,feature:ge,intersectionZ:ce})}}}}}},aa.prototype.lookupSymbolFeatures=function(e,t,r,a,u,p,f,g){var x={};this.loadVTLayers();for(var w=Zs(u),E=0,I=e;E<I.length;E+=1)this.loadMatchingFeature(x,r,a,I[E],w,p,f,g,t);return x},aa.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var a=0,u=r[t];a<u.length;a+=1)if(e===u[a])return!0;return!1},aa.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&typeof(r=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(r=Number(r)),r},Ne("FeatureIndex",aa,{omit:["rawTileData","sourceLayerCoder"]});var ui=function(e,t){this.tileID=e,this.uid=or(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};ui.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<en.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},ui.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},ui.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var a in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(w,E){var I={};if(!E)return I;for(var z=function(){var N=V[L],Q=N.layerIds.map(function(ae){return E.getLayer(ae)}).filter(Boolean);if(Q.length!==0){N.layers=Q,N.stateDependentLayerIds&&(N.stateDependentLayers=N.stateDependentLayerIds.map(function(ae){return Q.filter(function(ue){return ue.id===ae})[0]}));for(var W=0,ne=Q;W<ne.length;W+=1)I[ne[W].id]=N}},L=0,V=w;L<V.length;L+=1)z();return I}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var u=this.buckets[a];if(u instanceof Qt){if(this.hasSymbolBuckets=!0,!r)break;u.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var p in this.buckets){var f=this.buckets[p];if(f instanceof Qt&&f.hasRTLText){this.hasRTLText=!0,Er.isLoading()||Er.isLoaded()||Cn()!=="deferred"||vc();break}}for(var g in this.queryPadding=0,this.buckets){var x=this.buckets[g];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(g).queryRadius(x))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new n},ui.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},ui.prototype.getBucket=function(e){return this.buckets[e.id]},ui.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var a=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ms(e,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ms(e,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)},ui.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},ui.prototype.queryRenderedFeatures=function(e,t,r,a,u,p,f,g,x,w){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:a,cameraQueryGeometry:u,scale:p,tileSize:this.tileSize,pixelPosMatrix:w,transform:g,params:f,queryPadding:this.queryPadding*x},e,t,r):{}},ui.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var a=r.loadVTLayers(),u=t?t.sourceLayer:"",p=a._geojsonTileLayer||a[u];if(p)for(var f=Zs(t&&t.filter),g=this.tileID.canonical,x=g.z,w=g.x,E=g.y,I={z:x,x:w,y:E},z=0;z<p.length;z++){var L=p.feature(z);if(f.needGeometry){var V=vi(L,!0);if(!f.filter(new Xt(this.tileID.overscaledZ),V,this.tileID.canonical))continue}else if(!f.filter(new Xt(this.tileID.overscaledZ),L))continue;var N=r.getId(L,u),Q=new Oc(L,x,w,E,N);Q.tile=I,e.push(Q)}}},ui.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},ui.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},ui.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=ar(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var a=Date.now(),u=!1;if(this.expirationTime>a)u=!1;else if(t)if(this.expirationTime<t)u=!0;else{var p=this.expirationTime-t;p?this.expirationTime=a+Math.max(p,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},ui.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},ui.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var r=this.latestFeatureIndex.loadVTLayers();for(var a in this.buckets)if(t.style.hasLayer(a)){var u=this.buckets[a],p=u.layers[0].sourceLayer||"_geojsonTileLayer",f=r[p],g=e[p];if(f&&g&&Object.keys(g).length!==0){u.update(g,f,this.imageAtlas&&this.imageAtlas.patternPositions||{});var x=t&&t.style&&t.style.getLayer(a);x&&(this.queryPadding=Math.max(this.queryPadding,x.queryRadius(u)))}}}},ui.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},ui.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<en.now()},ui.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},ui.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=en.now()+e},ui.prototype.setDependencies=function(e,t){for(var r={},a=0,u=t;a<u.length;a+=1)r[u[a]]=!0;this.dependencies[e]=r},ui.prototype.hasDependency=function(e,t){for(var r=0,a=e;r<a.length;r+=1){var u=this.dependencies[a[r]];if(u){for(var p=0,f=t;p<f.length;p+=1)if(u[f[p]])return!0}}return!1};var za=fe.performance,yd=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},za.mark(this._marks.start)};yd.prototype.finish=function(){za.mark(this._marks.end);var e=za.getEntriesByName(this._marks.measure);return e.length===0&&(za.measure(this._marks.measure,this._marks.start,this._marks.end),e=za.getEntriesByName(this._marks.measure),za.clearMarks(this._marks.start),za.clearMarks(this._marks.end),za.clearMeasures(this._marks.measure)),e},l.Actor=gl,l.AlphaImage=ds,l.CanonicalTileID=gs,l.CollisionBoxArray=n,l.Color=kt,l.DEMData=oa,l.DataConstantProperty=Fe,l.DictionaryCoder=Bc,l.EXTENT=8192,l.ErrorEvent=re,l.EvaluationParameters=Xt,l.Event=ee,l.Evented=Y,l.FeatureIndex=aa,l.FillBucket=no,l.FillExtrusionBucket=oo,l.ImageAtlas=_u,l.ImagePosition=Cc,l.LineBucket=Vi,l.LngLat=xr,l.LngLatBounds=Kr,l.MercatorCoordinate=ys,l.ONE_EM=24,l.OverscaledTileID=$r,l.Point=se,l.Point$1=se,l.Properties=Ki,l.Protobuf=Tc,l.RGBAImage=Ji,l.RequestManager=ye,l.RequestPerformance=yd,l.ResourceType=Bo,l.SegmentVector=R,l.SourceFeatureState=_l,l.StructArrayLayout1ui2=rl,l.StructArrayLayout2f1f2i16=ou,l.StructArrayLayout2i4=as,l.StructArrayLayout3ui6=on,l.StructArrayLayout4i8=to,l.SymbolBucket=Qt,l.Texture=ms,l.Tile=ui,l.Transitionable=rn,l.Uniform1f=Se,l.Uniform1i=ze,l.Uniform2f=Ue,l.Uniform3f=Qe,l.Uniform4f=rt,l.UniformColor=et,l.UniformMatrix4f=Ze,l.UnwrappedTileID=fd,l.ValidationError=X,l.WritingMode=_n,l.ZoomHistory=Oi,l.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},l.addDynamicAttributes=ah,l.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var a=e.length,u=new Array(e.length),p=null;e.forEach(function(f,g){t(f,function(x,w){x&&(p=x),u[g]=w,--a==0&&r(p,u)})})},l.bezier=wt,l.bindAll=qr,l.browser=en,l.cacheEntryPossiblyAdded=function(e){++ni>Sn&&(e.getActor().send("enforceCacheSizeLimit",hi),ni=0)},l.clamp=Nt,l.clearTileCache=function(e){var t=fe.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},l.clipLine=Jf,l.clone=function(e){var t=new Mr(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},l.clone$1=Gt,l.clone$2=function(e){var t=new Mr(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},l.collisionCircleLayout=Pg,l.config=Ht,l.create=function(){var e=new Mr(16);return Mr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},l.create$1=function(){var e=new Mr(9);return Mr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},l.create$2=function(){var e=new Mr(4);return Mr!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},l.createCommonjsModule=J,l.createExpression=qs,l.createLayout=li,l.createStyleLayer=function(e){return e.type==="custom"?new s_(e):new l_[e.type](e)},l.cross=function(e,t,r){var a=t[0],u=t[1],p=t[2],f=r[0],g=r[1],x=r[2];return e[0]=u*x-p*g,e[1]=p*f-a*x,e[2]=a*g-u*f,e},l.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var a=0;a<t.length;a++)if(!e(t[a],r[a]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object"||Object.keys(t).length!==Object.keys(r).length)return!1;for(var u in t)if(!e(t[u],r[u]))return!1;return!0}return t===r},l.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},l.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},l.ease=Et,l.emitValidationErrors=is,l.endsWith=Pr,l.enforceCacheSizeLimit=function(e){Kn(),Ye&&Ye.then(function(t){t.keys().then(function(r){for(var a=0;a<r.length-e;a++)t.delete(r[a])})})},l.evaluateSizeForFeature=Gf,l.evaluateSizeForZoom=Hf,l.evaluateVariableOffset=ed,l.evented=ru,l.extend=Pt,l.featureFilter=Zs,l.filterObject=Vt,l.fromRotation=function(e,t){var r=Math.sin(t),a=Math.cos(t);return e[0]=a,e[1]=r,e[2]=0,e[3]=-r,e[4]=a,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},l.getAnchorAlignment=rh,l.getAnchorJustification=oh,l.getArrayBuffer=Ir,l.getImage=k,l.getJSON=function(e,t){return da(Pt(e,{type:"json"}),t)},l.getRTLTextPluginStatus=Cn,l.getReferrer=Oo,l.getVideo=function(e,t){var r,a,u=fe.document.createElement("video");u.muted=!0,u.onloadstart=function(){t(null,u)};for(var p=0;p<e.length;p++){var f=fe.document.createElement("source");r=e[p],a=void 0,(a=fe.document.createElement("a")).href=r,(a.protocol!==fe.document.location.protocol||a.host!==fe.document.location.host)&&(u.crossOrigin="Anonymous"),f.src=e[p],u.appendChild(f)}return{cancel:function(){}}},l.identity=Ci,l.invert=function(e,t){var r=t[0],a=t[1],u=t[2],p=t[3],f=t[4],g=t[5],x=t[6],w=t[7],E=t[8],I=t[9],z=t[10],L=t[11],V=t[12],N=t[13],Q=t[14],W=t[15],ne=r*g-a*f,ae=r*x-u*f,ue=r*w-p*f,ce=a*x-u*g,ge=a*w-p*g,Ae=u*w-p*x,ke=E*N-I*V,Ke=E*Q-z*V,Re=E*W-L*V,Je=I*Q-z*N,Be=I*W-L*N,bt=z*W-L*Q,at=ne*bt-ae*Be+ue*Je+ce*Re-ge*Ke+Ae*ke;return at?(e[0]=(g*bt-x*Be+w*Je)*(at=1/at),e[1]=(u*Be-a*bt-p*Je)*at,e[2]=(N*Ae-Q*ge+W*ce)*at,e[3]=(z*ge-I*Ae-L*ce)*at,e[4]=(x*Re-f*bt-w*Ke)*at,e[5]=(r*bt-u*Re+p*Ke)*at,e[6]=(Q*ue-V*Ae-W*ae)*at,e[7]=(E*Ae-z*ue+L*ae)*at,e[8]=(f*Be-g*Re+w*ke)*at,e[9]=(a*Re-r*Be-p*ke)*at,e[10]=(V*ge-N*ue+W*ne)*at,e[11]=(I*ue-E*ge-L*ne)*at,e[12]=(g*Ke-f*Je-x*ke)*at,e[13]=(r*Je-a*Ke+u*ke)*at,e[14]=(N*ae-V*ce-Q*ne)*at,e[15]=(E*ce-I*ae+z*ne)*at,e):null},l.isChar=qe,l.isMapboxURL=Te,l.keysDifference=function(e,t){var r=[];for(var a in e)a in t||r.push(a);return r},l.makeRequest=da,l.mapObject=ht,l.mercatorXfromLng=cd,l.mercatorYfromLat=pd,l.mercatorZfromAltitude=hd,l.mul=Gp,l.multiply=ps,l.mvt=ll,l.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},l.normalize=function(e,t){var r=t[0],a=t[1],u=t[2],p=r*r+a*a+u*u;return p>0&&(p=1/Math.sqrt(p)),e[0]=t[0]*p,e[1]=t[1]*p,e[2]=t[2]*p,e},l.number=Vr,l.offscreenCanvasSupported=Si,l.ortho=function(e,t,r,a,u,p,f){var g=1/(t-r),x=1/(a-u),w=1/(p-f);return e[0]=-2*g,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*x,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*w,e[11]=0,e[12]=(t+r)*g,e[13]=(u+a)*x,e[14]=(f+p)*w,e[15]=1,e},l.parseGlyphPBF=function(e){return new Tc(e).readFields(Vg,[])},l.pbf=Tc,l.performSymbolLayout=function(e,t,r,a,u,p,f){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var g=e.layers[0].layout,x=e.layers[0]._unevaluatedLayout._values,w={};if(e.textSizeData.kind==="composite"){var E=e.textSizeData,I=E.maxZoom;w.compositeTextSizes=[x["text-size"].possiblyEvaluate(new Xt(E.minZoom),f),x["text-size"].possiblyEvaluate(new Xt(I),f)]}if(e.iconSizeData.kind==="composite"){var z=e.iconSizeData,L=z.maxZoom;w.compositeIconSizes=[x["icon-size"].possiblyEvaluate(new Xt(z.minZoom),f),x["icon-size"].possiblyEvaluate(new Xt(L),f)]}w.layoutTextSize=x["text-size"].possiblyEvaluate(new Xt(e.zoom+1),f),w.layoutIconSize=x["icon-size"].possiblyEvaluate(new Xt(e.zoom+1),f),w.textMaxSize=x["text-size"].possiblyEvaluate(new Xt(18));for(var V=24*g.get("text-line-height"),N=g.get("text-rotation-alignment")==="map"&&g.get("symbol-placement")!=="point",Q=g.get("text-keep-upright"),W=g.get("text-size"),ne=function(){var ce=ue[ae],ge=g.get("text-font").evaluate(ce,{},f).join(","),Ae=W.evaluate(ce,{},f),ke=w.layoutTextSize.evaluate(ce,{},f),Ke=w.layoutIconSize.evaluate(ce,{},f),Re={horizontal:{},vertical:void 0},Je=ce.text,Be=[0,0];if(Je){var bt=Je.toString(),at=24*g.get("text-letter-spacing").evaluate(ce,{},f),We=function(zt){for(var ir=0,$t=zt;ir<$t.length;ir+=1)if(Ut=$t[ir].charCodeAt(0),qe.Arabic(Ut)||qe["Arabic Supplement"](Ut)||qe["Arabic Extended-A"](Ut)||qe["Arabic Presentation Forms-A"](Ut)||qe["Arabic Presentation Forms-B"](Ut))return!1;var Ut;return!0}(bt)?at:0,It=g.get("text-anchor").evaluate(ce,{},f),_t=g.get("text-variable-anchor");if(!_t){var Dt=g.get("text-radial-offset").evaluate(ce,{},f);Be=Dt?ed(It,[24*Dt,nh]):g.get("text-offset").evaluate(ce,{},f).map(function(zt){return 24*zt})}var tt=N?"center":g.get("text-justify").evaluate(ce,{},f),jt=g.get("symbol-placement"),br=jt==="point"?24*g.get("text-max-width").evaluate(ce,{},f):0,kr=function(){e.allowVerticalPlacement&&$s(bt)&&(Re.vertical=Ac(Je,t,r,u,ge,br,V,It,"left",We,Be,_n.vertical,!0,jt,ke,Ae))};if(!N&&_t){for(var Ar=tt==="auto"?_t.map(function(zt){return oh(zt)}):[tt],wr=!1,Lr=0;Lr<Ar.length;Lr++){var ti=Ar[Lr];if(!Re.horizontal[ti])if(wr)Re.horizontal[ti]=Re.horizontal[0];else{var ri=Ac(Je,t,r,u,ge,br,V,"center",ti,We,Be,_n.horizontal,!1,jt,ke,Ae);ri&&(Re.horizontal[ti]=ri,wr=ri.positionedLines.length===1)}}kr()}else{tt==="auto"&&(tt=oh(It));var Pi=Ac(Je,t,r,u,ge,br,V,It,tt,We,Be,_n.horizontal,!1,jt,ke,Ae);Pi&&(Re.horizontal[tt]=Pi),kr(),$s(bt)&&N&&Q&&(Re.vertical=Ac(Je,t,r,u,ge,br,V,It,tt,We,Be,_n.vertical,!1,jt,ke,Ae))}}var ci=void 0,zi=!1;if(ce.icon&&ce.icon.name){var Or=a[ce.icon.name];Or&&(ci=function(zt,ir,$t){var Ut=rh($t),Ni=ir[0]-zt.displaySize[0]*Ut.horizontalAlign,xi=ir[1]-zt.displaySize[1]*Ut.verticalAlign;return{image:zt,top:xi,bottom:xi+zt.displaySize[1],left:Ni,right:Ni+zt.displaySize[0]}}(u[ce.icon.name],g.get("icon-offset").evaluate(ce,{},f),g.get("icon-anchor").evaluate(ce,{},f)),zi=Or.sdf,e.sdfIcons===void 0?e.sdfIcons=Or.sdf:e.sdfIcons!==Or.sdf&&vt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Or.pixelRatio!==e.pixelRatio||g.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var pi=rd(Re.horizontal)||Re.vertical;e.iconsInText=!!pi&&pi.iconsInText,(pi||ci)&&function(zt,ir,$t,Ut,Ni,xi,gr,Nr,bi,qt,Co){var vn=xi.textMaxSize.evaluate(ir,{});vn===void 0&&(vn=gr);var Ao,Fr=zt.layers[0].layout,Po=Fr.get("icon-offset").evaluate(ir,{},Co),qn=rd($t.horizontal),vl=gr/24,_s=zt.tilePixelRatio*vl,xl=zt.tilePixelRatio*vn/24,sa=zt.tilePixelRatio*Nr,bl=zt.tilePixelRatio*Fr.get("symbol-spacing"),Fc=Fr.get("text-padding")*zt.tilePixelRatio,wl=Fr.get("icon-padding")*zt.tilePixelRatio,bu=Fr.get("text-max-angle")/180*Math.PI,Uc=Fr.get("text-rotation-alignment")==="map"&&Fr.get("symbol-placement")!=="point",Vc=Fr.get("icon-rotation-alignment")==="map"&&Fr.get("symbol-placement")!=="point",la=Fr.get("symbol-placement"),wu=bl/2,Sl=Fr.get("icon-text-fit");Ut&&Sl!=="none"&&(zt.allowVerticalPlacement&&$t.vertical&&(Ao=Zf(Ut,$t.vertical,Sl,Fr.get("icon-text-fit-padding"),Po,vl)),qn&&(Ut=Zf(Ut,qn,Sl,Fr.get("icon-text-fit-padding"),Po,vl)));var Ma=function(c_,zu){zu.x<0||zu.x>=8192||zu.y<0||zu.y>=8192||function(Ur,ao,p_,ka,dh,vd,Hc,zo,Xc,Mu,Wc,Kc,mh,xd,ku,bd,wd,Sd,Ed,Td,xn,$c,Id,Mo,h_){var Cd,xs,Al,Pl,zl,Ml=Ur.addToLineVertexArray(ao,p_),Ad=0,Pd=0,zd=0,Md=0,yh=-1,gh=-1,ua={},kd=K(""),_h=0,vh=0;if(zo._unevaluatedLayout.getValue("text-radial-offset")===void 0?(_h=(Cd=zo.layout.get("text-offset").evaluate(xn,{},Mo).map(function(Du){return 24*Du}))[0],vh=Cd[1]):(_h=24*zo.layout.get("text-radial-offset").evaluate(xn,{},Mo),vh=nh),Ur.allowVerticalPlacement&&ka.vertical){var Ld=zo.layout.get("text-rotate").evaluate(xn,{},Mo)+90;Pl=new Lc(Xc,ao,Mu,Wc,Kc,ka.vertical,mh,xd,ku,Ld),Hc&&(zl=new Lc(Xc,ao,Mu,Wc,Kc,Hc,wd,Sd,ku,Ld))}if(dh){var xh=zo.layout.get("icon-rotate").evaluate(xn,{}),Dd=zo.layout.get("icon-text-fit")!=="none",Rd=Yf(dh,xh,Id,Dd),bh=Hc?Yf(Hc,xh,Id,Dd):void 0;Al=new Lc(Xc,ao,Mu,Wc,Kc,dh,wd,Sd,!1,xh),Ad=4*Rd.length;var Bd=Ur.iconSizeData,Lu=null;Bd.kind==="source"?(Lu=[128*zo.layout.get("icon-size").evaluate(xn,{})])[0]>32640&&vt(Ur.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):Bd.kind==="composite"&&((Lu=[128*$c.compositeIconSizes[0].evaluate(xn,{},Mo),128*$c.compositeIconSizes[1].evaluate(xn,{},Mo)])[0]>32640||Lu[1]>32640)&&vt(Ur.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Ur.addSymbols(Ur.icon,Rd,Lu,Td,Ed,xn,!1,ao,Ml.lineStartIndex,Ml.lineLength,-1,Mo),yh=Ur.icon.placedSymbolArray.length-1,bh&&(Pd=4*bh.length,Ur.addSymbols(Ur.icon,bh,Lu,Td,Ed,xn,_n.vertical,ao,Ml.lineStartIndex,Ml.lineLength,-1,Mo),gh=Ur.icon.placedSymbolArray.length-1)}for(var Od in ka.horizontal){var Jc=ka.horizontal[Od];if(!xs){kd=K(Jc.text);var f_=zo.layout.get("text-rotate").evaluate(xn,{},Mo);xs=new Lc(Xc,ao,Mu,Wc,Kc,Jc,mh,xd,ku,f_)}var Fd=Jc.positionedLines.length===1;if(zd+=td(Ur,ao,Jc,vd,zo,ku,xn,bd,Ml,ka.vertical?_n.horizontal:_n.horizontalOnly,Fd?Object.keys(ka.horizontal):[Od],ua,yh,$c,Mo),Fd)break}ka.vertical&&(Md+=td(Ur,ao,ka.vertical,vd,zo,ku,xn,bd,Ml,_n.vertical,["vertical"],ua,gh,$c,Mo));var d_=xs?xs.boxStartIndex:Ur.collisionBoxArray.length,m_=xs?xs.boxEndIndex:Ur.collisionBoxArray.length,y_=Pl?Pl.boxStartIndex:Ur.collisionBoxArray.length,g_=Pl?Pl.boxEndIndex:Ur.collisionBoxArray.length,__=Al?Al.boxStartIndex:Ur.collisionBoxArray.length,v_=Al?Al.boxEndIndex:Ur.collisionBoxArray.length,x_=zl?zl.boxStartIndex:Ur.collisionBoxArray.length,b_=zl?zl.boxEndIndex:Ur.collisionBoxArray.length,ko=-1,Yc=function(Du,Vd){return Du&&Du.circleDiameter?Math.max(Du.circleDiameter,Vd):Vd};ko=Yc(xs,ko),ko=Yc(Pl,ko),ko=Yc(Al,ko);var Ud=(ko=Yc(zl,ko))>-1?1:0;Ud&&(ko*=h_/24),Ur.glyphOffsetArray.length>=Qt.MAX_GLYPHS&&vt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),xn.sortKey!==void 0&&Ur.addToSortKeyRanges(Ur.symbolInstances.length,xn.sortKey),Ur.symbolInstances.emplaceBack(ao.x,ao.y,ua.right>=0?ua.right:-1,ua.center>=0?ua.center:-1,ua.left>=0?ua.left:-1,ua.vertical||-1,yh,gh,kd,d_,m_,y_,g_,__,v_,x_,b_,Mu,zd,Md,Ad,Pd,Ud,0,mh,_h,vh,ko)}(zt,zu,c_,$t,Ut,Ni,Ao,zt.layers[0],zt.collisionBoxArray,ir.index,ir.sourceLayerIndex,zt.index,_s,Fc,Uc,bi,sa,wl,Vc,Po,ir,xi,qt,Co,gr)};if(la==="line")for(var El=0,Nc=Jf(ir.geometry,0,0,8192,8192);El<Nc.length;El+=1)for(var jc=Nc[El],Su=0,Eu=Xg(jc,bl,bu,$t.vertical||qn,Ut,24,xl,zt.overscaling,8192);Su<Eu.length;Su+=1){var qc=Eu[Su];qn&&Jg(zt,qn.text,wu,qc)||Ma(jc,qc)}else if(la==="line-center")for(var Tu=0,Iu=ir.geometry;Tu<Iu.length;Tu+=1){var Cu=Iu[Tu];if(Cu.length>1){var Zc=Hg(Cu,bu,$t.vertical||qn,Ut,24,xl);Zc&&Ma(Cu,Zc)}}else if(ir.type==="Polygon")for(var Tl=0,Gc=Jp(ir.geometry,0);Tl<Gc.length;Tl+=1){var Il=Gc[Tl],Au=Kg(Il,16);Ma(Il[0],new hl(Au.x,Au.y,0))}else if(ir.type==="LineString")for(var vs=0,Pu=ir.geometry;vs<Pu.length;vs+=1){var Cl=Pu[vs];Ma(Cl,new hl(Cl[0].x,Cl[0].y,0))}else if(ir.type==="Point")for(var ph=0,gd=ir.geometry;ph<gd.length;ph+=1)for(var hh=0,_d=gd[ph];hh<_d.length;hh+=1){var fh=_d[hh];Ma([fh],new hl(fh.x,fh.y,0))}}(e,ce,Re,ci,a,w,ke,Ke,Be,zi,f)},ae=0,ue=e.features;ae<ue.length;ae+=1)ne();p&&e.generateCollisionDebugBuffers()},l.perspective=function(e,t,r,a,u){var p,f=1/Math.tan(t/2);return e[0]=f/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,u!=null&&u!==1/0?(e[10]=(u+a)*(p=1/(a-u)),e[14]=2*u*a*p):(e[10]=-1,e[14]=-2*a),e},l.pick=function(e,t){for(var r={},a=0;a<t.length;a++){var u=t[a];u in e&&(r[u]=e[u])}return r},l.plugin=Er,l.polygonIntersectsPolygon=Ii,l.postMapLoadEvent=zr,l.postTurnstileEvent=sr,l.potpack=Vf,l.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],l.register=Ne,l.registerForPluginStateChange=function(e){return e({pluginStatus:Ui,pluginURL:So}),ru.on("pluginStateChange",e),e},l.renderColorRamp=bf,l.rotate=function(e,t,r){var a=t[0],u=t[1],p=t[2],f=t[3],g=Math.sin(r),x=Math.cos(r);return e[0]=a*x+p*g,e[1]=u*x+f*g,e[2]=a*-g+p*x,e[3]=u*-g+f*x,e},l.rotateX=function(e,t,r){var a=Math.sin(r),u=Math.cos(r),p=t[4],f=t[5],g=t[6],x=t[7],w=t[8],E=t[9],I=t[10],z=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=p*u+w*a,e[5]=f*u+E*a,e[6]=g*u+I*a,e[7]=x*u+z*a,e[8]=w*u-p*a,e[9]=E*u-f*a,e[10]=I*u-g*a,e[11]=z*u-x*a,e},l.rotateZ=function(e,t,r){var a=Math.sin(r),u=Math.cos(r),p=t[0],f=t[1],g=t[2],x=t[3],w=t[4],E=t[5],I=t[6],z=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=p*u+w*a,e[1]=f*u+E*a,e[2]=g*u+I*a,e[3]=x*u+z*a,e[4]=w*u-p*a,e[5]=E*u-f*a,e[6]=I*u-g*a,e[7]=z*u-x*a,e},l.scale=function(e,t,r){var a=r[0],u=r[1],p=r[2];return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e[4]=t[4]*u,e[5]=t[5]*u,e[6]=t[6]*u,e[7]=t[7]*u,e[8]=t[8]*p,e[9]=t[9]*p,e[10]=t[10]*p,e[11]=t[11]*p,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},l.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},l.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},l.setCacheLimits=function(e,t){hi=e,Sn=t},l.setRTLTextPlugin=function(e,t,r){if(r===void 0&&(r=!1),Ui==="deferred"||Ui==="loading"||Ui==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");So=en.resolveURL(e),Ui="deferred",eu=t,tu(),r||vc()},l.sphericalToCartesian=function(e){var t=e[0],r=e[1],a=e[2];return r+=90,r*=Math.PI/180,a*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(a),y:t*Math.sin(r)*Math.sin(a),z:t*Math.cos(a)}},l.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},l.styleSpec=F,l.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},l.symbolSize=Gg,l.transformMat3=function(e,t,r){var a=t[0],u=t[1],p=t[2];return e[0]=a*r[0]+u*r[3]+p*r[6],e[1]=a*r[1]+u*r[4]+p*r[7],e[2]=a*r[2]+u*r[5]+p*r[8],e},l.transformMat4=nl,l.translate=function(e,t,r){var a,u,p,f,g,x,w,E,I,z,L,V,N=r[0],Q=r[1],W=r[2];return t===e?(e[12]=t[0]*N+t[4]*Q+t[8]*W+t[12],e[13]=t[1]*N+t[5]*Q+t[9]*W+t[13],e[14]=t[2]*N+t[6]*Q+t[10]*W+t[14],e[15]=t[3]*N+t[7]*Q+t[11]*W+t[15]):(u=t[1],p=t[2],f=t[3],g=t[4],x=t[5],w=t[6],E=t[7],I=t[8],z=t[9],L=t[10],V=t[11],e[0]=a=t[0],e[1]=u,e[2]=p,e[3]=f,e[4]=g,e[5]=x,e[6]=w,e[7]=E,e[8]=I,e[9]=z,e[10]=L,e[11]=V,e[12]=a*N+g*Q+I*W+t[12],e[13]=u*N+x*Q+z*W+t[13],e[14]=p*N+w*Q+L*W+t[14],e[15]=f*N+E*Q+V*W+t[15]),e},l.triggerPluginCompletionEvent=Qs,l.uniqueId=or,l.validateCustomStyleLayer=function(e){var t=[],r=e.id;return r===void 0&&t.push({message:"layers."+r+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},l.validateLight=qp,l.validateStyle=ts,l.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},l.vectorTile=ll,l.version="1.15.3",l.warnOnce=vt,l.webpSupported=yi,l.window=fe,l.wrap=Wt}),P(["./shared"],function(l){function J(C){var M=typeof C;if(M==="number"||M==="boolean"||M==="string"||C==null)return JSON.stringify(C);if(Array.isArray(C)){for(var k="[",O=0,Z=C;O<Z.length;O+=1)k+=J(Z[O])+",";return k+"]"}for(var ee=Object.keys(C).sort(),re="{",Y=0;Y<ee.length;Y++)re+=JSON.stringify(ee[Y])+":"+J(C[ee[Y]])+",";return re+"}"}function U(C){for(var M="",k=0,O=l.refProperties;k<O.length;k+=1)M+="/"+J(C[O[k]]);return M}var he=function(C){this.keyCache={},C&&this.replace(C)};he.prototype.replace=function(C){this._layerConfigs={},this._layers={},this.update(C,[])},he.prototype.update=function(C,M){for(var k=this,O=0,Z=C;O<Z.length;O+=1){var ee=Z[O];this._layerConfigs[ee.id]=ee;var re=this._layers[ee.id]=l.createStyleLayer(ee);re._featureFilter=l.featureFilter(re.filter),this.keyCache[ee.id]&&delete this.keyCache[ee.id]}for(var Y=0,F=M;Y<F.length;Y+=1){var X=F[Y];delete this.keyCache[X],delete this._layerConfigs[X],delete this._layers[X]}this.familiesBySource={};for(var be=0,Me=function(De,xe){for(var yt={},gt=0;gt<De.length;gt++){var Xe=xe&&xe[De[gt].id]||U(De[gt]);xe&&(xe[De[gt].id]=Xe);var lr=yt[Xe];lr||(lr=yt[Xe]=[]),lr.push(De[gt])}var At=[];for(var hr in yt)At.push(yt[hr]);return At}(l.values(this._layerConfigs),this.keyCache);be<Me.length;be+=1){var le=Me[be].map(function(De){return k._layers[De.id]}),we=le[0];if(we.visibility!=="none"){var Ve=we.source||"",je=this.familiesBySource[Ve];je||(je=this.familiesBySource[Ve]={});var $e=we.sourceLayer||"_geojsonTileLayer",ve=je[$e];ve||(ve=je[$e]=[]),ve.push(le)}}};var se=function(C){var M={},k=[];for(var O in C){var Z=C[O],ee=M[O]={};for(var re in Z){var Y=Z[+re];if(Y&&Y.bitmap.width!==0&&Y.bitmap.height!==0){var F={x:0,y:0,w:Y.bitmap.width+2,h:Y.bitmap.height+2};k.push(F),ee[re]={rect:F,metrics:Y.metrics}}}}var X=l.potpack(k),be=new l.AlphaImage({width:X.w||1,height:X.h||1});for(var Me in C){var le=C[Me];for(var we in le){var Ve=le[+we];if(Ve&&Ve.bitmap.width!==0&&Ve.bitmap.height!==0){var je=M[Me][we].rect;l.AlphaImage.copy(Ve.bitmap,be,{x:0,y:0},{x:je.x+1,y:je.y+1},Ve.bitmap)}}}this.image=be,this.positions=M};l.register("GlyphAtlas",se);var Ee=function(C){this.tileID=new l.OverscaledTileID(C.tileID.overscaledZ,C.tileID.wrap,C.tileID.canonical.z,C.tileID.canonical.x,C.tileID.canonical.y),this.uid=C.uid,this.zoom=C.zoom,this.pixelRatio=C.pixelRatio,this.tileSize=C.tileSize,this.source=C.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=C.showCollisionBoxes,this.collectResourceTiming=!!C.collectResourceTiming,this.returnDependencies=!!C.returnDependencies,this.promoteId=C.promoteId};function fe(C,M,k){for(var O=new l.EvaluationParameters(M),Z=0,ee=C;Z<ee.length;Z+=1)ee[Z].recalculate(O,k)}function ft(C,M){var k=l.getArrayBuffer(C.request,function(O,Z,ee,re){O?M(O):Z&&M(null,{vectorTile:new l.vectorTile.VectorTile(new l.pbf(Z)),rawData:Z,cacheControl:ee,expires:re})});return function(){k.cancel(),M()}}Ee.prototype.parse=function(C,M,k,O,Z){var ee=this;this.status="parsing",this.data=C,this.collisionBoxArray=new l.CollisionBoxArray;var re=new l.DictionaryCoder(Object.keys(C.layers).sort()),Y=new l.FeatureIndex(this.tileID,this.promoteId);Y.bucketLayerIDs=[];var F,X,be,Me,le={},we={featureIndex:Y,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:k},Ve=M.familiesBySource[this.source];for(var je in Ve){var $e=C.layers[je];if($e){$e.version===1&&l.warnOnce('Vector tile source "'+this.source+'" layer "'+je+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var ve=re.encode(je),De=[],xe=0;xe<$e.length;xe++){var yt=$e.feature(xe),gt=Y.getId(yt,je);De.push({feature:yt,id:gt,index:xe,sourceLayerIndex:ve})}for(var Xe=0,lr=Ve[je];Xe<lr.length;Xe+=1){var At=lr[Xe],hr=At[0];hr.minzoom&&this.zoom<Math.floor(hr.minzoom)||hr.maxzoom&&this.zoom>=hr.maxzoom||hr.visibility!=="none"&&(fe(At,this.zoom,k),(le[hr.id]=hr.createBucket({index:Y.bucketLayerIDs.length,layers:At,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ve,sourceID:this.source})).populate(De,we,this.tileID.canonical),Y.bucketLayerIDs.push(At.map(function(cr){return cr.id})))}}}var yr=l.mapObject(we.glyphDependencies,function(cr){return Object.keys(cr).map(Number)});Object.keys(yr).length?O.send("getGlyphs",{uid:this.uid,stacks:yr},function(cr,Tt){F||(F=cr,X=Tt,Cr.call(ee))}):X={};var Bt=Object.keys(we.iconDependencies);Bt.length?O.send("getImages",{icons:Bt,source:this.source,tileID:this.tileID,type:"icons"},function(cr,Tt){F||(F=cr,be=Tt,Cr.call(ee))}):be={};var ur=Object.keys(we.patternDependencies);function Cr(){if(F)return Z(F);if(X&&be&&Me){var cr=new se(X),Tt=new l.ImageAtlas(be,Me);for(var ma in le){var kt=le[ma];kt instanceof l.SymbolBucket?(fe(kt.layers,this.zoom,k),l.performSymbolLayout(kt,X,cr.positions,be,Tt.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):kt.hasPattern&&(kt instanceof l.LineBucket||kt instanceof l.FillBucket||kt instanceof l.FillExtrusionBucket)&&(fe(kt.layers,this.zoom,k),kt.addFeatures(we,this.tileID.canonical,Tt.patternPositions))}this.status="done",Z(null,{buckets:l.values(le).filter(function(Vo){return!Vo.isEmpty()}),featureIndex:Y,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:cr.image,imageAtlas:Tt,glyphMap:this.returnDependencies?X:null,iconMap:this.returnDependencies?be:null,glyphPositions:this.returnDependencies?cr.positions:null})}}ur.length?O.send("getImages",{icons:ur,source:this.source,tileID:this.tileID,type:"patterns"},function(cr,Tt){F||(F=cr,Me=Tt,Cr.call(ee))}):Me={},Cr.call(this)};var wt=function(C,M,k,O){this.actor=C,this.layerIndex=M,this.availableImages=k,this.loadVectorData=O||ft,this.loading={},this.loaded={}};wt.prototype.loadTile=function(C,M){var k=this,O=C.uid;this.loading||(this.loading={});var Z=!!(C&&C.request&&C.request.collectResourceTiming)&&new l.RequestPerformance(C.request),ee=this.loading[O]=new Ee(C);ee.abort=this.loadVectorData(C,function(re,Y){if(delete k.loading[O],re||!Y)return ee.status="done",k.loaded[O]=ee,M(re);var F=Y.rawData,X={};Y.expires&&(X.expires=Y.expires),Y.cacheControl&&(X.cacheControl=Y.cacheControl);var be={};if(Z){var Me=Z.finish();Me&&(be.resourceTiming=JSON.parse(JSON.stringify(Me)))}ee.vectorTile=Y.vectorTile,ee.parse(Y.vectorTile,k.layerIndex,k.availableImages,k.actor,function(le,we){if(le||!we)return M(le);M(null,l.extend({rawTileData:F.slice(0)},we,X,be))}),k.loaded=k.loaded||{},k.loaded[O]=ee})},wt.prototype.reloadTile=function(C,M){var k=this,O=this.loaded,Z=C.uid,ee=this;if(O&&O[Z]){var re=O[Z];re.showCollisionBoxes=C.showCollisionBoxes;var Y=function(F,X){var be=re.reloadCallback;be&&(delete re.reloadCallback,re.parse(re.vectorTile,ee.layerIndex,k.availableImages,ee.actor,be)),M(F,X)};re.status==="parsing"?re.reloadCallback=Y:re.status==="done"&&(re.vectorTile?re.parse(re.vectorTile,this.layerIndex,this.availableImages,this.actor,Y):Y())}},wt.prototype.abortTile=function(C,M){var k=this.loading,O=C.uid;k&&k[O]&&k[O].abort&&(k[O].abort(),delete k[O]),M()},wt.prototype.removeTile=function(C,M){var k=this.loaded,O=C.uid;k&&k[O]&&delete k[O],M()};var Et=l.window.ImageBitmap,Nt=function(){this.loaded={}};function Wt(C,M){if(C.length!==0){Pt(C[0],M);for(var k=1;k<C.length;k++)Pt(C[k],!M)}}function Pt(C,M){for(var k=0,O=0,Z=C.length,ee=Z-1;O<Z;ee=O++)k+=(C[O][0]-C[ee][0])*(C[ee][1]+C[O][1]);k>=0!=!!M&&C.reverse()}Nt.prototype.loadTile=function(C,M){var k=C.uid,O=C.encoding,Z=C.rawImageData,ee=Et&&Z instanceof Et?this.getImageData(Z):Z,re=new l.DEMData(k,ee,O);this.loaded=this.loaded||{},this.loaded[k]=re,M(null,re)},Nt.prototype.getImageData=function(C){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(C.width,C.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=C.width,this.offscreenCanvas.height=C.height,this.offscreenCanvasContext.drawImage(C,0,0,C.width,C.height);var M=this.offscreenCanvasContext.getImageData(-1,-1,C.width+2,C.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new l.RGBAImage({width:M.width,height:M.height},M.data)},Nt.prototype.removeTile=function(C){var M=this.loaded,k=C.uid;M&&M[k]&&delete M[k]};var Rt=l.vectorTile.VectorTileFeature.prototype.toGeoJSON,or=function(C){this._feature=C,this.extent=l.EXTENT,this.type=C.type,this.properties=C.tags,"id"in C&&!isNaN(C.id)&&(this.id=parseInt(C.id,10))};or.prototype.loadGeometry=function(){if(this._feature.type===1){for(var C=[],M=0,k=this._feature.geometry;M<k.length;M+=1){var O=k[M];C.push([new l.Point$1(O[0],O[1])])}return C}for(var Z=[],ee=0,re=this._feature.geometry;ee<re.length;ee+=1){for(var Y=[],F=0,X=re[ee];F<X.length;F+=1){var be=X[F];Y.push(new l.Point$1(be[0],be[1]))}Z.push(Y)}return Z},or.prototype.toGeoJSON=function(C,M,k){return Rt.call(this,C,M,k)};var pr=function(C){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=C.length,this._features=C};pr.prototype.feature=function(C){return new or(this._features[C])};var xt=l.vectorTile.VectorTileFeature,qr=Pr;function Pr(C,M){this.options=M||{},this.features=C,this.length=C.length}function ht(C,M){this.id=typeof C.id=="number"?C.id:void 0,this.type=C.type,this.rawGeometry=C.type===1?[C.geometry]:C.geometry,this.properties=C.tags,this.extent=M||4096}Pr.prototype.feature=function(C){return new ht(this.features[C],this.options.extent)},ht.prototype.loadGeometry=function(){var C=this.rawGeometry;this.geometry=[];for(var M=0;M<C.length;M++){for(var k=C[M],O=[],Z=0;Z<k.length;Z++)O.push(new l.Point$1(k[Z][0],k[Z][1]));this.geometry.push(O)}return this.geometry},ht.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var C=this.geometry,M=1/0,k=-1/0,O=1/0,Z=-1/0,ee=0;ee<C.length;ee++)for(var re=C[ee],Y=0;Y<re.length;Y++){var F=re[Y];M=Math.min(M,F.x),k=Math.max(k,F.x),O=Math.min(O,F.y),Z=Math.max(Z,F.y)}return[M,O,k,Z]},ht.prototype.toGeoJSON=xt.prototype.toGeoJSON;var Vt=ot,Gt=qr;function ot(C){var M=new l.pbf;return function(k,O){for(var Z in k.layers)O.writeMessage(3,vt,k.layers[Z])}(C,M),M.finish()}function vt(C,M){var k;M.writeVarintField(15,C.version||1),M.writeStringField(1,C.name||""),M.writeVarintField(5,C.extent||4096);var O={keys:[],values:[],keycache:{},valuecache:{}};for(k=0;k<C.length;k++)O.feature=C.feature(k),M.writeMessage(2,er,O);var Z=O.keys;for(k=0;k<Z.length;k++)M.writeStringField(3,Z[k]);var ee=O.values;for(k=0;k<ee.length;k++)M.writeMessage(4,pn,ee[k])}function er(C,M){var k=C.feature;k.id!==void 0&&M.writeVarintField(1,k.id),M.writeMessage(2,cn,C),M.writeVarintField(3,k.type),M.writeMessage(4,Kt,k)}function cn(C,M){var k=C.feature,O=C.keys,Z=C.values,ee=C.keycache,re=C.valuecache;for(var Y in k.properties){var F=ee[Y];F===void 0&&(O.push(Y),ee[Y]=F=O.length-1),M.writeVarint(F);var X=k.properties[Y],be=typeof X;be!=="string"&&be!=="boolean"&&be!=="number"&&(X=JSON.stringify(X));var Me=be+":"+X,le=re[Me];le===void 0&&(Z.push(X),re[Me]=le=Z.length-1),M.writeVarint(le)}}function Jt(C,M){return(M<<3)+(7&C)}function ar(C){return C<<1^C>>31}function Kt(C,M){for(var k=C.loadGeometry(),O=C.type,Z=0,ee=0,re=k.length,Y=0;Y<re;Y++){var F=k[Y],X=1;O===1&&(X=F.length),M.writeVarint(Jt(1,X));for(var be=O===3?F.length-1:F.length,Me=0;Me<be;Me++){Me===1&&O!==1&&M.writeVarint(Jt(2,be-1));var le=F[Me].x-Z,we=F[Me].y-ee;M.writeVarint(ar(le)),M.writeVarint(ar(we)),Z+=le,ee+=we}O===3&&M.writeVarint(Jt(7,1))}}function pn(C,M){var k=typeof C;k==="string"?M.writeStringField(1,C):k==="boolean"?M.writeBooleanField(7,C):k==="number"&&(C%1!=0?M.writeDoubleField(3,C):C<0?M.writeSVarintField(6,C):M.writeVarintField(5,C))}function Qi(C,M,k,O){ii(C,k,O),ii(M,2*k,2*O),ii(M,2*k+1,2*O+1)}function ii(C,M,k){var O=C[M];C[M]=C[k],C[k]=O}function Zr(C,M,k,O){var Z=C-k,ee=M-O;return Z*Z+ee*ee}Vt.fromVectorTileJs=ot,Vt.fromGeojsonVt=function(C,M){M=M||{};var k={};for(var O in C)k[O]=new qr(C[O].features,M),k[O].name=O,k[O].version=M.version,k[O].extent=M.extent;return ot({layers:k})},Vt.GeoJSONWrapper=Gt;var Ln=function(C){return C[0]},Xn=function(C){return C[1]},Dn=function(C,M,k,O,Z){M===void 0&&(M=Ln),k===void 0&&(k=Xn),O===void 0&&(O=64),Z===void 0&&(Z=Float64Array),this.nodeSize=O,this.points=C;for(var ee=C.length<65536?Uint16Array:Uint32Array,re=this.ids=new ee(C.length),Y=this.coords=new Z(2*C.length),F=0;F<C.length;F++)re[F]=F,Y[2*F]=M(C[F]),Y[2*F+1]=k(C[F]);(function X(be,Me,le,we,Ve,je){if(!(Ve-we<=le)){var $e=we+Ve>>1;(function ve(De,xe,yt,gt,Xe,lr){for(;Xe>gt;){if(Xe-gt>600){var At=Xe-gt+1,hr=yt-gt+1,yr=Math.log(At),Bt=.5*Math.exp(2*yr/3),ur=.5*Math.sqrt(yr*Bt*(At-Bt)/At)*(hr-At/2<0?-1:1);ve(De,xe,yt,Math.max(gt,Math.floor(yt-hr*Bt/At+ur)),Math.min(Xe,Math.floor(yt+(At-hr)*Bt/At+ur)),lr)}var Cr=xe[2*yt+lr],cr=gt,Tt=Xe;for(Qi(De,xe,gt,yt),xe[2*Xe+lr]>Cr&&Qi(De,xe,gt,Xe);cr<Tt;){for(Qi(De,xe,cr,Tt),cr++,Tt--;xe[2*cr+lr]<Cr;)cr++;for(;xe[2*Tt+lr]>Cr;)Tt--}xe[2*gt+lr]===Cr?Qi(De,xe,gt,Tt):Qi(De,xe,++Tt,Xe),Tt<=yt&&(gt=Tt+1),yt<=Tt&&(Xe=Tt-1)}})(be,Me,$e,we,Ve,je%2),X(be,Me,le,we,$e-1,je+1),X(be,Me,le,$e+1,Ve,je+1)}})(re,Y,O,0,re.length-1,0)};Dn.prototype.range=function(C,M,k,O){return function(Z,ee,re,Y,F,X,be){for(var Me,le,we=[0,Z.length-1,0],Ve=[];we.length;){var je=we.pop(),$e=we.pop(),ve=we.pop();if($e-ve<=be)for(var De=ve;De<=$e;De++)le=ee[2*De+1],(Me=ee[2*De])>=re&&Me<=F&&le>=Y&&le<=X&&Ve.push(Z[De]);else{var xe=Math.floor((ve+$e)/2);le=ee[2*xe+1],(Me=ee[2*xe])>=re&&Me<=F&&le>=Y&&le<=X&&Ve.push(Z[xe]);var yt=(je+1)%2;(je===0?re<=Me:Y<=le)&&(we.push(ve),we.push(xe-1),we.push(yt)),(je===0?F>=Me:X>=le)&&(we.push(xe+1),we.push($e),we.push(yt))}}return Ve}(this.ids,this.coords,C,M,k,O,this.nodeSize)},Dn.prototype.within=function(C,M,k){return function(O,Z,ee,re,Y,F){for(var X=[0,O.length-1,0],be=[],Me=Y*Y;X.length;){var le=X.pop(),we=X.pop(),Ve=X.pop();if(we-Ve<=F)for(var je=Ve;je<=we;je++)Zr(Z[2*je],Z[2*je+1],ee,re)<=Me&&be.push(O[je]);else{var $e=Math.floor((Ve+we)/2),ve=Z[2*$e],De=Z[2*$e+1];Zr(ve,De,ee,re)<=Me&&be.push(O[$e]);var xe=(le+1)%2;(le===0?ee-Y<=ve:re-Y<=De)&&(X.push(Ve),X.push($e-1),X.push(xe)),(le===0?ee+Y>=ve:re+Y>=De)&&(X.push($e+1),X.push(we),X.push(xe))}}return be}(this.ids,this.coords,C,M,k,this.nodeSize)};var Wn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(C){return C}},Gr=function(C){this.options=ie(Object.create(Wn),C),this.trees=new Array(this.options.maxZoom+1)};function en(C,M,k,O,Z){return{x:C,y:M,zoom:1/0,id:k,parentId:-1,numPoints:O,properties:Z}}function Ht(C,M){var k=C.geometry.coordinates,O=k[1];return{x:Li(k[0]),y:H(O),zoom:1/0,index:M,parentId:-1}}function yi(C){return{type:"Feature",id:C.id,properties:Rn(C),geometry:{type:"Point",coordinates:[(O=C.x,360*(O-.5)),(M=C.y,k=(180-360*M)*Math.PI/180,360*Math.atan(Math.exp(k))/Math.PI-90)]}};var M,k,O}function Rn(C){var M=C.numPoints,k=M>=1e4?Math.round(M/1e3)+"k":M>=1e3?Math.round(M/100)/10+"k":M;return ie(ie({},C.properties),{cluster:!0,cluster_id:C.id,point_count:M,point_count_abbreviated:k})}function Li(C){return C/360+.5}function H(C){var M=Math.sin(C*Math.PI/180),k=.5-.25*Math.log((1+M)/(1-M))/Math.PI;return k<0?0:k>1?1:k}function ie(C,M){for(var k in M)C[k]=M[k];return C}function ye(C){return C.x}function Te(C){return C.y}function Ie(C,M,k,O,Z,ee){var re=Z-k,Y=ee-O;if(re!==0||Y!==0){var F=((C-k)*re+(M-O)*Y)/(re*re+Y*Y);F>1?(k=Z,O=ee):F>0&&(k+=re*F,O+=Y*F)}return(re=C-k)*re+(Y=M-O)*Y}function Ce(C,M,k,O){var Z={id:C===void 0?null:C,type:M,geometry:k,tags:O,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ee){var re=ee.geometry,Y=ee.type;if(Y==="Point"||Y==="MultiPoint"||Y==="LineString")Ge(ee,re);else if(Y==="Polygon"||Y==="MultiLineString")for(var F=0;F<re.length;F++)Ge(ee,re[F]);else if(Y==="MultiPolygon")for(F=0;F<re.length;F++)for(var X=0;X<re[F].length;X++)Ge(ee,re[F][X])}(Z),Z}function Ge(C,M){for(var k=0;k<M.length;k+=3)C.minX=Math.min(C.minX,M[k]),C.minY=Math.min(C.minY,M[k+1]),C.maxX=Math.max(C.maxX,M[k]),C.maxY=Math.max(C.maxY,M[k+1])}function Le(C,M,k,O){if(M.geometry){var Z=M.geometry.coordinates,ee=M.geometry.type,re=Math.pow(k.tolerance/((1<<k.maxZoom)*k.extent),2),Y=[],F=M.id;if(k.promoteId?F=M.properties[k.promoteId]:k.generateId&&(F=O||0),ee==="Point")Oe(Z,Y);else if(ee==="MultiPoint")for(var X=0;X<Z.length;X++)Oe(Z[X],Y);else if(ee==="LineString")Pe(Z,Y,re,!1);else if(ee==="MultiLineString"){if(k.lineMetrics){for(X=0;X<Z.length;X++)Pe(Z[X],Y=[],re,!1),C.push(Ce(F,"LineString",Y,M.properties));return}He(Z,Y,re,!1)}else if(ee==="Polygon")He(Z,Y,re,!0);else{if(ee!=="MultiPolygon"){if(ee==="GeometryCollection"){for(X=0;X<M.geometry.geometries.length;X++)Le(C,{id:F,geometry:M.geometry.geometries[X],properties:M.properties},k,O);return}throw new Error("Input data is not a valid GeoJSON object.")}for(X=0;X<Z.length;X++){var be=[];He(Z[X],be,re,!0),Y.push(be)}}C.push(Ce(F,ee,Y,M.properties))}}function Oe(C,M){M.push(Ye(C[0])),M.push(it(C[1])),M.push(0)}function Pe(C,M,k,O){for(var Z,ee,re=0,Y=0;Y<C.length;Y++){var F=Ye(C[Y][0]),X=it(C[Y][1]);M.push(F),M.push(X),M.push(0),Y>0&&(re+=O?(Z*X-F*ee)/2:Math.sqrt(Math.pow(F-Z,2)+Math.pow(X-ee,2))),Z=F,ee=X}var be=M.length-3;M[2]=1,function Me(le,we,Ve,je){for(var $e,ve=je,De=Ve-we>>1,xe=Ve-we,yt=le[we],gt=le[we+1],Xe=le[Ve],lr=le[Ve+1],At=we+3;At<Ve;At+=3){var hr=Ie(le[At],le[At+1],yt,gt,Xe,lr);if(hr>ve)$e=At,ve=hr;else if(hr===ve){var yr=Math.abs(At-De);yr<xe&&($e=At,xe=yr)}}ve>je&&($e-we>3&&Me(le,we,$e,je),le[$e+2]=ve,Ve-$e>3&&Me(le,$e,Ve,je))}(M,0,be,k),M[be+2]=1,M.size=Math.abs(re),M.start=0,M.end=M.size}function He(C,M,k,O){for(var Z=0;Z<C.length;Z++){var ee=[];Pe(C[Z],ee,k,O),M.push(ee)}}function Ye(C){return C/360+.5}function it(C){var M=Math.sin(C*Math.PI/180),k=.5-.25*Math.log((1+M)/(1-M))/Math.PI;return k<0?0:k>1?1:k}function ut(C,M,k,O,Z,ee,re,Y){if(O/=M,ee>=(k/=M)&&re<O)return C;if(re<k||ee>=O)return null;for(var F=[],X=0;X<C.length;X++){var be=C[X],Me=be.geometry,le=be.type,we=Z===0?be.minX:be.minY,Ve=Z===0?be.maxX:be.maxY;if(we>=k&&Ve<O)F.push(be);else if(!(Ve<k||we>=O)){var je=[];if(le==="Point"||le==="MultiPoint")Mt(Me,je,k,O,Z);else if(le==="LineString")sr(Me,je,k,O,Z,!1,Y.lineMetrics);else if(le==="MultiLineString")zr(Me,je,k,O,Z,!1);else if(le==="Polygon")zr(Me,je,k,O,Z,!0);else if(le==="MultiPolygon")for(var $e=0;$e<Me.length;$e++){var ve=[];zr(Me[$e],ve,k,O,Z,!0),ve.length&&je.push(ve)}if(je.length){if(Y.lineMetrics&&le==="LineString"){for($e=0;$e<je.length;$e++)F.push(Ce(be.id,le,je[$e],be.tags));continue}le!=="LineString"&&le!=="MultiLineString"||(je.length===1?(le="LineString",je=je[0]):le="MultiLineString"),le!=="Point"&&le!=="MultiPoint"||(le=je.length===3?"Point":"MultiPoint"),F.push(Ce(be.id,le,je,be.tags))}}}return F.length?F:null}function Mt(C,M,k,O,Z){for(var ee=0;ee<C.length;ee+=3){var re=C[ee+Z];re>=k&&re<=O&&(M.push(C[ee]),M.push(C[ee+1]),M.push(C[ee+2]))}}function sr(C,M,k,O,Z,ee,re){for(var Y,F,X=Zt(C),be=Z===0?Sn:Kn,Me=C.start,le=0;le<C.length-3;le+=3){var we=C[le],Ve=C[le+1],je=C[le+2],$e=C[le+3],ve=C[le+4],De=Z===0?we:Ve,xe=Z===0?$e:ve,yt=!1;re&&(Y=Math.sqrt(Math.pow(we-$e,2)+Math.pow(Ve-ve,2))),De<k?xe>k&&(F=be(X,we,Ve,$e,ve,k),re&&(X.start=Me+Y*F)):De>O?xe<O&&(F=be(X,we,Ve,$e,ve,O),re&&(X.start=Me+Y*F)):hi(X,we,Ve,je),xe<k&&De>=k&&(F=be(X,we,Ve,$e,ve,k),yt=!0),xe>O&&De<=O&&(F=be(X,we,Ve,$e,ve,O),yt=!0),!ee&&yt&&(re&&(X.end=Me+Y*F),M.push(X),X=Zt(C)),re&&(Me+=Y)}var gt=C.length-3;we=C[gt],Ve=C[gt+1],je=C[gt+2],(De=Z===0?we:Ve)>=k&&De<=O&&hi(X,we,Ve,je),gt=X.length-3,ee&&gt>=3&&(X[gt]!==X[0]||X[gt+1]!==X[1])&&hi(X,X[0],X[1],X[2]),X.length&&M.push(X)}function Zt(C){var M=[];return M.size=C.size,M.start=C.start,M.end=C.end,M}function zr(C,M,k,O,Z,ee){for(var re=0;re<C.length;re++)sr(C[re],M,k,O,Z,ee,!1)}function hi(C,M,k,O){C.push(M),C.push(k),C.push(O)}function Sn(C,M,k,O,Z,ee){var re=(ee-M)/(O-M);return C.push(ee),C.push(k+(Z-k)*re),C.push(1),re}function Kn(C,M,k,O,Z,ee){var re=(ee-k)/(Z-k);return C.push(M+(O-M)*re),C.push(ee),C.push(1),re}function En(C,M){for(var k=[],O=0;O<C.length;O++){var Z,ee=C[O],re=ee.type;if(re==="Point"||re==="MultiPoint"||re==="LineString")Z=Bn(ee.geometry,M);else if(re==="MultiLineString"||re==="Polygon"){Z=[];for(var Y=0;Y<ee.geometry.length;Y++)Z.push(Bn(ee.geometry[Y],M))}else if(re==="MultiPolygon")for(Z=[],Y=0;Y<ee.geometry.length;Y++){for(var F=[],X=0;X<ee.geometry[Y].length;X++)F.push(Bn(ee.geometry[Y][X],M));Z.push(F)}k.push(Ce(ee.id,re,Z,ee.tags))}return k}function Bn(C,M){var k=[];k.size=C.size,C.start!==void 0&&(k.start=C.start,k.end=C.end);for(var O=0;O<C.length;O+=3)k.push(C[O]+M,C[O+1],C[O+2]);return k}function ni(C,M){if(C.transformed)return C;var k,O,Z,ee=1<<C.z,re=C.x,Y=C.y;for(k=0;k<C.features.length;k++){var F=C.features[k],X=F.geometry,be=F.type;if(F.geometry=[],be===1)for(O=0;O<X.length;O+=2)F.geometry.push(Si(X[O],X[O+1],M,ee,re,Y));else for(O=0;O<X.length;O++){var Me=[];for(Z=0;Z<X[O].length;Z+=2)Me.push(Si(X[O][Z],X[O][Z+1],M,ee,re,Y));F.geometry.push(Me)}}return C.transformed=!0,C}function Si(C,M,k,O,Z,ee){return[Math.round(k*(C*O-Z)),Math.round(k*(M*O-ee))]}function Bo(C,M,k,O,Z){for(var ee=M===Z.maxZoom?0:Z.tolerance/((1<<M)*Z.extent),re={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:k,y:O,z:M,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Y=0;Y<C.length;Y++){re.numFeatures++,Ms(re,C[Y],ee,Z);var F=C[Y].minX,X=C[Y].minY,be=C[Y].maxX,Me=C[Y].maxY;F<re.minX&&(re.minX=F),X<re.minY&&(re.minY=X),be>re.maxX&&(re.maxX=be),Me>re.maxY&&(re.maxY=Me)}return re}function Ms(C,M,k,O){var Z=M.geometry,ee=M.type,re=[];if(ee==="Point"||ee==="MultiPoint")for(var Y=0;Y<Z.length;Y+=3)re.push(Z[Y]),re.push(Z[Y+1]),C.numPoints++,C.numSimplified++;else if(ee==="LineString")Oo(re,Z,C,k,!1,!1);else if(ee==="MultiLineString"||ee==="Polygon")for(Y=0;Y<Z.length;Y++)Oo(re,Z[Y],C,k,ee==="Polygon",Y===0);else if(ee==="MultiPolygon")for(var F=0;F<Z.length;F++){var X=Z[F];for(Y=0;Y<X.length;Y++)Oo(re,X[Y],C,k,!0,Y===0)}if(re.length){var be=M.tags||null;if(ee==="LineString"&&O.lineMetrics){for(var Me in be={},M.tags)be[Me]=M.tags[Me];be.mapbox_clip_start=Z.start/Z.size,be.mapbox_clip_end=Z.end/Z.size}var le={geometry:re,type:ee==="Polygon"||ee==="MultiPolygon"?3:ee==="LineString"||ee==="MultiLineString"?2:1,tags:be};M.id!==null&&(le.id=M.id),C.features.push(le)}}function Oo(C,M,k,O,Z,ee){var re=O*O;if(O>0&&M.size<(Z?re:O))k.numPoints+=M.length/3;else{for(var Y=[],F=0;F<M.length;F+=3)(O===0||M[F+2]>re)&&(k.numSimplified++,Y.push(M[F]),Y.push(M[F+1])),k.numPoints++;Z&&function(X,be){for(var Me=0,le=0,we=X.length,Ve=we-2;le<we;Ve=le,le+=2)Me+=(X[le]-X[Ve])*(X[le+1]+X[Ve+1]);if(Me>0===be)for(le=0,we=X.length;le<we/2;le+=2){var je=X[le],$e=X[le+1];X[le]=X[we-2-le],X[le+1]=X[we-1-le],X[we-2-le]=je,X[we-1-le]=$e}}(Y,ee),C.push(Y)}}function Fo(C,M){var k=(M=this.options=function(Z,ee){for(var re in ee)Z[re]=ee[re];return Z}(Object.create(this.options),M)).debug;if(k&&console.time("preprocess data"),M.maxZoom<0||M.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(M.promoteId&&M.generateId)throw new Error("promoteId and generateId cannot be used together.");var O=function(Z,ee){var re=[];if(Z.type==="FeatureCollection")for(var Y=0;Y<Z.features.length;Y++)Le(re,Z.features[Y],ee,Y);else Le(re,Z.type==="Feature"?Z:{geometry:Z},ee);return re}(C,M);this.tiles={},this.tileCoords=[],k&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",M.indexMaxZoom,M.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(O=function(Z,ee){var re=ee.buffer/ee.extent,Y=Z,F=ut(Z,1,-1-re,re,0,-1,2,ee),X=ut(Z,1,1-re,2+re,0,-1,2,ee);return(F||X)&&(Y=ut(Z,1,-re,1+re,0,-1,2,ee)||[],F&&(Y=En(F,1).concat(Y)),X&&(Y=Y.concat(En(X,-1)))),Y}(O,M)).length&&this.splitTile(O,0,0,0),k&&(O.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function co(C,M,k){return 32*((1<<C)*k+M)+C}function Uo(C,M){var k=C.tileID.canonical;if(!this._geoJSONIndex)return M(null,null);var O=this._geoJSONIndex.getTile(k.z,k.x,k.y);if(!O)return M(null,null);var Z=new pr(O.features),ee=Vt(Z);ee.byteOffset===0&&ee.byteLength===ee.buffer.byteLength||(ee=new Uint8Array(ee)),M(null,{vectorTile:Z,rawData:ee.buffer})}Gr.prototype.load=function(C){var M=this.options,k=M.log,O=M.minZoom,Z=M.maxZoom,ee=M.nodeSize;k&&console.time("total time");var re="prepare "+C.length+" points";k&&console.time(re),this.points=C;for(var Y=[],F=0;F<C.length;F++)C[F].geometry&&Y.push(Ht(C[F],F));this.trees[Z+1]=new Dn(Y,ye,Te,ee,Float32Array),k&&console.timeEnd(re);for(var X=Z;X>=O;X--){var be=+Date.now();Y=this._cluster(Y,X),this.trees[X]=new Dn(Y,ye,Te,ee,Float32Array),k&&console.log("z%d: %d clusters in %dms",X,Y.length,+Date.now()-be)}return k&&console.timeEnd("total time"),this},Gr.prototype.getClusters=function(C,M){var k=((C[0]+180)%360+360)%360-180,O=Math.max(-90,Math.min(90,C[1])),Z=C[2]===180?180:((C[2]+180)%360+360)%360-180,ee=Math.max(-90,Math.min(90,C[3]));if(C[2]-C[0]>=360)k=-180,Z=180;else if(k>Z){var re=this.getClusters([k,O,180,ee],M),Y=this.getClusters([-180,O,Z,ee],M);return re.concat(Y)}for(var F=this.trees[this._limitZoom(M)],X=[],be=0,Me=F.range(Li(k),H(ee),Li(Z),H(O));be<Me.length;be+=1){var le=F.points[Me[be]];X.push(le.numPoints?yi(le):this.points[le.index])}return X},Gr.prototype.getChildren=function(C){var M=this._getOriginId(C),k=this._getOriginZoom(C),O="No cluster with the specified id.",Z=this.trees[k];if(!Z)throw new Error(O);var ee=Z.points[M];if(!ee)throw new Error(O);for(var re=this.options.radius/(this.options.extent*Math.pow(2,k-1)),Y=[],F=0,X=Z.within(ee.x,ee.y,re);F<X.length;F+=1){var be=Z.points[X[F]];be.parentId===C&&Y.push(be.numPoints?yi(be):this.points[be.index])}if(Y.length===0)throw new Error(O);return Y},Gr.prototype.getLeaves=function(C,M,k){var O=[];return this._appendLeaves(O,C,M=M||10,k=k||0,0),O},Gr.prototype.getTile=function(C,M,k){var O=this.trees[this._limitZoom(C)],Z=Math.pow(2,C),ee=this.options,re=ee.radius/ee.extent,Y=(k-re)/Z,F=(k+1+re)/Z,X={features:[]};return this._addTileFeatures(O.range((M-re)/Z,Y,(M+1+re)/Z,F),O.points,M,k,Z,X),M===0&&this._addTileFeatures(O.range(1-re/Z,Y,1,F),O.points,Z,k,Z,X),M===Z-1&&this._addTileFeatures(O.range(0,Y,re/Z,F),O.points,-1,k,Z,X),X.features.length?X:null},Gr.prototype.getClusterExpansionZoom=function(C){for(var M=this._getOriginZoom(C)-1;M<=this.options.maxZoom;){var k=this.getChildren(C);if(M++,k.length!==1)break;C=k[0].properties.cluster_id}return M},Gr.prototype._appendLeaves=function(C,M,k,O,Z){for(var ee=0,re=this.getChildren(M);ee<re.length;ee+=1){var Y=re[ee],F=Y.properties;if(F&&F.cluster?Z+F.point_count<=O?Z+=F.point_count:Z=this._appendLeaves(C,F.cluster_id,k,O,Z):Z<O?Z++:C.push(Y),C.length===k)break}return Z},Gr.prototype._addTileFeatures=function(C,M,k,O,Z,ee){for(var re=0,Y=C;re<Y.length;re+=1){var F=M[Y[re]],X=F.numPoints,be={type:1,geometry:[[Math.round(this.options.extent*(F.x*Z-k)),Math.round(this.options.extent*(F.y*Z-O))]],tags:X?Rn(F):this.points[F.index].properties},Me=void 0;X?Me=F.id:this.options.generateId?Me=F.index:this.points[F.index].id&&(Me=this.points[F.index].id),Me!==void 0&&(be.id=Me),ee.features.push(be)}},Gr.prototype._limitZoom=function(C){return Math.max(this.options.minZoom,Math.min(+C,this.options.maxZoom+1))},Gr.prototype._cluster=function(C,M){for(var k=[],O=this.options,Z=O.reduce,ee=O.minPoints,re=O.radius/(O.extent*Math.pow(2,M)),Y=0;Y<C.length;Y++){var F=C[Y];if(!(F.zoom<=M)){F.zoom=M;for(var X=this.trees[M+1],be=X.within(F.x,F.y,re),Me=F.numPoints||1,le=Me,we=0,Ve=be;we<Ve.length;we+=1){var je=X.points[Ve[we]];je.zoom>M&&(le+=je.numPoints||1)}if(le>=ee){for(var $e=F.x*Me,ve=F.y*Me,De=Z&&Me>1?this._map(F,!0):null,xe=(Y<<5)+(M+1)+this.points.length,yt=0,gt=be;yt<gt.length;yt+=1){var Xe=X.points[gt[yt]];if(!(Xe.zoom<=M)){Xe.zoom=M;var lr=Xe.numPoints||1;$e+=Xe.x*lr,ve+=Xe.y*lr,Xe.parentId=xe,Z&&(De||(De=this._map(F,!0)),Z(De,this._map(Xe)))}}F.parentId=xe,k.push(en($e/le,ve/le,xe,le,De))}else if(k.push(F),le>1)for(var At=0,hr=be;At<hr.length;At+=1){var yr=X.points[hr[At]];yr.zoom<=M||(yr.zoom=M,k.push(yr))}}}return k},Gr.prototype._getOriginId=function(C){return C-this.points.length>>5},Gr.prototype._getOriginZoom=function(C){return(C-this.points.length)%32},Gr.prototype._map=function(C,M){if(C.numPoints)return M?ie({},C.properties):C.properties;var k=this.points[C.index].properties,O=this.options.map(k);return M&&O===k?ie({},O):O},Fo.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Fo.prototype.splitTile=function(C,M,k,O,Z,ee,re){for(var Y=[C,M,k,O],F=this.options,X=F.debug;Y.length;){O=Y.pop(),k=Y.pop(),M=Y.pop(),C=Y.pop();var be=1<<M,Me=co(M,k,O),le=this.tiles[Me];if(!le&&(X>1&&console.time("creation"),le=this.tiles[Me]=Bo(C,M,k,O,F),this.tileCoords.push({z:M,x:k,y:O}),X)){X>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",M,k,O,le.numFeatures,le.numPoints,le.numSimplified),console.timeEnd("creation"));var we="z"+M;this.stats[we]=(this.stats[we]||0)+1,this.total++}if(le.source=C,Z){if(M===F.maxZoom||M===Z)continue;var Ve=1<<Z-M;if(k!==Math.floor(ee/Ve)||O!==Math.floor(re/Ve))continue}else if(M===F.indexMaxZoom||le.numPoints<=F.indexMaxPoints)continue;if(le.source=null,C.length!==0){X>1&&console.time("clipping");var je,$e,ve,De,xe,yt,gt=.5*F.buffer/F.extent,Xe=.5-gt,lr=.5+gt,At=1+gt;je=$e=ve=De=null,xe=ut(C,be,k-gt,k+lr,0,le.minX,le.maxX,F),yt=ut(C,be,k+Xe,k+At,0,le.minX,le.maxX,F),C=null,xe&&(je=ut(xe,be,O-gt,O+lr,1,le.minY,le.maxY,F),$e=ut(xe,be,O+Xe,O+At,1,le.minY,le.maxY,F),xe=null),yt&&(ve=ut(yt,be,O-gt,O+lr,1,le.minY,le.maxY,F),De=ut(yt,be,O+Xe,O+At,1,le.minY,le.maxY,F),yt=null),X>1&&console.timeEnd("clipping"),Y.push(je||[],M+1,2*k,2*O),Y.push($e||[],M+1,2*k,2*O+1),Y.push(ve||[],M+1,2*k+1,2*O),Y.push(De||[],M+1,2*k+1,2*O+1)}}},Fo.prototype.getTile=function(C,M,k){var O=this.options,Z=O.extent,ee=O.debug;if(C<0||C>24)return null;var re=1<<C,Y=co(C,M=(M%re+re)%re,k);if(this.tiles[Y])return ni(this.tiles[Y],Z);ee>1&&console.log("drilling down to z%d-%d-%d",C,M,k);for(var F,X=C,be=M,Me=k;!F&&X>0;)X--,be=Math.floor(be/2),Me=Math.floor(Me/2),F=this.tiles[co(X,be,Me)];return F&&F.source?(ee>1&&console.log("found parent tile z%d-%d-%d",X,be,Me),ee>1&&console.time("drilling down"),this.splitTile(F.source,X,be,Me,C,M,k),ee>1&&console.timeEnd("drilling down"),this.tiles[Y]?ni(this.tiles[Y],Z):null):null};var da=function(C){function M(k,O,Z,ee){C.call(this,k,O,Z,Uo),ee&&(this.loadGeoJSON=ee)}return C&&(M.__proto__=C),(M.prototype=Object.create(C&&C.prototype)).constructor=M,M.prototype.loadData=function(k,O){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=O,this._pendingLoadDataParams=k,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},M.prototype._loadData=function(){var k=this;if(this._pendingCallback&&this._pendingLoadDataParams){var O=this._pendingCallback,Z=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var ee=!!(Z&&Z.request&&Z.request.collectResourceTiming)&&new l.RequestPerformance(Z.request);this.loadGeoJSON(Z,function(re,Y){if(re||!Y)return O(re);if(typeof Y!="object")return O(new Error("Input data given to '"+Z.source+"' is not a valid GeoJSON object."));(function le(we,Ve){var je,$e=we&&we.type;if($e==="FeatureCollection")for(je=0;je<we.features.length;je++)le(we.features[je],Ve);else if($e==="GeometryCollection")for(je=0;je<we.geometries.length;je++)le(we.geometries[je],Ve);else if($e==="Feature")le(we.geometry,Ve);else if($e==="Polygon")Wt(we.coordinates,Ve);else if($e==="MultiPolygon")for(je=0;je<we.coordinates.length;je++)Wt(we.coordinates[je],Ve);return we})(Y,!0);try{if(Z.filter){var F=l.createExpression(Z.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(F.result==="error")throw new Error(F.value.map(function(le){return le.key+": "+le.message}).join(", "));var X=Y.features.filter(function(le){return F.value.evaluate({zoom:0},le)});Y={type:"FeatureCollection",features:X}}k._geoJSONIndex=Z.cluster?new Gr(function(le){var we=le.superclusterOptions,Ve=le.clusterProperties;if(!Ve||!we)return we;for(var je={},$e={},ve={accumulated:null,zoom:0},De={properties:null},xe=Object.keys(Ve),yt=0,gt=xe;yt<gt.length;yt+=1){var Xe=gt[yt],lr=Ve[Xe],At=lr[0],hr=l.createExpression(lr[1]),yr=l.createExpression(typeof At=="string"?[At,["accumulated"],["get",Xe]]:At);je[Xe]=hr.value,$e[Xe]=yr.value}return we.map=function(Bt){De.properties=Bt;for(var ur={},Cr=0,cr=xe;Cr<cr.length;Cr+=1){var Tt=cr[Cr];ur[Tt]=je[Tt].evaluate(ve,De)}return ur},we.reduce=function(Bt,ur){De.properties=ur;for(var Cr=0,cr=xe;Cr<cr.length;Cr+=1){var Tt=cr[Cr];ve.accumulated=Bt[Tt],Bt[Tt]=$e[Tt].evaluate(ve,De)}},we}(Z)).load(Y.features):function(le,we){return new Fo(le,we)}(Y,Z.geojsonVtOptions)}catch(le){return O(le)}k.loaded={};var be={};if(ee){var Me=ee.finish();Me&&(be.resourceTiming={},be.resourceTiming[Z.source]=JSON.parse(JSON.stringify(Me)))}O(null,be)})}},M.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},M.prototype.reloadTile=function(k,O){var Z=this.loaded;return Z&&Z[k.uid]?C.prototype.reloadTile.call(this,k,O):this.loadTile(k,O)},M.prototype.loadGeoJSON=function(k,O){if(k.request)l.getJSON(k.request,O);else{if(typeof k.data!="string")return O(new Error("Input data given to '"+k.source+"' is not a valid GeoJSON object."));try{return O(null,JSON.parse(k.data))}catch{return O(new Error("Input data given to '"+k.source+"' is not a valid GeoJSON object."))}}},M.prototype.removeSource=function(k,O){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),O()},M.prototype.getClusterExpansionZoom=function(k,O){try{O(null,this._geoJSONIndex.getClusterExpansionZoom(k.clusterId))}catch(Z){O(Z)}},M.prototype.getClusterChildren=function(k,O){try{O(null,this._geoJSONIndex.getChildren(k.clusterId))}catch(Z){O(Z)}},M.prototype.getClusterLeaves=function(k,O){try{O(null,this._geoJSONIndex.getLeaves(k.clusterId,k.limit,k.offset))}catch(Z){O(Z)}},M}(wt),Ir=function(C){var M=this;this.self=C,this.actor=new l.Actor(C,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:wt,geojson:da},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(k,O){if(M.workerSourceTypes[k])throw new Error('Worker source with name "'+k+'" already registered.');M.workerSourceTypes[k]=O},this.self.registerRTLTextPlugin=function(k){if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=k.applyArabicShaping,l.plugin.processBidirectionalText=k.processBidirectionalText,l.plugin.processStyledBidirectionalText=k.processStyledBidirectionalText}};return Ir.prototype.setReferrer=function(C,M){this.referrer=M},Ir.prototype.setImages=function(C,M,k){for(var O in this.availableImages[C]=M,this.workerSources[C]){var Z=this.workerSources[C][O];for(var ee in Z)Z[ee].availableImages=M}k()},Ir.prototype.setLayers=function(C,M,k){this.getLayerIndex(C).replace(M),k()},Ir.prototype.updateLayers=function(C,M,k){this.getLayerIndex(C).update(M.layers,M.removedIds),k()},Ir.prototype.loadTile=function(C,M,k){this.getWorkerSource(C,M.type,M.source).loadTile(M,k)},Ir.prototype.loadDEMTile=function(C,M,k){this.getDEMWorkerSource(C,M.source).loadTile(M,k)},Ir.prototype.reloadTile=function(C,M,k){this.getWorkerSource(C,M.type,M.source).reloadTile(M,k)},Ir.prototype.abortTile=function(C,M,k){this.getWorkerSource(C,M.type,M.source).abortTile(M,k)},Ir.prototype.removeTile=function(C,M,k){this.getWorkerSource(C,M.type,M.source).removeTile(M,k)},Ir.prototype.removeDEMTile=function(C,M){this.getDEMWorkerSource(C,M.source).removeTile(M)},Ir.prototype.removeSource=function(C,M,k){if(this.workerSources[C]&&this.workerSources[C][M.type]&&this.workerSources[C][M.type][M.source]){var O=this.workerSources[C][M.type][M.source];delete this.workerSources[C][M.type][M.source],O.removeSource!==void 0?O.removeSource(M,k):k()}},Ir.prototype.loadWorkerSource=function(C,M,k){try{this.self.importScripts(M.url),k()}catch(O){k(O.toString())}},Ir.prototype.syncRTLPluginState=function(C,M,k){try{l.plugin.setState(M);var O=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&O!=null){this.self.importScripts(O);var Z=l.plugin.isParsed();k(Z?void 0:new Error("RTL Text Plugin failed to import scripts from "+O),Z)}}catch(ee){k(ee.toString())}},Ir.prototype.getAvailableImages=function(C){var M=this.availableImages[C];return M||(M=[]),M},Ir.prototype.getLayerIndex=function(C){var M=this.layerIndexes[C];return M||(M=this.layerIndexes[C]=new he),M},Ir.prototype.getWorkerSource=function(C,M,k){var O=this;return this.workerSources[C]||(this.workerSources[C]={}),this.workerSources[C][M]||(this.workerSources[C][M]={}),this.workerSources[C][M][k]||(this.workerSources[C][M][k]=new this.workerSourceTypes[M]({send:function(Z,ee,re){O.actor.send(Z,ee,re,C)}},this.getLayerIndex(C),this.getAvailableImages(C))),this.workerSources[C][M][k]},Ir.prototype.getDEMWorkerSource=function(C,M){return this.demWorkerSources[C]||(this.demWorkerSources[C]={}),this.demWorkerSources[C][M]||(this.demWorkerSources[C][M]=new Nt),this.demWorkerSources[C][M]},Ir.prototype.enforceCacheSizeLimit=function(C,M){l.enforceCacheSizeLimit(M)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ir(self)),Ir}),P(["./shared"],function(l){var J=l.createCommonjsModule(function(i){function o(h){return!n(h)}function n(h){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var y,v,S=new Blob([""],{type:"text/javascript"}),A=URL.createObjectURL(S);try{v=new Worker(A),y=!0}catch{y=!1}return v&&v.terminate(),URL.revokeObjectURL(A),y}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var y=document.createElement("canvas");y.width=y.height=1;var v=y.getContext("2d");if(!v)return!1;var S=v.getImageData(0,0,1,1);return S&&S.width===y.width}()?(s[m=h&&h.failIfMajorPerformanceCaveat]===void 0&&(s[m]=function(y){var v=function(A){var D=document.createElement("canvas"),B=Object.create(o.webGLContextAttributes);return B.failIfMajorPerformanceCaveat=A,D.probablySupportsContext?D.probablySupportsContext("webgl",B)||D.probablySupportsContext("experimental-webgl",B):D.supportsContext?D.supportsContext("webgl",B)||D.supportsContext("experimental-webgl",B):D.getContext("webgl",B)||D.getContext("experimental-webgl",B)}(y);if(!v)return!1;var S=v.createShader(v.VERTEX_SHADER);return!(!S||v.isContextLost())&&(v.shaderSource(S,"void main() {}"),v.compileShader(S),v.getShaderParameter(S,v.COMPILE_STATUS)===!0)}(m)),s[m]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var m}i.exports?i.exports=o:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=o,window.mapboxgl.notSupportedReason=n);var s={};o.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),U={create:function(i,o,n){var s=l.window.document.createElement(i);return o!==void 0&&(s.className=o),n&&n.appendChild(s),s},createNS:function(i,o){return l.window.document.createElementNS(i,o)}},he=l.window.document&&l.window.document.documentElement.style;function se(i){if(!he)return i[0];for(var o=0;o<i.length;o++)if(i[o]in he)return i[o];return i[0]}var Ee,fe=se(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);U.disableDrag=function(){he&&fe&&(Ee=he[fe],he[fe]="none")},U.enableDrag=function(){he&&fe&&(he[fe]=Ee)};var ft=se(["transform","WebkitTransform"]);U.setTransform=function(i,o){i.style[ft]=o};var wt=!1;try{var Et=Object.defineProperty({},"passive",{get:function(){wt=!0}});l.window.addEventListener("test",Et,Et),l.window.removeEventListener("test",Et,Et)}catch{wt=!1}U.addEventListener=function(i,o,n,s){s===void 0&&(s={}),i.addEventListener(o,n,"passive"in s&&wt?s:s.capture)},U.removeEventListener=function(i,o,n,s){s===void 0&&(s={}),i.removeEventListener(o,n,"passive"in s&&wt?s:s.capture)};var Nt=function(i){i.preventDefault(),i.stopPropagation(),l.window.removeEventListener("click",Nt,!0)};function Wt(i){var o=i.userImage;return!!(o&&o.render&&o.render())&&(i.data.replace(new Uint8Array(o.data.buffer)),!0)}U.suppressClick=function(){l.window.addEventListener("click",Nt,!0),l.window.setTimeout(function(){l.window.removeEventListener("click",Nt,!0)},0)},U.mousePos=function(i,o){var n=i.getBoundingClientRect();return new l.Point(o.clientX-n.left-i.clientLeft,o.clientY-n.top-i.clientTop)},U.touchPos=function(i,o){for(var n=i.getBoundingClientRect(),s=[],h=0;h<o.length;h++)s.push(new l.Point(o[h].clientX-n.left-i.clientLeft,o[h].clientY-n.top-i.clientTop));return s},U.mouseButton=function(i){return l.window.InstallTrigger!==void 0&&i.button===2&&i.ctrlKey&&l.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:i.button},U.remove=function(i){i.parentNode&&i.parentNode.removeChild(i)};var Pt=function(i){function o(){i.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.isLoaded=function(){return this.loaded},o.prototype.setLoaded=function(n){if(this.loaded!==n&&(this.loaded=n,n)){for(var s=0,h=this.requestors;s<h.length;s+=1){var m=h[s];this._notify(m.ids,m.callback)}this.requestors=[]}},o.prototype.getImage=function(n){return this.images[n]},o.prototype.addImage=function(n,s){this._validate(n,s)&&(this.images[n]=s)},o.prototype._validate=function(n,s){var h=!0;return this._validateStretch(s.stretchX,s.data&&s.data.width)||(this.fire(new l.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchX" value'))),h=!1),this._validateStretch(s.stretchY,s.data&&s.data.height)||(this.fire(new l.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchY" value'))),h=!1),this._validateContent(s.content,s)||(this.fire(new l.ErrorEvent(new Error('Image "'+n+'" has invalid "content" value'))),h=!1),h},o.prototype._validateStretch=function(n,s){if(!n)return!0;for(var h=0,m=0,y=n;m<y.length;m+=1){var v=y[m];if(v[0]<h||v[1]<v[0]||s<v[1])return!1;h=v[1]}return!0},o.prototype._validateContent=function(n,s){return!(n&&(n.length!==4||n[0]<0||s.data.width<n[0]||n[1]<0||s.data.height<n[1]||n[2]<0||s.data.width<n[2]||n[3]<0||s.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))},o.prototype.updateImage=function(n,s){s.version=this.images[n].version+1,this.images[n]=s,this.updatedImages[n]=!0},o.prototype.removeImage=function(n){var s=this.images[n];delete this.images[n],delete this.patterns[n],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()},o.prototype.listImages=function(){return Object.keys(this.images)},o.prototype.getImages=function(n,s){var h=!0;if(!this.isLoaded())for(var m=0,y=n;m<y.length;m+=1)this.images[y[m]]||(h=!1);this.isLoaded()||h?this._notify(n,s):this.requestors.push({ids:n,callback:s})},o.prototype._notify=function(n,s){for(var h={},m=0,y=n;m<y.length;m+=1){var v=y[m];this.images[v]||this.fire(new l.Event("styleimagemissing",{id:v}));var S=this.images[v];S?h[v]={data:S.data.clone(),pixelRatio:S.pixelRatio,sdf:S.sdf,version:S.version,stretchX:S.stretchX,stretchY:S.stretchY,content:S.content,hasRenderCallback:!!(S.userImage&&S.userImage.render)}:l.warnOnce('Image "'+v+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}s(null,h)},o.prototype.getPixelSize=function(){var n=this.atlasImage;return{width:n.width,height:n.height}},o.prototype.getPattern=function(n){var s=this.patterns[n],h=this.getImage(n);if(!h)return null;if(s&&s.position.version===h.version)return s.position;if(s)s.position.version=h.version;else{var m={w:h.data.width+2,h:h.data.height+2,x:0,y:0},y=new l.ImagePosition(m,h);this.patterns[n]={bin:m,position:y}}return this._updatePatternAtlas(),this.patterns[n].position},o.prototype.bind=function(n){var s=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new l.Texture(n,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)},o.prototype._updatePatternAtlas=function(){var n=[];for(var s in this.patterns)n.push(this.patterns[s].bin);var h=l.potpack(n),m=h.w,y=h.h,v=this.atlasImage;for(var S in v.resize({width:m||1,height:y||1}),this.patterns){var A=this.patterns[S].bin,D=A.x+1,B=A.y+1,R=this.images[S].data,G=R.width,q=R.height;l.RGBAImage.copy(R,v,{x:0,y:0},{x:D,y:B},{width:G,height:q}),l.RGBAImage.copy(R,v,{x:0,y:q-1},{x:D,y:B-1},{width:G,height:1}),l.RGBAImage.copy(R,v,{x:0,y:0},{x:D,y:B+q},{width:G,height:1}),l.RGBAImage.copy(R,v,{x:G-1,y:0},{x:D-1,y:B},{width:1,height:q}),l.RGBAImage.copy(R,v,{x:0,y:0},{x:D+G,y:B},{width:1,height:q})}this.dirty=!0},o.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},o.prototype.dispatchRenderCallbacks=function(n){for(var s=0,h=n;s<h.length;s+=1){var m=h[s];if(!this.callbackDispatchedThisFrame[m]){this.callbackDispatchedThisFrame[m]=!0;var y=this.images[m];Wt(y)&&this.updateImage(m,y)}}},o}(l.Evented),Rt=xt,or=xt,pr=1e20;function xt(i,o,n,s,h,m){this.fontSize=i||24,this.buffer=o===void 0?3:o,this.cutoff=s||.25,this.fontFamily=h||"sans-serif",this.fontWeight=m||"normal",this.radius=n||8;var y=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=y,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(y*y),this.gridInner=new Float64Array(y*y),this.f=new Float64Array(y),this.d=new Float64Array(y),this.z=new Float64Array(y+1),this.v=new Int16Array(y),this.middle=Math.round(y/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function qr(i,o,n,s,h,m,y){for(var v=0;v<o;v++){for(var S=0;S<n;S++)s[S]=i[S*o+v];for(Pr(s,h,m,y,n),S=0;S<n;S++)i[S*o+v]=h[S]}for(S=0;S<n;S++){for(v=0;v<o;v++)s[v]=i[S*o+v];for(Pr(s,h,m,y,o),v=0;v<o;v++)i[S*o+v]=Math.sqrt(h[v])}}function Pr(i,o,n,s,h){n[0]=0,s[0]=-pr,s[1]=+pr;for(var m=1,y=0;m<h;m++){for(var v=(i[m]+m*m-(i[n[y]]+n[y]*n[y]))/(2*m-2*n[y]);v<=s[y];)y--,v=(i[m]+m*m-(i[n[y]]+n[y]*n[y]))/(2*m-2*n[y]);n[++y]=m,s[y]=v,s[y+1]=+pr}for(m=0,y=0;m<h;m++){for(;s[y+1]<m;)y++;o[m]=(m-n[y])*(m-n[y])+i[n[y]]}}xt.prototype.draw=function(i){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(i,this.buffer,this.middle);for(var o=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),s=0;s<this.size*this.size;s++){var h=o.data[4*s+3]/255;this.gridOuter[s]=h===1?0:h===0?pr:Math.pow(Math.max(0,.5-h),2),this.gridInner[s]=h===1?pr:h===0?0:Math.pow(Math.max(0,h-.5),2)}for(qr(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),qr(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),s=0;s<this.size*this.size;s++)n[s]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[s]-this.gridInner[s])/this.radius+this.cutoff))));return n},Rt.default=or;var ht=function(i,o){this.requestManager=i,this.localIdeographFontFamily=o,this.entries={}};ht.prototype.setURL=function(i){this.url=i},ht.prototype.getGlyphs=function(i,o){var n=this,s=[];for(var h in i)for(var m=0,y=i[h];m<y.length;m+=1)s.push({stack:h,id:y[m]});l.asyncAll(s,function(v,S){var A=v.stack,D=v.id,B=n.entries[A];B||(B=n.entries[A]={glyphs:{},requests:{},ranges:{}});var R=B.glyphs[D];if(R===void 0){if(R=n._tinySDF(B,A,D))return B.glyphs[D]=R,void S(null,{stack:A,id:D,glyph:R});var G=Math.floor(D/256);if(256*G>65535)S(new Error("glyphs > 65535 not supported"));else if(B.ranges[G])S(null,{stack:A,id:D,glyph:R});else{var q=B.requests[G];q||(q=B.requests[G]=[],ht.loadGlyphRange(A,G,n.url,n.requestManager,function($,j){if(j){for(var K in j)n._doesCharSupportLocalGlyph(+K)||(B.glyphs[+K]=j[+K]);B.ranges[G]=!0}for(var te=0,oe=q;te<oe.length;te+=1)(0,oe[te])($,j);delete B.requests[G]})),q.push(function($,j){$?S($):j&&S(null,{stack:A,id:D,glyph:j[D]||null})})}}else S(null,{stack:A,id:D,glyph:R})},function(v,S){if(v)o(v);else if(S){for(var A={},D=0,B=S;D<B.length;D+=1){var R=B[D],G=R.stack,q=R.id,$=R.glyph;(A[G]||(A[G]={}))[q]=$&&{id:$.id,bitmap:$.bitmap.clone(),metrics:$.metrics}}o(null,A)}})},ht.prototype._doesCharSupportLocalGlyph=function(i){return!!this.localIdeographFontFamily&&(l.isChar["CJK Unified Ideographs"](i)||l.isChar["Hangul Syllables"](i)||l.isChar.Hiragana(i)||l.isChar.Katakana(i))},ht.prototype._tinySDF=function(i,o,n){var s=this.localIdeographFontFamily;if(s&&this._doesCharSupportLocalGlyph(n)){var h=i.tinySDF;if(!h){var m="400";/bold/i.test(o)?m="900":/medium/i.test(o)?m="500":/light/i.test(o)&&(m="200"),h=i.tinySDF=new ht.TinySDF(24,3,8,.25,s,m)}return{id:n,bitmap:new l.AlphaImage({width:30,height:30},h.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},ht.loadGlyphRange=function(i,o,n,s,h){var m=256*o,y=m+255,v=s.transformRequest(s.normalizeGlyphsURL(n).replace("{fontstack}",i).replace("{range}",m+"-"+y),l.ResourceType.Glyphs);l.getArrayBuffer(v,function(S,A){if(S)h(S);else if(A){for(var D={},B=0,R=l.parseGlyphPBF(A);B<R.length;B+=1){var G=R[B];D[G.id]=G}h(null,D)}})},ht.TinySDF=Rt;var Vt=function(){this.specification=l.styleSpec.light.position};Vt.prototype.possiblyEvaluate=function(i,o){return l.sphericalToCartesian(i.expression.evaluate(o))},Vt.prototype.interpolate=function(i,o,n){return{x:l.number(i.x,o.x,n),y:l.number(i.y,o.y,n),z:l.number(i.z,o.z,n)}};var Gt=new l.Properties({anchor:new l.DataConstantProperty(l.styleSpec.light.anchor),position:new Vt,color:new l.DataConstantProperty(l.styleSpec.light.color),intensity:new l.DataConstantProperty(l.styleSpec.light.intensity)}),ot=function(i){function o(n){i.call(this),this._transitionable=new l.Transitionable(Gt),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getLight=function(){return this._transitionable.serialize()},o.prototype.setLight=function(n,s){if(s===void 0&&(s={}),!this._validate(l.validateLight,n,s))for(var h in n){var m=n[h];l.endsWith(h,"-transition")?this._transitionable.setTransition(h.slice(0,-11),m):this._transitionable.setValue(h,m)}},o.prototype.updateTransitions=function(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)},o.prototype.hasTransition=function(){return this._transitioning.hasTransition()},o.prototype.recalculate=function(n){this.properties=this._transitioning.possiblyEvaluate(n)},o.prototype._validate=function(n,s,h){return(!h||h.validate!==!1)&&l.emitValidationErrors(this,n.call(l.validateStyle,l.extend({value:s,style:{glyphs:!0,sprite:!0},styleSpec:l.styleSpec})))},o}(l.Evented),vt=function(i,o){this.width=i,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};vt.prototype.getDash=function(i,o){var n=i.join(",")+String(o);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(i,o)),this.dashEntry[n]},vt.prototype.getDashRanges=function(i,o,n){var s=[],h=i.length%2==1?-i[i.length-1]*n:0,m=i[0]*n,y=!0;s.push({left:h,right:m,isDash:y,zeroLength:i[0]===0});for(var v=i[0],S=1;S<i.length;S++){var A=i[S];s.push({left:h=v*n,right:m=(v+=A)*n,isDash:y=!y,zeroLength:A===0})}return s},vt.prototype.addRoundDash=function(i,o,n){for(var s=o/2,h=-n;h<=n;h++)for(var m=this.width*(this.nextRow+n+h),y=0,v=i[y],S=0;S<this.width;S++){S/v.right>1&&(v=i[++y]);var A=Math.abs(S-v.left),D=Math.abs(S-v.right),B=Math.min(A,D),R=void 0,G=h/n*(s+1);if(v.isDash){var q=s-Math.abs(G);R=Math.sqrt(B*B+q*q)}else R=s-Math.sqrt(B*B+G*G);this.data[m+S]=Math.max(0,Math.min(255,R+128))}},vt.prototype.addRegularDash=function(i){for(var o=i.length-1;o>=0;--o){var n=i[o],s=i[o+1];n.zeroLength?i.splice(o,1):s&&s.isDash===n.isDash&&(s.left=n.left,i.splice(o,1))}var h=i[0],m=i[i.length-1];h.isDash===m.isDash&&(h.left=m.left-this.width,m.right=h.right+this.width);for(var y=this.width*this.nextRow,v=0,S=i[v],A=0;A<this.width;A++){A/S.right>1&&(S=i[++v]);var D=Math.abs(A-S.left),B=Math.abs(A-S.right),R=Math.min(D,B);this.data[y+A]=Math.max(0,Math.min(255,(S.isDash?R:-R)+128))}},vt.prototype.addDash=function(i,o){var n=o?7:0,s=2*n+1;if(this.nextRow+s>this.height)return l.warnOnce("LineAtlas out of space"),null;for(var h=0,m=0;m<i.length;m++)h+=i[m];if(h!==0){var y=this.width/h,v=this.getDashRanges(i,this.width,y);o?this.addRoundDash(v,y,n):this.addRegularDash(v)}var S={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:h};return this.nextRow+=s,this.dirty=!0,S},vt.prototype.bind=function(i){var o=i.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))};var er=function i(o,n){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=l.uniqueId();for(var s=this.workerPool.acquire(this.id),h=0;h<s.length;h++){var m=new i.Actor(s[h],n,this.id);m.name="Worker "+h,this.actors.push(m)}};function cn(i,o,n){var s=function(h,m){if(h)return n(h);if(m){var y=l.pick(l.extend(m,i),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);m.vector_layers&&(y.vectorLayers=m.vector_layers,y.vectorLayerIds=y.vectorLayers.map(function(v){return v.id})),y.tiles=o.canonicalizeTileset(y,i.url),n(null,y)}};return i.url?l.getJSON(o.transformRequest(o.normalizeSourceURL(i.url),l.ResourceType.Source),s):l.browser.frame(function(){return s(null,i)})}er.prototype.broadcast=function(i,o,n){l.asyncAll(this.actors,function(s,h){s.send(i,o,h)},n=n||function(){})},er.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},er.prototype.remove=function(){this.actors.forEach(function(i){i.remove()}),this.actors=[],this.workerPool.release(this.id)},er.Actor=l.Actor;var Jt=function(i,o,n){this.bounds=l.LngLatBounds.convert(this.validateBounds(i)),this.minzoom=o||0,this.maxzoom=n||24};Jt.prototype.validateBounds=function(i){return Array.isArray(i)&&i.length===4?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]},Jt.prototype.contains=function(i){var o=Math.pow(2,i.z),n=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*o),s=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*o),h=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*o),m=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*o);return i.x>=n&&i.x<h&&i.y>=s&&i.y<m};var ar=function(i){function o(n,s,h,m){if(i.call(this),this.id=n,this.dispatcher=h,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(s,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},s),this._collectResourceTiming=s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(m)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=cn(this._options,this.map._requestManager,function(s,h){n._tileJSONRequest=null,n._loaded=!0,s?n.fire(new l.ErrorEvent(s)):h&&(l.extend(n,h),h.bounds&&(n.tileBounds=new Jt(h.bounds,n.minzoom,n.maxzoom)),l.postTurnstileEvent(h.tiles,n.map._requestManager._customAccessToken),l.postMapLoadEvent(h.tiles,n.map._getMapId(),n.map._requestManager._skuToken,n.map._requestManager._customAccessToken),n.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})},o.prototype.loaded=function(){return this._loaded},o.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},o.prototype.onAdd=function(n){this.map=n,this.load()},o.prototype.setSourceProperty=function(n){this._tileJSONRequest&&this._tileJSONRequest.cancel(),n(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},o.prototype.setTiles=function(n){var s=this;return this.setSourceProperty(function(){s._options.tiles=n}),this},o.prototype.setUrl=function(n){var s=this;return this.setSourceProperty(function(){s.url=n,s._options.url=n}),this},o.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},o.prototype.serialize=function(){return l.extend({},this._options)},o.prototype.loadTile=function(n,s){var h=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme)),m={request:this.map._requestManager.transformRequest(h,l.ResourceType.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:l.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function y(v,S){return delete n.request,n.aborted?s(null):v&&v.status!==404?s(v):(S&&S.resourceTiming&&(n.resourceTiming=S.resourceTiming),this.map._refreshExpiredTiles&&S&&n.setExpiryData(S),n.loadVectorData(S,this.map.painter),l.cacheEntryPossiblyAdded(this.dispatcher),s(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}m.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired"?n.state==="loading"?n.reloadCallback=s:n.request=n.actor.send("reloadTile",m,y.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",m,y.bind(this)))},o.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id},void 0)},o.prototype.unloadTile=function(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id},void 0)},o.prototype.hasTransition=function(){return!1},o}(l.Evented),Kt=function(i){function o(n,s,h,m){i.call(this),this.id=n,this.dispatcher=h,this.setEventedParent(m),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},s),l.extend(this,l.pick(s,["url","scheme","tileSize"]))}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=cn(this._options,this.map._requestManager,function(s,h){n._tileJSONRequest=null,n._loaded=!0,s?n.fire(new l.ErrorEvent(s)):h&&(l.extend(n,h),h.bounds&&(n.tileBounds=new Jt(h.bounds,n.minzoom,n.maxzoom)),l.postTurnstileEvent(h.tiles),l.postMapLoadEvent(h.tiles,n.map._getMapId(),n.map._requestManager._skuToken),n.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})},o.prototype.loaded=function(){return this._loaded},o.prototype.onAdd=function(n){this.map=n,this.load()},o.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},o.prototype.serialize=function(){return l.extend({},this._options)},o.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},o.prototype.loadTile=function(n,s){var h=this,m=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);n.request=l.getImage(this.map._requestManager.transformRequest(m,l.ResourceType.Tile),function(y,v){if(delete n.request,n.aborted)n.state="unloaded",s(null);else if(y)n.state="errored",s(y);else if(v){h.map._refreshExpiredTiles&&n.setExpiryData(v),delete v.cacheControl,delete v.expires;var S=h.map.painter.context,A=S.gl;n.texture=h.map.painter.getTileTexture(v.width),n.texture?n.texture.update(v,{useMipmap:!0}):(n.texture=new l.Texture(S,v,A.RGBA,{useMipmap:!0}),n.texture.bind(A.LINEAR,A.CLAMP_TO_EDGE,A.LINEAR_MIPMAP_NEAREST),S.extTextureFilterAnisotropic&&A.texParameterf(A.TEXTURE_2D,S.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,S.extTextureFilterAnisotropicMax)),n.state="loaded",l.cacheEntryPossiblyAdded(h.dispatcher),s(null)}})},o.prototype.abortTile=function(n,s){n.request&&(n.request.cancel(),delete n.request),s()},o.prototype.unloadTile=function(n,s){n.texture&&this.map.painter.saveTileTexture(n.texture),s()},o.prototype.hasTransition=function(){return!1},o}(l.Evented),pn=function(i){function o(n,s,h,m){i.call(this,n,s,h,m),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},o.prototype.loadTile=function(n,s){var h=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function m(y,v){y&&(n.state="errored",s(y)),v&&(n.dem=v,n.needsHillshadePrepare=!0,n.state="loaded",s(null))}n.request=l.getImage(this.map._requestManager.transformRequest(h,l.ResourceType.Tile),(function(y,v){if(delete n.request,n.aborted)n.state="unloaded",s(null);else if(y)n.state="errored",s(y);else if(v){this.map._refreshExpiredTiles&&n.setExpiryData(v),delete v.cacheControl,delete v.expires;var S=l.window.ImageBitmap&&v instanceof l.window.ImageBitmap&&l.offscreenCanvasSupported()?v:l.browser.getImageData(v,1),A={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:S,encoding:this.encoding};n.actor&&n.state!=="expired"||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",A,m.bind(this)))}}).bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)},o.prototype._getNeighboringTiles=function(n){var s=n.canonical,h=Math.pow(2,s.z),m=(s.x-1+h)%h,y=s.x===0?n.wrap-1:n.wrap,v=(s.x+1+h)%h,S=s.x+1===h?n.wrap+1:n.wrap,A={};return A[new l.OverscaledTileID(n.overscaledZ,y,s.z,m,s.y).key]={backfilled:!1},A[new l.OverscaledTileID(n.overscaledZ,S,s.z,v,s.y).key]={backfilled:!1},s.y>0&&(A[new l.OverscaledTileID(n.overscaledZ,y,s.z,m,s.y-1).key]={backfilled:!1},A[new l.OverscaledTileID(n.overscaledZ,n.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},A[new l.OverscaledTileID(n.overscaledZ,S,s.z,v,s.y-1).key]={backfilled:!1}),s.y+1<h&&(A[new l.OverscaledTileID(n.overscaledZ,y,s.z,m,s.y+1).key]={backfilled:!1},A[new l.OverscaledTileID(n.overscaledZ,n.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},A[new l.OverscaledTileID(n.overscaledZ,S,s.z,v,s.y+1).key]={backfilled:!1}),A},o.prototype.unloadTile=function(n){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&n.actor.send("removeDEMTile",{uid:n.uid,source:this.id})},o}(Kt),Qi=function(i){function o(n,s,h,m){i.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(m),this._data=s.data,this._options=l.extend({},s),this._collectResourceTiming=s.collectResourceTiming,this._resourceTiming=[],s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;var y=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*y,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*y,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?Math.min(s.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:l.EXTENT,radius:(s.clusterRadius||50)*y,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.load=function(){var n=this;this.fire(new l.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(s){if(s)n.fire(new l.ErrorEvent(s));else{var h={dataType:"source",sourceDataType:"metadata"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(h.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new l.Event("data",h))}})},o.prototype.onAdd=function(n){this.map=n,this.load()},o.prototype.setData=function(n){var s=this;return this._data=n,this.fire(new l.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(h){if(h)s.fire(new l.ErrorEvent(h));else{var m={dataType:"source",sourceDataType:"content"};s._collectResourceTiming&&s._resourceTiming&&s._resourceTiming.length>0&&(m.resourceTiming=s._resourceTiming,s._resourceTiming=[]),s.fire(new l.Event("data",m))}}),this},o.prototype.getClusterExpansionZoom=function(n,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:n,source:this.id},s),this},o.prototype.getClusterChildren=function(n,s){return this.actor.send("geojson.getClusterChildren",{clusterId:n,source:this.id},s),this},o.prototype.getClusterLeaves=function(n,s,h,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:n,limit:s,offset:h},m),this},o.prototype._updateWorkerData=function(n){var s=this;this._loaded=!1;var h=l.extend({},this.workerOptions),m=this._data;typeof m=="string"?(h.request=this.map._requestManager.transformRequest(l.browser.resolveURL(m),l.ResourceType.Source),h.request.collectResourceTiming=this._collectResourceTiming):h.data=JSON.stringify(m),this.actor.send(this.type+".loadData",h,function(y,v){s._removed||v&&v.abandoned||(s._loaded=!0,v&&v.resourceTiming&&v.resourceTiming[s.id]&&(s._resourceTiming=v.resourceTiming[s.id].slice(0)),s.actor.send(s.type+".coalesce",{source:h.source},null),n(y))})},o.prototype.loaded=function(){return this._loaded},o.prototype.loadTile=function(n,s){var h=this,m=n.actor?"reloadTile":"loadTile";n.actor=this.actor,n.request=this.actor.send(m,{type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:l.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(y,v){return delete n.request,n.unloadVectorData(),n.aborted?s(null):y?s(y):(n.loadVectorData(v,h.map.painter,m==="reloadTile"),s(null))})},o.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.aborted=!0},o.prototype.unloadTile=function(n){n.unloadVectorData(),this.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})},o.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},o.prototype.serialize=function(){return l.extend({},this._options,{type:this.type,data:this._data})},o.prototype.hasTransition=function(){return!1},o}(l.Evented),ii=l.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Zr=function(i){function o(n,s,h,m){i.call(this),this.id=n,this.dispatcher=h,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(m),this.options=s}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.load=function(n,s){var h=this;this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,l.getImage(this.map._requestManager.transformRequest(this.url,l.ResourceType.Image),function(m,y){h._loaded=!0,m?h.fire(new l.ErrorEvent(m)):y&&(h.image=y,n&&(h.coordinates=n),s&&s(),h._finishLoading())})},o.prototype.loaded=function(){return this._loaded},o.prototype.updateImage=function(n){var s=this;return this.image&&n.url?(this.options.url=n.url,this.load(n.coordinates,function(){s.texture=null}),this):this},o.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))},o.prototype.onAdd=function(n){this.map=n,this.load()},o.prototype.setCoordinates=function(n){var s=this;this.coordinates=n;var h=n.map(l.MercatorCoordinate.fromLngLat);this.tileID=function(y){for(var v=1/0,S=1/0,A=-1/0,D=-1/0,B=0,R=y;B<R.length;B+=1){var G=R[B];v=Math.min(v,G.x),S=Math.min(S,G.y),A=Math.max(A,G.x),D=Math.max(D,G.y)}var q=Math.max(A-v,D-S),$=Math.max(0,Math.floor(-Math.log(q)/Math.LN2)),j=Math.pow(2,$);return new l.CanonicalTileID($,Math.floor((v+A)/2*j),Math.floor((S+D)/2*j))}(h),this.minzoom=this.maxzoom=this.tileID.z;var m=h.map(function(y){return s.tileID.getTilePoint(y)._round()});return this._boundsArray=new l.StructArrayLayout4i8,this._boundsArray.emplaceBack(m[0].x,m[0].y,0,0),this._boundsArray.emplaceBack(m[1].x,m[1].y,l.EXTENT,0),this._boundsArray.emplaceBack(m[3].x,m[3].y,0,l.EXTENT),this._boundsArray.emplaceBack(m[2].x,m[2].y,l.EXTENT,l.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this},o.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var n=this.map.painter.context,s=n.gl;for(var h in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,ii.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new l.Texture(n,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE)),this.tiles){var m=this.tiles[h];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture)}}},o.prototype.loadTile=function(n,s){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},s(null)):(n.state="errored",s(null))},o.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},o.prototype.hasTransition=function(){return!1},o}(l.Evented),Ln=function(i){function o(n,s,h,m){i.call(this,n,s,h,m),this.roundZoom=!0,this.type="video",this.options=s}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.load=function(){var n=this;this._loaded=!1;var s=this.options;this.urls=[];for(var h=0,m=s.urls;h<m.length;h+=1)this.urls.push(this.map._requestManager.transformRequest(m[h],l.ResourceType.Source).url);l.getVideo(this.urls,function(y,v){n._loaded=!0,y?n.fire(new l.ErrorEvent(y)):v&&(n.video=v,n.video.loop=!0,n.video.addEventListener("playing",function(){n.map.triggerRepaint()}),n.map&&n.video.play(),n._finishLoading())})},o.prototype.pause=function(){this.video&&this.video.pause()},o.prototype.play=function(){this.video&&this.video.play()},o.prototype.seek=function(n){if(this.video){var s=this.video.seekable;n<s.start(0)||n>s.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+s.start(0)+" and "+s.end(0)+"-second mark."))):this.video.currentTime=n}},o.prototype.getVideo=function(){return this.video},o.prototype.onAdd=function(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},o.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var n=this.map.painter.context,s=n.gl;for(var h in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,ii.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new l.Texture(n,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE)),this.tiles){var m=this.tiles[h];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture)}}},o.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},o.prototype.hasTransition=function(){return this.video&&!this.video.paused},o}(Zr),Xn=function(i){function o(n,s,h,m){i.call(this,n,s,h,m),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(function(y){return!Array.isArray(y)||y.length!==2||y.some(function(v){return typeof v!="number"})})||this.fire(new l.ErrorEvent(new l.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError("sources."+n,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new l.ErrorEvent(new l.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof l.window.HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof l.window.HTMLCanvasElement?this.options.canvas:l.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},o.prototype.getCanvas=function(){return this.canvas},o.prototype.onAdd=function(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()},o.prototype.onRemove=function(){this.pause()},o.prototype.prepare=function(){var n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var s=this.map.painter.context,h=s.gl;for(var m in this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,ii.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new l.Texture(s,this.canvas,h.RGBA,{premultiply:!0}),this.tiles){var y=this.tiles[m];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture)}}},o.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},o.prototype.hasTransition=function(){return this._playing},o.prototype._hasInvalidDimensions=function(){for(var n=0,s=[this.canvas.width,this.canvas.height];n<s.length;n+=1){var h=s[n];if(isNaN(h)||h<=0)return!0}return!1},o}(Zr),Dn={vector:ar,raster:Kt,"raster-dem":pn,geojson:Qi,video:Ln,image:Zr,canvas:Xn};function Wn(i,o){var n=l.identity([]);return l.translate(n,n,[1,1,0]),l.scale(n,n,[.5*i.width,.5*i.height,1]),l.multiply(n,n,i.calculatePosMatrix(o.toUnwrapped()))}function Gr(i,o,n,s,h,m){var y=function($,j,K){if($)for(var te=0,oe=$;te<oe.length;te+=1){var de=j[oe[te]];if(de&&de.source===K&&de.type==="fill-extrusion")return!0}else for(var pe in j){var me=j[pe];if(me.source===K&&me.type==="fill-extrusion")return!0}return!1}(h&&h.layers,o,i.id),v=m.maxPitchScaleFactor(),S=i.tilesIn(s,v,y);S.sort(en);for(var A=[],D=0,B=S;D<B.length;D+=1){var R=B[D];A.push({wrappedTileID:R.tileID.wrapped().key,queryResults:R.tile.queryRenderedFeatures(o,n,i._state,R.queryGeometry,R.cameraQueryGeometry,R.scale,h,m,v,Wn(i.transform,R.tileID))})}var G=function($){for(var j={},K={},te=0,oe=$;te<oe.length;te+=1){var de=oe[te],pe=de.queryResults,me=de.wrappedTileID,_e=K[me]=K[me]||{};for(var ze in pe)for(var Se=pe[ze],Ue=_e[ze]=_e[ze]||{},Qe=j[ze]=j[ze]||[],rt=0,et=Se;rt<et.length;rt+=1){var Ft=et[rt];Ue[Ft.featureIndex]||(Ue[Ft.featureIndex]=!0,Qe.push(Ft))}}return j}(A);for(var q in G)G[q].forEach(function($){var j=$.feature,K=i.getFeatureState(j.layer["source-layer"],j.id);j.source=j.layer.source,j.layer["source-layer"]&&(j.sourceLayer=j.layer["source-layer"]),j.state=K});return G}function en(i,o){var n=i.tileID,s=o.tileID;return n.overscaledZ-s.overscaledZ||n.canonical.y-s.canonical.y||n.wrap-s.wrap||n.canonical.x-s.canonical.x}var Ht=function(i,o){this.max=i,this.onRemove=o,this.reset()};Ht.prototype.reset=function(){for(var i in this.data)for(var o=0,n=this.data[i];o<n.length;o+=1){var s=n[o];s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value)}return this.data={},this.order=[],this},Ht.prototype.add=function(i,o,n){var s=this,h=i.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);var m={value:o,timeout:void 0};if(n!==void 0&&(m.timeout=setTimeout(function(){s.remove(i,m)},n)),this.data[h].push(m),this.order.push(h),this.order.length>this.max){var y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this},Ht.prototype.has=function(i){return i.wrapped().key in this.data},Ht.prototype.getAndRemove=function(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null},Ht.prototype._getAndRemoveByKey=function(i){var o=this.data[i].shift();return o.timeout&&clearTimeout(o.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),o.value},Ht.prototype.getByKey=function(i){var o=this.data[i];return o?o[0].value:null},Ht.prototype.get=function(i){return this.has(i)?this.data[i.wrapped().key][0].value:null},Ht.prototype.remove=function(i,o){if(!this.has(i))return this;var n=i.wrapped().key,s=o===void 0?0:this.data[n].indexOf(o),h=this.data[n][s];return this.data[n].splice(s,1),h.timeout&&clearTimeout(h.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(h.value),this.order.splice(this.order.indexOf(n),1),this},Ht.prototype.setMaxSize=function(i){for(this.max=i;this.order.length>this.max;){var o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this},Ht.prototype.filter=function(i){var o=[];for(var n in this.data)for(var s=0,h=this.data[n];s<h.length;s+=1){var m=h[s];i(m.value)||o.push(m)}for(var y=0,v=o;y<v.length;y+=1){var S=v[y];this.remove(S.value.tileID,S)}};var yi=function(i,o,n){this.context=i;var s=i.gl;this.buffer=s.createBuffer(),this.dynamicDraw=!!n,this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),s.bufferData(s.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?s.DYNAMIC_DRAW:s.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer};yi.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},yi.prototype.updateData=function(i){var o=this.context.gl;this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)},yi.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Rn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Li=function(i,o,n,s){this.length=o.length,this.attributes=n,this.itemSize=o.bytesPerElement,this.dynamicDraw=s,this.context=i;var h=i.gl;this.buffer=h.createBuffer(),i.bindVertexBuffer.set(this.buffer),h.bufferData(h.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer};Li.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Li.prototype.updateData=function(i){var o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,i.arrayBuffer)},Li.prototype.enableAttributes=function(i,o){for(var n=0;n<this.attributes.length;n++){var s=o.attributes[this.attributes[n].name];s!==void 0&&i.enableVertexAttribArray(s)}},Li.prototype.setVertexAttribPointers=function(i,o,n){for(var s=0;s<this.attributes.length;s++){var h=this.attributes[s],m=o.attributes[h.name];m!==void 0&&i.vertexAttribPointer(m,h.components,i[Rn[h.type]],!1,this.itemSize,h.offset+this.itemSize*(n||0))}},Li.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var H=function(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};H.prototype.get=function(){return this.current},H.prototype.set=function(i){},H.prototype.getDefault=function(){return this.default},H.prototype.setDefault=function(){this.set(this.default)};var ie=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return l.Color.transparent},o.prototype.set=function(n){var s=this.current;(n.r!==s.r||n.g!==s.g||n.b!==s.b||n.a!==s.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},o}(H),ye=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return 1},o.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)},o}(H),Te=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return 0},o.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)},o}(H),Ie=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return[!0,!0,!0,!0]},o.prototype.set=function(n){var s=this.current;(n[0]!==s[0]||n[1]!==s[1]||n[2]!==s[2]||n[3]!==s[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},o}(H),Ce=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return!0},o.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)},o}(H),Ge=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return 255},o.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)},o}(H),Le=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},o.prototype.set=function(n){var s=this.current;(n.func!==s.func||n.ref!==s.ref||n.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)},o}(H),Oe=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){var n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]},o.prototype.set=function(n){var s=this.current;(n[0]!==s[0]||n[1]!==s[1]||n[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)},o}(H),Pe=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;n?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=n,this.dirty=!1}},o}(H),He=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return[0,1]},o.prototype.set=function(n){var s=this.current;(n[0]!==s[0]||n[1]!==s[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)},o}(H),Ye=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;n?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=n,this.dirty=!1}},o}(H),it=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.LESS},o.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)},o}(H),ut=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;n?s.enable(s.BLEND):s.disable(s.BLEND),this.current=n,this.dirty=!1}},o}(H),Mt=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){var n=this.gl;return[n.ONE,n.ZERO]},o.prototype.set=function(n){var s=this.current;(n[0]!==s[0]||n[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)},o}(H),sr=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return l.Color.transparent},o.prototype.set=function(n){var s=this.current;(n.r!==s.r||n.g!==s.g||n.b!==s.b||n.a!==s.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},o}(H),Zt=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.FUNC_ADD},o.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)},o}(H),zr=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;n?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=n,this.dirty=!1}},o}(H),hi=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.BACK},o.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)},o}(H),Sn=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.CCW},o.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)},o}(H),Kn=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)},o}(H),En=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.TEXTURE0},o.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)},o}(H),Bn=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){var n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]},o.prototype.set=function(n){var s=this.current;(n[0]!==s[0]||n[1]!==s[1]||n[2]!==s[2]||n[3]!==s[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},o}(H),ni=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,n),this.current=n,this.dirty=!1}},o}(H),Si=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,n),this.current=n,this.dirty=!1}},o}(H),Bo=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.bindTexture(s.TEXTURE_2D,n),this.current=n,this.dirty=!1}},o}(H),Ms=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}},o}(H),Oo=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(n){var s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1},o}(H),Fo=function(i){function o(n){i.call(this,n),this.vao=n.extVertexArrayObject}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)},o}(H),co=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return 4},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}},o}(H),Uo=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}},o}(H),da=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}},o}(H),Ir=function(i){function o(n,s){i.call(this,n),this.context=n,this.parent=s}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o}(H),C=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.setDirty=function(){this.dirty=!0},o.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}},o}(Ir),M=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,n),this.current=n,this.dirty=!1}},o}(Ir),k=function(i,o,n,s){this.context=i,this.width=o,this.height=n;var h=this.framebuffer=i.gl.createFramebuffer();this.colorAttachment=new C(i,h),s&&(this.depthAttachment=new M(i,h))};k.prototype.destroy=function(){var i=this.context.gl,o=this.colorAttachment.get();if(o&&i.deleteTexture(o),this.depthAttachment){var n=this.depthAttachment.get();n&&i.deleteRenderbuffer(n)}i.deleteFramebuffer(this.framebuffer)};var O=function(i,o,n){this.func=i,this.mask=o,this.range=n};O.ReadOnly=!1,O.ReadWrite=!0,O.disabled=new O(519,O.ReadOnly,[0,1]);var Z=function(i,o,n,s,h,m){this.test=i,this.ref=o,this.mask=n,this.fail=s,this.depthFail=h,this.pass=m};Z.disabled=new Z({func:519,mask:0},0,0,7680,7680,7680);var ee=function(i,o,n){this.blendFunction=i,this.blendColor=o,this.mask=n};ee.disabled=new ee(ee.Replace=[1,0],l.Color.transparent,[!1,!1,!1,!1]),ee.unblended=new ee(ee.Replace,l.Color.transparent,[!0,!0,!0,!0]),ee.alphaBlended=new ee([1,771],l.Color.transparent,[!0,!0,!0,!0]);var re=function(i,o,n){this.enable=i,this.mode=o,this.frontFace=n};re.disabled=new re(!1,1029,2305),re.backCCW=new re(!0,1029,2305);var Y=function(i){this.gl=i,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ie(this),this.clearDepth=new ye(this),this.clearStencil=new Te(this),this.colorMask=new Ie(this),this.depthMask=new Ce(this),this.stencilMask=new Ge(this),this.stencilFunc=new Le(this),this.stencilOp=new Oe(this),this.stencilTest=new Pe(this),this.depthRange=new He(this),this.depthTest=new Ye(this),this.depthFunc=new it(this),this.blend=new ut(this),this.blendFunc=new Mt(this),this.blendColor=new sr(this),this.blendEquation=new Zt(this),this.cullFace=new zr(this),this.cullFaceSide=new hi(this),this.frontFace=new Sn(this),this.program=new Kn(this),this.activeTexture=new En(this),this.viewport=new Bn(this),this.bindFramebuffer=new ni(this),this.bindRenderbuffer=new Si(this),this.bindTexture=new Bo(this),this.bindVertexBuffer=new Ms(this),this.bindElementBuffer=new Oo(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Fo(this),this.pixelStoreUnpack=new co(this),this.pixelStoreUnpackPremultiplyAlpha=new Uo(this),this.pixelStoreUnpackFlipY=new da(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=i.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(i.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=i.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=i.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE)};Y.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Y.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Y.prototype.createIndexBuffer=function(i,o){return new yi(this,i,o)},Y.prototype.createVertexBuffer=function(i,o,n){return new Li(this,i,o,n)},Y.prototype.createRenderbuffer=function(i,o,n){var s=this.gl,h=s.createRenderbuffer();return this.bindRenderbuffer.set(h),s.renderbufferStorage(s.RENDERBUFFER,i,o,n),this.bindRenderbuffer.set(null),h},Y.prototype.createFramebuffer=function(i,o,n){return new k(this,i,o,n)},Y.prototype.clear=function(i){var o=i.color,n=i.depth,s=this.gl,h=0;o&&(h|=s.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(h|=s.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),s.clear(h)},Y.prototype.setCullFace=function(i){i.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))},Y.prototype.setDepthMode=function(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)},Y.prototype.setStencilMode=function(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)},Y.prototype.setColorMode=function(i){l.deepEqual(i.blendFunction,ee.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)},Y.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var F=function(i){function o(n,s,h){var m=this;i.call(this),this.id=n,this.dispatcher=h,this.on("data",function(y){y.dataType==="source"&&y.sourceDataType==="metadata"&&(m._sourceLoaded=!0),m._sourceLoaded&&!m._paused&&y.dataType==="source"&&y.sourceDataType==="content"&&(m.reload(),m.transform&&m.update(m.transform))}),this.on("error",function(){m._sourceErrored=!0}),this._source=function(y,v,S,A){var D=new Dn[v.type](y,v,S,A);if(D.id!==y)throw new Error("Expected Source id to be "+y+" instead of "+D.id);return l.bindAll(["load","abort","unload","serialize","prepare"],D),D}(n,s,h,this),this._tiles={},this._cache=new Ht(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new l.SourceFeatureState}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.onAdd=function(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(n)},o.prototype.onRemove=function(n){this._source&&this._source.onRemove&&this._source.onRemove(n)},o.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var n in this._tiles){var s=this._tiles[n];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0},o.prototype.getSource=function(){return this._source},o.prototype.pause=function(){this._paused=!0},o.prototype.resume=function(){if(this._paused){var n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}},o.prototype._loadTile=function(n,s){return this._source.loadTile(n,s)},o.prototype._unloadTile=function(n){if(this._source.unloadTile)return this._source.unloadTile(n,function(){})},o.prototype._abortTile=function(n){if(this._source.abortTile)return this._source.abortTile(n,function(){})},o.prototype.serialize=function(){return this._source.serialize()},o.prototype.prepare=function(n){for(var s in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var h=this._tiles[s];h.upload(n),h.prepare(this.map.style.imageManager)}},o.prototype.getIds=function(){return l.values(this._tiles).map(function(n){return n.tileID}).sort(X).map(function(n){return n.key})},o.prototype.getRenderableIds=function(n){var s=this,h=[];for(var m in this._tiles)this._isIdRenderable(m,n)&&h.push(this._tiles[m]);return n?h.sort(function(y,v){var S=y.tileID,A=v.tileID,D=new l.Point(S.canonical.x,S.canonical.y)._rotate(s.transform.angle),B=new l.Point(A.canonical.x,A.canonical.y)._rotate(s.transform.angle);return S.overscaledZ-A.overscaledZ||B.y-D.y||B.x-D.x}).map(function(y){return y.tileID.key}):h.map(function(y){return y.tileID}).sort(X).map(function(y){return y.key})},o.prototype.hasRenderableParent=function(n){var s=this.findLoadedParent(n,0);return!!s&&this._isIdRenderable(s.tileID.key)},o.prototype._isIdRenderable=function(n,s){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(s||!this._tiles[n].holdingForFade())},o.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var n in this._cache.reset(),this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")},o.prototype._reloadTile=function(n,s){var h=this._tiles[n];h&&(h.state!=="loading"&&(h.state=s),this._loadTile(h,this._tileLoaded.bind(this,h,n,s)))},o.prototype._tileLoaded=function(n,s,h,m){if(m)return n.state="errored",void(m.status!==404?this._source.fire(new l.ErrorEvent(m,{tile:n})):this.update(this.transform));n.timeAdded=l.browser.now(),h==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(s,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new l.Event("data",{dataType:"source",tile:n,coord:n.tileID}))},o.prototype._backfillDEM=function(n){for(var s=this.getRenderableIds(),h=0;h<s.length;h++){var m=s[h];if(n.neighboringTiles&&n.neighboringTiles[m]){var y=this.getTileByID(m);v(n,y),v(y,n)}}function v(S,A){S.needsHillshadePrepare=!0;var D=A.tileID.canonical.x-S.tileID.canonical.x,B=A.tileID.canonical.y-S.tileID.canonical.y,R=Math.pow(2,S.tileID.canonical.z),G=A.tileID.key;D===0&&B===0||Math.abs(B)>1||(Math.abs(D)>1&&(Math.abs(D+R)===1?D+=R:Math.abs(D-R)===1&&(D-=R)),A.dem&&S.dem&&(S.dem.backfillBorder(A.dem,D,B),S.neighboringTiles&&S.neighboringTiles[G]&&(S.neighboringTiles[G].backfilled=!0)))}},o.prototype.getTile=function(n){return this.getTileByID(n.key)},o.prototype.getTileByID=function(n){return this._tiles[n]},o.prototype._retainLoadedChildren=function(n,s,h,m){for(var y in this._tiles){var v=this._tiles[y];if(!(m[y]||!v.hasData()||v.tileID.overscaledZ<=s||v.tileID.overscaledZ>h)){for(var S=v.tileID;v&&v.tileID.overscaledZ>s+1;){var A=v.tileID.scaledTo(v.tileID.overscaledZ-1);(v=this._tiles[A.key])&&v.hasData()&&(S=A)}for(var D=S;D.overscaledZ>s;)if(n[(D=D.scaledTo(D.overscaledZ-1)).key]){m[S.key]=S;break}}}},o.prototype.findLoadedParent=function(n,s){if(n.key in this._loadedParentTiles){var h=this._loadedParentTiles[n.key];return h&&h.tileID.overscaledZ>=s?h:null}for(var m=n.overscaledZ-1;m>=s;m--){var y=n.scaledTo(m),v=this._getLoadedTile(y);if(v)return v}},o.prototype._getLoadedTile=function(n){var s=this._tiles[n.key];return s&&s.hasData()?s:this._cache.getByKey(n.wrapped().key)},o.prototype.updateCacheSize=function(n){var s=Math.ceil(n.width/this._source.tileSize)+1,h=Math.ceil(n.height/this._source.tileSize)+1,m=Math.floor(s*h*5),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,m):m;this._cache.setMaxSize(y)},o.prototype.handleWrapJump=function(n){var s=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,s){var h={};for(var m in this._tiles){var y=this._tiles[m];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+s),h[y.tileID.key]=y}for(var v in this._tiles=h,this._timers)clearTimeout(this._timers[v]),delete this._timers[v];for(var S in this._tiles)this._setTileReloadTimer(S,this._tiles[S])}},o.prototype.update=function(n){var s=this;if(this.transform=n,this._sourceLoaded&&!this._paused){var h;this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?h=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(_e){return new l.OverscaledTileID(_e.canonical.z,_e.wrap,_e.canonical.z,_e.canonical.x,_e.canonical.y)}):(h=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(h=h.filter(function(_e){return s._source.hasTile(_e)}))):h=[];var m=n.coveringZoomLevel(this._source),y=Math.max(m-o.maxOverzooming,this._source.minzoom),v=Math.max(m+o.maxUnderzooming,this._source.minzoom),S=this._updateRetainedTiles(h,m);if(be(this._source.type)){for(var A={},D={},B=0,R=Object.keys(S);B<R.length;B+=1){var G=R[B],q=S[G],$=this._tiles[G];if($&&!($.fadeEndTime&&$.fadeEndTime<=l.browser.now())){var j=this.findLoadedParent(q,y);j&&(this._addTile(j.tileID),A[j.tileID.key]=j.tileID),D[G]=q}}for(var K in this._retainLoadedChildren(D,m,v,S),A)S[K]||(this._coveredTiles[K]=!0,S[K]=A[K])}for(var te in S)this._tiles[te].clearFadeHold();for(var oe=0,de=l.keysDifference(this._tiles,S);oe<de.length;oe+=1){var pe=de[oe],me=this._tiles[pe];me.hasSymbolBuckets&&!me.holdingForFade()?me.setHoldDuration(this.map._fadeDuration):me.hasSymbolBuckets&&!me.symbolFadeFinished()||this._removeTile(pe)}this._updateLoadedParentTileCache()}},o.prototype.releaseSymbolFadeTiles=function(){for(var n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)},o.prototype._updateRetainedTiles=function(n,s){for(var h={},m={},y=Math.max(s-o.maxOverzooming,this._source.minzoom),v=Math.max(s+o.maxUnderzooming,this._source.minzoom),S={},A=0,D=n;A<D.length;A+=1){var B=D[A],R=this._addTile(B);h[B.key]=B,R.hasData()||s<this._source.maxzoom&&(S[B.key]=B)}this._retainLoadedChildren(S,s,v,h);for(var G=0,q=n;G<q.length;G+=1){var $=q[G],j=this._tiles[$.key];if(!j.hasData()){if(s+1>this._source.maxzoom){var K=$.children(this._source.maxzoom)[0],te=this.getTile(K);if(te&&te.hasData()){h[K.key]=K;continue}}else{var oe=$.children(this._source.maxzoom);if(h[oe[0].key]&&h[oe[1].key]&&h[oe[2].key]&&h[oe[3].key])continue}for(var de=j.wasRequested(),pe=$.overscaledZ-1;pe>=y;--pe){var me=$.scaledTo(pe);if(m[me.key]||(m[me.key]=!0,!(j=this.getTile(me))&&de&&(j=this._addTile(me)),j&&(h[me.key]=me,de=j.wasRequested(),j.hasData())))break}}}return h},o.prototype._updateLoadedParentTileCache=function(){for(var n in this._loadedParentTiles={},this._tiles){for(var s=[],h=void 0,m=this._tiles[n].tileID;m.overscaledZ>0;){if(m.key in this._loadedParentTiles){h=this._loadedParentTiles[m.key];break}s.push(m.key);var y=m.scaledTo(m.overscaledZ-1);if(h=this._getLoadedTile(y))break;m=y}for(var v=0,S=s;v<S.length;v+=1)this._loadedParentTiles[S[v]]=h}},o.prototype._addTile=function(n){var s=this._tiles[n.key];if(s)return s;(s=this._cache.getAndRemove(n))&&(this._setTileReloadTimer(n.key,s),s.tileID=n,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,s)));var h=!!s;return h||(s=new l.Tile(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(s,this._tileLoaded.bind(this,s,n.key,s.state))),s?(s.uses++,this._tiles[n.key]=s,h||this._source.fire(new l.Event("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s):null},o.prototype._setTileReloadTimer=function(n,s){var h=this;n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);var m=s.getExpiryTimeout();m&&(this._timers[n]=setTimeout(function(){h._reloadTile(n,"expired"),delete h._timers[n]},m))},o.prototype._removeTile=function(n){var s=this._tiles[n];s&&(s.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))},o.prototype.clearTiles=function(){for(var n in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(n);this._cache.reset()},o.prototype.tilesIn=function(n,s,h){var m=this,y=[],v=this.transform;if(!v)return y;for(var S=h?v.getCameraQueryGeometry(n):n,A=n.map(function(pe){return v.pointCoordinate(pe)}),D=S.map(function(pe){return v.pointCoordinate(pe)}),B=this.getIds(),R=1/0,G=1/0,q=-1/0,$=-1/0,j=0,K=D;j<K.length;j+=1){var te=K[j];R=Math.min(R,te.x),G=Math.min(G,te.y),q=Math.max(q,te.x),$=Math.max($,te.y)}for(var oe=function(pe){var me=m._tiles[B[pe]];if(!me.holdingForFade()){var _e=me.tileID,ze=Math.pow(2,v.zoom-me.tileID.overscaledZ),Se=s*me.queryPadding*l.EXTENT/me.tileSize/ze,Ue=[_e.getTilePoint(new l.MercatorCoordinate(R,G)),_e.getTilePoint(new l.MercatorCoordinate(q,$))];if(Ue[0].x-Se<l.EXTENT&&Ue[0].y-Se<l.EXTENT&&Ue[1].x+Se>=0&&Ue[1].y+Se>=0){var Qe=A.map(function(et){return _e.getTilePoint(et)}),rt=D.map(function(et){return _e.getTilePoint(et)});y.push({tile:me,tileID:_e,queryGeometry:Qe,cameraQueryGeometry:rt,scale:ze})}}},de=0;de<B.length;de++)oe(de);return y},o.prototype.getVisibleCoordinates=function(n){for(var s=this,h=this.getRenderableIds(n).map(function(S){return s._tiles[S].tileID}),m=0,y=h;m<y.length;m+=1){var v=y[m];v.posMatrix=this.transform.calculatePosMatrix(v.toUnwrapped())}return h},o.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(be(this._source.type))for(var n in this._tiles){var s=this._tiles[n];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=l.browser.now())return!0}return!1},o.prototype.setFeatureState=function(n,s,h){this._state.updateState(n=n||"_geojsonTileLayer",s,h)},o.prototype.removeFeatureState=function(n,s,h){this._state.removeFeatureState(n=n||"_geojsonTileLayer",s,h)},o.prototype.getFeatureState=function(n,s){return this._state.getState(n=n||"_geojsonTileLayer",s)},o.prototype.setDependencies=function(n,s,h){var m=this._tiles[n];m&&m.setDependencies(s,h)},o.prototype.reloadTilesForDependencies=function(n,s){for(var h in this._tiles)this._tiles[h].hasDependency(n,s)&&this._reloadTile(h,"reloading");this._cache.filter(function(m){return!m.hasDependency(n,s)})},o}(l.Evented);function X(i,o){var n=Math.abs(2*i.wrap)-+(i.wrap<0),s=Math.abs(2*o.wrap)-+(o.wrap<0);return i.overscaledZ-o.overscaledZ||s-n||o.canonical.y-i.canonical.y||o.canonical.x-i.canonical.x}function be(i){return i==="raster"||i==="image"||i==="video"}function Me(){return new l.window.Worker(rl.workerUrl)}F.maxOverzooming=10,F.maxUnderzooming=3;var le="mapboxgl_preloaded_worker_pool",we=function(){this.active={}};we.prototype.acquire=function(i){if(!this.workers)for(this.workers=[];this.workers.length<we.workerCount;)this.workers.push(new Me);return this.active[i]=!0,this.workers.slice()},we.prototype.release=function(i){delete this.active[i],this.numActive()===0&&(this.workers.forEach(function(o){o.terminate()}),this.workers=null)},we.prototype.isPreloaded=function(){return!!this.active[le]},we.prototype.numActive=function(){return Object.keys(this.active).length};var Ve,je=Math.floor(l.browser.hardwareConcurrency/2);function $e(){return Ve||(Ve=new we),Ve}function ve(i,o){var n={};for(var s in i)s!=="ref"&&(n[s]=i[s]);return l.refProperties.forEach(function(h){h in o&&(n[h]=o[h])}),n}function De(i){i=i.slice();for(var o=Object.create(null),n=0;n<i.length;n++)o[i[n].id]=i[n];for(var s=0;s<i.length;s++)"ref"in i[s]&&(i[s]=ve(i[s],o[i[s].ref]));return i}we.workerCount=Math.max(Math.min(je,6),1);var xe={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function yt(i,o,n){n.push({command:xe.addSource,args:[i,o[i]]})}function gt(i,o,n){o.push({command:xe.removeSource,args:[i]}),n[i]=!0}function Xe(i,o,n,s){gt(i,n,s),yt(i,o,n)}function lr(i,o,n){var s;for(s in i[n])if(i[n].hasOwnProperty(s)&&s!=="data"&&!l.deepEqual(i[n][s],o[n][s]))return!1;for(s in o[n])if(o[n].hasOwnProperty(s)&&s!=="data"&&!l.deepEqual(i[n][s],o[n][s]))return!1;return!0}function At(i,o,n,s,h,m){var y;for(y in o=o||{},i=i||{})i.hasOwnProperty(y)&&(l.deepEqual(i[y],o[y])||n.push({command:m,args:[s,y,o[y],h]}));for(y in o)o.hasOwnProperty(y)&&!i.hasOwnProperty(y)&&(l.deepEqual(i[y],o[y])||n.push({command:m,args:[s,y,o[y],h]}))}function hr(i){return i.id}function yr(i,o){return i[o.id]=o,i}var Bt=function(i,o){this.reset(i,o)};Bt.prototype.reset=function(i,o){this.points=i||[],this._distances=[0];for(var n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Bt.prototype.lerp=function(i){if(this.points.length===1)return this.points[0];i=l.clamp(i,0,1);for(var o=1,n=this._distances[o],s=i*this.paddedLength+this.padding;n<s&&o<this._distances.length;)n=this._distances[++o];var h=o-1,m=this._distances[h],y=n-m,v=y>0?(s-m)/y:0;return this.points[h].mult(1-v).add(this.points[o].mult(v))};var ur=function(i,o,n){var s=this.boxCells=[],h=this.circleCells=[];this.xCellCount=Math.ceil(i/n),this.yCellCount=Math.ceil(o/n);for(var m=0;m<this.xCellCount*this.yCellCount;m++)s.push([]),h.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=o,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0};function Cr(i,o,n,s,h){var m=l.create();return o?(l.scale(m,m,[1/h,1/h,1]),n||l.rotateZ(m,m,s.angle)):l.multiply(m,s.labelPlaneMatrix,i),m}function cr(i,o,n,s,h){if(o){var m=l.clone(i);return l.scale(m,m,[h,h,1]),n||l.rotateZ(m,m,-s.angle),m}return s.glCoordMatrix}function Tt(i,o){var n=[i.x,i.y,0,1];hn(n,n,o);var s=n[3];return{point:new l.Point(n[0]/s,n[1]/s),signedDistanceFromCamera:s}}function ma(i,o){return .5+i/o*.5}function kt(i,o){var n=i[0]/i[3],s=i[1]/i[3];return n>=-o[0]&&n<=o[0]&&s>=-o[1]&&s<=o[1]}function Vo(i,o,n,s,h,m,y,v){var S=s?i.textSizeData:i.iconSizeData,A=l.evaluateSizeForZoom(S,n.transform.zoom),D=[256/n.width*2+1,256/n.height*2+1],B=s?i.text.dynamicLayoutVertexArray:i.icon.dynamicLayoutVertexArray;B.clear();for(var R=i.lineVertexArray,G=s?i.text.placedSymbolArray:i.icon.placedSymbolArray,q=n.transform.width/n.transform.height,$=!1,j=0;j<G.length;j++){var K=G.get(j);if(K.hidden||K.writingMode===l.WritingMode.vertical&&!$)On(K.numGlyphs,B);else{$=!1;var te=[K.anchorX,K.anchorY,0,1];if(l.transformMat4(te,te,o),kt(te,D)){var oe=ma(n.transform.cameraToCenterDistance,te[3]),de=l.evaluateSizeForFeature(S,A,K),pe=y?de/oe:de*oe,me=new l.Point(K.anchorX,K.anchorY),_e=Tt(me,h).point,ze={},Se=Di(K,pe,!1,v,o,h,m,i.glyphOffsetArray,R,B,_e,me,ze,q);$=Se.useVertical,(Se.notEnoughRoom||$||Se.needsFlipping&&Di(K,pe,!0,v,o,h,m,i.glyphOffsetArray,R,B,_e,me,ze,q).notEnoughRoom)&&On(K.numGlyphs,B)}else On(K.numGlyphs,B)}}s?i.text.dynamicLayoutVertexBuffer.updateData(B):i.icon.dynamicLayoutVertexBuffer.updateData(B)}function ks(i,o,n,s,h,m,y,v,S,A,D){var B=v.glyphStartIndex+v.numGlyphs,R=v.lineStartIndex,G=v.lineStartIndex+v.lineLength,q=o.getoffsetX(v.glyphStartIndex),$=o.getoffsetX(B-1),j=No(i*q,n,s,h,m,y,v.segment,R,G,S,A,D);if(!j)return null;var K=No(i*$,n,s,h,m,y,v.segment,R,G,S,A,D);return K?{first:j,last:K}:null}function oi(i,o,n,s){return i===l.WritingMode.horizontal&&Math.abs(n.y-o.y)>Math.abs(n.x-o.x)*s?{useVertical:!0}:(i===l.WritingMode.vertical?o.y<n.y:o.x>n.x)?{needsFlipping:!0}:null}function Di(i,o,n,s,h,m,y,v,S,A,D,B,R,G){var q,$=o/24,j=i.lineOffsetX*$,K=i.lineOffsetY*$;if(i.numGlyphs>1){var te=i.glyphStartIndex+i.numGlyphs,oe=i.lineStartIndex,de=i.lineStartIndex+i.lineLength,pe=ks($,v,j,K,n,D,B,i,S,m,R);if(!pe)return{notEnoughRoom:!0};var me=Tt(pe.first.point,y).point,_e=Tt(pe.last.point,y).point;if(s&&!n){var ze=oi(i.writingMode,me,_e,G);if(ze)return ze}q=[pe.first];for(var Se=i.glyphStartIndex+1;Se<te-1;Se++)q.push(No($*v.getoffsetX(Se),j,K,n,D,B,i.segment,oe,de,S,m,R));q.push(pe.last)}else{if(s&&!n){var Ue=Tt(B,h).point,Qe=i.lineStartIndex+i.segment+1,rt=new l.Point(S.getx(Qe),S.gety(Qe)),et=Tt(rt,h),Ft=et.signedDistanceFromCamera>0?et.point:Ol(B,rt,Ue,1,h),Ze=oi(i.writingMode,Ue,Ft,G);if(Ze)return Ze}var dt=No($*v.getoffsetX(i.glyphStartIndex),j,K,n,D,B,i.segment,i.lineStartIndex,i.lineStartIndex+i.lineLength,S,m,R);if(!dt)return{notEnoughRoom:!0};q=[dt]}for(var St=0,mt=q;St<mt.length;St+=1){var pt=mt[St];l.addDynamicAttributes(A,pt.point,pt.angle)}return{}}function Ol(i,o,n,s,h){var m=Tt(i.add(i.sub(o)._unit()),h).point,y=n.sub(m);return n.add(y._mult(s/y.mag()))}function No(i,o,n,s,h,m,y,v,S,A,D,B){var R=s?i-o:i+o,G=R>0?1:-1,q=0;s&&(G*=-1,q=Math.PI),G<0&&(q+=Math.PI);for(var $=G>0?v+y:v+y+1,j=h,K=h,te=0,oe=0,de=Math.abs(R),pe=[];te+oe<=de;){if(($+=G)<v||$>=S)return null;if(K=j,pe.push(j),(j=B[$])===void 0){var me=new l.Point(A.getx($),A.gety($)),_e=Tt(me,D);if(_e.signedDistanceFromCamera>0)j=B[$]=_e.point;else{var ze=$-G;j=Ol(te===0?m:new l.Point(A.getx(ze),A.gety(ze)),me,K,de-te+1,D)}}te+=oe,oe=K.dist(j)}var Se=(de-te)/oe,Ue=j.sub(K),Qe=Ue.mult(Se)._add(K);Qe._add(Ue._unit()._perp()._mult(n*G));var rt=q+Math.atan2(j.y-K.y,j.x-K.x);return pe.push(Qe),{point:Qe,angle:rt,path:pe}}ur.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},ur.prototype.insert=function(i,o,n,s,h){this._forEachCell(o,n,s,h,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(o),this.bboxes.push(n),this.bboxes.push(s),this.bboxes.push(h)},ur.prototype.insertCircle=function(i,o,n,s){this._forEachCell(o-s,n-s,o+s,n+s,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(o),this.circles.push(n),this.circles.push(s)},ur.prototype._insertBoxCell=function(i,o,n,s,h,m){this.boxCells[h].push(m)},ur.prototype._insertCircleCell=function(i,o,n,s,h,m){this.circleCells[h].push(m)},ur.prototype._query=function(i,o,n,s,h,m){if(n<0||i>this.width||s<0||o>this.height)return!h&&[];var y=[];if(i<=0&&o<=0&&this.width<=n&&this.height<=s){if(h)return!0;for(var v=0;v<this.boxKeys.length;v++)y.push({key:this.boxKeys[v],x1:this.bboxes[4*v],y1:this.bboxes[4*v+1],x2:this.bboxes[4*v+2],y2:this.bboxes[4*v+3]});for(var S=0;S<this.circleKeys.length;S++){var A=this.circles[3*S],D=this.circles[3*S+1],B=this.circles[3*S+2];y.push({key:this.circleKeys[S],x1:A-B,y1:D-B,x2:A+B,y2:D+B})}return m?y.filter(m):y}return this._forEachCell(i,o,n,s,this._queryCell,y,{hitTest:h,seenUids:{box:{},circle:{}}},m),h?y.length>0:y},ur.prototype._queryCircle=function(i,o,n,s,h){var m=i-n,y=i+n,v=o-n,S=o+n;if(y<0||m>this.width||S<0||v>this.height)return!s&&[];var A=[];return this._forEachCell(m,v,y,S,this._queryCellCircle,A,{hitTest:s,circle:{x:i,y:o,radius:n},seenUids:{box:{},circle:{}}},h),s?A.length>0:A},ur.prototype.query=function(i,o,n,s,h){return this._query(i,o,n,s,!1,h)},ur.prototype.hitTest=function(i,o,n,s,h){return this._query(i,o,n,s,!0,h)},ur.prototype.hitTestCircle=function(i,o,n,s){return this._queryCircle(i,o,n,!0,s)},ur.prototype._queryCell=function(i,o,n,s,h,m,y,v){var S=y.seenUids,A=this.boxCells[h];if(A!==null)for(var D=this.bboxes,B=0,R=A;B<R.length;B+=1){var G=R[B];if(!S.box[G]){S.box[G]=!0;var q=4*G;if(i<=D[q+2]&&o<=D[q+3]&&n>=D[q+0]&&s>=D[q+1]&&(!v||v(this.boxKeys[G]))){if(y.hitTest)return m.push(!0),!0;m.push({key:this.boxKeys[G],x1:D[q],y1:D[q+1],x2:D[q+2],y2:D[q+3]})}}}var $=this.circleCells[h];if($!==null)for(var j=this.circles,K=0,te=$;K<te.length;K+=1){var oe=te[K];if(!S.circle[oe]){S.circle[oe]=!0;var de=3*oe;if(this._circleAndRectCollide(j[de],j[de+1],j[de+2],i,o,n,s)&&(!v||v(this.circleKeys[oe]))){if(y.hitTest)return m.push(!0),!0;var pe=j[de],me=j[de+1],_e=j[de+2];m.push({key:this.circleKeys[oe],x1:pe-_e,y1:me-_e,x2:pe+_e,y2:me+_e})}}}},ur.prototype._queryCellCircle=function(i,o,n,s,h,m,y,v){var S=y.circle,A=y.seenUids,D=this.boxCells[h];if(D!==null)for(var B=this.bboxes,R=0,G=D;R<G.length;R+=1){var q=G[R];if(!A.box[q]){A.box[q]=!0;var $=4*q;if(this._circleAndRectCollide(S.x,S.y,S.radius,B[$+0],B[$+1],B[$+2],B[$+3])&&(!v||v(this.boxKeys[q])))return m.push(!0),!0}}var j=this.circleCells[h];if(j!==null)for(var K=this.circles,te=0,oe=j;te<oe.length;te+=1){var de=oe[te];if(!A.circle[de]){A.circle[de]=!0;var pe=3*de;if(this._circlesCollide(K[pe],K[pe+1],K[pe+2],S.x,S.y,S.radius)&&(!v||v(this.circleKeys[de])))return m.push(!0),!0}}},ur.prototype._forEachCell=function(i,o,n,s,h,m,y,v){for(var S=this._convertToXCellCoord(i),A=this._convertToYCellCoord(o),D=this._convertToXCellCoord(n),B=this._convertToYCellCoord(s),R=S;R<=D;R++)for(var G=A;G<=B;G++)if(h.call(this,i,o,n,s,this.xCellCount*G+R,m,y,v))return},ur.prototype._convertToXCellCoord=function(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))},ur.prototype._convertToYCellCoord=function(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))},ur.prototype._circlesCollide=function(i,o,n,s,h,m){var y=s-i,v=h-o,S=n+m;return S*S>y*y+v*v},ur.prototype._circleAndRectCollide=function(i,o,n,s,h,m,y){var v=(m-s)/2,S=Math.abs(i-(s+v));if(S>v+n)return!1;var A=(y-h)/2,D=Math.abs(o-(h+A));if(D>A+n)return!1;if(S<=v||D<=A)return!0;var B=S-v,R=D-A;return B*B+R*R<=n*n};var Yr=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function On(i,o){for(var n=0;n<i;n++){var s=o.length;o.resize(s+4),o.float32.set(Yr,3*s)}}function hn(i,o,n){var s=o[0],h=o[1];return i[0]=n[0]*s+n[4]*h+n[12],i[1]=n[1]*s+n[5]*h+n[13],i[3]=n[3]*s+n[7]*h+n[15],i}var _r=function(i,o,n){o===void 0&&(o=new ur(i.width+200,i.height+200,25)),n===void 0&&(n=new ur(i.width+200,i.height+200,25)),this.transform=i,this.grid=o,this.ignoredGrid=n,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+100,this.screenBottomBoundary=i.height+100,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200};function Ri(i,o,n){return o*(l.EXTENT/(i.tileSize*Math.pow(2,n-i.tileID.overscaledZ)))}_r.prototype.placeCollisionBox=function(i,o,n,s,h){var m=this.projectAndGetPerspectiveRatio(s,i.anchorPointX,i.anchorPointY),y=n*m.perspectiveRatio,v=i.x1*y+m.point.x,S=i.y1*y+m.point.y,A=i.x2*y+m.point.x,D=i.y2*y+m.point.y;return!this.isInsideGrid(v,S,A,D)||!o&&this.grid.hitTest(v,S,A,D,h)?{box:[],offscreen:!1}:{box:[v,S,A,D],offscreen:this.isOffscreen(v,S,A,D)}},_r.prototype.placeCollisionCircles=function(i,o,n,s,h,m,y,v,S,A,D,B,R){var G=[],q=new l.Point(o.anchorX,o.anchorY),$=Tt(q,m),j=ma(this.transform.cameraToCenterDistance,$.signedDistanceFromCamera),K=(A?h/j:h*j)/l.ONE_EM,te=Tt(q,y).point,oe=ks(K,s,o.lineOffsetX*K,o.lineOffsetY*K,!1,te,q,o,n,y,{}),de=!1,pe=!1,me=!0;if(oe){for(var _e=.5*B*j+R,ze=new l.Point(-100,-100),Se=new l.Point(this.screenRightBoundary,this.screenBottomBoundary),Ue=new Bt,Qe=oe.first,rt=oe.last,et=[],Ft=Qe.path.length-1;Ft>=1;Ft--)et.push(Qe.path[Ft]);for(var Ze=1;Ze<rt.path.length;Ze++)et.push(rt.path[Ze]);var dt=2.5*_e;if(v){var St=et.map(function(sn){return Tt(sn,v)});et=St.some(function(sn){return sn.signedDistanceFromCamera<=0})?[]:St.map(function(sn){return sn.point})}var mt=[];if(et.length>0){for(var pt=et[0].clone(),ct=et[0].clone(),lt=1;lt<et.length;lt++)pt.x=Math.min(pt.x,et[lt].x),pt.y=Math.min(pt.y,et[lt].y),ct.x=Math.max(ct.x,et[lt].x),ct.y=Math.max(ct.y,et[lt].y);mt=pt.x>=ze.x&&ct.x<=Se.x&&pt.y>=ze.y&&ct.y<=Se.y?[et]:ct.x<ze.x||pt.x>Se.x||ct.y<ze.y||pt.y>Se.y?[]:l.clipLine([et],ze.x,ze.y,Se.x,Se.y)}for(var nt=0,rr=mt;nt<rr.length;nt+=1){var Dr;Ue.reset(rr[nt],.25*_e),Dr=Ue.length<=.5*_e?1:Math.ceil(Ue.paddedLength/dt)+1;for(var Ei=0;Ei<Dr;Ei++){var Qr=Ei/Math.max(Dr-1,1),ei=Ue.lerp(Qr),Rr=ei.x+100,vi=ei.y+100;G.push(Rr,vi,_e,0);var Vn=Rr-_e,Ti=vi-_e,Ii=Rr+_e,Nn=vi+_e;if(me=me&&this.isOffscreen(Vn,Ti,Ii,Nn),pe=pe||this.isInsideGrid(Vn,Ti,Ii,Nn),!i&&this.grid.hitTestCircle(Rr,vi,_e,D)&&(de=!0,!S))return{circles:[],offscreen:!1,collisionDetected:de}}}}return{circles:!S&&de||!pe?[]:G,offscreen:me,collisionDetected:de}},_r.prototype.queryRenderedSymbols=function(i){if(i.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var o=[],n=1/0,s=1/0,h=-1/0,m=-1/0,y=0,v=i;y<v.length;y+=1){var S=v[y],A=new l.Point(S.x+100,S.y+100);n=Math.min(n,A.x),s=Math.min(s,A.y),h=Math.max(h,A.x),m=Math.max(m,A.y),o.push(A)}for(var D={},B={},R=0,G=this.grid.query(n,s,h,m).concat(this.ignoredGrid.query(n,s,h,m));R<G.length;R+=1){var q=G[R],$=q.key;if(D[$.bucketInstanceId]===void 0&&(D[$.bucketInstanceId]={}),!D[$.bucketInstanceId][$.featureIndex]){var j=[new l.Point(q.x1,q.y1),new l.Point(q.x2,q.y1),new l.Point(q.x2,q.y2),new l.Point(q.x1,q.y2)];l.polygonIntersectsPolygon(o,j)&&(D[$.bucketInstanceId][$.featureIndex]=!0,B[$.bucketInstanceId]===void 0&&(B[$.bucketInstanceId]=[]),B[$.bucketInstanceId].push($.featureIndex))}}return B},_r.prototype.insertCollisionBox=function(i,o,n,s,h){(o?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:s,collisionGroupID:h},i[0],i[1],i[2],i[3])},_r.prototype.insertCollisionCircles=function(i,o,n,s,h){for(var m=o?this.ignoredGrid:this.grid,y={bucketInstanceId:n,featureIndex:s,collisionGroupID:h},v=0;v<i.length;v+=4)m.insertCircle(y,i[v],i[v+1],i[v+2])},_r.prototype.projectAndGetPerspectiveRatio=function(i,o,n){var s=[o,n,0,1];return hn(s,s,i),{point:new l.Point((s[0]/s[3]+1)/2*this.transform.width+100,(-s[1]/s[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/s[3]*.5}},_r.prototype.isOffscreen=function(i,o,n,s){return n<100||i>=this.screenRightBoundary||s<100||o>this.screenBottomBoundary},_r.prototype.isInsideGrid=function(i,o,n,s){return n>=0&&i<this.gridRightBoundary&&s>=0&&o<this.gridBottomBoundary},_r.prototype.getViewportMatrix=function(){var i=l.identity([]);return l.translate(i,i,[-100,-100,0]),i};var gi=function(i,o,n,s){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?o:-o))):s&&n?1:0,this.placed=n};gi.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Zi=function(i,o,n,s,h){this.text=new gi(i?i.text:null,o,n,h),this.icon=new gi(i?i.icon:null,o,s,h)};Zi.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var $n=function(i,o,n){this.text=i,this.icon=o,this.skipFade=n},zp=function(){this.invProjMatrix=l.create(),this.viewportMatrix=l.create(),this.circles=[]},fn=function(i,o,n,s,h){this.bucketInstanceId=i,this.featureIndex=o,this.sourceLayerIndex=n,this.bucketIndex=s,this.tileID=h},Ku=function(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}};function Jn(i,o,n,s,h){var m=l.getAnchorAlignment(i),y=-(m.horizontalAlign-.5)*o,v=-(m.verticalAlign-.5)*n,S=l.evaluateVariableOffset(i,s);return new l.Point(y+S[0]*h,v+S[1]*h)}function ai(i,o,n,s,h,m){var y=i.x1,v=i.x2,S=i.y1,A=i.y2,D=i.anchorPointX,B=i.anchorPointY,R=new l.Point(o,n);return s&&R._rotate(h?m:-m),{x1:y+R.x,y1:S+R.y,x2:v+R.x,y2:A+R.y,anchorPointX:D,anchorPointY:B}}Ku.prototype.get=function(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){var o=++this.maxGroupID;this.collisionGroups[i]={ID:o,predicate:function(n){return n.collisionGroupID===o}}}return this.collisionGroups[i]};var Hr=function(i,o,n,s){this.transform=i.clone(),this.collisionIndex=new _r(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=o,this.retainedQueryData={},this.collisionGroups=new Ku(n),this.collisionCircleArrays={},this.prevPlacement=s,s&&(s.prevPlacement=void 0),this.placedOrientations={}};function ya(i,o,n,s,h){i.emplaceBack(o?1:0,n?1:0,s||0,h||0),i.emplaceBack(o?1:0,n?1:0,s||0,h||0),i.emplaceBack(o?1:0,n?1:0,s||0,h||0),i.emplaceBack(o?1:0,n?1:0,s||0,h||0)}Hr.prototype.getBucketParts=function(i,o,n,s){var h=n.getBucket(o),m=n.latestFeatureIndex;if(h&&m&&o.id===h.layerIds[0]){var y=n.collisionBoxArray,v=h.layers[0].layout,S=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),A=n.tileSize/l.EXTENT,D=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),B=v.get("text-pitch-alignment")==="map",R=v.get("text-rotation-alignment")==="map",G=Ri(n,1,this.transform.zoom),q=Cr(D,B,R,this.transform,G),$=null;if(B){var j=cr(D,B,R,this.transform,G);$=l.multiply([],this.transform.labelPlaneMatrix,j)}this.retainedQueryData[h.bucketInstanceId]=new fn(h.bucketInstanceId,m,h.sourceLayerIndex,h.index,n.tileID);var K={bucket:h,layout:v,posMatrix:D,textLabelPlaneMatrix:q,labelToScreenMatrix:$,scale:S,textPixelRatio:A,holdingForFade:n.holdingForFade(),collisionBoxArray:y,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(h.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(h.sourceID)};if(s)for(var te=0,oe=h.sortKeyRanges;te<oe.length;te+=1){var de=oe[te];i.push({sortKey:de.sortKey,symbolInstanceStart:de.symbolInstanceStart,symbolInstanceEnd:de.symbolInstanceEnd,parameters:K})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:h.symbolInstances.length,parameters:K})}},Hr.prototype.attemptAnchorPlacement=function(i,o,n,s,h,m,y,v,S,A,D,B,R,G,q){var $,j=[B.textOffset0,B.textOffset1],K=Jn(i,n,s,j,h),te=this.collisionIndex.placeCollisionBox(ai(o,K.x,K.y,m,y,this.transform.angle),D,v,S,A.predicate);if(!q||this.collisionIndex.placeCollisionBox(ai(q,K.x,K.y,m,y,this.transform.angle),D,v,S,A.predicate).box.length!==0)return te.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[B.crossTileID]&&this.prevPlacement.placements[B.crossTileID]&&this.prevPlacement.placements[B.crossTileID].text&&($=this.prevPlacement.variableOffsets[B.crossTileID].anchor),this.variableOffsets[B.crossTileID]={textOffset:j,width:n,height:s,anchor:i,textBoxScale:h,prevAnchor:$},this.markUsedJustification(R,i,B,G),R.allowVerticalPlacement&&(this.markUsedOrientation(R,G,B),this.placedOrientations[B.crossTileID]=G),{shift:K,placedGlyphBoxes:te}):void 0},Hr.prototype.placeLayerBucketPart=function(i,o,n){var s=this,h=i.parameters,m=h.bucket,y=h.layout,v=h.posMatrix,S=h.textLabelPlaneMatrix,A=h.labelToScreenMatrix,D=h.textPixelRatio,B=h.holdingForFade,R=h.collisionBoxArray,G=h.partiallyEvaluatedTextSize,q=h.collisionGroup,$=y.get("text-optional"),j=y.get("icon-optional"),K=y.get("text-allow-overlap"),te=y.get("icon-allow-overlap"),oe=y.get("text-rotation-alignment")==="map",de=y.get("text-pitch-alignment")==="map",pe=y.get("icon-text-fit")!=="none",me=y.get("symbol-z-order")==="viewport-y",_e=K&&(te||!m.hasIconData()||j),ze=te&&(K||!m.hasTextData()||$);!m.collisionArrays&&R&&m.deserializeCollisionBoxes(R);var Se=function(Ze,dt){if(!o[Ze.crossTileID])if(B)s.placements[Ze.crossTileID]=new $n(!1,!1,!1);else{var St,mt=!1,pt=!1,ct=!0,lt=null,nt={box:null,offscreen:null},rr={box:null,offscreen:null},Dr=null,Ei=null,Qr=0,ei=0,Rr=0;dt.textFeatureIndex?Qr=dt.textFeatureIndex:Ze.useRuntimeCollisionCircles&&(Qr=Ze.featureIndex),dt.verticalTextFeatureIndex&&(ei=dt.verticalTextFeatureIndex);var vi=dt.textBox;if(vi){var Vn=function(Br){var Mr=l.WritingMode.horizontal;if(m.allowVerticalPlacement&&!Br&&s.prevPlacement){var Ci=s.prevPlacement.placedOrientations[Ze.crossTileID];Ci&&(s.placedOrientations[Ze.crossTileID]=Ci,s.markUsedOrientation(m,Mr=Ci,Ze))}return Mr},Ti=function(Br,Mr){if(m.allowVerticalPlacement&&Ze.numVerticalGlyphVertices>0&&dt.verticalTextBox)for(var Ci=0,ps=m.writingModes;Ci<ps.length&&(ps[Ci]===l.WritingMode.vertical?(nt=Mr(),rr=nt):nt=Br(),!(nt&&nt.box&&nt.box.length));Ci+=1);else nt=Br()};if(y.get("text-variable-anchor")){var Ii=y.get("text-variable-anchor");if(s.prevPlacement&&s.prevPlacement.variableOffsets[Ze.crossTileID]){var Nn=s.prevPlacement.variableOffsets[Ze.crossTileID];Ii.indexOf(Nn.anchor)>0&&(Ii=Ii.filter(function(Br){return Br!==Nn.anchor})).unshift(Nn.anchor)}var sn=function(Br,Mr,Ci){for(var ps=Br.x2-Br.x1,il=Br.y2-Br.y1,Gp=Ze.textBoxScale,nl=pe&&!te?Mr:null,ol={box:[],offscreen:!1},xc=K?2*Ii.length:Ii.length,hs=0;hs<xc;++hs){var fs=s.attemptAnchorPlacement(Ii[hs%Ii.length],Br,ps,il,Gp,oe,de,D,v,q,hs>=Ii.length,Ze,m,Ci,nl);if(fs&&(ol=fs.placedGlyphBoxes)&&ol.box&&ol.box.length){mt=!0,lt=fs.shift;break}}return ol};Ti(function(){return sn(vi,dt.iconBox,l.WritingMode.horizontal)},function(){var Br=dt.verticalTextBox;return m.allowVerticalPlacement&&!(nt&&nt.box&&nt.box.length)&&Ze.numVerticalGlyphVertices>0&&Br?sn(Br,dt.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null}}),nt&&(mt=nt.box,ct=nt.offscreen);var uu=Vn(nt&&nt.box);if(!mt&&s.prevPlacement){var Io=s.prevPlacement.variableOffsets[Ze.crossTileID];Io&&(s.variableOffsets[Ze.crossTileID]=Io,s.markUsedJustification(m,Io.anchor,Ze,uu))}}else{var Ia=function(Br,Mr){var Ci=s.collisionIndex.placeCollisionBox(Br,K,D,v,q.predicate);return Ci&&Ci.box&&Ci.box.length&&(s.markUsedOrientation(m,Mr,Ze),s.placedOrientations[Ze.crossTileID]=Mr),Ci};Ti(function(){return Ia(vi,l.WritingMode.horizontal)},function(){var Br=dt.verticalTextBox;return m.allowVerticalPlacement&&Ze.numVerticalGlyphVertices>0&&Br?Ia(Br,l.WritingMode.vertical):{box:null,offscreen:null}}),Vn(nt&&nt.box&&nt.box.length)}}if(mt=(St=nt)&&St.box&&St.box.length>0,ct=St&&St.offscreen,Ze.useRuntimeCollisionCircles){var ra=m.text.placedSymbolArray.get(Ze.centerJustifiedTextSymbolIndex),cs=l.evaluateSizeForFeature(m.textSizeData,G,ra),Ca=y.get("text-padding");Dr=s.collisionIndex.placeCollisionCircles(K,ra,m.lineVertexArray,m.glyphOffsetArray,cs,v,S,A,n,de,q.predicate,Ze.collisionCircleDiameter,Ca),mt=K||Dr.circles.length>0&&!Dr.collisionDetected,ct=ct&&Dr.offscreen}if(dt.iconFeatureIndex&&(Rr=dt.iconFeatureIndex),dt.iconBox){var jn=function(Br){var Mr=pe&&lt?ai(Br,lt.x,lt.y,oe,de,s.transform.angle):Br;return s.collisionIndex.placeCollisionBox(Mr,te,D,v,q.predicate)};pt=rr&&rr.box&&rr.box.length&&dt.verticalIconBox?(Ei=jn(dt.verticalIconBox)).box.length>0:(Ei=jn(dt.iconBox)).box.length>0,ct=ct&&Ei.offscreen}var Aa=$||Ze.numHorizontalGlyphVertices===0&&Ze.numVerticalGlyphVertices===0,Xr=j||Ze.numIconVertices===0;if(Aa||Xr?Xr?Aa||(pt=pt&&mt):mt=pt&&mt:pt=mt=pt&&mt,mt&&St&&St.box&&s.collisionIndex.insertCollisionBox(St.box,y.get("text-ignore-placement"),m.bucketInstanceId,rr&&rr.box&&ei?ei:Qr,q.ID),pt&&Ei&&s.collisionIndex.insertCollisionBox(Ei.box,y.get("icon-ignore-placement"),m.bucketInstanceId,Rr,q.ID),Dr&&(mt&&s.collisionIndex.insertCollisionCircles(Dr.circles,y.get("text-ignore-placement"),m.bucketInstanceId,Qr,q.ID),n)){var io=m.bucketInstanceId,An=s.collisionCircleArrays[io];An===void 0&&(An=s.collisionCircleArrays[io]=new zp);for(var ia=0;ia<Dr.circles.length;ia+=4)An.circles.push(Dr.circles[ia+0]),An.circles.push(Dr.circles[ia+1]),An.circles.push(Dr.circles[ia+2]),An.circles.push(Dr.collisionDetected?1:0)}s.placements[Ze.crossTileID]=new $n(mt||_e,pt||ze,ct||m.justReloaded),o[Ze.crossTileID]=!0}};if(me)for(var Ue=m.getSortedSymbolIndexes(this.transform.angle),Qe=Ue.length-1;Qe>=0;--Qe){var rt=Ue[Qe];Se(m.symbolInstances.get(rt),m.collisionArrays[rt])}else for(var et=i.symbolInstanceStart;et<i.symbolInstanceEnd;et++)Se(m.symbolInstances.get(et),m.collisionArrays[et]);if(n&&m.bucketInstanceId in this.collisionCircleArrays){var Ft=this.collisionCircleArrays[m.bucketInstanceId];l.invert(Ft.invProjMatrix,v),Ft.viewportMatrix=this.collisionIndex.getViewportMatrix()}m.justReloaded=!1},Hr.prototype.markUsedJustification=function(i,o,n,s){var h;h=s===l.WritingMode.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[l.getAnchorJustification(o)];for(var m=0,y=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];m<y.length;m+=1){var v=y[m];v>=0&&(i.text.placedSymbolArray.get(v).crossTileID=h>=0&&v!==h?0:n.crossTileID)}},Hr.prototype.markUsedOrientation=function(i,o,n){for(var s=o===l.WritingMode.horizontal||o===l.WritingMode.horizontalOnly?o:0,h=o===l.WritingMode.vertical?o:0,m=0,y=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];m<y.length;m+=1)i.text.placedSymbolArray.get(y[m]).placedOrientation=s;n.verticalPlacedTextSymbolIndex&&(i.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=h)},Hr.prototype.commit=function(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;var o=this.prevPlacement,n=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;var s=o?o.symbolFadeChange(i):1,h=o?o.opacities:{},m=o?o.variableOffsets:{},y=o?o.placedOrientations:{};for(var v in this.placements){var S=this.placements[v],A=h[v];A?(this.opacities[v]=new Zi(A,s,S.text,S.icon),n=n||S.text!==A.text.placed||S.icon!==A.icon.placed):(this.opacities[v]=new Zi(null,s,S.text,S.icon,S.skipFade),n=n||S.text||S.icon)}for(var D in h){var B=h[D];if(!this.opacities[D]){var R=new Zi(B,s,!1,!1);R.isHidden()||(this.opacities[D]=R,n=n||B.text.placed||B.icon.placed)}}for(var G in m)this.variableOffsets[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.variableOffsets[G]=m[G]);for(var q in y)this.placedOrientations[q]||!this.opacities[q]||this.opacities[q].isHidden()||(this.placedOrientations[q]=y[q]);n?this.lastPlacementChangeTime=i:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:i)},Hr.prototype.updateLayerOpacities=function(i,o){for(var n={},s=0,h=o;s<h.length;s+=1){var m=h[s],y=m.getBucket(i);y&&m.latestFeatureIndex&&i.id===y.layerIds[0]&&this.updateBucketOpacities(y,n,m.collisionBoxArray)}},Hr.prototype.updateBucketOpacities=function(i,o,n){var s=this;i.hasTextData()&&i.text.opacityVertexArray.clear(),i.hasIconData()&&i.icon.opacityVertexArray.clear(),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();var h=i.layers[0].layout,m=new Zi(null,0,!1,!1,!0),y=h.get("text-allow-overlap"),v=h.get("icon-allow-overlap"),S=h.get("text-variable-anchor"),A=h.get("text-rotation-alignment")==="map",D=h.get("text-pitch-alignment")==="map",B=h.get("icon-text-fit")!=="none",R=new Zi(null,0,y&&(v||!i.hasIconData()||h.get("icon-optional")),v&&(y||!i.hasTextData()||h.get("text-optional")),!0);!i.collisionArrays&&n&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(n);for(var G=function(K,te,oe){for(var de=0;de<te/4;de++)K.opacityVertexArray.emplaceBack(oe)},q=function(K){var te=i.symbolInstances.get(K),oe=te.numHorizontalGlyphVertices,de=te.numVerticalGlyphVertices,pe=te.crossTileID,me=s.opacities[pe];o[pe]?me=m:me||(s.opacities[pe]=me=R),o[pe]=!0;var _e=te.numIconVertices>0,ze=s.placedOrientations[te.crossTileID],Se=ze===l.WritingMode.vertical,Ue=ze===l.WritingMode.horizontal||ze===l.WritingMode.horizontalOnly;if(oe>0||de>0){var Qe=Ul(me.text);G(i.text,oe,Se?Ds:Qe),G(i.text,de,Ue?Ds:Qe);var rt=me.text.isHidden();[te.rightJustifiedTextSymbolIndex,te.centerJustifiedTextSymbolIndex,te.leftJustifiedTextSymbolIndex].forEach(function(nt){nt>=0&&(i.text.placedSymbolArray.get(nt).hidden=rt||Se?1:0)}),te.verticalPlacedTextSymbolIndex>=0&&(i.text.placedSymbolArray.get(te.verticalPlacedTextSymbolIndex).hidden=rt||Ue?1:0);var et=s.variableOffsets[te.crossTileID];et&&s.markUsedJustification(i,et.anchor,te,ze);var Ft=s.placedOrientations[te.crossTileID];Ft&&(s.markUsedJustification(i,"left",te,Ft),s.markUsedOrientation(i,Ft,te))}if(_e){var Ze=Ul(me.icon),dt=!(B&&te.verticalPlacedIconSymbolIndex&&Se);te.placedIconSymbolIndex>=0&&(G(i.icon,te.numIconVertices,dt?Ze:Ds),i.icon.placedSymbolArray.get(te.placedIconSymbolIndex).hidden=me.icon.isHidden()),te.verticalPlacedIconSymbolIndex>=0&&(G(i.icon,te.numVerticalIconVertices,dt?Ds:Ze),i.icon.placedSymbolArray.get(te.verticalPlacedIconSymbolIndex).hidden=me.icon.isHidden())}if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){var St=i.collisionArrays[K];if(St){var mt=new l.Point(0,0);if(St.textBox||St.verticalTextBox){var pt=!0;if(S){var ct=s.variableOffsets[pe];ct?(mt=Jn(ct.anchor,ct.width,ct.height,ct.textOffset,ct.textBoxScale),A&&mt._rotate(D?s.transform.angle:-s.transform.angle)):pt=!1}St.textBox&&ya(i.textCollisionBox.collisionVertexArray,me.text.placed,!pt||Se,mt.x,mt.y),St.verticalTextBox&&ya(i.textCollisionBox.collisionVertexArray,me.text.placed,!pt||Ue,mt.x,mt.y)}var lt=!!(!Ue&&St.verticalIconBox);St.iconBox&&ya(i.iconCollisionBox.collisionVertexArray,me.icon.placed,lt,B?mt.x:0,B?mt.y:0),St.verticalIconBox&&ya(i.iconCollisionBox.collisionVertexArray,me.icon.placed,!lt,B?mt.x:0,B?mt.y:0)}}},$=0;$<i.symbolInstances.length;$++)q($);if(i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.bucketInstanceId in this.collisionCircleArrays){var j=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=j.invProjMatrix,i.placementViewportMatrix=j.viewportMatrix,i.collisionCircleArray=j.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}},Hr.prototype.symbolFadeChange=function(i){return this.fadeDuration===0?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Hr.prototype.zoomAdjustment=function(i){return Math.max(0,(this.transform.zoom-i)/1.5)},Hr.prototype.hasTransitions=function(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration},Hr.prototype.stillRecent=function(i,o){var n=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*n>i},Hr.prototype.setStale=function(){this.stale=!0};var Ls=Math.pow(2,25),Mp=Math.pow(2,24),kp=Math.pow(2,17),Fl=Math.pow(2,16),Lp=Math.pow(2,9),$u=Math.pow(2,8),Dp=Math.pow(2,1);function Ul(i){if(i.opacity===0&&!i.placed)return 0;if(i.opacity===1&&i.placed)return 4294967295;var o=i.placed?1:0,n=Math.floor(127*i.opacity);return n*Ls+o*Mp+n*kp+o*Fl+n*Lp+o*$u+n*Dp+o}var Ds=0,Rs=function(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&!i.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Rs.prototype.continuePlacement=function(i,o,n,s,h){for(var m=this._bucketParts;this._currentTileIndex<i.length;)if(o.getBucketParts(m,s,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,h())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,m.sort(function(y,v){return y.sortKey-v.sortKey}));this._currentPartIndex<m.length;)if(o.placeLayerBucketPart(m[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,h())return!0;return!1};var Ha=function(i,o,n,s,h,m,y){this.placement=new Hr(i,h,m,y),this._currentPlacementIndex=o.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=s,this._done=!1};Ha.prototype.isDone=function(){return this._done},Ha.prototype.continuePlacement=function(i,o,n){for(var s=this,h=l.browser.now(),m=function(){var S=l.browser.now()-h;return!s._forceFullPlacement&&S>2};this._currentPlacementIndex>=0;){var y=o[i[this._currentPlacementIndex]],v=this.placement.collisionIndex.transform.zoom;if(y.type==="symbol"&&(!y.minzoom||y.minzoom<=v)&&(!y.maxzoom||y.maxzoom>v)){if(this._inProgressLayer||(this._inProgressLayer=new Rs(y)),this._inProgressLayer.continuePlacement(n[y.source],this.placement,this._showCollisionBoxes,y,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Ha.prototype.commit=function(i){return this.placement.commit(i),this.placement};var Ju=512/l.EXTENT/2,Bs=function(i,o,n){this.tileID=i,this.indexedSymbolInstances={},this.bucketInstanceId=n;for(var s=0;s<o.length;s++){var h=o.get(s),m=h.key;this.indexedSymbolInstances[m]||(this.indexedSymbolInstances[m]=[]),this.indexedSymbolInstances[m].push({crossTileID:h.crossTileID,coord:this.getScaledCoordinates(h,i)})}};Bs.prototype.getScaledCoordinates=function(i,o){var n=Ju/Math.pow(2,o.canonical.z-this.tileID.canonical.z);return{x:Math.floor((o.canonical.x*l.EXTENT+i.anchorX)*n),y:Math.floor((o.canonical.y*l.EXTENT+i.anchorY)*n)}},Bs.prototype.findMatches=function(i,o,n){for(var s=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z),h=0;h<i.length;h++){var m=i.get(h);if(!m.crossTileID){var y=this.indexedSymbolInstances[m.key];if(y)for(var v=this.getScaledCoordinates(m,o),S=0,A=y;S<A.length;S+=1){var D=A[S];if(Math.abs(D.coord.x-v.x)<=s&&Math.abs(D.coord.y-v.y)<=s&&!n[D.crossTileID]){n[D.crossTileID]=!0,m.crossTileID=D.crossTileID;break}}}}};var Vl=function(){this.maxCrossTileID=0};Vl.prototype.generate=function(){return++this.maxCrossTileID};var Bi=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Bi.prototype.handleWrapJump=function(i){var o=Math.round((i-this.lng)/360);if(o!==0)for(var n in this.indexes){var s=this.indexes[n],h={};for(var m in s){var y=s[m];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+o),h[y.tileID.key]=y}this.indexes[n]=h}this.lng=i},Bi.prototype.addBucket=function(i,o,n){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(var s=0;s<o.symbolInstances.length;s++)o.symbolInstances.get(s).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});var h=this.usedCrossTileIDs[i.overscaledZ];for(var m in this.indexes){var y=this.indexes[m];if(Number(m)>i.overscaledZ)for(var v in y){var S=y[v];S.tileID.isChildOf(i)&&S.findMatches(o.symbolInstances,i,h)}else{var A=y[i.scaledTo(Number(m)).key];A&&A.findMatches(o.symbolInstances,i,h)}}for(var D=0;D<o.symbolInstances.length;D++){var B=o.symbolInstances.get(D);B.crossTileID||(B.crossTileID=n.generate(),h[B.crossTileID]=!0)}return this.indexes[i.overscaledZ]===void 0&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new Bs(i,o.symbolInstances,o.bucketInstanceId),!0},Bi.prototype.removeBucketCrossTileIDs=function(i,o){for(var n in o.indexedSymbolInstances)for(var s=0,h=o.indexedSymbolInstances[n];s<h.length;s+=1)delete this.usedCrossTileIDs[i][h[s].crossTileID]},Bi.prototype.removeStaleBuckets=function(i){var o=!1;for(var n in this.indexes){var s=this.indexes[n];for(var h in s)i[s[h].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,s[h]),delete s[h],o=!0)}return o};var jo=function(){this.layerIndexes={},this.crossTileIDs=new Vl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};jo.prototype.addLayer=function(i,o,n){var s=this.layerIndexes[i.id];s===void 0&&(s=this.layerIndexes[i.id]=new Bi);var h=!1,m={};s.handleWrapJump(n);for(var y=0,v=o;y<v.length;y+=1){var S=v[y],A=S.getBucket(i);A&&i.id===A.layerIds[0]&&(A.bucketInstanceId||(A.bucketInstanceId=++this.maxBucketInstanceId),s.addBucket(S.tileID,A,this.crossTileIDs)&&(h=!0),m[A.bucketInstanceId]=!0)}return s.removeStaleBuckets(m)&&(h=!0),h},jo.prototype.pruneUnusedLayers=function(i){var o={};for(var n in i.forEach(function(s){o[s]=!0}),this.layerIndexes)o[n]||delete this.layerIndexes[n]};var po=function(i,o){return l.emitValidationErrors(i,o&&o.filter(function(n){return n.identifier!=="source.canvas"}))},Os=l.pick(xe,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),ho=l.pick(xe,["setCenter","setZoom","setBearing","setPitch"]),fo=function(){var i={},o=l.styleSpec.$version;for(var n in l.styleSpec.$root){var s,h=l.styleSpec.$root[n];h.required&&(s=n==="version"?o:h.type==="array"?[]:{})!=null&&(i[n]=s)}return i}(),Yn=function(i){function o(n,s){var h=this;s===void 0&&(s={}),i.call(this),this.map=n,this.dispatcher=new er($e(),this),this.imageManager=new Pt,this.imageManager.setEventedParent(this),this.glyphManager=new ht(n._requestManager,s.localIdeographFontFamily),this.lineAtlas=new vt(256,512),this.crossTileSymbolIndex=new jo,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());var m=this;this._rtlTextPluginCallback=o.registerForPluginStateChange(function(y){m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},function(v,S){if(l.triggerPluginCompletionEvent(v),S&&S.every(function(D){return D}))for(var A in m.sourceCaches)m.sourceCaches[A].reload()})}),this.on("data",function(y){if(y.dataType==="source"&&y.sourceDataType==="metadata"){var v=h.sourceCaches[y.sourceId];if(v){var S=v.getSource();if(S&&S.vectorLayerIds)for(var A in h._layers){var D=h._layers[A];D.source===S.id&&h._validateLayer(D)}}}})}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.loadURL=function(n,s){var h=this;s===void 0&&(s={}),this.fire(new l.Event("dataloading",{dataType:"style"}));var m=typeof s.validate=="boolean"?s.validate:!l.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,s.accessToken);var y=this.map._requestManager.transformRequest(n,l.ResourceType.Style);this._request=l.getJSON(y,function(v,S){h._request=null,v?h.fire(new l.ErrorEvent(v)):S&&h._load(S,m)})},o.prototype.loadJSON=function(n,s){var h=this;s===void 0&&(s={}),this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.browser.frame(function(){h._request=null,h._load(n,s.validate!==!1)})},o.prototype.loadEmpty=function(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load(fo,!1)},o.prototype._load=function(n,s){if(!s||!po(this,l.validateStyle(n))){for(var h in this._loaded=!0,this.stylesheet=n,n.sources)this.addSource(h,n.sources[h],{validate:!1});n.sprite?this._loadSprite(n.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(n.glyphs);var m=De(this.stylesheet.layers);this._order=m.map(function(A){return A.id}),this._layers={},this._serializedLayers={};for(var y=0,v=m;y<v.length;y+=1){var S=v[y];(S=l.createStyleLayer(S)).setEventedParent(this,{layer:{id:S.id}}),this._layers[S.id]=S,this._serializedLayers[S.id]=S.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ot(this.stylesheet.light),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}},o.prototype._loadSprite=function(n){var s=this;this._spriteRequest=function(h,m,y){var v,S,A,D=l.browser.devicePixelRatio>1?"@2x":"",B=l.getJSON(m.transformRequest(m.normalizeSpriteURL(h,D,".json"),l.ResourceType.SpriteJSON),function(q,$){B=null,A||(A=q,v=$,G())}),R=l.getImage(m.transformRequest(m.normalizeSpriteURL(h,D,".png"),l.ResourceType.SpriteImage),function(q,$){R=null,A||(A=q,S=$,G())});function G(){if(A)y(A);else if(v&&S){var q=l.browser.getImageData(S),$={};for(var j in v){var K=v[j],te=K.width,oe=K.height,de=K.x,pe=K.y,me=K.sdf,_e=K.pixelRatio,ze=K.stretchX,Se=K.stretchY,Ue=K.content,Qe=new l.RGBAImage({width:te,height:oe});l.RGBAImage.copy(q,Qe,{x:de,y:pe},{x:0,y:0},{width:te,height:oe}),$[j]={data:Qe,pixelRatio:_e,sdf:me,stretchX:ze,stretchY:Se,content:Ue}}y(null,$)}}return{cancel:function(){B&&(B.cancel(),B=null),R&&(R.cancel(),R=null)}}}(n,this.map._requestManager,function(h,m){if(s._spriteRequest=null,h)s.fire(new l.ErrorEvent(h));else if(m)for(var y in m)s.imageManager.addImage(y,m[y]);s.imageManager.setLoaded(!0),s._availableImages=s.imageManager.listImages(),s.dispatcher.broadcast("setImages",s._availableImages),s.fire(new l.Event("data",{dataType:"style"}))})},o.prototype._validateLayer=function(n){var s=this.sourceCaches[n.source];if(s){var h=n.sourceLayer;if(h){var m=s.getSource();(m.type==="geojson"||m.vectorLayerIds&&m.vectorLayerIds.indexOf(h)===-1)&&this.fire(new l.ErrorEvent(new Error('Source layer "'+h+'" does not exist on source "'+m.id+'" as specified by style layer "'+n.id+'"')))}}},o.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()},o.prototype._serializeLayers=function(n){for(var s=[],h=0,m=n;h<m.length;h+=1){var y=this._layers[m[h]];y.type!=="custom"&&s.push(y.serialize())}return s},o.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(var s in this._layers)if(this._layers[s].hasTransition())return!0;return!1},o.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},o.prototype.update=function(n){if(this._loaded){var s=this._changed;if(this._changed){var h=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);for(var y in(h.length||m.length)&&this._updateWorkerLayers(h,m),this._updatedSources){var v=this._updatedSources[y];v==="reload"?this._reloadSource(y):v==="clear"&&this._clearSource(y)}for(var S in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[S].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}var A={};for(var D in this.sourceCaches){var B=this.sourceCaches[D];A[D]=B.used,B.used=!1}for(var R=0,G=this._order;R<G.length;R+=1){var q=this._layers[G[R]];q.recalculate(n,this._availableImages),!q.isHidden(n.zoom)&&q.source&&(this.sourceCaches[q.source].used=!0)}for(var $ in A){var j=this.sourceCaches[$];A[$]!==j.used&&j.fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:$}))}this.light.recalculate(n),this.z=n.zoom,s&&this.fire(new l.Event("data",{dataType:"style"}))}},o.prototype._updateTilesForChangedImages=function(){var n=Object.keys(this._changedImages);if(n.length){for(var s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}},o.prototype._updateWorkerLayers=function(n,s){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:s})},o.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},o.prototype.setState=function(n){var s=this;if(this._checkLoaded(),po(this,l.validateStyle(n)))return!1;(n=l.clone$1(n)).layers=De(n.layers);var h=function(y,v){if(!y)return[{command:xe.setStyle,args:[v]}];var S=[];try{if(!l.deepEqual(y.version,v.version))return[{command:xe.setStyle,args:[v]}];l.deepEqual(y.center,v.center)||S.push({command:xe.setCenter,args:[v.center]}),l.deepEqual(y.zoom,v.zoom)||S.push({command:xe.setZoom,args:[v.zoom]}),l.deepEqual(y.bearing,v.bearing)||S.push({command:xe.setBearing,args:[v.bearing]}),l.deepEqual(y.pitch,v.pitch)||S.push({command:xe.setPitch,args:[v.pitch]}),l.deepEqual(y.sprite,v.sprite)||S.push({command:xe.setSprite,args:[v.sprite]}),l.deepEqual(y.glyphs,v.glyphs)||S.push({command:xe.setGlyphs,args:[v.glyphs]}),l.deepEqual(y.transition,v.transition)||S.push({command:xe.setTransition,args:[v.transition]}),l.deepEqual(y.light,v.light)||S.push({command:xe.setLight,args:[v.light]});var A={},D=[];(function(R,G,q,$){var j;for(j in G=G||{},R=R||{})R.hasOwnProperty(j)&&(G.hasOwnProperty(j)||gt(j,q,$));for(j in G)G.hasOwnProperty(j)&&(R.hasOwnProperty(j)?l.deepEqual(R[j],G[j])||(R[j].type==="geojson"&&G[j].type==="geojson"&&lr(R,G,j)?q.push({command:xe.setGeoJSONSourceData,args:[j,G[j].data]}):Xe(j,G,q,$)):yt(j,G,q))})(y.sources,v.sources,D,A);var B=[];y.layers&&y.layers.forEach(function(R){A[R.source]?S.push({command:xe.removeLayer,args:[R.id]}):B.push(R)}),S=S.concat(D),function(R,G,q){G=G||[];var $,j,K,te,oe,de,pe,me=(R=R||[]).map(hr),_e=G.map(hr),ze=R.reduce(yr,{}),Se=G.reduce(yr,{}),Ue=me.slice(),Qe=Object.create(null);for($=0,j=0;$<me.length;$++)Se.hasOwnProperty(K=me[$])?j++:(q.push({command:xe.removeLayer,args:[K]}),Ue.splice(Ue.indexOf(K,j),1));for($=0,j=0;$<_e.length;$++)Ue[Ue.length-1-$]!==(K=_e[_e.length-1-$])&&(ze.hasOwnProperty(K)?(q.push({command:xe.removeLayer,args:[K]}),Ue.splice(Ue.lastIndexOf(K,Ue.length-j),1)):j++,q.push({command:xe.addLayer,args:[Se[K],de=Ue[Ue.length-$]]}),Ue.splice(Ue.length-$,0,K),Qe[K]=!0);for($=0;$<_e.length;$++)if(te=ze[K=_e[$]],oe=Se[K],!Qe[K]&&!l.deepEqual(te,oe))if(l.deepEqual(te.source,oe.source)&&l.deepEqual(te["source-layer"],oe["source-layer"])&&l.deepEqual(te.type,oe.type)){for(pe in At(te.layout,oe.layout,q,K,null,xe.setLayoutProperty),At(te.paint,oe.paint,q,K,null,xe.setPaintProperty),l.deepEqual(te.filter,oe.filter)||q.push({command:xe.setFilter,args:[K,oe.filter]}),l.deepEqual(te.minzoom,oe.minzoom)&&l.deepEqual(te.maxzoom,oe.maxzoom)||q.push({command:xe.setLayerZoomRange,args:[K,oe.minzoom,oe.maxzoom]}),te)te.hasOwnProperty(pe)&&pe!=="layout"&&pe!=="paint"&&pe!=="filter"&&pe!=="metadata"&&pe!=="minzoom"&&pe!=="maxzoom"&&(pe.indexOf("paint.")===0?At(te[pe],oe[pe],q,K,pe.slice(6),xe.setPaintProperty):l.deepEqual(te[pe],oe[pe])||q.push({command:xe.setLayerProperty,args:[K,pe,oe[pe]]}));for(pe in oe)oe.hasOwnProperty(pe)&&!te.hasOwnProperty(pe)&&pe!=="layout"&&pe!=="paint"&&pe!=="filter"&&pe!=="metadata"&&pe!=="minzoom"&&pe!=="maxzoom"&&(pe.indexOf("paint.")===0?At(te[pe],oe[pe],q,K,pe.slice(6),xe.setPaintProperty):l.deepEqual(te[pe],oe[pe])||q.push({command:xe.setLayerProperty,args:[K,pe,oe[pe]]}))}else q.push({command:xe.removeLayer,args:[K]}),de=Ue[Ue.lastIndexOf(K)+1],q.push({command:xe.addLayer,args:[oe,de]})}(B,v.layers,S)}catch(R){console.warn("Unable to compute style diff:",R),S=[{command:xe.setStyle,args:[v]}]}return S}(this.serialize(),n).filter(function(y){return!(y.command in ho)});if(h.length===0)return!1;var m=h.filter(function(y){return!(y.command in Os)});if(m.length>0)throw new Error("Unimplemented: "+m.map(function(y){return y.command}).join(", ")+".");return h.forEach(function(y){y.command!=="setTransition"&&s[y.command].apply(s,y.args)}),this.stylesheet=n,!0},o.prototype.addImage=function(n,s){if(this.getImage(n))return this.fire(new l.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(n,s),this._afterImageUpdated(n)},o.prototype.updateImage=function(n,s){this.imageManager.updateImage(n,s)},o.prototype.getImage=function(n){return this.imageManager.getImage(n)},o.prototype.removeImage=function(n){if(!this.getImage(n))return this.fire(new l.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(n),this._afterImageUpdated(n)},o.prototype._afterImageUpdated=function(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))},o.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},o.prototype.addSource=function(n,s,h){var m=this;if(h===void 0&&(h={}),this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error("There is already a source with this ID");if(!s.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(s).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(l.validateStyle.source,"sources."+n,s,null,h))){this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);var y=this.sourceCaches[n]=new F(n,s,this.dispatcher);y.style=this,y.setEventedParent(this,function(){return{isSourceLoaded:m.loaded(),source:y.serialize(),sourceId:n}}),y.onAdd(this.map),this._changed=!0}},o.prototype.removeSource=function(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(var s in this._layers)if(this._layers[s].source===n)return this.fire(new l.ErrorEvent(new Error('Source "'+n+'" cannot be removed while layer "'+s+'" is using it.')));var h=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],h.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),h.setEventedParent(null),h.clearTiles(),h.onRemove&&h.onRemove(this.map),this._changed=!0},o.prototype.setGeoJSONSourceData=function(n,s){this._checkLoaded(),this.sourceCaches[n].getSource().setData(s),this._changed=!0},o.prototype.getSource=function(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()},o.prototype.addLayer=function(n,s,h){h===void 0&&(h={}),this._checkLoaded();var m=n.id;if(this.getLayer(m))this.fire(new l.ErrorEvent(new Error('Layer with id "'+m+'" already exists on this map')));else{var y;if(n.type==="custom"){if(po(this,l.validateCustomStyleLayer(n)))return;y=l.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(m,n.source),n=l.clone$1(n),n=l.extend(n,{source:m})),this._validate(l.validateStyle.layer,"layers."+m,n,{arrayIndex:-1},h))return;y=l.createStyleLayer(n),this._validateLayer(y),y.setEventedParent(this,{layer:{id:m}}),this._serializedLayers[y.id]=y.serialize()}var v=s?this._order.indexOf(s):this._order.length;if(s&&v===-1)this.fire(new l.ErrorEvent(new Error('Layer with id "'+s+'" does not exist on this map.')));else{if(this._order.splice(v,0,m),this._layerOrderChanged=!0,this._layers[m]=y,this._removedLayers[m]&&y.source&&y.type!=="custom"){var S=this._removedLayers[m];delete this._removedLayers[m],S.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}},o.prototype.moveLayer=function(n,s){if(this._checkLoaded(),this._changed=!0,this._layers[n]){if(n!==s){var h=this._order.indexOf(n);this._order.splice(h,1);var m=s?this._order.indexOf(s):this._order.length;s&&m===-1?this.fire(new l.ErrorEvent(new Error('Layer with id "'+s+'" does not exist on this map.'))):(this._order.splice(m,0,n),this._layerOrderChanged=!0)}}else this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be moved.")))},o.prototype.removeLayer=function(n){this._checkLoaded();var s=this._layers[n];if(s){s.setEventedParent(null);var h=this._order.indexOf(n);this._order.splice(h,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=s,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],s.onRemove&&s.onRemove(this.map)}else this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be removed.")))},o.prototype.getLayer=function(n){return this._layers[n]},o.prototype.hasLayer=function(n){return n in this._layers},o.prototype.setLayerZoomRange=function(n,s,h){this._checkLoaded();var m=this.getLayer(n);m?m.minzoom===s&&m.maxzoom===h||(s!=null&&(m.minzoom=s),h!=null&&(m.maxzoom=h),this._updateLayer(m)):this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot have zoom extent.")))},o.prototype.setFilter=function(n,s,h){h===void 0&&(h={}),this._checkLoaded();var m=this.getLayer(n);if(m){if(!l.deepEqual(m.filter,s))return s==null?(m.filter=void 0,void this._updateLayer(m)):void(this._validate(l.validateStyle.filter,"layers."+m.id+".filter",s,null,h)||(m.filter=l.clone$1(s),this._updateLayer(m)))}else this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be filtered.")))},o.prototype.getFilter=function(n){return l.clone$1(this.getLayer(n).filter)},o.prototype.setLayoutProperty=function(n,s,h,m){m===void 0&&(m={}),this._checkLoaded();var y=this.getLayer(n);y?l.deepEqual(y.getLayoutProperty(s),h)||(y.setLayoutProperty(s,h,m),this._updateLayer(y)):this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},o.prototype.getLayoutProperty=function(n,s){var h=this.getLayer(n);if(h)return h.getLayoutProperty(s);this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style.")))},o.prototype.setPaintProperty=function(n,s,h,m){m===void 0&&(m={}),this._checkLoaded();var y=this.getLayer(n);y?l.deepEqual(y.getPaintProperty(s),h)||(y.setPaintProperty(s,h,m)&&this._updateLayer(y),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},o.prototype.getPaintProperty=function(n,s){return this.getLayer(n).getPaintProperty(s)},o.prototype.setFeatureState=function(n,s){this._checkLoaded();var h=n.source,m=n.sourceLayer,y=this.sourceCaches[h];if(y!==void 0){var v=y.getSource().type;v==="geojson"&&m?this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):v!=="vector"||m?(n.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),y.setFeatureState(m,n.id,s)):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error("The source '"+h+"' does not exist in the map's style.")))},o.prototype.removeFeatureState=function(n,s){this._checkLoaded();var h=n.source,m=this.sourceCaches[h];if(m!==void 0){var y=m.getSource().type,v=y==="vector"?n.sourceLayer:void 0;y!=="vector"||v?s&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):m.removeFeatureState(v,n.id,s):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error("The source '"+h+"' does not exist in the map's style.")))},o.prototype.getFeatureState=function(n){this._checkLoaded();var s=n.source,h=n.sourceLayer,m=this.sourceCaches[s];if(m!==void 0){if(m.getSource().type!=="vector"||h)return n.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),m.getFeatureState(h,n.id);this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error("The source '"+s+"' does not exist in the map's style.")))},o.prototype.getTransition=function(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},o.prototype.serialize=function(){return l.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:l.mapObject(this.sourceCaches,function(n){return n.serialize()}),layers:this._serializeLayers(this._order)},function(n){return n!==void 0})},o.prototype._updateLayer=function(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._changed=!0},o.prototype._flattenAndSortRenderedFeatures=function(n){for(var s=this,h=function(ze){return s._layers[ze].type==="fill-extrusion"},m={},y=[],v=this._order.length-1;v>=0;v--){var S=this._order[v];if(h(S)){m[S]=v;for(var A=0,D=n;A<D.length;A+=1){var B=D[A][S];if(B)for(var R=0,G=B;R<G.length;R+=1)y.push(G[R])}}}y.sort(function(ze,Se){return Se.intersectionZ-ze.intersectionZ});for(var q=[],$=this._order.length-1;$>=0;$--){var j=this._order[$];if(h(j))for(var K=y.length-1;K>=0;K--){var te=y[K].feature;if(m[te.layer.id]<$)break;q.push(te),y.pop()}else for(var oe=0,de=n;oe<de.length;oe+=1){var pe=de[oe][j];if(pe)for(var me=0,_e=pe;me<_e.length;me+=1)q.push(_e[me].feature)}}return q},o.prototype.queryRenderedFeatures=function(n,s,h){s&&s.filter&&this._validate(l.validateStyle.filter,"queryRenderedFeatures.filter",s.filter,null,s);var m={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var y=0,v=s.layers;y<v.length;y+=1){var S=v[y],A=this._layers[S];if(!A)return this.fire(new l.ErrorEvent(new Error("The layer '"+S+"' does not exist in the map's style and cannot be queried for features."))),[];m[A.source]=!0}}var D=[];for(var B in s.availableImages=this._availableImages,this.sourceCaches)s.layers&&!m[B]||D.push(Gr(this.sourceCaches[B],this._layers,this._serializedLayers,n,s,h));return this.placement&&D.push(function(R,G,q,$,j,K,te){for(var oe={},de=K.queryRenderedSymbols($),pe=[],me=0,_e=Object.keys(de).map(Number);me<_e.length;me+=1)pe.push(te[_e[me]]);pe.sort(en);for(var ze=function(){var et=Ue[Se],Ft=et.featureIndex.lookupSymbolFeatures(de[et.bucketInstanceId],G,et.bucketIndex,et.sourceLayerIndex,j.filter,j.layers,j.availableImages,R);for(var Ze in Ft){var dt=oe[Ze]=oe[Ze]||[],St=Ft[Ze];St.sort(function(ct,lt){var nt=et.featureSortOrder;if(nt){var rr=nt.indexOf(ct.featureIndex);return nt.indexOf(lt.featureIndex)-rr}return lt.featureIndex-ct.featureIndex});for(var mt=0,pt=St;mt<pt.length;mt+=1)dt.push(pt[mt])}},Se=0,Ue=pe;Se<Ue.length;Se+=1)ze();var Qe=function(et){oe[et].forEach(function(Ft){var Ze=Ft.feature,dt=q[R[et].source].getFeatureState(Ze.layer["source-layer"],Ze.id);Ze.source=Ze.layer.source,Ze.layer["source-layer"]&&(Ze.sourceLayer=Ze.layer["source-layer"]),Ze.state=dt})};for(var rt in oe)Qe(rt);return oe}(this._layers,this._serializedLayers,this.sourceCaches,n,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(D)},o.prototype.querySourceFeatures=function(n,s){s&&s.filter&&this._validate(l.validateStyle.filter,"querySourceFeatures.filter",s.filter,null,s);var h=this.sourceCaches[n];return h?function(m,y){for(var v=m.getRenderableIds().map(function(G){return m.getTileByID(G)}),S=[],A={},D=0;D<v.length;D++){var B=v[D],R=B.tileID.canonical.key;A[R]||(A[R]=!0,B.querySourceFeatures(S,y))}return S}(h,s):[]},o.prototype.addSourceType=function(n,s,h){return o.getSourceType(n)?h(new Error('A source type called "'+n+'" already exists.')):(o.setSourceType(n,s),s.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:s.workerSourceURL},h):h(null,null))},o.prototype.getLight=function(){return this.light.getLight()},o.prototype.setLight=function(n,s){s===void 0&&(s={}),this._checkLoaded();var h=this.light.getLight(),m=!1;for(var y in n)if(!l.deepEqual(n[y],h[y])){m=!0;break}if(m){var v={now:l.browser.now(),transition:l.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,s),this.light.updateTransitions(v)}},o.prototype._validate=function(n,s,h,m,y){return y===void 0&&(y={}),(!y||y.validate!==!1)&&po(this,n.call(l.validateStyle,l.extend({key:s,style:this.serialize(),value:h,styleSpec:l.styleSpec},m)))},o.prototype._remove=function(){for(var n in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[n].setEventedParent(null);for(var s in this.sourceCaches)this.sourceCaches[s].clearTiles(),this.sourceCaches[s].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},o.prototype._clearSource=function(n){this.sourceCaches[n].clearTiles()},o.prototype._reloadSource=function(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()},o.prototype._updateSources=function(n){for(var s in this.sourceCaches)this.sourceCaches[s].update(n)},o.prototype._generateCollisionBoxes=function(){for(var n in this.sourceCaches)this._reloadSource(n)},o.prototype._updatePlacement=function(n,s,h,m,y){y===void 0&&(y=!1);for(var v=!1,S=!1,A={},D=0,B=this._order;D<B.length;D+=1){var R=this._layers[B[D]];if(R.type==="symbol"){if(!A[R.source]){var G=this.sourceCaches[R.source];A[R.source]=G.getRenderableIds(!0).map(function(te){return G.getTileByID(te)}).sort(function(te,oe){return oe.tileID.overscaledZ-te.tileID.overscaledZ||(te.tileID.isLessThan(oe.tileID)?-1:1)})}var q=this.crossTileSymbolIndex.addLayer(R,A[R.source],n.center.lng);v=v||q}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||h===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.browser.now(),n.zoom))&&(this.pauseablePlacement=new Ha(n,this._order,y,s,h,m,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,A),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.browser.now()),S=!0),v&&this.pauseablePlacement.placement.setStale()),S||v)for(var $=0,j=this._order;$<j.length;$+=1){var K=this._layers[j[$]];K.type==="symbol"&&this.placement.updateLayerOpacities(K,A[K.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.browser.now())},o.prototype._releaseSymbolFadeTiles=function(){for(var n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()},o.prototype.getImages=function(n,s,h){this.imageManager.getImages(s.icons,h),this._updateTilesForChangedImages();var m=this.sourceCaches[s.source];m&&m.setDependencies(s.tileID.key,s.type,s.icons)},o.prototype.getGlyphs=function(n,s,h){this.glyphManager.getGlyphs(s.stacks,h)},o.prototype.getResource=function(n,s,h){return l.makeRequest(s,h)},o}(l.Evented);Yn.getSourceType=function(i){return Dn[i]},Yn.setSourceType=function(i,o){Dn[i]=o},Yn.registerForPluginStateChange=l.registerForPluginStateChange;var Tn=l.createLayout([{name:"a_pos",type:"Int16",components:2}]),Vr=vr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Fs=vr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Yu=vr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Rp=vr(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Bp=vr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Nl=vr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),jl=vr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),ql=vr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Zl=vr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Qu=vr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),ec=vr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Op=vr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Xa=vr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Wa=vr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),tc=vr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fi=vr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),Gl=vr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),mo=vr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),yo=vr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),qo=vr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Zo=vr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),go=vr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Go=vr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Ho=vr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),_o=vr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),rc=vr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function vr(i,o){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,s=o.match(/attribute ([\w]+) ([\w]+)/g),h=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=m?m.concat(h):h,v={};return{fragmentSource:i=i.replace(n,function(S,A,D,B,R){return v[R]=!0,A==="define"?`
#ifndef HAS_UNIFORM_u_`+R+`
varying `+D+" "+B+" "+R+`;
#else
uniform `+D+" "+B+" u_"+R+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+R+`
    `+D+" "+B+" "+R+" = u_"+R+`;
#endif
`}),vertexSource:o=o.replace(n,function(S,A,D,B,R){var G=B==="float"?"vec2":"vec4",q=R.match(/color/)?"color":G;return v[R]?A==="define"?`
#ifndef HAS_UNIFORM_u_`+R+`
uniform lowp float u_`+R+`_t;
attribute `+D+" "+G+" a_"+R+`;
varying `+D+" "+B+" "+R+`;
#else
uniform `+D+" "+B+" u_"+R+`;
#endif
`:q==="vec4"?`
#ifndef HAS_UNIFORM_u_`+R+`
    `+R+" = a_"+R+`;
#else
    `+D+" "+B+" "+R+" = u_"+R+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+R+`
    `+R+" = unpack_mix_"+q+"(a_"+R+", u_"+R+`_t);
#else
    `+D+" "+B+" "+R+" = u_"+R+`;
#endif
`:A==="define"?`
#ifndef HAS_UNIFORM_u_`+R+`
uniform lowp float u_`+R+`_t;
attribute `+D+" "+G+" a_"+R+`;
#else
uniform `+D+" "+B+" u_"+R+`;
#endif
`:q==="vec4"?`
#ifndef HAS_UNIFORM_u_`+R+`
    `+D+" "+B+" "+R+" = a_"+R+`;
#else
    `+D+" "+B+" "+R+" = u_"+R+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+R+`
    `+D+" "+B+" "+R+" = unpack_mix_"+q+"(a_"+R+", u_"+R+`_t);
#else
    `+D+" "+B+" "+R+" = u_"+R+`;
#endif
`}),staticAttributes:s,staticUniforms:y}}var ga=Object.freeze({__proto__:null,prelude:Vr,background:Fs,backgroundPattern:Yu,circle:Rp,clippingMask:Bp,heatmap:Nl,heatmapTexture:jl,collisionBox:ql,collisionCircle:Zl,debug:Qu,fill:ec,fillOutline:Op,fillOutlinePattern:Xa,fillPattern:Wa,fillExtrusion:tc,fillExtrusionPattern:fi,hillshadePrepare:Gl,hillshade:mo,line:yo,lineGradient:qo,linePattern:Zo,lineSDF:go,raster:Go,symbolIcon:Ho,symbolSDF:_o,symbolTextAndIcon:rc}),Us=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function ic(i){for(var o=[],n=0;n<i.length;n++)if(i[n]!==null){var s=i[n].split(" ");o.push(s.pop())}return o}Us.prototype.bind=function(i,o,n,s,h,m,y,v){this.context=i;for(var S=this.boundPaintVertexBuffers.length!==s.length,A=0;!S&&A<s.length;A++)this.boundPaintVertexBuffers[A]!==s[A]&&(S=!0);i.extVertexArrayObject&&this.vao&&this.boundProgram===o&&this.boundLayoutVertexBuffer===n&&!S&&this.boundIndexBuffer===h&&this.boundVertexOffset===m&&this.boundDynamicVertexBuffer===y&&this.boundDynamicVertexBuffer2===v?(i.bindVertexArrayOES.set(this.vao),y&&y.bind(),h&&h.dynamicDraw&&h.bind(),v&&v.bind()):this.freshBind(o,n,s,h,m,y,v)},Us.prototype.freshBind=function(i,o,n,s,h,m,y){var v,S=i.numAttributes,A=this.context,D=A.gl;if(A.extVertexArrayObject)this.vao&&this.destroy(),this.vao=A.extVertexArrayObject.createVertexArrayOES(),A.bindVertexArrayOES.set(this.vao),v=0,this.boundProgram=i,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=s,this.boundVertexOffset=h,this.boundDynamicVertexBuffer=m,this.boundDynamicVertexBuffer2=y;else{v=A.currentNumAttributes||0;for(var B=S;B<v;B++)D.disableVertexAttribArray(B)}o.enableAttributes(D,i);for(var R=0,G=n;R<G.length;R+=1)G[R].enableAttributes(D,i);m&&m.enableAttributes(D,i),y&&y.enableAttributes(D,i),o.bind(),o.setVertexAttribPointers(D,i,h);for(var q=0,$=n;q<$.length;q+=1){var j=$[q];j.bind(),j.setVertexAttribPointers(D,i,h)}m&&(m.bind(),m.setVertexAttribPointers(D,i,h)),s&&s.bind(),y&&(y.bind(),y.setVertexAttribPointers(D,i,h)),A.currentNumAttributes=S},Us.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var nc=function(i,o,n,s,h,m){var y=i.gl;this.program=y.createProgram();for(var v=ic(n.staticAttributes),S=s?s.getBinderAttributes():[],A=v.concat(S),D=n.staticUniforms?ic(n.staticUniforms):[],B=s?s.getBinderUniforms():[],R=[],G=0,q=D.concat(B);G<q.length;G+=1){var $=q[G];R.indexOf($)<0&&R.push($)}var j=s?s.defines():[];m&&j.push("#define OVERDRAW_INSPECTOR;");var K=j.concat(Vr.fragmentSource,n.fragmentSource).join(`
`),te=j.concat(Vr.vertexSource,n.vertexSource).join(`
`),oe=y.createShader(y.FRAGMENT_SHADER);if(y.isContextLost())this.failedToCreate=!0;else{y.shaderSource(oe,K),y.compileShader(oe),y.attachShader(this.program,oe);var de=y.createShader(y.VERTEX_SHADER);if(y.isContextLost())this.failedToCreate=!0;else{y.shaderSource(de,te),y.compileShader(de),y.attachShader(this.program,de),this.attributes={};var pe={};this.numAttributes=A.length;for(var me=0;me<this.numAttributes;me++)A[me]&&(y.bindAttribLocation(this.program,me,A[me]),this.attributes[A[me]]=me);y.linkProgram(this.program),y.deleteShader(de),y.deleteShader(oe);for(var _e=0;_e<R.length;_e++){var ze=R[_e];if(ze&&!pe[ze]){var Se=y.getUniformLocation(this.program,ze);Se&&(pe[ze]=Se)}}this.fixedUniforms=h(i,pe),this.binderUniforms=s?s.getUniforms(i,pe):[]}}};function oc(i,o,n){var s=1/Ri(n,1,o.transform.tileZoom),h=Math.pow(2,n.tileID.overscaledZ),m=n.tileSize*Math.pow(2,o.transform.tileZoom)/h,y=m*(n.tileID.canonical.x+n.tileID.wrap*h),v=m*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[s,i.fromScale,i.toScale],u_fade:i.t,u_pixel_coord_upper:[y>>16,v>>16],u_pixel_coord_lower:[65535&y,65535&v]}}nc.prototype.draw=function(i,o,n,s,h,m,y,v,S,A,D,B,R,G,q,$){var j,K=i.gl;if(!this.failedToCreate){for(var te in i.program.set(this.program),i.setDepthMode(n),i.setStencilMode(s),i.setColorMode(h),i.setCullFace(m),this.fixedUniforms)this.fixedUniforms[te].set(y[te]);G&&G.setUniforms(i,this.binderUniforms,B,{zoom:R});for(var oe=(j={},j[K.LINES]=2,j[K.TRIANGLES]=3,j[K.LINE_STRIP]=1,j)[o],de=0,pe=D.get();de<pe.length;de+=1){var me=pe[de],_e=me.vaos||(me.vaos={});(_e[v]||(_e[v]=new Us)).bind(i,this,S,G?G.getPaintVertexBuffers():[],A,me.vertexOffset,q,$),K.drawElements(o,me.primitiveLength*oe,K.UNSIGNED_SHORT,me.primitiveOffset*oe*2)}}};var ac=function(i,o,n,s){var h=o.style.light,m=h.properties.get("position"),y=[m.x,m.y,m.z],v=l.create$1();h.properties.get("anchor")==="viewport"&&l.fromRotation(v,-o.transform.angle),l.transformMat3(y,y,v);var S=h.properties.get("color");return{u_matrix:i,u_lightpos:y,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[S.r,S.g,S.b],u_vertical_gradient:+n,u_opacity:s}},Fp=function(i,o,n,s,h,m,y){return l.extend(ac(i,o,n,s),oc(m,o,y),{u_height_factor:-Math.pow(2,h.overscaledZ)/y.tileSize/8})},vo=function(i){return{u_matrix:i}},xo=function(i,o,n,s){return l.extend(vo(i),oc(n,o,s))},_a=function(i,o){return{u_matrix:i,u_world:o}},sc=function(i,o,n,s,h){return l.extend(xo(i,o,n,s),{u_world:h})},lc=function(i,o,n,s){var h,m,y=i.transform;if(s.paint.get("circle-pitch-alignment")==="map"){var v=Ri(n,1,y.zoom);h=!0,m=[v,v]}else h=!1,m=y.pixelsToGLUnits;return{u_camera_to_center_distance:y.cameraToCenterDistance,u_scale_with_map:+(s.paint.get("circle-pitch-scale")==="map"),u_matrix:i.translatePosMatrix(o.posMatrix,n,s.paint.get("circle-translate"),s.paint.get("circle-translate-anchor")),u_pitch_with_map:+h,u_device_pixel_ratio:l.browser.devicePixelRatio,u_extrude_scale:m}},Hl=function(i,o,n){var s=Ri(n,1,o.zoom),h=Math.pow(2,o.zoom-n.tileID.overscaledZ),m=n.tileID.overscaleFactor();return{u_matrix:i,u_camera_to_center_distance:o.cameraToCenterDistance,u_pixels_to_tile_units:s,u_extrude_scale:[o.pixelsToGLUnits[0]/(s*h),o.pixelsToGLUnits[1]/(s*h)],u_overscale_factor:m}},Xo=function(i,o,n){return{u_matrix:i,u_inv_matrix:o,u_camera_to_center_distance:n.cameraToCenterDistance,u_viewport_size:[n.width,n.height]}},Xl=function(i,o,n){return n===void 0&&(n=1),{u_matrix:i,u_color:o,u_overlay:0,u_overlay_scale:n}},Wo=function(i){return{u_matrix:i}},va=function(i,o,n,s){return{u_matrix:i,u_extrude_scale:Ri(o,1,n),u_intensity:s}},Vs=function(i,o,n){var s=i.transform;return{u_matrix:xa(i,o,n),u_ratio:1/Ri(o,1,s.zoom),u_device_pixel_ratio:l.browser.devicePixelRatio,u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]]}},Wl=function(i,o,n,s){return l.extend(Vs(i,o,n),{u_image:0,u_image_height:s})},fr=function(i,o,n,s){var h=i.transform,m=uc(o,h);return{u_matrix:xa(i,o,n),u_texsize:o.imageAtlasTexture.size,u_ratio:1/Ri(o,1,h.zoom),u_device_pixel_ratio:l.browser.devicePixelRatio,u_image:0,u_scale:[m,s.fromScale,s.toScale],u_fade:s.t,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]]}},Ns=function(i,o,n,s,h){var m=i.lineAtlas,y=uc(o,i.transform),v=n.layout.get("line-cap")==="round",S=m.getDash(s.from,v),A=m.getDash(s.to,v),D=S.width*h.fromScale,B=A.width*h.toScale;return l.extend(Vs(i,o,n),{u_patternscale_a:[y/D,-S.height/2],u_patternscale_b:[y/B,-A.height/2],u_sdfgamma:m.width/(256*Math.min(D,B)*l.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:S.y,u_tex_y_b:A.y,u_mix:h.t})};function uc(i,o){return 1/Ri(i,1,o.tileZoom)}function xa(i,o,n){return i.translatePosMatrix(o.tileID.posMatrix,o,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var Up=function(i,o,n,s,h){return{u_matrix:i,u_tl_parent:o,u_scale_parent:n,u_buffer_scale:1,u_fade_t:s.mix,u_opacity:s.opacity*h.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:h.paint.get("raster-brightness-min"),u_brightness_high:h.paint.get("raster-brightness-max"),u_saturation_factor:(y=h.paint.get("raster-saturation"),y>0?1-1/(1.001-y):-y),u_contrast_factor:(m=h.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:Vp(h.paint.get("raster-hue-rotate"))};var m,y};function Vp(i){i*=Math.PI/180;var o=Math.sin(i),n=Math.cos(i);return[(2*n+1)/3,(-Math.sqrt(3)*o-n+1)/3,(Math.sqrt(3)*o-n+1)/3]}var Ka,cc=function(i,o,n,s,h,m,y,v,S,A){var D=h.transform;return{u_is_size_zoom_constant:+(i==="constant"||i==="source"),u_is_size_feature_constant:+(i==="constant"||i==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:D.cameraToCenterDistance,u_pitch:D.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:D.width/D.height,u_fade_change:h.options.fadeDuration?h.symbolFadeChange:1,u_matrix:m,u_label_plane_matrix:y,u_coord_matrix:v,u_is_text:+S,u_pitch_with_map:+s,u_texsize:A,u_texture:0}},ba=function(i,o,n,s,h,m,y,v,S,A,D){var B=h.transform;return l.extend(cc(i,o,n,s,h,m,y,v,S,A),{u_gamma_scale:s?Math.cos(B._pitch)*B.cameraToCenterDistance:1,u_device_pixel_ratio:l.browser.devicePixelRatio,u_is_halo:+D})},js=function(i,o,n,s,h,m,y,v,S,A){return l.extend(ba(i,o,n,s,h,m,y,v,!0,S,!0),{u_texsize_icon:A,u_texture_icon:1})},qs=function(i,o,n){return{u_matrix:i,u_opacity:o,u_color:n}},$a=function(i,o,n,s,h,m){return l.extend(function(y,v,S,A){var D=S.imageManager.getPattern(y.from.toString()),B=S.imageManager.getPattern(y.to.toString()),R=S.imageManager.getPixelSize(),G=R.width,q=R.height,$=Math.pow(2,A.tileID.overscaledZ),j=A.tileSize*Math.pow(2,S.transform.tileZoom)/$,K=j*(A.tileID.canonical.x+A.tileID.wrap*$),te=j*A.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:D.tl,u_pattern_br_a:D.br,u_pattern_tl_b:B.tl,u_pattern_br_b:B.br,u_texsize:[G,q],u_mix:v.t,u_pattern_size_a:D.displaySize,u_pattern_size_b:B.displaySize,u_scale_a:v.fromScale,u_scale_b:v.toScale,u_tile_units_to_pixels:1/Ri(A,1,S.transform.tileZoom),u_pixel_coord_upper:[K>>16,te>>16],u_pixel_coord_lower:[65535&K,65535&te]}}(s,m,n,h),{u_matrix:i,u_opacity:o})},wa={fillExtrusion:function(i,o){return{u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_lightpos:new l.Uniform3f(i,o.u_lightpos),u_lightintensity:new l.Uniform1f(i,o.u_lightintensity),u_lightcolor:new l.Uniform3f(i,o.u_lightcolor),u_vertical_gradient:new l.Uniform1f(i,o.u_vertical_gradient),u_opacity:new l.Uniform1f(i,o.u_opacity)}},fillExtrusionPattern:function(i,o){return{u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_lightpos:new l.Uniform3f(i,o.u_lightpos),u_lightintensity:new l.Uniform1f(i,o.u_lightintensity),u_lightcolor:new l.Uniform3f(i,o.u_lightcolor),u_vertical_gradient:new l.Uniform1f(i,o.u_vertical_gradient),u_height_factor:new l.Uniform1f(i,o.u_height_factor),u_image:new l.Uniform1i(i,o.u_image),u_texsize:new l.Uniform2f(i,o.u_texsize),u_pixel_coord_upper:new l.Uniform2f(i,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(i,o.u_pixel_coord_lower),u_scale:new l.Uniform3f(i,o.u_scale),u_fade:new l.Uniform1f(i,o.u_fade),u_opacity:new l.Uniform1f(i,o.u_opacity)}},fill:function(i,o){return{u_matrix:new l.UniformMatrix4f(i,o.u_matrix)}},fillPattern:function(i,o){return{u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_image:new l.Uniform1i(i,o.u_image),u_texsize:new l.Uniform2f(i,o.u_texsize),u_pixel_coord_upper:new l.Uniform2f(i,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(i,o.u_pixel_coord_lower),u_scale:new l.Uniform3f(i,o.u_scale),u_fade:new l.Uniform1f(i,o.u_fade)}},fillOutline:function(i,o){return{u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_world:new l.Uniform2f(i,o.u_world)}},fillOutlinePattern:function(i,o){return{u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_world:new l.Uniform2f(i,o.u_world),u_image:new l.Uniform1i(i,o.u_image),u_texsize:new l.Uniform2f(i,o.u_texsize),u_pixel_coord_upper:new l.Uniform2f(i,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(i,o.u_pixel_coord_lower),u_scale:new l.Uniform3f(i,o.u_scale),u_fade:new l.Uniform1f(i,o.u_fade)}},circle:function(i,o){return{u_camera_to_center_distance:new l.Uniform1f(i,o.u_camera_to_center_distance),u_scale_with_map:new l.Uniform1i(i,o.u_scale_with_map),u_pitch_with_map:new l.Uniform1i(i,o.u_pitch_with_map),u_extrude_scale:new l.Uniform2f(i,o.u_extrude_scale),u_device_pixel_ratio:new l.Uniform1f(i,o.u_device_pixel_ratio),u_matrix:new l.UniformMatrix4f(i,o.u_matrix)}},collisionBox:function(i,o){return{u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_camera_to_center_distance:new l.Uniform1f(i,o.u_camera_to_center_distance),u_pixels_to_tile_units:new l.Uniform1f(i,o.u_pixels_to_tile_units),u_extrude_scale:new l.Uniform2f(i,o.u_extrude_scale),u_overscale_factor:new l.Uniform1f(i,o.u_overscale_factor)}},collisionCircle:function(i,o){return{u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_inv_matrix:new l.UniformMatrix4f(i,o.u_inv_matrix),u_camera_to_center_distance:new l.Uniform1f(i,o.u_camera_to_center_distance),u_viewport_size:new l.Uniform2f(i,o.u_viewport_size)}},debug:function(i,o){return{u_color:new l.UniformColor(i,o.u_color),u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_overlay:new l.Uniform1i(i,o.u_overlay),u_overlay_scale:new l.Uniform1f(i,o.u_overlay_scale)}},clippingMask:function(i,o){return{u_matrix:new l.UniformMatrix4f(i,o.u_matrix)}},heatmap:function(i,o){return{u_extrude_scale:new l.Uniform1f(i,o.u_extrude_scale),u_intensity:new l.Uniform1f(i,o.u_intensity),u_matrix:new l.UniformMatrix4f(i,o.u_matrix)}},heatmapTexture:function(i,o){return{u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_world:new l.Uniform2f(i,o.u_world),u_image:new l.Uniform1i(i,o.u_image),u_color_ramp:new l.Uniform1i(i,o.u_color_ramp),u_opacity:new l.Uniform1f(i,o.u_opacity)}},hillshade:function(i,o){return{u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_image:new l.Uniform1i(i,o.u_image),u_latrange:new l.Uniform2f(i,o.u_latrange),u_light:new l.Uniform2f(i,o.u_light),u_shadow:new l.UniformColor(i,o.u_shadow),u_highlight:new l.UniformColor(i,o.u_highlight),u_accent:new l.UniformColor(i,o.u_accent)}},hillshadePrepare:function(i,o){return{u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_image:new l.Uniform1i(i,o.u_image),u_dimension:new l.Uniform2f(i,o.u_dimension),u_zoom:new l.Uniform1f(i,o.u_zoom),u_unpack:new l.Uniform4f(i,o.u_unpack)}},line:function(i,o){return{u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_ratio:new l.Uniform1f(i,o.u_ratio),u_device_pixel_ratio:new l.Uniform1f(i,o.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(i,o.u_units_to_pixels)}},lineGradient:function(i,o){return{u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_ratio:new l.Uniform1f(i,o.u_ratio),u_device_pixel_ratio:new l.Uniform1f(i,o.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(i,o.u_units_to_pixels),u_image:new l.Uniform1i(i,o.u_image),u_image_height:new l.Uniform1f(i,o.u_image_height)}},linePattern:function(i,o){return{u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_texsize:new l.Uniform2f(i,o.u_texsize),u_ratio:new l.Uniform1f(i,o.u_ratio),u_device_pixel_ratio:new l.Uniform1f(i,o.u_device_pixel_ratio),u_image:new l.Uniform1i(i,o.u_image),u_units_to_pixels:new l.Uniform2f(i,o.u_units_to_pixels),u_scale:new l.Uniform3f(i,o.u_scale),u_fade:new l.Uniform1f(i,o.u_fade)}},lineSDF:function(i,o){return{u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_ratio:new l.Uniform1f(i,o.u_ratio),u_device_pixel_ratio:new l.Uniform1f(i,o.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(i,o.u_units_to_pixels),u_patternscale_a:new l.Uniform2f(i,o.u_patternscale_a),u_patternscale_b:new l.Uniform2f(i,o.u_patternscale_b),u_sdfgamma:new l.Uniform1f(i,o.u_sdfgamma),u_image:new l.Uniform1i(i,o.u_image),u_tex_y_a:new l.Uniform1f(i,o.u_tex_y_a),u_tex_y_b:new l.Uniform1f(i,o.u_tex_y_b),u_mix:new l.Uniform1f(i,o.u_mix)}},raster:function(i,o){return{u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_tl_parent:new l.Uniform2f(i,o.u_tl_parent),u_scale_parent:new l.Uniform1f(i,o.u_scale_parent),u_buffer_scale:new l.Uniform1f(i,o.u_buffer_scale),u_fade_t:new l.Uniform1f(i,o.u_fade_t),u_opacity:new l.Uniform1f(i,o.u_opacity),u_image0:new l.Uniform1i(i,o.u_image0),u_image1:new l.Uniform1i(i,o.u_image1),u_brightness_low:new l.Uniform1f(i,o.u_brightness_low),u_brightness_high:new l.Uniform1f(i,o.u_brightness_high),u_saturation_factor:new l.Uniform1f(i,o.u_saturation_factor),u_contrast_factor:new l.Uniform1f(i,o.u_contrast_factor),u_spin_weights:new l.Uniform3f(i,o.u_spin_weights)}},symbolIcon:function(i,o){return{u_is_size_zoom_constant:new l.Uniform1i(i,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(i,o.u_is_size_feature_constant),u_size_t:new l.Uniform1f(i,o.u_size_t),u_size:new l.Uniform1f(i,o.u_size),u_camera_to_center_distance:new l.Uniform1f(i,o.u_camera_to_center_distance),u_pitch:new l.Uniform1f(i,o.u_pitch),u_rotate_symbol:new l.Uniform1i(i,o.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(i,o.u_aspect_ratio),u_fade_change:new l.Uniform1f(i,o.u_fade_change),u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(i,o.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(i,o.u_coord_matrix),u_is_text:new l.Uniform1i(i,o.u_is_text),u_pitch_with_map:new l.Uniform1i(i,o.u_pitch_with_map),u_texsize:new l.Uniform2f(i,o.u_texsize),u_texture:new l.Uniform1i(i,o.u_texture)}},symbolSDF:function(i,o){return{u_is_size_zoom_constant:new l.Uniform1i(i,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(i,o.u_is_size_feature_constant),u_size_t:new l.Uniform1f(i,o.u_size_t),u_size:new l.Uniform1f(i,o.u_size),u_camera_to_center_distance:new l.Uniform1f(i,o.u_camera_to_center_distance),u_pitch:new l.Uniform1f(i,o.u_pitch),u_rotate_symbol:new l.Uniform1i(i,o.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(i,o.u_aspect_ratio),u_fade_change:new l.Uniform1f(i,o.u_fade_change),u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(i,o.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(i,o.u_coord_matrix),u_is_text:new l.Uniform1i(i,o.u_is_text),u_pitch_with_map:new l.Uniform1i(i,o.u_pitch_with_map),u_texsize:new l.Uniform2f(i,o.u_texsize),u_texture:new l.Uniform1i(i,o.u_texture),u_gamma_scale:new l.Uniform1f(i,o.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(i,o.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(i,o.u_is_halo)}},symbolTextAndIcon:function(i,o){return{u_is_size_zoom_constant:new l.Uniform1i(i,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(i,o.u_is_size_feature_constant),u_size_t:new l.Uniform1f(i,o.u_size_t),u_size:new l.Uniform1f(i,o.u_size),u_camera_to_center_distance:new l.Uniform1f(i,o.u_camera_to_center_distance),u_pitch:new l.Uniform1f(i,o.u_pitch),u_rotate_symbol:new l.Uniform1i(i,o.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(i,o.u_aspect_ratio),u_fade_change:new l.Uniform1f(i,o.u_fade_change),u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(i,o.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(i,o.u_coord_matrix),u_is_text:new l.Uniform1i(i,o.u_is_text),u_pitch_with_map:new l.Uniform1i(i,o.u_pitch_with_map),u_texsize:new l.Uniform2f(i,o.u_texsize),u_texsize_icon:new l.Uniform2f(i,o.u_texsize_icon),u_texture:new l.Uniform1i(i,o.u_texture),u_texture_icon:new l.Uniform1i(i,o.u_texture_icon),u_gamma_scale:new l.Uniform1f(i,o.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(i,o.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(i,o.u_is_halo)}},background:function(i,o){return{u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_opacity:new l.Uniform1f(i,o.u_opacity),u_color:new l.UniformColor(i,o.u_color)}},backgroundPattern:function(i,o){return{u_matrix:new l.UniformMatrix4f(i,o.u_matrix),u_opacity:new l.Uniform1f(i,o.u_opacity),u_image:new l.Uniform1i(i,o.u_image),u_pattern_tl_a:new l.Uniform2f(i,o.u_pattern_tl_a),u_pattern_br_a:new l.Uniform2f(i,o.u_pattern_br_a),u_pattern_tl_b:new l.Uniform2f(i,o.u_pattern_tl_b),u_pattern_br_b:new l.Uniform2f(i,o.u_pattern_br_b),u_texsize:new l.Uniform2f(i,o.u_texsize),u_mix:new l.Uniform1f(i,o.u_mix),u_pattern_size_a:new l.Uniform2f(i,o.u_pattern_size_a),u_pattern_size_b:new l.Uniform2f(i,o.u_pattern_size_b),u_scale_a:new l.Uniform1f(i,o.u_scale_a),u_scale_b:new l.Uniform1f(i,o.u_scale_b),u_pixel_coord_upper:new l.Uniform2f(i,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(i,o.u_pixel_coord_lower),u_tile_units_to_pixels:new l.Uniform1f(i,o.u_tile_units_to_pixels)}}};function Kl(i,o,n,s,h,m,y){for(var v=i.context,S=v.gl,A=i.useProgram("collisionBox"),D=[],B=0,R=0,G=0;G<s.length;G++){var q=s[G],$=o.getTile(q),j=$.getBucket(n);if(j){var K=q.posMatrix;h[0]===0&&h[1]===0||(K=i.translatePosMatrix(q.posMatrix,$,h,m));var te=y?j.textCollisionBox:j.iconCollisionBox,oe=j.collisionCircleArray;if(oe.length>0){var de=l.create(),pe=K;l.mul(de,j.placementInvProjMatrix,i.transform.glCoordMatrix),l.mul(de,de,j.placementViewportMatrix),D.push({circleArray:oe,circleOffset:R,transform:pe,invTransform:de}),R=B+=oe.length/4}te&&A.draw(v,S.LINES,O.disabled,Z.disabled,i.colorModeForRenderPass(),re.disabled,Hl(K,i.transform,$),n.id,te.layoutVertexBuffer,te.indexBuffer,te.segments,null,i.transform.zoom,null,null,te.collisionVertexBuffer)}}if(y&&D.length){var me=i.useProgram("collisionCircle"),_e=new l.StructArrayLayout2f1f2i16;_e.resize(4*B),_e._trim();for(var ze=0,Se=0,Ue=D;Se<Ue.length;Se+=1)for(var Qe=Ue[Se],rt=0;rt<Qe.circleArray.length/4;rt++){var et=4*rt,Ft=Qe.circleArray[et+0],Ze=Qe.circleArray[et+1],dt=Qe.circleArray[et+2],St=Qe.circleArray[et+3];_e.emplace(ze++,Ft,Ze,dt,St,0),_e.emplace(ze++,Ft,Ze,dt,St,1),_e.emplace(ze++,Ft,Ze,dt,St,2),_e.emplace(ze++,Ft,Ze,dt,St,3)}(!Ka||Ka.length<2*B)&&(Ka=function(Dr){var Ei=2*Dr,Qr=new l.StructArrayLayout3ui6;Qr.resize(Ei),Qr._trim();for(var ei=0;ei<Ei;ei++){var Rr=6*ei;Qr.uint16[Rr+0]=4*ei+0,Qr.uint16[Rr+1]=4*ei+1,Qr.uint16[Rr+2]=4*ei+2,Qr.uint16[Rr+3]=4*ei+2,Qr.uint16[Rr+4]=4*ei+3,Qr.uint16[Rr+5]=4*ei+0}return Qr}(B));for(var mt=v.createIndexBuffer(Ka,!0),pt=v.createVertexBuffer(_e,l.collisionCircleLayout.members,!0),ct=0,lt=D;ct<lt.length;ct+=1){var nt=lt[ct],rr=Xo(nt.transform,nt.invTransform,i.transform);me.draw(v,S.TRIANGLES,O.disabled,Z.disabled,i.colorModeForRenderPass(),re.disabled,rr,n.id,pt,mt,l.SegmentVector.simpleSegment(0,2*nt.circleOffset,nt.circleArray.length,nt.circleArray.length/2),null,i.transform.zoom,null,null,null)}pt.destroy(),mt.destroy()}}var Ja=l.identity(new Float32Array(16));function In(i,o,n,s,h,m){var y=l.getAnchorAlignment(i),v=-(y.horizontalAlign-.5)*o,S=-(y.verticalAlign-.5)*n,A=l.evaluateVariableOffset(i,s);return new l.Point((v/h+A[0])*m,(S/h+A[1])*m)}function pc(i,o,n,s,h,m,y,v,S,A,D){var B=i.text.placedSymbolArray,R=i.text.dynamicLayoutVertexArray,G=i.icon.dynamicLayoutVertexArray,q={};R.clear();for(var $=0;$<B.length;$++){var j=B.get($),K=j.hidden||!j.crossTileID||i.allowVerticalPlacement&&!j.placedOrientation?null:s[j.crossTileID];if(K){var te=new l.Point(j.anchorX,j.anchorY),oe=Tt(te,n?v:y),de=ma(m.cameraToCenterDistance,oe.signedDistanceFromCamera),pe=h.evaluateSizeForFeature(i.textSizeData,A,j)*de/l.ONE_EM;n&&(pe*=i.tilePixelRatio/S);for(var me=In(K.anchor,K.width,K.height,K.textOffset,K.textBoxScale,pe),_e=n?Tt(te.add(me),y).point:oe.point.add(o?me.rotate(-m.angle):me),ze=i.allowVerticalPlacement&&j.placedOrientation===l.WritingMode.vertical?Math.PI/2:0,Se=0;Se<j.numGlyphs;Se++)l.addDynamicAttributes(R,_e,ze);D&&j.associatedIconIndex>=0&&(q[j.associatedIconIndex]={shiftedAnchor:_e,angle:ze})}else On(j.numGlyphs,R)}if(D){G.clear();for(var Ue=i.icon.placedSymbolArray,Qe=0;Qe<Ue.length;Qe++){var rt=Ue.get(Qe);if(rt.hidden)On(rt.numGlyphs,G);else{var et=q[Qe];if(et)for(var Ft=0;Ft<rt.numGlyphs;Ft++)l.addDynamicAttributes(G,et.shiftedAnchor,et.angle);else On(rt.numGlyphs,G)}}i.icon.dynamicLayoutVertexBuffer.updateData(G)}i.text.dynamicLayoutVertexBuffer.updateData(R)}function hc(i,o,n){return n.iconsInText&&o?"symbolTextAndIcon":i?"symbolSDF":"symbolIcon"}function $l(i,o,n,s,h,m,y,v,S,A,D,B){for(var R=i.context,G=R.gl,q=i.transform,$=v==="map",j=S==="map",K=$&&n.layout.get("symbol-placement")!=="point",te=$&&!j&&!K,oe=!n.layout.get("symbol-sort-key").isConstant(),de=!1,pe=i.depthModeForSublayer(0,O.ReadOnly),me=n.layout.get("text-variable-anchor"),_e=[],ze=0,Se=s;ze<Se.length;ze+=1){var Ue=Se[ze],Qe=o.getTile(Ue),rt=Qe.getBucket(n);if(rt){var et=h?rt.text:rt.icon;if(et&&et.segments.get().length){var Ft=et.programConfigurations.get(n.id),Ze=h||rt.sdfIcons,dt=h?rt.textSizeData:rt.iconSizeData,St=j||q.pitch!==0,mt=i.useProgram(hc(Ze,h,rt),Ft),pt=l.evaluateSizeForZoom(dt,q.zoom),ct=void 0,lt=[0,0],nt=void 0,rr=void 0,Dr=null,Ei=void 0;if(h)nt=Qe.glyphAtlasTexture,rr=G.LINEAR,ct=Qe.glyphAtlasTexture.size,rt.iconsInText&&(lt=Qe.imageAtlasTexture.size,Dr=Qe.imageAtlasTexture,Ei=St||i.options.rotating||i.options.zooming||dt.kind==="composite"||dt.kind==="camera"?G.LINEAR:G.NEAREST);else{var Qr=n.layout.get("icon-size").constantOr(0)!==1||rt.iconsNeedLinear;nt=Qe.imageAtlasTexture,rr=Ze||i.options.rotating||i.options.zooming||Qr||St?G.LINEAR:G.NEAREST,ct=Qe.imageAtlasTexture.size}var ei=Ri(Qe,1,i.transform.zoom),Rr=Cr(Ue.posMatrix,j,$,i.transform,ei),vi=cr(Ue.posMatrix,j,$,i.transform,ei),Vn=me&&rt.hasTextData(),Ti=n.layout.get("icon-text-fit")!=="none"&&Vn&&rt.hasIconData();K&&Vo(rt,Ue.posMatrix,i,h,Rr,vi,j,A);var Ii=i.translatePosMatrix(Ue.posMatrix,Qe,m,y),Nn=K||h&&me||Ti?Ja:Rr,sn=i.translatePosMatrix(vi,Qe,m,y,!0),uu=Ze&&n.paint.get(h?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Io={program:mt,buffers:et,uniformValues:Ze?rt.iconsInText?js(dt.kind,pt,te,j,i,Ii,Nn,sn,ct,lt):ba(dt.kind,pt,te,j,i,Ii,Nn,sn,h,ct,!0):cc(dt.kind,pt,te,j,i,Ii,Nn,sn,h,ct),atlasTexture:nt,atlasTextureIcon:Dr,atlasInterpolation:rr,atlasInterpolationIcon:Ei,isSDF:Ze,hasHalo:uu};if(oe&&rt.canOverlap){de=!0;for(var Ia=0,ra=et.segments.get();Ia<ra.length;Ia+=1){var cs=ra[Ia];_e.push({segments:new l.SegmentVector([cs]),sortKey:cs.sortKey,state:Io})}}else _e.push({segments:et.segments,sortKey:0,state:Io})}}}de&&_e.sort(function(An,ia){return An.sortKey-ia.sortKey});for(var Ca=0,jn=_e;Ca<jn.length;Ca+=1){var Aa=jn[Ca],Xr=Aa.state;if(R.activeTexture.set(G.TEXTURE0),Xr.atlasTexture.bind(Xr.atlasInterpolation,G.CLAMP_TO_EDGE),Xr.atlasTextureIcon&&(R.activeTexture.set(G.TEXTURE1),Xr.atlasTextureIcon&&Xr.atlasTextureIcon.bind(Xr.atlasInterpolationIcon,G.CLAMP_TO_EDGE)),Xr.isSDF){var io=Xr.uniformValues;Xr.hasHalo&&(io.u_is_halo=1,Ko(Xr.buffers,Aa.segments,n,i,Xr.program,pe,D,B,io)),io.u_is_halo=0}Ko(Xr.buffers,Aa.segments,n,i,Xr.program,pe,D,B,Xr.uniformValues)}}function Ko(i,o,n,s,h,m,y,v,S){var A=s.context;h.draw(A,A.gl.TRIANGLES,m,y,v,re.disabled,S,n.id,i.layoutVertexBuffer,i.indexBuffer,o,n.paint,s.transform.zoom,i.programConfigurations.get(n.id),i.dynamicLayoutVertexBuffer,i.opacityVertexBuffer)}function Ya(i,o,n,s,h,m,y){var v,S,A,D,B,R=i.context.gl,G=n.paint.get("fill-pattern"),q=G&&G.constantOr(1),$=n.getCrossfadeParameters();y?(S=q&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",v=R.LINES):(S=q?"fillPattern":"fill",v=R.TRIANGLES);for(var j=0,K=s;j<K.length;j+=1){var te=K[j],oe=o.getTile(te);if(!q||oe.patternsLoaded()){var de=oe.getBucket(n);if(de){var pe=de.programConfigurations.get(n.id),me=i.useProgram(S,pe);q&&(i.context.activeTexture.set(R.TEXTURE0),oe.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),pe.updatePaintBuffers($));var _e=G.constantOr(null);if(_e&&oe.imageAtlas){var ze=oe.imageAtlas,Se=ze.patternPositions[_e.to.toString()],Ue=ze.patternPositions[_e.from.toString()];Se&&Ue&&pe.setConstantPatternPositions(Se,Ue)}var Qe=i.translatePosMatrix(te.posMatrix,oe,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(y){D=de.indexBuffer2,B=de.segments2;var rt=[R.drawingBufferWidth,R.drawingBufferHeight];A=S==="fillOutlinePattern"&&q?sc(Qe,i,$,oe,rt):_a(Qe,rt)}else D=de.indexBuffer,B=de.segments,A=q?xo(Qe,i,$,oe):vo(Qe);me.draw(i.context,v,h,i.stencilModeForClipping(te),m,re.disabled,A,n.id,de.layoutVertexBuffer,D,B,n.paint,i.transform.zoom,pe)}}}}function Qa(i,o,n,s,h,m,y){for(var v=i.context,S=v.gl,A=n.paint.get("fill-extrusion-pattern"),D=A.constantOr(1),B=n.getCrossfadeParameters(),R=n.paint.get("fill-extrusion-opacity"),G=0,q=s;G<q.length;G+=1){var $=q[G],j=o.getTile($),K=j.getBucket(n);if(K){var te=K.programConfigurations.get(n.id),oe=i.useProgram(D?"fillExtrusionPattern":"fillExtrusion",te);D&&(i.context.activeTexture.set(S.TEXTURE0),j.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),te.updatePaintBuffers(B));var de=A.constantOr(null);if(de&&j.imageAtlas){var pe=j.imageAtlas,me=pe.patternPositions[de.to.toString()],_e=pe.patternPositions[de.from.toString()];me&&_e&&te.setConstantPatternPositions(me,_e)}var ze=i.translatePosMatrix($.posMatrix,j,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Se=n.paint.get("fill-extrusion-vertical-gradient"),Ue=D?Fp(ze,i,Se,R,$,B,j):ac(ze,i,Se,R);oe.draw(v,v.gl.TRIANGLES,h,m,y,re.backCCW,Ue,n.id,K.layoutVertexBuffer,K.indexBuffer,K.segments,n.paint,i.transform.zoom,te)}}}function Np(i,o,n,s,h,m){var y=i.context,v=y.gl,S=o.fbo;if(S){var A=i.useProgram("hillshade");y.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,S.colorAttachment.get());var D=function(B,R,G){var q=G.paint.get("hillshade-shadow-color"),$=G.paint.get("hillshade-highlight-color"),j=G.paint.get("hillshade-accent-color"),K=G.paint.get("hillshade-illumination-direction")*(Math.PI/180);G.paint.get("hillshade-illumination-anchor")==="viewport"&&(K-=B.transform.angle);var te,oe,de,pe=!B.options.moving;return{u_matrix:B.transform.calculatePosMatrix(R.tileID.toUnwrapped(),pe),u_image:0,u_latrange:(te=R.tileID,oe=Math.pow(2,te.canonical.z),de=te.canonical.y,[new l.MercatorCoordinate(0,de/oe).toLngLat().lat,new l.MercatorCoordinate(0,(de+1)/oe).toLngLat().lat]),u_light:[G.paint.get("hillshade-exaggeration"),K],u_shadow:q,u_highlight:$,u_accent:j}}(i,o,n);A.draw(y,v.TRIANGLES,s,h,m,re.disabled,D,n.id,i.rasterBoundsBuffer,i.quadTriangleIndexBuffer,i.rasterBoundsSegments)}}function Zs(i,o,n,s,h,m){var y=i.context,v=y.gl,S=o.dem;if(S&&S.data){var A=S.dim,D=S.stride,B=S.getPixels();if(y.activeTexture.set(v.TEXTURE1),y.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||i.getTileTexture(D),o.demTexture){var R=o.demTexture;R.update(B,{premultiply:!1}),R.bind(v.NEAREST,v.CLAMP_TO_EDGE)}else o.demTexture=new l.Texture(y,B,v.RGBA,{premultiply:!1}),o.demTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE);y.activeTexture.set(v.TEXTURE0);var G=o.fbo;if(!G){var q=new l.Texture(y,{width:A,height:A,data:null},v.RGBA);q.bind(v.LINEAR,v.CLAMP_TO_EDGE),(G=o.fbo=y.createFramebuffer(A,A,!0)).colorAttachment.set(q.texture)}y.bindFramebuffer.set(G.framebuffer),y.viewport.set([0,0,A,A]),i.useProgram("hillshadePrepare").draw(y,v.TRIANGLES,s,h,m,re.disabled,function($,j){var K=j.stride,te=l.create();return l.ortho(te,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(te,te,[0,-l.EXTENT,0]),{u_matrix:te,u_image:1,u_dimension:[K,K],u_zoom:$.overscaledZ,u_unpack:j.getUnpackVector()}}(o.tileID,S),n.id,i.rasterBoundsBuffer,i.quadTriangleIndexBuffer,i.rasterBoundsSegments),o.needsHillshadePrepare=!1}}function jp(i,o,n,s,h){var m=s.paint.get("raster-fade-duration");if(m>0){var y=l.browser.now(),v=(y-i.timeAdded)/m,S=o?(y-o.timeAdded)/m:-1,A=n.getSource(),D=h.coveringZoomLevel({tileSize:A.tileSize,roundZoom:A.roundZoom}),B=!o||Math.abs(o.tileID.overscaledZ-D)>Math.abs(i.tileID.overscaledZ-D),R=B&&i.refreshedUponExpiration?1:l.clamp(B?v:1-S,0,1);return i.refreshedUponExpiration&&v>=1&&(i.refreshedUponExpiration=!1),o?{opacity:1,mix:1-R}:{opacity:R,mix:0}}return{opacity:1,mix:0}}var Gs=new l.Color(1,0,0,1),Jl=new l.Color(0,1,0,1),fc=new l.Color(0,0,1,1),dc=new l.Color(1,0,1,1),Hs=new l.Color(0,1,1,1);function Xs(i,o,n,s){es(i,0,o+n/2,i.transform.width,n,s)}function Yl(i,o,n,s){es(i,o-n/2,0,n,i.transform.height,s)}function es(i,o,n,s,h,m){var y=i.context,v=y.gl;v.enable(v.SCISSOR_TEST),v.scissor(o*l.browser.devicePixelRatio,n*l.browser.devicePixelRatio,s*l.browser.devicePixelRatio,h*l.browser.devicePixelRatio),y.clear({color:m}),v.disable(v.SCISSOR_TEST)}function mc(i,o,n){var s=i.context,h=s.gl,m=n.posMatrix,y=i.useProgram("debug"),v=O.disabled,S=Z.disabled,A=i.colorModeForRenderPass();s.activeTexture.set(h.TEXTURE0),i.emptyTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE),y.draw(s,h.LINE_STRIP,v,S,A,re.disabled,Xl(m,l.Color.red),"$debug",i.debugBuffer,i.tileBorderIndexBuffer,i.debugSegments);var D=o.getTileByID(n.key).latestRawTileData,B=Math.floor((D&&D.byteLength||0)/1024),R=o.getTile(n).tileSize,G=512/Math.min(R,512)*(n.overscaledZ/i.transform.zoom)*.5,q=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(q+=" => "+n.overscaledZ),function($,j){$.initDebugOverlayCanvas();var K=$.debugOverlayCanvas,te=$.context.gl,oe=$.debugOverlayCanvas.getContext("2d");oe.clearRect(0,0,K.width,K.height),oe.shadowColor="white",oe.shadowBlur=2,oe.lineWidth=1.5,oe.strokeStyle="white",oe.textBaseline="top",oe.font="bold 36px Open Sans, sans-serif",oe.fillText(j,5,5),oe.strokeText(j,5,5),$.debugOverlayTexture.update(K),$.debugOverlayTexture.bind(te.LINEAR,te.CLAMP_TO_EDGE)}(i,q+" "+B+"kb"),y.draw(s,h.TRIANGLES,v,S,ee.alphaBlended,re.disabled,Xl(m,l.Color.transparent,G),"$debug",i.debugBuffer,i.quadTriangleIndexBuffer,i.debugSegments)}var Ql={symbol:function(i,o,n,s,h){if(i.renderPass==="translucent"){var m=Z.disabled,y=i.colorModeForRenderPass();n.layout.get("text-variable-anchor")&&function(v,S,A,D,B,R,G){for(var q=S.transform,$=B==="map",j=R==="map",K=0,te=v;K<te.length;K+=1){var oe=te[K],de=D.getTile(oe),pe=de.getBucket(A);if(pe&&pe.text&&pe.text.segments.get().length){var me=l.evaluateSizeForZoom(pe.textSizeData,q.zoom),_e=Ri(de,1,S.transform.zoom),ze=Cr(oe.posMatrix,j,$,S.transform,_e),Se=A.layout.get("icon-text-fit")!=="none"&&pe.hasIconData();if(me){var Ue=Math.pow(2,q.zoom-de.tileID.overscaledZ);pc(pe,$,j,G,l.symbolSize,q,ze,oe.posMatrix,Ue,me,Se)}}}}(s,i,n,o,n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),h),n.paint.get("icon-opacity").constantOr(1)!==0&&$l(i,o,n,s,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),m,y),n.paint.get("text-opacity").constantOr(1)!==0&&$l(i,o,n,s,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),m,y),o.map.showCollisionBoxes&&(Kl(i,o,n,s,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),!0),Kl(i,o,n,s,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),!1))}},circle:function(i,o,n,s){if(i.renderPass==="translucent"){var h=n.paint.get("circle-opacity"),m=n.paint.get("circle-stroke-width"),y=n.paint.get("circle-stroke-opacity"),v=!n.layout.get("circle-sort-key").isConstant();if(h.constantOr(1)!==0||m.constantOr(1)!==0&&y.constantOr(1)!==0){for(var S=i.context,A=S.gl,D=i.depthModeForSublayer(0,O.ReadOnly),B=Z.disabled,R=i.colorModeForRenderPass(),G=[],q=0;q<s.length;q++){var $=s[q],j=o.getTile($),K=j.getBucket(n);if(K){var te=K.programConfigurations.get(n.id),oe={programConfiguration:te,program:i.useProgram("circle",te),layoutVertexBuffer:K.layoutVertexBuffer,indexBuffer:K.indexBuffer,uniformValues:lc(i,$,j,n)};if(v)for(var de=0,pe=K.segments.get();de<pe.length;de+=1){var me=pe[de];G.push({segments:new l.SegmentVector([me]),sortKey:me.sortKey,state:oe})}else G.push({segments:K.segments,sortKey:0,state:oe})}}v&&G.sort(function(Qe,rt){return Qe.sortKey-rt.sortKey});for(var _e=0,ze=G;_e<ze.length;_e+=1){var Se=ze[_e],Ue=Se.state;Ue.program.draw(S,A.TRIANGLES,D,B,R,re.disabled,Ue.uniformValues,n.id,Ue.layoutVertexBuffer,Ue.indexBuffer,Se.segments,n.paint,i.transform.zoom,Ue.programConfiguration)}}}},heatmap:function(i,o,n,s){if(n.paint.get("heatmap-opacity")!==0)if(i.renderPass==="offscreen"){var h=i.context,m=h.gl,y=Z.disabled,v=new ee([m.ONE,m.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(G,q,$){var j=G.gl;G.activeTexture.set(j.TEXTURE1),G.viewport.set([0,0,q.width/4,q.height/4]);var K=$.heatmapFbo;if(K)j.bindTexture(j.TEXTURE_2D,K.colorAttachment.get()),G.bindFramebuffer.set(K.framebuffer);else{var te=j.createTexture();j.bindTexture(j.TEXTURE_2D,te),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_S,j.CLAMP_TO_EDGE),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_T,j.CLAMP_TO_EDGE),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MIN_FILTER,j.LINEAR),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MAG_FILTER,j.LINEAR),K=$.heatmapFbo=G.createFramebuffer(q.width/4,q.height/4,!1),function(oe,de,pe,me){var _e=oe.gl;_e.texImage2D(_e.TEXTURE_2D,0,_e.RGBA,de.width/4,de.height/4,0,_e.RGBA,oe.extRenderToTextureHalfFloat?oe.extTextureHalfFloat.HALF_FLOAT_OES:_e.UNSIGNED_BYTE,null),me.colorAttachment.set(pe)}(G,q,te,K)}})(h,i,n),h.clear({color:l.Color.transparent});for(var S=0;S<s.length;S++){var A=s[S];if(!o.hasRenderableParent(A)){var D=o.getTile(A),B=D.getBucket(n);if(B){var R=B.programConfigurations.get(n.id);i.useProgram("heatmap",R).draw(h,m.TRIANGLES,O.disabled,y,v,re.disabled,va(A.posMatrix,D,i.transform.zoom,n.paint.get("heatmap-intensity")),n.id,B.layoutVertexBuffer,B.indexBuffer,B.segments,n.paint,i.transform.zoom,R)}}}h.viewport.set([0,0,i.width,i.height])}else i.renderPass==="translucent"&&(i.context.setColorMode(i.colorModeForRenderPass()),function(G,q){var $=G.context,j=$.gl,K=q.heatmapFbo;if(K){$.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,K.colorAttachment.get()),$.activeTexture.set(j.TEXTURE1);var te=q.colorRampTexture;te||(te=q.colorRampTexture=new l.Texture($,q.colorRamp,j.RGBA)),te.bind(j.LINEAR,j.CLAMP_TO_EDGE),G.useProgram("heatmapTexture").draw($,j.TRIANGLES,O.disabled,Z.disabled,G.colorModeForRenderPass(),re.disabled,function(oe,de,pe,me){var _e=l.create();l.ortho(_e,0,oe.width,oe.height,0,0,1);var ze=oe.context.gl;return{u_matrix:_e,u_world:[ze.drawingBufferWidth,ze.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:de.paint.get("heatmap-opacity")}}(G,q),q.id,G.viewportBuffer,G.quadTriangleIndexBuffer,G.viewportSegments,q.paint,G.transform.zoom)}}(i,n))},line:function(i,o,n,s){if(i.renderPass==="translucent"){var h=n.paint.get("line-opacity"),m=n.paint.get("line-width");if(h.constantOr(1)!==0&&m.constantOr(1)!==0)for(var y=i.depthModeForSublayer(0,O.ReadOnly),v=i.colorModeForRenderPass(),S=n.paint.get("line-dasharray"),A=n.paint.get("line-pattern"),D=A.constantOr(1),B=n.paint.get("line-gradient"),R=n.getCrossfadeParameters(),G=D?"linePattern":S?"lineSDF":B?"lineGradient":"line",q=i.context,$=q.gl,j=!0,K=0,te=s;K<te.length;K+=1){var oe=te[K],de=o.getTile(oe);if(!D||de.patternsLoaded()){var pe=de.getBucket(n);if(pe){var me=pe.programConfigurations.get(n.id),_e=i.context.program.get(),ze=i.useProgram(G,me),Se=j||ze.program!==_e,Ue=A.constantOr(null);if(Ue&&de.imageAtlas){var Qe=de.imageAtlas,rt=Qe.patternPositions[Ue.to.toString()],et=Qe.patternPositions[Ue.from.toString()];rt&&et&&me.setConstantPatternPositions(rt,et)}var Ft=D?fr(i,de,n,R):S?Ns(i,de,n,S,R):B?Wl(i,de,n,pe.lineClipsArray.length):Vs(i,de,n);if(D)q.activeTexture.set($.TEXTURE0),de.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),me.updatePaintBuffers(R);else if(S&&(Se||i.lineAtlas.dirty))q.activeTexture.set($.TEXTURE0),i.lineAtlas.bind(q);else if(B){var Ze=pe.gradients[n.id],dt=Ze.texture;if(n.gradientVersion!==Ze.version){var St=256;if(n.stepInterpolant){var mt=o.getSource().maxzoom,pt=oe.canonical.z===mt?Math.ceil(1<<i.transform.maxZoom-oe.canonical.z):1;St=l.clamp(l.nextPowerOfTwo(pe.maxLineLength/l.EXTENT*1024*pt),256,q.maxTextureSize)}Ze.gradient=l.renderColorRamp({expression:n.gradientExpression(),evaluationKey:"lineProgress",resolution:St,image:Ze.gradient||void 0,clips:pe.lineClipsArray}),Ze.texture?Ze.texture.update(Ze.gradient):Ze.texture=new l.Texture(q,Ze.gradient,$.RGBA),Ze.version=n.gradientVersion,dt=Ze.texture}q.activeTexture.set($.TEXTURE0),dt.bind(n.stepInterpolant?$.NEAREST:$.LINEAR,$.CLAMP_TO_EDGE)}ze.draw(q,$.TRIANGLES,y,i.stencilModeForClipping(oe),v,re.disabled,Ft,n.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,n.paint,i.transform.zoom,me,pe.layoutVertexBuffer2),j=!1}}}}},fill:function(i,o,n,s){var h=n.paint.get("fill-color"),m=n.paint.get("fill-opacity");if(m.constantOr(1)!==0){var y=i.colorModeForRenderPass(),v=n.paint.get("fill-pattern"),S=i.opaquePassEnabledForLayer()&&!v.constantOr(1)&&h.constantOr(l.Color.transparent).a===1&&m.constantOr(0)===1?"opaque":"translucent";if(i.renderPass===S){var A=i.depthModeForSublayer(1,i.renderPass==="opaque"?O.ReadWrite:O.ReadOnly);Ya(i,o,n,s,A,y,!1)}if(i.renderPass==="translucent"&&n.paint.get("fill-antialias")){var D=i.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,O.ReadOnly);Ya(i,o,n,s,D,y,!0)}}},"fill-extrusion":function(i,o,n,s){var h=n.paint.get("fill-extrusion-opacity");if(h!==0&&i.renderPass==="translucent"){var m=new O(i.context.gl.LEQUAL,O.ReadWrite,i.depthRangeFor3D);if(h!==1||n.paint.get("fill-extrusion-pattern").constantOr(1))Qa(i,o,n,s,m,Z.disabled,ee.disabled),Qa(i,o,n,s,m,i.stencilModeFor3D(),i.colorModeForRenderPass());else{var y=i.colorModeForRenderPass();Qa(i,o,n,s,m,Z.disabled,y)}}},hillshade:function(i,o,n,s){if(i.renderPass==="offscreen"||i.renderPass==="translucent"){for(var h=i.context,m=i.depthModeForSublayer(0,O.ReadOnly),y=i.colorModeForRenderPass(),v=i.renderPass==="translucent"?i.stencilConfigForOverlap(s):[{},s],S=v[0],A=0,D=v[1];A<D.length;A+=1){var B=D[A],R=o.getTile(B);R.needsHillshadePrepare&&i.renderPass==="offscreen"?Zs(i,R,n,m,Z.disabled,y):i.renderPass==="translucent"&&Np(i,R,n,m,S[B.overscaledZ],y)}h.viewport.set([0,0,i.width,i.height])}},raster:function(i,o,n,s){if(i.renderPass==="translucent"&&n.paint.get("raster-opacity")!==0&&s.length)for(var h=i.context,m=h.gl,y=o.getSource(),v=i.useProgram("raster"),S=i.colorModeForRenderPass(),A=y instanceof Zr?[{},s]:i.stencilConfigForOverlap(s),D=A[0],B=A[1],R=B[B.length-1].overscaledZ,G=!i.options.moving,q=0,$=B;q<$.length;q+=1){var j=$[q],K=i.depthModeForSublayer(j.overscaledZ-R,n.paint.get("raster-opacity")===1?O.ReadWrite:O.ReadOnly,m.LESS),te=o.getTile(j),oe=i.transform.calculatePosMatrix(j.toUnwrapped(),G);te.registerFadeDuration(n.paint.get("raster-fade-duration"));var de=o.findLoadedParent(j,0),pe=jp(te,de,o,n,i.transform),me=void 0,_e=void 0,ze=n.paint.get("raster-resampling")==="nearest"?m.NEAREST:m.LINEAR;h.activeTexture.set(m.TEXTURE0),te.texture.bind(ze,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST),h.activeTexture.set(m.TEXTURE1),de?(de.texture.bind(ze,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST),me=Math.pow(2,de.tileID.overscaledZ-te.tileID.overscaledZ),_e=[te.tileID.canonical.x*me%1,te.tileID.canonical.y*me%1]):te.texture.bind(ze,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST);var Se=Up(oe,_e||[0,0],me||1,pe,n);y instanceof Zr?v.draw(h,m.TRIANGLES,K,Z.disabled,S,re.disabled,Se,n.id,y.boundsBuffer,i.quadTriangleIndexBuffer,y.boundsSegments):v.draw(h,m.TRIANGLES,K,D[j.overscaledZ],S,re.disabled,Se,n.id,i.rasterBoundsBuffer,i.quadTriangleIndexBuffer,i.rasterBoundsSegments)}},background:function(i,o,n){var s=n.paint.get("background-color"),h=n.paint.get("background-opacity");if(h!==0){var m=i.context,y=m.gl,v=i.transform,S=v.tileSize,A=n.paint.get("background-pattern");if(!i.isPatternMissing(A)){var D=!A&&s.a===1&&h===1&&i.opaquePassEnabledForLayer()?"opaque":"translucent";if(i.renderPass===D){var B=Z.disabled,R=i.depthModeForSublayer(0,D==="opaque"?O.ReadWrite:O.ReadOnly),G=i.colorModeForRenderPass(),q=i.useProgram(A?"backgroundPattern":"background"),$=v.coveringTiles({tileSize:S});A&&(m.activeTexture.set(y.TEXTURE0),i.imageManager.bind(i.context));for(var j=n.getCrossfadeParameters(),K=0,te=$;K<te.length;K+=1){var oe=te[K],de=i.transform.calculatePosMatrix(oe.toUnwrapped()),pe=A?$a(de,h,i,A,{tileID:oe,tileSize:S},j):qs(de,h,s);q.draw(m,y.TRIANGLES,R,B,G,re.disabled,pe,n.id,i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments)}}}}},debug:function(i,o,n){for(var s=0;s<n.length;s++)mc(i,o,n[s])},custom:function(i,o,n){var s=i.context,h=n.implementation;if(i.renderPass==="offscreen"){var m=h.prerender;m&&(i.setCustomLayerDefaults(),s.setColorMode(i.colorModeForRenderPass()),m.call(h,s.gl,i.transform.customLayerMatrix()),s.setDirty(),i.setBaseState())}else if(i.renderPass==="translucent"){i.setCustomLayerDefaults(),s.setColorMode(i.colorModeForRenderPass()),s.setStencilMode(Z.disabled);var y=h.renderingMode==="3d"?new O(i.context.gl.LEQUAL,O.ReadWrite,i.depthRangeFor3D):i.depthModeForSublayer(0,O.ReadOnly);s.setDepthMode(y),h.render(s.gl,i.transform.customLayerMatrix()),s.setDirty(),i.setBaseState(),s.bindFramebuffer.set(null)}}},tr=function(i,o){this.context=new Y(i),this.transform=o,this._tileTextures={},this.setup(),this.numSublayers=F.maxUnderzooming+F.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new jo,this.gpuTimers={}};tr.prototype.resize=function(i,o){if(this.width=i*l.browser.devicePixelRatio,this.height=o*l.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var n=0,s=this.style._order;n<s.length;n+=1)this.style._layers[s[n]].resize()},tr.prototype.setup=function(){var i=this.context,o=new l.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(l.EXTENT,0),o.emplaceBack(0,l.EXTENT),o.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=i.createVertexBuffer(o,Tn.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);var n=new l.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(l.EXTENT,0),n.emplaceBack(0,l.EXTENT),n.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=i.createVertexBuffer(n,Tn.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);var s=new l.StructArrayLayout4i8;s.emplaceBack(0,0,0,0),s.emplaceBack(l.EXTENT,0,l.EXTENT,0),s.emplaceBack(0,l.EXTENT,0,l.EXTENT),s.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.rasterBoundsBuffer=i.createVertexBuffer(s,ii.members),this.rasterBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);var h=new l.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(1,0),h.emplaceBack(0,1),h.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(h,Tn.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);var m=new l.StructArrayLayout1ui2;m.emplaceBack(0),m.emplaceBack(1),m.emplaceBack(3),m.emplaceBack(2),m.emplaceBack(0),this.tileBorderIndexBuffer=i.createIndexBuffer(m);var y=new l.StructArrayLayout3ui6;y.emplaceBack(0,1,2),y.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(y),this.emptyTexture=new l.Texture(i,{width:1,height:1,data:new Uint8Array([0,0,0,0])},i.gl.RGBA);var v=this.context.gl;this.stencilClearMode=new Z({func:v.ALWAYS,mask:0},0,255,v.ZERO,v.ZERO,v.ZERO)},tr.prototype.clearStencil=function(){var i=this.context,o=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var n=l.create();l.ortho(n,0,this.width,this.height,0,0,1),l.scale(n,n,[o.drawingBufferWidth,o.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(i,o.TRIANGLES,O.disabled,this.stencilClearMode,ee.disabled,re.disabled,Wo(n),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},tr.prototype._renderTileClippingMasks=function(i,o){if(this.currentStencilSource!==i.source&&i.isTileClipped()&&o&&o.length){this.currentStencilSource=i.source;var n=this.context,s=n.gl;this.nextStencilID+o.length>256&&this.clearStencil(),n.setColorMode(ee.disabled),n.setDepthMode(O.disabled);var h=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var m=0,y=o;m<y.length;m+=1){var v=y[m],S=this._tileClippingMaskIDs[v.key]=this.nextStencilID++;h.draw(n,s.TRIANGLES,O.disabled,new Z({func:s.ALWAYS,mask:0},S,255,s.KEEP,s.KEEP,s.REPLACE),ee.disabled,re.disabled,Wo(v.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},tr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var i=this.nextStencilID++,o=this.context.gl;return new Z({func:o.NOTEQUAL,mask:255},i,255,o.KEEP,o.KEEP,o.REPLACE)},tr.prototype.stencilModeForClipping=function(i){var o=this.context.gl;return new Z({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,o.KEEP,o.KEEP,o.REPLACE)},tr.prototype.stencilConfigForOverlap=function(i){var o,n=this.context.gl,s=i.sort(function(S,A){return A.overscaledZ-S.overscaledZ}),h=s[s.length-1].overscaledZ,m=s[0].overscaledZ-h+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();for(var y={},v=0;v<m;v++)y[v+h]=new Z({func:n.GEQUAL,mask:255},v+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=m,[y,s]}return[(o={},o[h]=Z.disabled,o),s]},tr.prototype.colorModeForRenderPass=function(){var i=this.context.gl;return this._showOverdrawInspector?new ee([i.CONSTANT_COLOR,i.ONE],new l.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ee.unblended:ee.alphaBlended},tr.prototype.depthModeForSublayer=function(i,o,n){if(!this.opaquePassEnabledForLayer())return O.disabled;var s=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new O(n||this.context.gl.LEQUAL,o,[s,s])},tr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},tr.prototype.render=function(i,o){var n=this;this.style=i,this.options=o,this.lineAtlas=i.lineAtlas,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(l.browser.now()),this.imageManager.beginFrame();var s=this.style._order,h=this.style.sourceCaches;for(var m in h){var y=h[m];y.used&&y.prepare(this.context)}var v,S,A={},D={},B={};for(var R in h){var G=h[R];A[R]=G.getVisibleCoordinates(),D[R]=A[R].slice().reverse(),B[R]=G.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var q=0;q<s.length;q++)if(this.style._layers[s[q]].is3D()){this.opaquePassCutoff=q;break}this.renderPass="offscreen";for(var $=0,j=s;$<j.length;$+=1){var K=this.style._layers[j[$]];if(K.hasOffscreenPass()&&!K.isHidden(this.transform.zoom)){var te=D[K.source];(K.type==="custom"||te.length)&&this.renderLayer(this,h[K.source],K,te)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?l.Color.black:l.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(i._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=s.length-1;this.currentLayer>=0;this.currentLayer--){var oe=this.style._layers[s[this.currentLayer]],de=h[oe.source],pe=A[oe.source];this._renderTileClippingMasks(oe,pe),this.renderLayer(this,de,oe,pe)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<s.length;this.currentLayer++){var me=this.style._layers[s[this.currentLayer]],_e=h[me.source],ze=(me.type==="symbol"?B:D)[me.source];this._renderTileClippingMasks(me,A[me.source]),this.renderLayer(this,_e,me,ze)}this.options.showTileBoundaries&&(l.values(this.style._layers).forEach(function(Se){Se.source&&!Se.isHidden(n.transform.zoom)&&(Se.source!==(S&&S.id)&&(S=n.style.sourceCaches[Se.source]),(!v||v.getSource().maxzoom<S.getSource().maxzoom)&&(v=S))}),v&&Ql.debug(this,v,v.getVisibleCoordinates())),this.options.showPadding&&function(Se){var Ue=Se.transform.padding;Xs(Se,Se.transform.height-(Ue.top||0),3,Gs),Xs(Se,Ue.bottom||0,3,Jl),Yl(Se,Ue.left||0,3,fc),Yl(Se,Se.transform.width-(Ue.right||0),3,dc);var Qe=Se.transform.centerPoint;(function(rt,et,Ft,Ze){es(rt,et-1,Ft-10,2,20,Ze),es(rt,et-10,Ft-1,20,2,Ze)})(Se,Qe.x,Se.transform.height-Qe.y,Hs)}(this),this.context.setDefault()},tr.prototype.renderLayer=function(i,o,n,s){n.isHidden(this.transform.zoom)||(n.type==="background"||n.type==="custom"||s.length)&&(this.id=n.id,this.gpuTimingStart(n),Ql[n.type](i,o,n,s,this.style.placement.variableOffsets),this.gpuTimingEnd())},tr.prototype.gpuTimingStart=function(i){if(this.options.gpuTiming){var o=this.context.extTimerQuery,n=this.gpuTimers[i.id];n||(n=this.gpuTimers[i.id]={calls:0,cpuTime:0,query:o.createQueryEXT()}),n.calls++,o.beginQueryEXT(o.TIME_ELAPSED_EXT,n.query)}},tr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var i=this.context.extTimerQuery;i.endQueryEXT(i.TIME_ELAPSED_EXT)}},tr.prototype.collectGpuTimers=function(){var i=this.gpuTimers;return this.gpuTimers={},i},tr.prototype.queryGpuTimers=function(i){var o={};for(var n in i){var s=i[n],h=this.context.extTimerQuery,m=h.getQueryObjectEXT(s.query,h.QUERY_RESULT_EXT)/1e6;h.deleteQueryEXT(s.query),o[n]=m}return o},tr.prototype.translatePosMatrix=function(i,o,n,s,h){if(!n[0]&&!n[1])return i;var m=h?s==="map"?this.transform.angle:0:s==="viewport"?-this.transform.angle:0;if(m){var y=Math.sin(m),v=Math.cos(m);n=[n[0]*v-n[1]*y,n[0]*y+n[1]*v]}var S=[h?n[0]:Ri(o,n[0],this.transform.zoom),h?n[1]:Ri(o,n[1],this.transform.zoom),0],A=new Float32Array(16);return l.translate(A,i,S),A},tr.prototype.saveTileTexture=function(i){var o=this._tileTextures[i.size[0]];o?o.push(i):this._tileTextures[i.size[0]]=[i]},tr.prototype.getTileTexture=function(i){var o=this._tileTextures[i];return o&&o.length>0?o.pop():null},tr.prototype.isPatternMissing=function(i){if(!i)return!1;if(!i.from||!i.to)return!0;var o=this.imageManager.getPattern(i.from.toString()),n=this.imageManager.getPattern(i.to.toString());return!o||!n},tr.prototype.useProgram=function(i,o){this.cache=this.cache||{};var n=""+i+(o?o.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new nc(this.context,i,ga[i],o,wa[i],this._showOverdrawInspector)),this.cache[n]},tr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},tr.prototype.setBaseState=function(){var i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)},tr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=l.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new l.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},tr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Ws=function(i,o){this.points=i,this.planes=o};Ws.fromInvProjectionMatrix=function(i,o,n){var s=Math.pow(2,n),h=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(y){return l.transformMat4([],y,i)}).map(function(y){return l.scale$1([],y,1/y[3]/o*s)}),m=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(y){var v=l.sub([],h[y[0]],h[y[1]]),S=l.sub([],h[y[2]],h[y[1]]),A=l.normalize([],l.cross([],v,S)),D=-l.dot(A,h[y[1]]);return A.concat(D)});return new Ws(h,m)};var $o=function(i,o){this.min=i,this.max=o,this.center=l.scale$2([],l.add([],this.min,this.max),.5)};$o.prototype.quadrant=function(i){for(var o=[i%2==0,i<2],n=l.clone$2(this.min),s=l.clone$2(this.max),h=0;h<o.length;h++)n[h]=o[h]?this.min[h]:this.center[h],s[h]=o[h]?this.center[h]:this.max[h];return s[2]=this.max[2],new $o(n,s)},$o.prototype.distanceX=function(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]},$o.prototype.distanceY=function(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]},$o.prototype.intersects=function(i){for(var o=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],n=!0,s=0;s<i.planes.length;s++){for(var h=i.planes[s],m=0,y=0;y<o.length;y++)m+=l.dot$1(h,o[y])>=0;if(m===0)return 0;m!==o.length&&(n=!1)}if(n)return 2;for(var v=0;v<3;v++){for(var S=Number.MAX_VALUE,A=-Number.MAX_VALUE,D=0;D<i.points.length;D++){var B=i.points[D][v]-this.min[v];S=Math.min(S,B),A=Math.max(A,B)}if(A<0||S>this.max[v]-this.min[v])return 0}return 1};var bo=function(i,o,n,s){if(i===void 0&&(i=0),o===void 0&&(o=0),n===void 0&&(n=0),s===void 0&&(s=0),isNaN(i)||i<0||isNaN(o)||o<0||isNaN(n)||n<0||isNaN(s)||s<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=o,this.left=n,this.right=s};bo.prototype.interpolate=function(i,o,n){return o.top!=null&&i.top!=null&&(this.top=l.number(i.top,o.top,n)),o.bottom!=null&&i.bottom!=null&&(this.bottom=l.number(i.bottom,o.bottom,n)),o.left!=null&&i.left!=null&&(this.left=l.number(i.left,o.left,n)),o.right!=null&&i.right!=null&&(this.right=l.number(i.right,o.right,n)),this},bo.prototype.getCenter=function(i,o){var n=l.clamp((this.left+i-this.right)/2,0,i),s=l.clamp((this.top+o-this.bottom)/2,0,o);return new l.Point(n,s)},bo.prototype.equals=function(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right},bo.prototype.clone=function(){return new bo(this.top,this.bottom,this.left,this.right)},bo.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Yt=function(i,o,n,s,h){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=h===void 0||h,this._minZoom=i||0,this._maxZoom=o||22,this._minPitch=n??0,this._maxPitch=s??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new bo,this._posMatrixCache={},this._alignedPosMatrixCache={}},Ot={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Yt.prototype.clone=function(){var i=new Yt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return i.tileSize=this.tileSize,i.latRange=this.latRange,i.width=this.width,i.height=this.height,i._center=this._center,i.zoom=this.zoom,i.angle=this.angle,i._fov=this._fov,i._pitch=this._pitch,i._unmodified=this._unmodified,i._edgeInsets=this._edgeInsets.clone(),i._calcMatrices(),i},Ot.minZoom.get=function(){return this._minZoom},Ot.minZoom.set=function(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))},Ot.maxZoom.get=function(){return this._maxZoom},Ot.maxZoom.set=function(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))},Ot.minPitch.get=function(){return this._minPitch},Ot.minPitch.set=function(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))},Ot.maxPitch.get=function(){return this._maxPitch},Ot.maxPitch.set=function(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))},Ot.renderWorldCopies.get=function(){return this._renderWorldCopies},Ot.renderWorldCopies.set=function(i){i===void 0?i=!0:i===null&&(i=!1),this._renderWorldCopies=i},Ot.worldSize.get=function(){return this.tileSize*this.scale},Ot.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Ot.size.get=function(){return new l.Point(this.width,this.height)},Ot.bearing.get=function(){return-this.angle/Math.PI*180},Ot.bearing.set=function(i){var o=-l.wrap(i,-180,180)*Math.PI/180;this.angle!==o&&(this._unmodified=!1,this.angle=o,this._calcMatrices(),this.rotationMatrix=l.create$2(),l.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Ot.pitch.get=function(){return this._pitch/Math.PI*180},Ot.pitch.set=function(i){var o=l.clamp(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==o&&(this._unmodified=!1,this._pitch=o,this._calcMatrices())},Ot.fov.get=function(){return this._fov/Math.PI*180},Ot.fov.set=function(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=i/180*Math.PI,this._calcMatrices())},Ot.zoom.get=function(){return this._zoom},Ot.zoom.set=function(i){var o=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom,this._constrain(),this._calcMatrices())},Ot.center.get=function(){return this._center},Ot.center.set=function(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._constrain(),this._calcMatrices())},Ot.padding.get=function(){return this._edgeInsets.toJSON()},Ot.padding.set=function(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())},Ot.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Yt.prototype.isPaddingEqual=function(i){return this._edgeInsets.equals(i)},Yt.prototype.interpolatePadding=function(i,o,n){this._unmodified=!1,this._edgeInsets.interpolate(i,o,n),this._constrain(),this._calcMatrices()},Yt.prototype.coveringZoomLevel=function(i){var o=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,o)},Yt.prototype.getVisibleUnwrappedCoordinates=function(i){var o=[new l.UnwrappedTileID(0,i)];if(this._renderWorldCopies)for(var n=this.pointCoordinate(new l.Point(0,0)),s=this.pointCoordinate(new l.Point(this.width,0)),h=this.pointCoordinate(new l.Point(this.width,this.height)),m=this.pointCoordinate(new l.Point(0,this.height)),y=Math.floor(Math.min(n.x,s.x,h.x,m.x)),v=Math.floor(Math.max(n.x,s.x,h.x,m.x)),S=y-1;S<=v+1;S++)S!==0&&o.push(new l.UnwrappedTileID(S,i));return o},Yt.prototype.coveringTiles=function(i){var o=this.coveringZoomLevel(i),n=o;if(i.minzoom!==void 0&&o<i.minzoom)return[];i.maxzoom!==void 0&&o>i.maxzoom&&(o=i.maxzoom);var s=l.MercatorCoordinate.fromLngLat(this.center),h=Math.pow(2,o),m=[h*s.x,h*s.y,0],y=Ws.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,o),v=i.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(v=o);var S=function(Se){return{aabb:new $o([Se*h,0,0],[(Se+1)*h,h,0]),zoom:0,x:0,y:0,wrap:Se,fullyVisible:!1}},A=[],D=[],B=o,R=i.reparseOverscaled?n:o;if(this._renderWorldCopies)for(var G=1;G<=3;G++)A.push(S(-G)),A.push(S(G));for(A.push(S(0));A.length>0;){var q=A.pop(),$=q.x,j=q.y,K=q.fullyVisible;if(!K){var te=q.aabb.intersects(y);if(te===0)continue;K=te===2}var oe=q.aabb.distanceX(m),de=q.aabb.distanceY(m),pe=Math.max(Math.abs(oe),Math.abs(de));if(q.zoom===B||pe>3+(1<<B-q.zoom)-2&&q.zoom>=v)D.push({tileID:new l.OverscaledTileID(q.zoom===B?R:q.zoom,q.wrap,q.zoom,$,j),distanceSq:l.sqrLen([m[0]-.5-$,m[1]-.5-j])});else for(var me=0;me<4;me++){var _e=($<<1)+me%2,ze=(j<<1)+(me>>1);A.push({aabb:q.aabb.quadrant(me),zoom:q.zoom+1,x:_e,y:ze,wrap:q.wrap,fullyVisible:K})}}return D.sort(function(Se,Ue){return Se.distanceSq-Ue.distanceSq}).map(function(Se){return Se.tileID})},Yt.prototype.resize=function(i,o){this.width=i,this.height=o,this.pixelsToGLUnits=[2/i,-2/o],this._constrain(),this._calcMatrices()},Ot.unmodified.get=function(){return this._unmodified},Yt.prototype.zoomScale=function(i){return Math.pow(2,i)},Yt.prototype.scaleZoom=function(i){return Math.log(i)/Math.LN2},Yt.prototype.project=function(i){var o=l.clamp(i.lat,-this.maxValidLatitude,this.maxValidLatitude);return new l.Point(l.mercatorXfromLng(i.lng)*this.worldSize,l.mercatorYfromLat(o)*this.worldSize)},Yt.prototype.unproject=function(i){return new l.MercatorCoordinate(i.x/this.worldSize,i.y/this.worldSize).toLngLat()},Ot.point.get=function(){return this.project(this.center)},Yt.prototype.setLocationAtPoint=function(i,o){var n=this.pointCoordinate(o),s=this.pointCoordinate(this.centerPoint),h=this.locationCoordinate(i),m=new l.MercatorCoordinate(h.x-(n.x-s.x),h.y-(n.y-s.y));this.center=this.coordinateLocation(m),this._renderWorldCopies&&(this.center=this.center.wrap())},Yt.prototype.locationPoint=function(i){return this.coordinatePoint(this.locationCoordinate(i))},Yt.prototype.pointLocation=function(i){return this.coordinateLocation(this.pointCoordinate(i))},Yt.prototype.locationCoordinate=function(i){return l.MercatorCoordinate.fromLngLat(i)},Yt.prototype.coordinateLocation=function(i){return i.toLngLat()},Yt.prototype.pointCoordinate=function(i){var o=[i.x,i.y,0,1],n=[i.x,i.y,1,1];l.transformMat4(o,o,this.pixelMatrixInverse),l.transformMat4(n,n,this.pixelMatrixInverse);var s=o[3],h=n[3],m=o[1]/s,y=n[1]/h,v=o[2]/s,S=n[2]/h,A=v===S?0:(0-v)/(S-v);return new l.MercatorCoordinate(l.number(o[0]/s,n[0]/h,A)/this.worldSize,l.number(m,y,A)/this.worldSize)},Yt.prototype.coordinatePoint=function(i){var o=[i.x*this.worldSize,i.y*this.worldSize,0,1];return l.transformMat4(o,o,this.pixelMatrix),new l.Point(o[0]/o[3],o[1]/o[3])},Yt.prototype.getBounds=function(){return new l.LngLatBounds().extend(this.pointLocation(new l.Point(0,0))).extend(this.pointLocation(new l.Point(this.width,0))).extend(this.pointLocation(new l.Point(this.width,this.height))).extend(this.pointLocation(new l.Point(0,this.height)))},Yt.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new l.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Yt.prototype.setMaxBounds=function(i){i?(this.lngRange=[i.getWest(),i.getEast()],this.latRange=[i.getSouth(),i.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Yt.prototype.calculatePosMatrix=function(i,o){o===void 0&&(o=!1);var n=i.key,s=o?this._alignedPosMatrixCache:this._posMatrixCache;if(s[n])return s[n];var h=i.canonical,m=this.worldSize/this.zoomScale(h.z),y=h.x+Math.pow(2,h.z)*i.wrap,v=l.identity(new Float64Array(16));return l.translate(v,v,[y*m,h.y*m,0]),l.scale(v,v,[m/l.EXTENT,m/l.EXTENT,1]),l.multiply(v,o?this.alignedProjMatrix:this.projMatrix,v),s[n]=new Float32Array(v),s[n]},Yt.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Yt.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var i,o,n,s,h=-90,m=90,y=-180,v=180,S=this.size,A=this._unmodified;if(this.latRange){var D=this.latRange;h=l.mercatorYfromLat(D[1])*this.worldSize,i=(m=l.mercatorYfromLat(D[0])*this.worldSize)-h<S.y?S.y/(m-h):0}if(this.lngRange){var B=this.lngRange;y=l.mercatorXfromLng(B[0])*this.worldSize,o=(v=l.mercatorXfromLng(B[1])*this.worldSize)-y<S.x?S.x/(v-y):0}var R=this.point,G=Math.max(o||0,i||0);if(G)return this.center=this.unproject(new l.Point(o?(v+y)/2:R.x,i?(m+h)/2:R.y)),this.zoom+=this.scaleZoom(G),this._unmodified=A,void(this._constraining=!1);if(this.latRange){var q=R.y,$=S.y/2;q-$<h&&(s=h+$),q+$>m&&(s=m-$)}if(this.lngRange){var j=R.x,K=S.x/2;j-K<y&&(n=y+K),j+K>v&&(n=v-K)}n===void 0&&s===void 0||(this.center=this.unproject(new l.Point(n!==void 0?n:R.x,s!==void 0?s:R.y))),this._unmodified=A,this._constraining=!1}},Yt.prototype._calcMatrices=function(){if(this.height){var i=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var o=Math.PI/2+this._pitch,n=this._fov*(.5+i.y/this.height),s=Math.sin(n)*this.cameraToCenterDistance/Math.sin(l.clamp(Math.PI-o-n,.01,Math.PI-.01)),h=this.point,m=h.x,y=h.y,v=1.01*(Math.cos(Math.PI/2-this._pitch)*s+this.cameraToCenterDistance),S=this.height/50,A=new Float64Array(16);l.perspective(A,this._fov,this.width/this.height,S,v),A[8]=2*-i.x/this.width,A[9]=2*i.y/this.height,l.scale(A,A,[1,-1,1]),l.translate(A,A,[0,0,-this.cameraToCenterDistance]),l.rotateX(A,A,this._pitch),l.rotateZ(A,A,this.angle),l.translate(A,A,[-m,-y,0]),this.mercatorMatrix=l.scale([],A,[this.worldSize,this.worldSize,this.worldSize]),l.scale(A,A,[1,1,l.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=A,this.invProjMatrix=l.invert([],this.projMatrix);var D=this.width%2/2,B=this.height%2/2,R=Math.cos(this.angle),G=Math.sin(this.angle),q=m-Math.round(m)+R*D+G*B,$=y-Math.round(y)+R*B+G*D,j=new Float64Array(A);if(l.translate(j,j,[q>.5?q-1:q,$>.5?$-1:$,0]),this.alignedProjMatrix=j,A=l.create(),l.scale(A,A,[this.width/2,-this.height/2,1]),l.translate(A,A,[1,-1,0]),this.labelPlaneMatrix=A,A=l.create(),l.scale(A,A,[1,-1,1]),l.translate(A,A,[-1,-1,0]),l.scale(A,A,[2/this.width,2/this.height,1]),this.glCoordMatrix=A,this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(A=l.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=A,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Yt.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var i=this.pointCoordinate(new l.Point(0,0)),o=[i.x*this.worldSize,i.y*this.worldSize,0,1];return l.transformMat4(o,o,this.pixelMatrix)[3]/this.cameraToCenterDistance},Yt.prototype.getCameraPoint=function(){var i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.Point(0,i))},Yt.prototype.getCameraQueryGeometry=function(i){var o=this.getCameraPoint();if(i.length===1)return[i[0],o];for(var n=o.x,s=o.y,h=o.x,m=o.y,y=0,v=i;y<v.length;y+=1){var S=v[y];n=Math.min(n,S.x),s=Math.min(s,S.y),h=Math.max(h,S.x),m=Math.max(m,S.y)}return[new l.Point(n,s),new l.Point(h,s),new l.Point(h,m),new l.Point(n,m),new l.Point(n,s)]},Object.defineProperties(Yt.prototype,Ot);var Jo=function(i){var o,n,s,h;this._hashName=i&&encodeURIComponent(i),l.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(o=this._updateHashUnthrottled.bind(this),n=!1,s=null,h=function(){s=null,n&&(o(),s=setTimeout(h,300),n=!1)},function(){return n=!0,s||h(),s})};Jo.prototype.addTo=function(i){return this._map=i,l.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Jo.prototype.remove=function(){return l.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Jo.prototype.getHashString=function(i){var o=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,s=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),h=Math.pow(10,s),m=Math.round(o.lng*h)/h,y=Math.round(o.lat*h)/h,v=this._map.getBearing(),S=this._map.getPitch(),A="";if(A+=i?"/"+m+"/"+y+"/"+n:n+"/"+y+"/"+m,(v||S)&&(A+="/"+Math.round(10*v)/10),S&&(A+="/"+Math.round(S)),this._hashName){var D=this._hashName,B=!1,R=l.window.location.hash.slice(1).split("&").map(function(G){var q=G.split("=")[0];return q===D?(B=!0,q+"="+A):G}).filter(function(G){return G});return B||R.push(D+"="+A),"#"+R.join("&")}return"#"+A},Jo.prototype._getCurrentHash=function(){var i,o=this,n=l.window.location.hash.replace("#","");return this._hashName?(n.split("&").map(function(s){return s.split("=")}).forEach(function(s){s[0]===o._hashName&&(i=s)}),(i&&i[1]||"").split("/")):n.split("/")},Jo.prototype._onHashChange=function(){var i=this._getCurrentHash();if(i.length>=3&&!i.some(function(n){return isNaN(n)})){var o=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(i[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+i[2],+i[1]],zoom:+i[0],bearing:o,pitch:+(i[4]||0)}),!0}return!1},Jo.prototype._updateHashUnthrottled=function(){var i=l.window.location.href.replace(/(#.+)?$/,this.getHashString());try{l.window.history.replaceState(l.window.history.state,null,i)}catch{}};var Fn={linearity:.3,easing:l.bezier(0,0,.3,1)},yc=l.extend({deceleration:2500,maxSpeed:1400},Fn),Sa=l.extend({deceleration:20,maxSpeed:1400},Fn),ts=l.extend({deceleration:1e3,maxSpeed:360},Fn),qp=l.extend({deceleration:1e3,maxSpeed:90},Fn),rs=function(i){this._map=i,this.clear()};function Ks(i,o){(!i.duration||i.duration<o.duration)&&(i.duration=o.duration,i.easing=o.easing)}function is(i,o,n){var s=n.maxSpeed,h=n.linearity,m=n.deceleration,y=l.clamp(i*h/(o/1e3),-s,s),v=Math.abs(y)/(m*h);return{easing:n.easing,duration:1e3*v,amount:y*(v/2)}}rs.prototype.clear=function(){this._inertiaBuffer=[]},rs.prototype.record=function(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.browser.now(),settings:i})},rs.prototype._drainInertiaBuffer=function(){for(var i=this._inertiaBuffer,o=l.browser.now();i.length>0&&o-i[0].time>160;)i.shift()},rs.prototype._onMoveEnd=function(i){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var o={zoom:0,bearing:0,pitch:0,pan:new l.Point(0,0),pinchAround:void 0,around:void 0},n=0,s=this._inertiaBuffer;n<s.length;n+=1){var h=s[n].settings;o.zoom+=h.zoomDelta||0,o.bearing+=h.bearingDelta||0,o.pitch+=h.pitchDelta||0,h.panDelta&&o.pan._add(h.panDelta),h.around&&(o.around=h.around),h.pinchAround&&(o.pinchAround=h.pinchAround)}var m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(o.pan.mag()){var v=is(o.pan.mag(),m,l.extend({},yc,i||{}));y.offset=o.pan.mult(v.amount/o.pan.mag()),y.center=this._map.transform.center,Ks(y,v)}if(o.zoom){var S=is(o.zoom,m,Sa);y.zoom=this._map.transform.zoom+S.amount,Ks(y,S)}if(o.bearing){var A=is(o.bearing,m,ts);y.bearing=this._map.transform.bearing+l.clamp(A.amount,-179,179),Ks(y,A)}if(o.pitch){var D=is(o.pitch,m,qp);y.pitch=this._map.transform.pitch+D.amount,Ks(y,D)}if(y.zoom||y.bearing){var B=o.pinchAround===void 0?o.around:o.pinchAround;y.around=B?this._map.unproject(B):this._map.getCenter()}return this.clear(),l.extend(y,{noMoveStart:!0})}};var _i=function(i){function o(s,h,m,y){y===void 0&&(y={});var v=U.mousePos(h.getCanvasContainer(),m),S=h.unproject(v);i.call(this,s,l.extend({point:v,lngLat:S,originalEvent:m},y)),this._defaultPrevented=!1,this.target=h}i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o;var n={defaultPrevented:{configurable:!0}};return o.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(o.prototype,n),o}(l.Event),tn=function(i){function o(s,h,m){var y=s==="touchend"?m.changedTouches:m.touches,v=U.touchPos(h.getCanvasContainer(),y),S=v.map(function(B){return h.unproject(B)}),A=v.reduce(function(B,R,G,q){return B.add(R.div(q.length))},new l.Point(0,0)),D=h.unproject(A);i.call(this,s,{points:v,point:A,lngLats:S,lngLat:D,originalEvent:m}),this._defaultPrevented=!1}i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o;var n={defaultPrevented:{configurable:!0}};return o.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(o.prototype,n),o}(l.Event),gc=function(i){function o(s,h,m){i.call(this,s,{originalEvent:m}),this._defaultPrevented=!1}i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o;var n={defaultPrevented:{configurable:!0}};return o.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(o.prototype,n),o}(l.Event),si=function(i,o){this._map=i,this._clickTolerance=o.clickTolerance};si.prototype.reset=function(){delete this._mousedownPos},si.prototype.wheel=function(i){return this._firePreventable(new gc(i.type,this._map,i))},si.prototype.mousedown=function(i,o){return this._mousedownPos=o,this._firePreventable(new _i(i.type,this._map,i))},si.prototype.mouseup=function(i){this._map.fire(new _i(i.type,this._map,i))},si.prototype.click=function(i,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new _i(i.type,this._map,i))},si.prototype.dblclick=function(i){return this._firePreventable(new _i(i.type,this._map,i))},si.prototype.mouseover=function(i){this._map.fire(new _i(i.type,this._map,i))},si.prototype.mouseout=function(i){this._map.fire(new _i(i.type,this._map,i))},si.prototype.touchstart=function(i){return this._firePreventable(new tn(i.type,this._map,i))},si.prototype.touchmove=function(i){this._map.fire(new tn(i.type,this._map,i))},si.prototype.touchend=function(i){this._map.fire(new tn(i.type,this._map,i))},si.prototype.touchcancel=function(i){this._map.fire(new tn(i.type,this._map,i))},si.prototype._firePreventable=function(i){if(this._map.fire(i),i.defaultPrevented)return{}},si.prototype.isEnabled=function(){return!0},si.prototype.isActive=function(){return!1},si.prototype.enable=function(){},si.prototype.disable=function(){};var Gi=function(i){this._map=i};Gi.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Gi.prototype.mousemove=function(i){this._map.fire(new _i(i.type,this._map,i))},Gi.prototype.mousedown=function(){this._delayContextMenu=!0},Gi.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new _i("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Gi.prototype.contextmenu=function(i){this._delayContextMenu?this._contextMenuEvent=i:this._map.fire(new _i(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()},Gi.prototype.isEnabled=function(){return!0},Gi.prototype.isActive=function(){return!1},Gi.prototype.enable=function(){},Gi.prototype.disable=function(){};var Ne=function(i,o){this._map=i,this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=o.clickTolerance||1};function ns(i,o){for(var n={},s=0;s<i.length;s++)n[i[s].identifier]=o[s];return n}Ne.prototype.isEnabled=function(){return!!this._enabled},Ne.prototype.isActive=function(){return!!this._active},Ne.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Ne.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ne.prototype.mousedown=function(i,o){this.isEnabled()&&i.shiftKey&&i.button===0&&(U.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)},Ne.prototype.mousemoveWindow=function(i,o){if(this._active){var n=o;if(!(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)){var s=this._startPos;this._lastPos=n,this._box||(this._box=U.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",i));var h=Math.min(s.x,n.x),m=Math.max(s.x,n.x),y=Math.min(s.y,n.y),v=Math.max(s.y,n.y);U.setTransform(this._box,"translate("+h+"px,"+y+"px)"),this._box.style.width=m-h+"px",this._box.style.height=v-y+"px"}}},Ne.prototype.mouseupWindow=function(i,o){var n=this;if(this._active&&i.button===0){var s=this._startPos,h=o;if(this.reset(),U.suppressClick(),s.x!==h.x||s.y!==h.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:i})),{cameraAnimation:function(m){return m.fitScreenCoordinates(s,h,n._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",i)}},Ne.prototype.keydown=function(i){this._active&&i.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",i))},Ne.prototype.reset=function(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(U.remove(this._box),this._box=null),U.enableDrag(),delete this._startPos,delete this._lastPos},Ne.prototype._fireEvent=function(i,o){return this._map.fire(new l.Event(i,{originalEvent:o}))};var Ea=function(i){this.reset(),this.numTouches=i.numTouches};Ea.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Ea.prototype.touchstart=function(i,o,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=i.timeStamp),n.length===this.numTouches&&(this.centroid=function(s){for(var h=new l.Point(0,0),m=0,y=s;m<y.length;m+=1)h._add(y[m]);return h.div(s.length)}(o),this.touches=ns(n,o)))},Ea.prototype.touchmove=function(i,o,n){if(!this.aborted&&this.centroid){var s=ns(n,o);for(var h in this.touches){var m=s[h];(!m||m.dist(this.touches[h])>30)&&(this.aborted=!0)}}},Ea.prototype.touchend=function(i,o,n){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),n.length===0){var s=!this.aborted&&this.centroid;if(this.reset(),s)return s}};var wo=function(i){this.singleTap=new Ea(i),this.numTaps=i.numTaps,this.reset()};wo.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},wo.prototype.touchstart=function(i,o,n){this.singleTap.touchstart(i,o,n)},wo.prototype.touchmove=function(i,o,n){this.singleTap.touchmove(i,o,n)},wo.prototype.touchend=function(i,o,n){var s=this.singleTap.touchend(i,o,n);if(s){var h=i.timeStamp-this.lastTime<500,m=!this.lastTap||this.lastTap.dist(s)<30;if(h&&m||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=s,this.count===this.numTaps)return this.reset(),s}};var Hi=function(){this._zoomIn=new wo({numTouches:1,numTaps:2}),this._zoomOut=new wo({numTouches:2,numTaps:1}),this.reset()};Hi.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Hi.prototype.touchstart=function(i,o,n){this._zoomIn.touchstart(i,o,n),this._zoomOut.touchstart(i,o,n)},Hi.prototype.touchmove=function(i,o,n){this._zoomIn.touchmove(i,o,n),this._zoomOut.touchmove(i,o,n)},Hi.prototype.touchend=function(i,o,n){var s=this,h=this._zoomIn.touchend(i,o,n),m=this._zoomOut.touchend(i,o,n);return h?(this._active=!0,i.preventDefault(),setTimeout(function(){return s.reset()},0),{cameraAnimation:function(y){return y.easeTo({duration:300,zoom:y.getZoom()+1,around:y.unproject(h)},{originalEvent:i})}}):m?(this._active=!0,i.preventDefault(),setTimeout(function(){return s.reset()},0),{cameraAnimation:function(y){return y.easeTo({duration:300,zoom:y.getZoom()-1,around:y.unproject(m)},{originalEvent:i})}}):void 0},Hi.prototype.touchcancel=function(){this.reset()},Hi.prototype.enable=function(){this._enabled=!0},Hi.prototype.disable=function(){this._enabled=!1,this.reset()},Hi.prototype.isEnabled=function(){return this._enabled},Hi.prototype.isActive=function(){return this._active};var os={0:1,2:2},Oi=function(i){this.reset(),this._clickTolerance=i.clickTolerance||1};Oi.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Oi.prototype._correctButton=function(i,o){return!1},Oi.prototype._move=function(i,o){return{}},Oi.prototype.mousedown=function(i,o){if(!this._lastPoint){var n=U.mouseButton(i);this._correctButton(i,n)&&(this._lastPoint=o,this._eventButton=n)}},Oi.prototype.mousemoveWindow=function(i,o){var n=this._lastPoint;if(n){if(i.preventDefault(),function(s,h){var m=os[h];return s.buttons===void 0||(s.buttons&m)!==m}(i,this._eventButton))this.reset();else if(this._moved||!(o.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=o,this._move(n,o)}},Oi.prototype.mouseupWindow=function(i){this._lastPoint&&U.mouseButton(i)===this._eventButton&&(this._moved&&U.suppressClick(),this.reset())},Oi.prototype.enable=function(){this._enabled=!0},Oi.prototype.disable=function(){this._enabled=!1,this.reset()},Oi.prototype.isEnabled=function(){return this._enabled},Oi.prototype.isActive=function(){return this._active};var qe=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.mousedown=function(n,s){i.prototype.mousedown.call(this,n,s),this._lastPoint&&(this._active=!0)},o.prototype._correctButton=function(n,s){return s===0&&!n.ctrlKey},o.prototype._move=function(n,s){return{around:s,panDelta:s.sub(n)}},o}(Oi),$s=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype._correctButton=function(n,s){return s===0&&n.ctrlKey||s===2},o.prototype._move=function(n,s){var h=.8*(s.x-n.x);if(h)return this._active=!0,{bearingDelta:h}},o.prototype.contextmenu=function(n){n.preventDefault()},o}(Oi),Js=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype._correctButton=function(n,s){return s===0&&n.ctrlKey||s===2},o.prototype._move=function(n,s){var h=-.5*(s.y-n.y);if(h)return this._active=!0,{pitchDelta:h}},o.prototype.contextmenu=function(n){n.preventDefault()},o}(Oi),dn=function(i){this._minTouches=1,this._clickTolerance=i.clickTolerance||1,this.reset()};dn.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new l.Point(0,0)},dn.prototype.touchstart=function(i,o,n){return this._calculateTransform(i,o,n)},dn.prototype.touchmove=function(i,o,n){if(this._active&&!(n.length<this._minTouches))return i.preventDefault(),this._calculateTransform(i,o,n)},dn.prototype.touchend=function(i,o,n){this._calculateTransform(i,o,n),this._active&&n.length<this._minTouches&&this.reset()},dn.prototype.touchcancel=function(){this.reset()},dn.prototype._calculateTransform=function(i,o,n){n.length>0&&(this._active=!0);var s=ns(n,o),h=new l.Point(0,0),m=new l.Point(0,0),y=0;for(var v in s){var S=s[v],A=this._touches[v];A&&(h._add(S),m._add(S.sub(A)),y++,s[v]=S)}if(this._touches=s,!(y<this._minTouches)&&m.mag()){var D=m.div(y);if(this._sum._add(D),!(this._sum.mag()<this._clickTolerance))return{around:h.div(y),panDelta:D}}},dn.prototype.enable=function(){this._enabled=!0},dn.prototype.disable=function(){this._enabled=!1,this.reset()},dn.prototype.isEnabled=function(){return this._enabled},dn.prototype.isActive=function(){return this._active};var Fi=function(){this.reset()};function Ys(i,o,n){for(var s=0;s<i.length;s++)if(i[s].identifier===n)return o[s]}function _c(i,o){return Math.log(i/o)/Math.LN2}Fi.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Fi.prototype._start=function(i){},Fi.prototype._move=function(i,o,n){return{}},Fi.prototype.touchstart=function(i,o,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([o[0],o[1]]))},Fi.prototype.touchmove=function(i,o,n){if(this._firstTwoTouches){i.preventDefault();var s=this._firstTwoTouches,h=s[1],m=Ys(n,o,s[0]),y=Ys(n,o,h);if(m&&y){var v=this._aroundCenter?null:m.add(y).div(2);return this._move([m,y],v,i)}}},Fi.prototype.touchend=function(i,o,n){if(this._firstTwoTouches){var s=this._firstTwoTouches,h=s[1],m=Ys(n,o,s[0]),y=Ys(n,o,h);m&&y||(this._active&&U.suppressClick(),this.reset())}},Fi.prototype.touchcancel=function(){this.reset()},Fi.prototype.enable=function(i){this._enabled=!0,this._aroundCenter=!!i&&i.around==="center"},Fi.prototype.disable=function(){this._enabled=!1,this.reset()},Fi.prototype.isEnabled=function(){return this._enabled},Fi.prototype.isActive=function(){return this._active};var eu=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.reset=function(){i.prototype.reset.call(this),delete this._distance,delete this._startDistance},o.prototype._start=function(n){this._startDistance=this._distance=n[0].dist(n[1])},o.prototype._move=function(n,s){var h=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(_c(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:_c(this._distance,h),pinchAround:s}},o}(Fi);function Ui(i,o){return 180*i.angleWith(o)/Math.PI}var So=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.reset=function(){i.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},o.prototype._start=function(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])},o.prototype._move=function(n,s){var h=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ui(this._vector,h),pinchAround:s}},o.prototype._isBelowThreshold=function(n){this._minDiameter=Math.min(this._minDiameter,n.mag());var s=25/(Math.PI*this._minDiameter)*360,h=Ui(n,this._startVector);return Math.abs(h)<s},o}(Fi);function Qs(i){return Math.abs(i.y)>Math.abs(i.x)}var tu=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.reset=function(){i.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},o.prototype._start=function(n){this._lastPoints=n,Qs(n[0].sub(n[1]))&&(this._valid=!1)},o.prototype._move=function(n,s,h){var m=n[0].sub(this._lastPoints[0]),y=n[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(m,y,h.timeStamp),this._valid)return this._lastPoints=n,this._active=!0,{pitchDelta:(m.y+y.y)/2*-.5}},o.prototype.gestureBeginsVertically=function(n,s,h){if(this._valid!==void 0)return this._valid;var m=n.mag()>=2,y=s.mag()>=2;if(m||y){if(!m||!y)return this._firstMove===void 0&&(this._firstMove=h),h-this._firstMove<100&&void 0;var v=n.y>0==s.y>0;return Qs(n)&&Qs(s)&&v}},o}(Fi),ru={panStep:100,bearingStep:15,pitchStep:10},Cn=function(){var i=ru;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1};function vc(i){return i*(2-i)}Cn.prototype.reset=function(){this._active=!1},Cn.prototype.keydown=function(i){var o=this;if(!(i.altKey||i.ctrlKey||i.metaKey)){var n=0,s=0,h=0,m=0,y=0;switch(i.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:i.shiftKey?s=-1:(i.preventDefault(),m=-1);break;case 39:i.shiftKey?s=1:(i.preventDefault(),m=1);break;case 38:i.shiftKey?h=1:(i.preventDefault(),y=-1);break;case 40:i.shiftKey?h=-1:(i.preventDefault(),y=1);break;default:return}return this._rotationDisabled&&(s=0,h=0),{cameraAnimation:function(v){var S=v.getZoom();v.easeTo({duration:300,easeId:"keyboardHandler",easing:vc,zoom:n?Math.round(S)+n*(i.shiftKey?2:1):S,bearing:v.getBearing()+s*o._bearingStep,pitch:v.getPitch()+h*o._pitchStep,offset:[-m*o._panStep,-y*o._panStep],center:v.getCenter()},{originalEvent:i})}}}},Cn.prototype.enable=function(){this._enabled=!0},Cn.prototype.disable=function(){this._enabled=!1,this.reset()},Cn.prototype.isEnabled=function(){return this._enabled},Cn.prototype.isActive=function(){return this._active},Cn.prototype.disableRotation=function(){this._rotationDisabled=!0},Cn.prototype.enableRotation=function(){this._rotationDisabled=!1};var Er=function(i,o){this._map=i,this._el=i.getCanvasContainer(),this._handler=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,l.bindAll(["_onTimeout"],this)};Er.prototype.setZoomRate=function(i){this._defaultZoomRate=i},Er.prototype.setWheelZoomRate=function(i){this._wheelZoomRate=i},Er.prototype.isEnabled=function(){return!!this._enabled},Er.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Er.prototype.isZooming=function(){return!!this._zooming},Er.prototype.enable=function(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=i&&i.around==="center")},Er.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Er.prototype.wheel=function(i){if(this.isEnabled()){var o=i.deltaMode===l.window.WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY,n=l.browser.now(),s=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,o!==0&&o%4.000244140625==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":s>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(s*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),i.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=i,this._delta-=o,this._active||this._start(i)),i.preventDefault()}},Er.prototype._onTimeout=function(i){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(i)},Er.prototype._start=function(i){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var o=U.mousePos(this._el,i);this._around=l.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(o)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Er.prototype.renderFrame=function(){var i=this;if(this._frameId&&(this._frameId=null,this.isActive())){var o=this._map.transform;if(this._delta!==0){var n=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,s=2/(1+Math.exp(-Math.abs(this._delta*n)));this._delta<0&&s!==0&&(s=1/s);var h=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):o.scale;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(h*s))),this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var m,y=typeof this._targetZoom=="number"?this._targetZoom:o.zoom,v=this._startZoom,S=this._easing,A=!1;if(this._type==="wheel"&&v&&S){var D=Math.min((l.browser.now()-this._lastWheelEventTime)/200,1),B=S(D);m=l.number(v,y,B),D<1?this._frameId||(this._frameId=!0):A=!0}else m=y,A=!0;return this._active=!0,A&&(this._active=!1,this._finishTimeout=setTimeout(function(){i._zooming=!1,i._handler._triggerRenderFrame(),delete i._targetZoom,delete i._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!A,zoomDelta:m-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Er.prototype._smoothOutEasing=function(i){var o=l.ease;if(this._prevEase){var n=this._prevEase,s=(l.browser.now()-n.start)/n.duration,h=n.easing(s+.01)-n.easing(s),m=.27/Math.sqrt(h*h+1e-4)*.01,y=Math.sqrt(.0729-m*m);o=l.bezier(m,y,.25,1)}return this._prevEase={start:l.browser.now(),duration:i,easing:o},o},Er.prototype.reset=function(){this._active=!1};var Xt=function(i,o){this._clickZoom=i,this._tapZoom=o};Xt.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Xt.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Xt.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Xt.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var mn=function(){this.reset()};mn.prototype.reset=function(){this._active=!1},mn.prototype.dblclick=function(i,o){return i.preventDefault(),{cameraAnimation:function(n){n.easeTo({duration:300,zoom:n.getZoom()+(i.shiftKey?-1:1),around:n.unproject(o)},{originalEvent:i})}}},mn.prototype.enable=function(){this._enabled=!0},mn.prototype.disable=function(){this._enabled=!1,this.reset()},mn.prototype.isEnabled=function(){return this._enabled},mn.prototype.isActive=function(){return this._active};var Xi=function(){this._tap=new wo({numTouches:1,numTaps:1}),this.reset()};Xi.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Xi.prototype.touchstart=function(i,o,n){this._swipePoint||(this._tapTime&&i.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=o[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(i,o,n))},Xi.prototype.touchmove=function(i,o,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;var s=o[0],h=s.y-this._swipePoint.y;return this._swipePoint=s,i.preventDefault(),this._active=!0,{zoomDelta:h/128}}}else this._tap.touchmove(i,o,n)},Xi.prototype.touchend=function(i,o,n){this._tapTime?this._swipePoint&&n.length===0&&this.reset():this._tap.touchend(i,o,n)&&(this._tapTime=i.timeStamp)},Xi.prototype.touchcancel=function(){this.reset()},Xi.prototype.enable=function(){this._enabled=!0},Xi.prototype.disable=function(){this._enabled=!1,this.reset()},Xi.prototype.isEnabled=function(){return this._enabled},Xi.prototype.isActive=function(){return this._active};var rn=function(i,o,n){this._el=i,this._mousePan=o,this._touchPan=n};rn.prototype.enable=function(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")},rn.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")},rn.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},rn.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Yo=function(i,o,n){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=o,this._mousePitch=n};Yo.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Yo.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Yo.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Yo.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Un=function(i,o,n,s){this._el=i,this._touchZoom=o,this._touchRotate=n,this._tapDragZoom=s,this._rotationDisabled=!1,this._enabled=!0};Un.prototype.enable=function(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")},Un.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")},Un.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Un.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Un.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Un.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Eo=function(i){return i.zoom||i.drag||i.pitch||i.rotate},nn=function(i){function o(){i.apply(this,arguments)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o}(l.Event);function Qo(i){return i.panDelta&&i.panDelta.mag()||i.zoomDelta||i.bearingDelta||i.pitchDelta}var Fe=function(i,o){this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new rs(i),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o),l.bindAll(["handleEvent","handleWindowEvent"],this);var n=this._el;this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[l.window.document,"mousemove",{capture:!0}],[l.window.document,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[l.window,"blur",void 0]];for(var s=0,h=this._listeners;s<h.length;s+=1){var m=h[s],y=m[0];U.addEventListener(y,m[1],y===l.window.document?this.handleWindowEvent:this.handleEvent,m[2])}};Fe.prototype.destroy=function(){for(var i=0,o=this._listeners;i<o.length;i+=1){var n=o[i],s=n[0];U.removeEventListener(s,n[1],s===l.window.document?this.handleWindowEvent:this.handleEvent,n[2])}},Fe.prototype._addDefaultHandlers=function(i){var o=this._map,n=o.getCanvasContainer();this._add("mapEvent",new si(o,i));var s=o.boxZoom=new Ne(o,i);this._add("boxZoom",s);var h=new Hi,m=new mn;o.doubleClickZoom=new Xt(m,h),this._add("tapZoom",h),this._add("clickZoom",m);var y=new Xi;this._add("tapDragZoom",y);var v=o.touchPitch=new tu;this._add("touchPitch",v);var S=new $s(i),A=new Js(i);o.dragRotate=new Yo(i,S,A),this._add("mouseRotate",S,["mousePitch"]),this._add("mousePitch",A,["mouseRotate"]);var D=new qe(i),B=new dn(i);o.dragPan=new rn(n,D,B),this._add("mousePan",D),this._add("touchPan",B,["touchZoom","touchRotate"]);var R=new So,G=new eu;o.touchZoomRotate=new Un(n,G,R,y),this._add("touchRotate",R,["touchPan","touchZoom"]),this._add("touchZoom",G,["touchPan","touchRotate"]);var q=o.scrollZoom=new Er(o,this);this._add("scrollZoom",q,["mousePan"]);var $=o.keyboard=new Cn;this._add("keyboard",$),this._add("blockableMapEvent",new Gi(o));for(var j=0,K=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];j<K.length;j+=1){var te=K[j];i.interactive&&i[te]&&o[te].enable(i[te])}},Fe.prototype._add=function(i,o,n){this._handlers.push({handlerName:i,handler:o,allowed:n}),this._handlersById[i]=o},Fe.prototype.stop=function(i){if(!this._updatingCamera){for(var o=0,n=this._handlers;o<n.length;o+=1)n[o].handler.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}},Fe.prototype.isActive=function(){for(var i=0,o=this._handlers;i<o.length;i+=1)if(o[i].handler.isActive())return!0;return!1},Fe.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Fe.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Fe.prototype.isMoving=function(){return!!Eo(this._eventsInProgress)||this.isZooming()},Fe.prototype._blockedByActive=function(i,o,n){for(var s in i)if(s!==n&&(!o||o.indexOf(s)<0))return!0;return!1},Fe.prototype.handleWindowEvent=function(i){this.handleEvent(i,i.type+"Window")},Fe.prototype._getMapTouches=function(i){for(var o=[],n=0,s=i;n<s.length;n+=1){var h=s[n];this._el.contains(h.target)&&o.push(h)}return o},Fe.prototype.handleEvent=function(i,o){if(i.type!=="blur"){this._updatingCamera=!0;for(var n=i.type==="renderFrame"?void 0:i,s={needsRenderFrame:!1},h={},m={},y=i.touches?this._getMapTouches(i.touches):void 0,v=y?U.touchPos(this._el,y):U.mousePos(this._el,i),S=0,A=this._handlers;S<A.length;S+=1){var D=A[S],B=D.handlerName,R=D.handler,G=D.allowed;if(R.isEnabled()){var q=void 0;this._blockedByActive(m,G,B)?R.reset():R[o||i.type]&&(q=R[o||i.type](i,v,y),this.mergeHandlerResult(s,h,q,B,n),q&&q.needsRenderFrame&&this._triggerRenderFrame()),(q||R.isActive())&&(m[B]=R)}}var $={};for(var j in this._previousActiveHandlers)m[j]||($[j]=n);this._previousActiveHandlers=m,(Object.keys($).length||Qo(s))&&(this._changes.push([s,h,$]),this._triggerRenderFrame()),(Object.keys(m).length||Qo(s))&&this._map._stop(!0),this._updatingCamera=!1;var K=s.cameraAnimation;K&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],K(this._map))}else this.stop(!0)},Fe.prototype.mergeHandlerResult=function(i,o,n,s,h){if(n){l.extend(i,n);var m={handlerName:s,originalEvent:n.originalEvent||h};n.zoomDelta!==void 0&&(o.zoom=m),n.panDelta!==void 0&&(o.drag=m),n.pitchDelta!==void 0&&(o.pitch=m),n.bearingDelta!==void 0&&(o.rotate=m)}},Fe.prototype._applyChanges=function(){for(var i={},o={},n={},s=0,h=this._changes;s<h.length;s+=1){var m=h[s],y=m[0],v=m[1],S=m[2];y.panDelta&&(i.panDelta=(i.panDelta||new l.Point(0,0))._add(y.panDelta)),y.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+y.pitchDelta),y.around!==void 0&&(i.around=y.around),y.pinchAround!==void 0&&(i.pinchAround=y.pinchAround),y.noInertia&&(i.noInertia=y.noInertia),l.extend(o,v),l.extend(n,S)}this._updateMapTransform(i,o,n),this._changes=[]},Fe.prototype._updateMapTransform=function(i,o,n){var s=this._map,h=s.transform;if(!Qo(i))return this._fireEvents(o,n,!0);var m=i.panDelta,y=i.zoomDelta,v=i.bearingDelta,S=i.pitchDelta,A=i.around,D=i.pinchAround;D!==void 0&&(A=D),s._stop(!0),A=A||s.transform.centerPoint;var B=h.pointLocation(m?A.sub(m):A);v&&(h.bearing+=v),S&&(h.pitch+=S),y&&(h.zoom+=y),h.setLocationAtPoint(B,A),this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(o,n,!0)},Fe.prototype._fireEvents=function(i,o,n){var s=this,h=Eo(this._eventsInProgress),m=Eo(i),y={};for(var v in i)this._eventsInProgress[v]||(y[v+"start"]=i[v].originalEvent),this._eventsInProgress[v]=i[v];for(var S in!h&&m&&this._fireEvent("movestart",m.originalEvent),y)this._fireEvent(S,y[S]);for(var A in m&&this._fireEvent("move",m.originalEvent),i)this._fireEvent(A,i[A].originalEvent);var D,B={};for(var R in this._eventsInProgress){var G=this._eventsInProgress[R],q=G.handlerName,$=G.originalEvent;this._handlersById[q].isActive()||(delete this._eventsInProgress[R],B[R+"end"]=D=o[q]||$)}for(var j in B)this._fireEvent(j,B[j]);var K=Eo(this._eventsInProgress);if(n&&(h||m)&&!K){this._updatingCamera=!0;var te=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),oe=function(de){return de!==0&&-s._bearingSnap<de&&de<s._bearingSnap};te?(oe(te.bearing||this._map.getBearing())&&(te.bearing=0),this._map.easeTo(te,{originalEvent:D})):(this._map.fire(new l.Event("moveend",{originalEvent:D})),oe(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Fe.prototype._fireEvent=function(i,o){this._map.fire(new l.Event(i,o?{originalEvent:o}:{}))},Fe.prototype._requestFrame=function(){var i=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(o){delete i._frameId,i.handleEvent(new nn("renderFrame",{timeStamp:o})),i._applyChanges()})},Fe.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var st=function(i){function o(n,s){i.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=s.bearingSnap,l.bindAll(["_renderFrameCallback"],this)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.getCenter=function(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)},o.prototype.setCenter=function(n,s){return this.jumpTo({center:n},s)},o.prototype.panBy=function(n,s,h){return n=l.Point.convert(n).mult(-1),this.panTo(this.transform.center,l.extend({offset:n},s),h)},o.prototype.panTo=function(n,s,h){return this.easeTo(l.extend({center:n},s),h)},o.prototype.getZoom=function(){return this.transform.zoom},o.prototype.setZoom=function(n,s){return this.jumpTo({zoom:n},s),this},o.prototype.zoomTo=function(n,s,h){return this.easeTo(l.extend({zoom:n},s),h)},o.prototype.zoomIn=function(n,s){return this.zoomTo(this.getZoom()+1,n,s),this},o.prototype.zoomOut=function(n,s){return this.zoomTo(this.getZoom()-1,n,s),this},o.prototype.getBearing=function(){return this.transform.bearing},o.prototype.setBearing=function(n,s){return this.jumpTo({bearing:n},s),this},o.prototype.getPadding=function(){return this.transform.padding},o.prototype.setPadding=function(n,s){return this.jumpTo({padding:n},s),this},o.prototype.rotateTo=function(n,s,h){return this.easeTo(l.extend({bearing:n},s),h)},o.prototype.resetNorth=function(n,s){return this.rotateTo(0,l.extend({duration:1e3},n),s),this},o.prototype.resetNorthPitch=function(n,s){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},n),s),this},o.prototype.snapToNorth=function(n,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,s):this},o.prototype.getPitch=function(){return this.transform.pitch},o.prototype.setPitch=function(n,s){return this.jumpTo({pitch:n},s),this},o.prototype.cameraForBounds=function(n,s){n=l.LngLatBounds.convert(n);var h=s&&s.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),h,s)},o.prototype._cameraForBoxAndBearing=function(n,s,h,m){var y={top:0,bottom:0,right:0,left:0};if(typeof(m=l.extend({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},m)).padding=="number"){var v=m.padding;m.padding={top:v,bottom:v,right:v,left:v}}m.padding=l.extend(y,m.padding);var S=this.transform,A=S.padding,D=S.project(l.LngLat.convert(n)),B=S.project(l.LngLat.convert(s)),R=D.rotate(-h*Math.PI/180),G=B.rotate(-h*Math.PI/180),q=new l.Point(Math.max(R.x,G.x),Math.max(R.y,G.y)),$=new l.Point(Math.min(R.x,G.x),Math.min(R.y,G.y)),j=q.sub($),K=(S.width-(A.left+A.right+m.padding.left+m.padding.right))/j.x,te=(S.height-(A.top+A.bottom+m.padding.top+m.padding.bottom))/j.y;if(!(te<0||K<0)){var oe=Math.min(S.scaleZoom(S.scale*Math.min(K,te)),m.maxZoom),de=typeof m.offset.x=="number"?new l.Point(m.offset.x,m.offset.y):l.Point.convert(m.offset),pe=new l.Point((m.padding.left-m.padding.right)/2,(m.padding.top-m.padding.bottom)/2).rotate(h*Math.PI/180),me=de.add(pe).mult(S.scale/S.zoomScale(oe));return{center:S.unproject(D.add(B).div(2).sub(me)),zoom:oe,bearing:h}}l.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},o.prototype.fitBounds=function(n,s,h){return this._fitInternal(this.cameraForBounds(n,s),s,h)},o.prototype.fitScreenCoordinates=function(n,s,h,m,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(l.Point.convert(n)),this.transform.pointLocation(l.Point.convert(s)),h,m),m,y)},o.prototype._fitInternal=function(n,s,h){return n?(delete(s=l.extend(n,s)).padding,s.linear?this.easeTo(s,h):this.flyTo(s,h)):this},o.prototype.jumpTo=function(n,s){this.stop();var h=this.transform,m=!1,y=!1,v=!1;return"zoom"in n&&h.zoom!==+n.zoom&&(m=!0,h.zoom=+n.zoom),n.center!==void 0&&(h.center=l.LngLat.convert(n.center)),"bearing"in n&&h.bearing!==+n.bearing&&(y=!0,h.bearing=+n.bearing),"pitch"in n&&h.pitch!==+n.pitch&&(v=!0,h.pitch=+n.pitch),n.padding==null||h.isPaddingEqual(n.padding)||(h.padding=n.padding),this.fire(new l.Event("movestart",s)).fire(new l.Event("move",s)),m&&this.fire(new l.Event("zoomstart",s)).fire(new l.Event("zoom",s)).fire(new l.Event("zoomend",s)),y&&this.fire(new l.Event("rotatestart",s)).fire(new l.Event("rotate",s)).fire(new l.Event("rotateend",s)),v&&this.fire(new l.Event("pitchstart",s)).fire(new l.Event("pitch",s)).fire(new l.Event("pitchend",s)),this.fire(new l.Event("moveend",s))},o.prototype.easeTo=function(n,s){var h=this;this._stop(!1,n.easeId),((n=l.extend({offset:[0,0],duration:500,easing:l.ease},n)).animate===!1||!n.essential&&l.browser.prefersReducedMotion)&&(n.duration=0);var m=this.transform,y=this.getZoom(),v=this.getBearing(),S=this.getPitch(),A=this.getPadding(),D="zoom"in n?+n.zoom:y,B="bearing"in n?this._normalizeBearing(n.bearing,v):v,R="pitch"in n?+n.pitch:S,G="padding"in n?n.padding:m.padding,q=l.Point.convert(n.offset),$=m.centerPoint.add(q),j=m.pointLocation($),K=l.LngLat.convert(n.center||j);this._normalizeCenter(K);var te,oe,de=m.project(j),pe=m.project(K).sub(de),me=m.zoomScale(D-y);n.around&&(te=l.LngLat.convert(n.around),oe=m.locationPoint(te));var _e={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||D!==y,this._rotating=this._rotating||v!==B,this._pitching=this._pitching||R!==S,this._padding=!m.isPaddingEqual(G),this._easeId=n.easeId,this._prepareEase(s,n.noMoveStart,_e),this._ease(function(ze){if(h._zooming&&(m.zoom=l.number(y,D,ze)),h._rotating&&(m.bearing=l.number(v,B,ze)),h._pitching&&(m.pitch=l.number(S,R,ze)),h._padding&&(m.interpolatePadding(A,G,ze),$=m.centerPoint.add(q)),te)m.setLocationAtPoint(te,oe);else{var Se=m.zoomScale(m.zoom-y),Ue=D>y?Math.min(2,me):Math.max(.5,me),Qe=Math.pow(Ue,1-ze),rt=m.unproject(de.add(pe.mult(ze*Qe)).mult(Se));m.setLocationAtPoint(m.renderWorldCopies?rt.wrap():rt,$)}h._fireMoveEvents(s)},function(ze){h._afterEase(s,ze)},n),this},o.prototype._prepareEase=function(n,s,h){h===void 0&&(h={}),this._moving=!0,s||h.moving||this.fire(new l.Event("movestart",n)),this._zooming&&!h.zooming&&this.fire(new l.Event("zoomstart",n)),this._rotating&&!h.rotating&&this.fire(new l.Event("rotatestart",n)),this._pitching&&!h.pitching&&this.fire(new l.Event("pitchstart",n))},o.prototype._fireMoveEvents=function(n){this.fire(new l.Event("move",n)),this._zooming&&this.fire(new l.Event("zoom",n)),this._rotating&&this.fire(new l.Event("rotate",n)),this._pitching&&this.fire(new l.Event("pitch",n))},o.prototype._afterEase=function(n,s){if(!this._easeId||!s||this._easeId!==s){delete this._easeId;var h=this._zooming,m=this._rotating,y=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,h&&this.fire(new l.Event("zoomend",n)),m&&this.fire(new l.Event("rotateend",n)),y&&this.fire(new l.Event("pitchend",n)),this.fire(new l.Event("moveend",n))}},o.prototype.flyTo=function(n,s){var h=this;if(!n.essential&&l.browser.prefersReducedMotion){var m=l.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(m,s)}this.stop(),n=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.ease},n);var y=this.transform,v=this.getZoom(),S=this.getBearing(),A=this.getPitch(),D=this.getPadding(),B="zoom"in n?l.clamp(+n.zoom,y.minZoom,y.maxZoom):v,R="bearing"in n?this._normalizeBearing(n.bearing,S):S,G="pitch"in n?+n.pitch:A,q="padding"in n?n.padding:y.padding,$=y.zoomScale(B-v),j=l.Point.convert(n.offset),K=y.centerPoint.add(j),te=y.pointLocation(K),oe=l.LngLat.convert(n.center||te);this._normalizeCenter(oe);var de=y.project(te),pe=y.project(oe).sub(de),me=n.curve,_e=Math.max(y.width,y.height),ze=_e/$,Se=pe.mag();if("minZoom"in n){var Ue=l.clamp(Math.min(n.minZoom,v,B),y.minZoom,y.maxZoom),Qe=_e/y.zoomScale(Ue-v);me=Math.sqrt(Qe/Se*2)}var rt=me*me;function et(lt){var nt=(ze*ze-_e*_e+(lt?-1:1)*rt*rt*Se*Se)/(2*(lt?ze:_e)*rt*Se);return Math.log(Math.sqrt(nt*nt+1)-nt)}function Ft(lt){return(Math.exp(lt)-Math.exp(-lt))/2}function Ze(lt){return(Math.exp(lt)+Math.exp(-lt))/2}var dt=et(0),St=function(lt){return Ze(dt)/Ze(dt+me*lt)},mt=function(lt){return _e*((Ze(dt)*(Ft(nt=dt+me*lt)/Ze(nt))-Ft(dt))/rt)/Se;var nt},pt=(et(1)-dt)/me;if(Math.abs(Se)<1e-6||!isFinite(pt)){if(Math.abs(_e-ze)<1e-6)return this.easeTo(n,s);var ct=ze<_e?-1:1;pt=Math.abs(Math.log(ze/_e))/me,mt=function(){return 0},St=function(lt){return Math.exp(ct*me*lt)}}return n.duration="duration"in n?+n.duration:1e3*pt/("screenSpeed"in n?+n.screenSpeed/me:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=S!==R,this._pitching=G!==A,this._padding=!y.isPaddingEqual(q),this._prepareEase(s,!1),this._ease(function(lt){var nt=lt*pt,rr=1/St(nt);y.zoom=lt===1?B:v+y.scaleZoom(rr),h._rotating&&(y.bearing=l.number(S,R,lt)),h._pitching&&(y.pitch=l.number(A,G,lt)),h._padding&&(y.interpolatePadding(D,q,lt),K=y.centerPoint.add(j));var Dr=lt===1?oe:y.unproject(de.add(pe.mult(mt(nt))).mult(rr));y.setLocationAtPoint(y.renderWorldCopies?Dr.wrap():Dr,K),h._fireMoveEvents(s)},function(){return h._afterEase(s)},n),this},o.prototype.isEasing=function(){return!!this._easeFrameId},o.prototype.stop=function(){return this._stop()},o.prototype._stop=function(n,s){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var h=this._onEaseEnd;delete this._onEaseEnd,h.call(this,s)}if(!n){var m=this.handlers;m&&m.stop(!1)}return this},o.prototype._ease=function(n,s,h){h.animate===!1||h.duration===0?(n(1),s()):(this._easeStart=l.browser.now(),this._easeOptions=h,this._onEaseFrame=n,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},o.prototype._renderFrameCallback=function(){var n=Math.min((l.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},o.prototype._normalizeBearing=function(n,s){n=l.wrap(n,-180,180);var h=Math.abs(n-s);return Math.abs(n-360-s)<h&&(n-=360),Math.abs(n+360-s)<h&&(n+=360),n},o.prototype._normalizeCenter=function(n){var s=this.transform;if(s.renderWorldCopies&&!s.lngRange){var h=n.lng-s.center.lng;n.lng+=h>180?-360:h<-180?360:0}},o}(l.Evented),Wi=function(i){i===void 0&&(i={}),this.options=i,l.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Wi.prototype.getDefaultPosition=function(){return"bottom-right"},Wi.prototype.onAdd=function(i){var o=this.options&&this.options.compact;return this._map=i,this._container=U.create("div","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=U.create("button","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.type="button",this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=U.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),o&&this._container.classList.add("maplibregl-compact","mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),o===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Wi.prototype.onRemove=function(){U.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Wi.prototype._setElementTitle=function(i,o){var n=this._map._getUIString("AttributionControl."+o);i.title=n,i.setAttribute("aria-label",n)},Wi.prototype._toggleAttribution=function(){this._container.classList.contains("maplibregl-compact-show")||this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Wi.prototype._updateEditLink=function(){var i=this._editLink;i||(i=this._editLink=this._container.querySelector(".mapbox-improve-map"));var o=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||l.config.ACCESS_TOKEN}];if(i){var n=o.reduce(function(s,h,m){return h.value&&(s+=h.key+"="+h.value+(m<o.length-1?"&":"")),s},"?");i.href=l.config.FEEDBACK_URL+"/"+n+(this._map._hash?this._map._hash.getHashString(!0):""),i.rel="noopener nofollow",this._setElementTitle(i,"MapFeedback")}},Wi.prototype._updateData=function(i){!i||i.sourceDataType!=="metadata"&&i.sourceDataType!=="visibility"&&i.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Wi.prototype._updateAttributions=function(){if(this._map.style){var i=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=i.concat(this.options.customAttribution.map(function(v){return typeof v!="string"?"":v})):typeof this.options.customAttribution=="string"&&i.push(this.options.customAttribution)),this._map.style.stylesheet){var o=this._map.style.stylesheet;this.styleOwner=o.owner,this.styleId=o.id}var n=this._map.style.sourceCaches;for(var s in n){var h=n[s];if(h.used){var m=h.getSource();m.attribution&&i.indexOf(m.attribution)<0&&i.push(m.attribution)}}i.sort(function(v,S){return v.length-S.length});var y=(i=i.filter(function(v,S){for(var A=S+1;A<i.length;A++)if(i[A].indexOf(v)>=0)return!1;return!0})).join(" | ");y!==this._attribHTML&&(this._attribHTML=y,i.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._editLink=null)}},Wi.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("maplibregl-compact","mapboxgl-compact"):this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show")};var yn=function(){l.bindAll(["_updateLogo"],this),l.bindAll(["_updateCompact"],this)};yn.prototype.onAdd=function(i){this._map=i,this._container=U.create("div","maplibregl-ctrl mapboxgl-ctrl");var o=U.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://maplibre.org/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},yn.prototype.onRemove=function(){U.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},yn.prototype.getDefaultPosition=function(){return"bottom-left"},yn.prototype._updateLogo=function(i){i&&i.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},yn.prototype._logoRequired=function(){if(this._map.style){var i=this._map.style.sourceCaches;for(var o in i)if(i[o].getSource().mapbox_logo)return!0;return!1}},yn.prototype._updateCompact=function(){var i=this._container.children;if(i.length){var o=i[0];this._map.getCanvasContainer().offsetWidth<250?o.classList.add("maplibregl-compact","mapboxgl-compact"):o.classList.remove("maplibregl-compact","mapboxgl-compact")}};var Qn=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Qn.prototype.add=function(i){var o=++this._id;return this._queue.push({callback:i,id:o,cancelled:!1}),o},Qn.prototype.remove=function(i){for(var o=this._currentlyRunning,n=0,s=o?this._queue.concat(o):this._queue;n<s.length;n+=1){var h=s[n];if(h.id===i)return void(h.cancelled=!0)}},Qn.prototype.run=function(i){i===void 0&&(i=0);var o=this._currentlyRunning=this._queue;this._queue=[];for(var n=0,s=o;n<s.length;n+=1){var h=s[n];if(!h.cancelled&&(h.callback(i),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Qn.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Ki={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},gn=l.window.HTMLImageElement,Zp=l.window.HTMLElement,eo=l.window.ImageBitmap,dr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},li=function(i){function o(s){var h=this;if((s=l.extend({},dr,s)).minZoom!=null&&s.maxZoom!=null&&s.minZoom>s.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(s.minPitch!=null&&s.maxPitch!=null&&s.minPitch>s.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(s.minPitch!=null&&s.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(s.maxPitch!=null&&s.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var m=new Yt(s.minZoom,s.maxZoom,s.minPitch,s.maxPitch,s.renderWorldCopies);if(i.call(this,m,s),this._interactive=s.interactive,this._maxTileCacheSize=s.maxTileCacheSize,this._failIfMajorPerformanceCaveat=s.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=s.preserveDrawingBuffer,this._antialias=s.antialias,this._trackResize=s.trackResize,this._bearingSnap=s.bearingSnap,this._refreshExpiredTiles=s.refreshExpiredTiles,this._fadeDuration=s.fadeDuration,this._crossSourceCollisions=s.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=s.collectResourceTiming,this._renderTaskQueue=new Qn,this._controls=[],this._mapId=l.uniqueId(),this._locale=l.extend({},Ki,s.locale),this._clickTolerance=s.clickTolerance,this._requestManager=new l.RequestManager(s.transformRequest,s.accessToken),typeof s.container=="string"){if(this._container=l.window.document.getElementById(s.container),!this._container)throw new Error("Container '"+s.container+"' not found.")}else{if(!(s.container instanceof Zp))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=s.container}if(s.maxBounds&&this.setMaxBounds(s.maxBounds),l.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return h._update(!1)}),this.on("moveend",function(){return h._update(!1)}),this.on("zoom",function(){return h._update(!0)}),l.window!==void 0&&(l.window.addEventListener("online",this._onWindowOnline,!1),l.window.addEventListener("resize",this._onWindowResize,!1),l.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Fe(this,s),this._hash=s.hash&&new Jo(typeof s.hash=="string"&&s.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:s.center,zoom:s.zoom,bearing:s.bearing,pitch:s.pitch}),s.bounds&&(this.resize(),this.fitBounds(s.bounds,l.extend({},s.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=s.localIdeographFontFamily,s.style&&this.setStyle(s.style,{localIdeographFontFamily:s.localIdeographFontFamily}),s.attributionControl&&this.addControl(new Wi({customAttribution:s.customAttribution})),this.addControl(new yn,s.logoPosition),this.on("style.load",function(){h.transform.unmodified&&h.jumpTo(h.style.stylesheet)}),this.on("data",function(y){h._update(y.dataType==="style"),h.fire(new l.Event(y.dataType+"data",y))}),this.on("dataloading",function(y){h.fire(new l.Event(y.dataType+"dataloading",y))})}i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o;var n={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return o.prototype._getMapId=function(){return this._mapId},o.prototype.addControl=function(s,h){if(h===void 0&&(h=s.getDefaultPosition?s.getDefaultPosition():"top-right"),!s||!s.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var m=s.onAdd(this);this._controls.push(s);var y=this._controlPositions[h];return h.indexOf("bottom")!==-1?y.insertBefore(m,y.firstChild):y.appendChild(m),this},o.prototype.removeControl=function(s){if(!s||!s.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var h=this._controls.indexOf(s);return h>-1&&this._controls.splice(h,1),s.onRemove(this),this},o.prototype.hasControl=function(s){return this._controls.indexOf(s)>-1},o.prototype.resize=function(s){var h=this._containerDimensions(),m=h[0],y=h[1];this._resizeCanvas(m,y),this.transform.resize(m,y),this.painter.resize(m,y);var v=!this._moving;return v&&(this.stop(),this.fire(new l.Event("movestart",s)).fire(new l.Event("move",s))),this.fire(new l.Event("resize",s)),v&&this.fire(new l.Event("moveend",s)),this},o.prototype.getBounds=function(){return this.transform.getBounds()},o.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},o.prototype.setMaxBounds=function(s){return this.transform.setMaxBounds(l.LngLatBounds.convert(s)),this._update()},o.prototype.setMinZoom=function(s){if((s=s??-2)>=-2&&s<=this.transform.maxZoom)return this.transform.minZoom=s,this._update(),this.getZoom()<s&&this.setZoom(s),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},o.prototype.getMinZoom=function(){return this.transform.minZoom},o.prototype.setMaxZoom=function(s){if((s=s??22)>=this.transform.minZoom)return this.transform.maxZoom=s,this._update(),this.getZoom()>s&&this.setZoom(s),this;throw new Error("maxZoom must be greater than the current minZoom")},o.prototype.getMaxZoom=function(){return this.transform.maxZoom},o.prototype.setMinPitch=function(s){if((s=s??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(s>=0&&s<=this.transform.maxPitch)return this.transform.minPitch=s,this._update(),this.getPitch()<s&&this.setPitch(s),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},o.prototype.getMinPitch=function(){return this.transform.minPitch},o.prototype.setMaxPitch=function(s){if((s=s??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(s>=this.transform.minPitch)return this.transform.maxPitch=s,this._update(),this.getPitch()>s&&this.setPitch(s),this;throw new Error("maxPitch must be greater than the current minPitch")},o.prototype.getMaxPitch=function(){return this.transform.maxPitch},o.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},o.prototype.setRenderWorldCopies=function(s){return this.transform.renderWorldCopies=s,this._update()},o.prototype.project=function(s){return this.transform.locationPoint(l.LngLat.convert(s))},o.prototype.unproject=function(s){return this.transform.pointLocation(l.Point.convert(s))},o.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},o.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},o.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},o.prototype._createDelegatedListener=function(s,h,m){var y,v=this;if(s==="mouseenter"||s==="mouseover"){var S=!1;return{layer:h,listener:m,delegates:{mousemove:function(D){var B=v.getLayer(h)?v.queryRenderedFeatures(D.point,{layers:[h]}):[];B.length?S||(S=!0,m.call(v,new _i(s,v,D.originalEvent,{features:B}))):S=!1},mouseout:function(){S=!1}}}}if(s==="mouseleave"||s==="mouseout"){var A=!1;return{layer:h,listener:m,delegates:{mousemove:function(D){(v.getLayer(h)?v.queryRenderedFeatures(D.point,{layers:[h]}):[]).length?A=!0:A&&(A=!1,m.call(v,new _i(s,v,D.originalEvent)))},mouseout:function(D){A&&(A=!1,m.call(v,new _i(s,v,D.originalEvent)))}}}}return{layer:h,listener:m,delegates:(y={},y[s]=function(D){var B=v.getLayer(h)?v.queryRenderedFeatures(D.point,{layers:[h]}):[];B.length&&(D.features=B,m.call(v,D),delete D.features)},y)}},o.prototype.on=function(s,h,m){if(m===void 0)return i.prototype.on.call(this,s,h);var y=this._createDelegatedListener(s,h,m);for(var v in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[s]=this._delegatedListeners[s]||[],this._delegatedListeners[s].push(y),y.delegates)this.on(v,y.delegates[v]);return this},o.prototype.once=function(s,h,m){if(m===void 0)return i.prototype.once.call(this,s,h);var y=this._createDelegatedListener(s,h,m);for(var v in y.delegates)this.once(v,y.delegates[v]);return this},o.prototype.off=function(s,h,m){var y=this;return m===void 0?i.prototype.off.call(this,s,h):(this._delegatedListeners&&this._delegatedListeners[s]&&function(v){for(var S=v[s],A=0;A<S.length;A++){var D=S[A];if(D.layer===h&&D.listener===m){for(var B in D.delegates)y.off(B,D.delegates[B]);return S.splice(A,1),y}}}(this._delegatedListeners),this)},o.prototype.queryRenderedFeatures=function(s,h){if(!this.style)return[];var m;if(h!==void 0||s===void 0||s instanceof l.Point||Array.isArray(s)||(h=s,s=void 0),h=h||{},(s=s||[[0,0],[this.transform.width,this.transform.height]])instanceof l.Point||typeof s[0]=="number")m=[l.Point.convert(s)];else{var y=l.Point.convert(s[0]),v=l.Point.convert(s[1]);m=[y,new l.Point(v.x,y.y),v,new l.Point(y.x,v.y),y]}return this.style.queryRenderedFeatures(m,h,this.transform)},o.prototype.querySourceFeatures=function(s,h){return this.style.querySourceFeatures(s,h)},o.prototype.setStyle=function(s,h){return(h=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},h)).diff!==!1&&h.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&s?(this._diffStyle(s,h),this):(this._localIdeographFontFamily=h.localIdeographFontFamily,this._updateStyle(s,h))},o.prototype.setTransformRequest=function(s){return this._requestManager.setTransformRequest(s),this},o.prototype._getUIString=function(s){var h=this._locale[s];if(h==null)throw new Error("Missing UI string '"+s+"'");return h},o.prototype._updateStyle=function(s,h){return this.style&&(this.style.setEventedParent(null),this.style._remove()),s?(this.style=new Yn(this,h||{}),this.style.setEventedParent(this,{style:this.style}),typeof s=="string"?this.style.loadURL(s):this.style.loadJSON(s),this):(delete this.style,this)},o.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Yn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},o.prototype._diffStyle=function(s,h){var m=this;if(typeof s=="string"){var y=this._requestManager.normalizeStyleURL(s),v=this._requestManager.transformRequest(y,l.ResourceType.Style);l.getJSON(v,function(S,A){S?m.fire(new l.ErrorEvent(S)):A&&m._updateDiff(A,h)})}else typeof s=="object"&&this._updateDiff(s,h)},o.prototype._updateDiff=function(s,h){try{this.style.setState(s)&&this._update(!0)}catch(m){l.warnOnce("Unable to perform style diff: "+(m.message||m.error||m)+".  Rebuilding the style from scratch."),this._updateStyle(s,h)}},o.prototype.getStyle=function(){if(this.style)return this.style.serialize()},o.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():l.warnOnce("There is no style added to the map.")},o.prototype.addSource=function(s,h){return this._lazyInitEmptyStyle(),this.style.addSource(s,h),this._update(!0)},o.prototype.isSourceLoaded=function(s){var h=this.style&&this.style.sourceCaches[s];if(h!==void 0)return h.loaded();this.fire(new l.ErrorEvent(new Error("There is no source with ID '"+s+"'")))},o.prototype.areTilesLoaded=function(){var s=this.style&&this.style.sourceCaches;for(var h in s){var m=s[h]._tiles;for(var y in m){var v=m[y];if(v.state!=="loaded"&&v.state!=="errored")return!1}}return!0},o.prototype.addSourceType=function(s,h,m){return this._lazyInitEmptyStyle(),this.style.addSourceType(s,h,m)},o.prototype.removeSource=function(s){return this.style.removeSource(s),this._update(!0)},o.prototype.getSource=function(s){return this.style.getSource(s)},o.prototype.addImage=function(s,h,m){m===void 0&&(m={});var y=m.pixelRatio;y===void 0&&(y=1);var v=m.sdf;v===void 0&&(v=!1);var S=m.stretchX,A=m.stretchY,D=m.content;if(this._lazyInitEmptyStyle(),h instanceof gn||eo&&h instanceof eo){var B=l.browser.getImageData(h);this.style.addImage(s,{data:new l.RGBAImage({width:B.width,height:B.height},B.data),pixelRatio:y,stretchX:S,stretchY:A,content:D,sdf:v,version:0})}else{if(h.width===void 0||h.height===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var R=h;this.style.addImage(s,{data:new l.RGBAImage({width:h.width,height:h.height},new Uint8Array(h.data)),pixelRatio:y,stretchX:S,stretchY:A,content:D,sdf:v,version:0,userImage:R}),R.onAdd&&R.onAdd(this,s)}},o.prototype.updateImage=function(s,h){var m=this.style.getImage(s);if(!m)return this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var y=h instanceof gn||eo&&h instanceof eo?l.browser.getImageData(h):h,v=y.width,S=y.height,A=y.data;return v===void 0||S===void 0?this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):v!==m.data.width||S!==m.data.height?this.fire(new l.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(m.data.replace(A,!(h instanceof gn||eo&&h instanceof eo)),void this.style.updateImage(s,m))},o.prototype.hasImage=function(s){return s?!!this.style.getImage(s):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)},o.prototype.removeImage=function(s){this.style.removeImage(s)},o.prototype.loadImage=function(s,h){l.getImage(this._requestManager.transformRequest(s,l.ResourceType.Image),h)},o.prototype.listImages=function(){return this.style.listImages()},o.prototype.addLayer=function(s,h){return this._lazyInitEmptyStyle(),this.style.addLayer(s,h),this._update(!0)},o.prototype.moveLayer=function(s,h){return this.style.moveLayer(s,h),this._update(!0)},o.prototype.removeLayer=function(s){return this.style.removeLayer(s),this._update(!0)},o.prototype.getLayer=function(s){return this.style.getLayer(s)},o.prototype.setLayerZoomRange=function(s,h,m){return this.style.setLayerZoomRange(s,h,m),this._update(!0)},o.prototype.setFilter=function(s,h,m){return m===void 0&&(m={}),this.style.setFilter(s,h,m),this._update(!0)},o.prototype.getFilter=function(s){return this.style.getFilter(s)},o.prototype.setPaintProperty=function(s,h,m,y){return y===void 0&&(y={}),this.style.setPaintProperty(s,h,m,y),this._update(!0)},o.prototype.getPaintProperty=function(s,h){return this.style.getPaintProperty(s,h)},o.prototype.setLayoutProperty=function(s,h,m,y){return y===void 0&&(y={}),this.style.setLayoutProperty(s,h,m,y),this._update(!0)},o.prototype.getLayoutProperty=function(s,h){return this.style.getLayoutProperty(s,h)},o.prototype.setLight=function(s,h){return h===void 0&&(h={}),this._lazyInitEmptyStyle(),this.style.setLight(s,h),this._update(!0)},o.prototype.getLight=function(){return this.style.getLight()},o.prototype.setFeatureState=function(s,h){return this.style.setFeatureState(s,h),this._update()},o.prototype.removeFeatureState=function(s,h){return this.style.removeFeatureState(s,h),this._update()},o.prototype.getFeatureState=function(s){return this.style.getFeatureState(s)},o.prototype.getContainer=function(){return this._container},o.prototype.getCanvasContainer=function(){return this._canvasContainer},o.prototype.getCanvas=function(){return this._canvas},o.prototype._containerDimensions=function(){var s=0,h=0;return this._container&&(s=this._container.clientWidth||400,h=this._container.clientHeight||300),[s,h]},o.prototype._setupContainer=function(){var s=this._container;s.classList.add("maplibregl-map","mapboxgl-map");var h=this._canvasContainer=U.create("div","maplibregl-canvas-container mapboxgl-canvas-container",s);this._interactive&&h.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=U.create("canvas","maplibregl-canvas mapboxgl-canvas",h),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var m=this._containerDimensions();this._resizeCanvas(m[0],m[1]);var y=this._controlContainer=U.create("div","maplibregl-control-container mapboxgl-control-container",s),v=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(S){v[S]=U.create("div","maplibregl-ctrl-"+S+" mapboxgl-ctrl-"+S,y)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},o.prototype._resizeCanvas=function(s,h){var m=l.browser.devicePixelRatio||1;this._canvas.width=m*s,this._canvas.height=m*h,this._canvas.style.width=s+"px",this._canvas.style.height=h+"px"},o.prototype._setupPainter=function(){var s=l.extend({},J.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),h=this._canvas.getContext("webgl",s)||this._canvas.getContext("experimental-webgl",s);h?(this.painter=new tr(h,this.transform),l.webpSupported.testSupport(h)):this.fire(new l.ErrorEvent(new Error("Failed to initialize WebGL")))},o.prototype._contextLost=function(s){s.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:s}))},o.prototype._contextRestored=function(s){this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:s}))},o.prototype._onMapScroll=function(s){if(s.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},o.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},o.prototype._update=function(s){return this.style?(this._styleDirty=this._styleDirty||s,this._sourcesDirty=!0,this.triggerRepaint(),this):this},o.prototype._requestRenderFrame=function(s){return this._update(),this._renderTaskQueue.add(s)},o.prototype._cancelRenderFrame=function(s){this._renderTaskQueue.remove(s)},o.prototype._render=function(s){var h,m=this,y=0,v=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(h=v.createQueryEXT(),v.beginQueryEXT(v.TIME_ELAPSED_EXT,h),y=l.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(s),!this._removed){var S=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var A=this.transform.zoom,D=l.browser.now();this.style.zoomHistory.update(A,D);var B=new l.EvaluationParameters(A,{now:D,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),R=B.crossFadingFactor();R===1&&R===this._crossFadingFactor||(S=!0,this._crossFadingFactor=R),this.style.update(B)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new l.Event("load"))),this.style&&(this.style.hasTransitions()||S)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var G=l.browser.now()-y;v.endQueryEXT(v.TIME_ELAPSED_EXT,h),setTimeout(function(){var j=v.getQueryObjectEXT(h,v.QUERY_RESULT_EXT)/1e6;v.deleteQueryEXT(h),m.fire(new l.Event("gpu-timing-frame",{cpuTime:G,gpuTime:j}))},50)}if(this.listens("gpu-timing-layer")){var q=this.painter.collectGpuTimers();setTimeout(function(){var j=m.painter.queryGpuTimers(q);m.fire(new l.Event("gpu-timing-layer",{layerTimes:j}))},50)}var $=this._sourcesDirty||this._styleDirty||this._placementDirty;return $||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.Event("idle")),!this._loaded||this._fullyLoaded||$||(this._fullyLoaded=!0),this}},o.prototype.remove=function(){this._hash&&this._hash.remove();for(var s=0,h=this._controls;s<h.length;s+=1)h[s].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),l.window!==void 0&&(l.window.removeEventListener("resize",this._onWindowResize,!1),l.window.removeEventListener("orientationchange",this._onWindowResize,!1),l.window.removeEventListener("online",this._onWindowOnline,!1));var m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),iu(this._canvasContainer),iu(this._controlContainer),this._container.classList.remove("maplibregl-map","mapboxgl-map"),this._removed=!0,this.fire(new l.Event("remove"))},o.prototype.triggerRepaint=function(){var s=this;this.style&&!this._frame&&(this._frame=l.browser.frame(function(h){s._frame=null,s._render(h)}))},o.prototype._onWindowOnline=function(){this._update()},o.prototype._onWindowResize=function(s){this._trackResize&&this.resize({originalEvent:s})._update()},n.showTileBoundaries.get=function(){return!!this._showTileBoundaries},n.showTileBoundaries.set=function(s){this._showTileBoundaries!==s&&(this._showTileBoundaries=s,this._update())},n.showPadding.get=function(){return!!this._showPadding},n.showPadding.set=function(s){this._showPadding!==s&&(this._showPadding=s,this._update())},n.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},n.showCollisionBoxes.set=function(s){this._showCollisionBoxes!==s&&(this._showCollisionBoxes=s,s?this.style._generateCollisionBoxes():this._update())},n.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},n.showOverdrawInspector.set=function(s){this._showOverdrawInspector!==s&&(this._showOverdrawInspector=s,this._update())},n.repaint.get=function(){return!!this._repaint},n.repaint.set=function(s){this._repaint!==s&&(this._repaint=s,this.triggerRepaint())},n.vertices.get=function(){return!!this._vertices},n.vertices.set=function(s){this._vertices=s,this._update()},o.prototype._setCacheLimits=function(s,h){l.setCacheLimits(s,h)},n.version.get=function(){return l.version},Object.defineProperties(o.prototype,n),o}(st);function iu(i){i.parentNode&&i.parentNode.removeChild(i)}var as={showCompass:!0,showZoom:!0,visualizePitch:!1},to=function(i){var o=this;this.options=l.extend({},as,i),this._container=U.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(n){return n.preventDefault()}),this.options.showZoom&&(l.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",function(n){return o._map.zoomIn({},{originalEvent:n})}),U.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",function(n){return o._map.zoomOut({},{originalEvent:n})}),U.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(l.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",function(n){o.options.visualizePitch?o._map.resetNorthPitch({},{originalEvent:n}):o._map.resetNorth({},{originalEvent:n})}),this._compassIcon=U.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};to.prototype._updateZoomButtons=function(){var i=this._map.getZoom(),o=i===this._map.getMaxZoom(),n=i===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},to.prototype._rotateCompassArrow=function(){var i=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=i},to.prototype.onAdd=function(i){return this._map=i,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new $i(this._map,this._compass,this.options.visualizePitch)),this._container},to.prototype.onRemove=function(){U.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},to.prototype._createButton=function(i,o){var n=U.create("button",i,this._container);return n.type="button",n.addEventListener("click",o),n},to.prototype._setButtonTitle=function(i,o){var n=this._map._getUIString("NavigationControl."+o);i.title=n,i.setAttribute("aria-label",n)};var $i=function(i,o,n){n===void 0&&(n=!1),this._clickTolerance=10,this.element=o,this.mouseRotate=new $s({clickTolerance:i.dragRotate._mouseRotate._clickTolerance}),this.map=i,n&&(this.mousePitch=new Js({clickTolerance:i.dragRotate._mousePitch._clickTolerance})),l.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),U.addEventListener(o,"mousedown",this.mousedown),U.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),U.addEventListener(o,"touchmove",this.touchmove),U.addEventListener(o,"touchend",this.touchend),U.addEventListener(o,"touchcancel",this.reset)};function el(i,o,n){if(i=new l.LngLat(i.lng,i.lat),o){var s=new l.LngLat(i.lng-360,i.lat),h=new l.LngLat(i.lng+360,i.lat),m=n.locationPoint(i).distSqr(o);n.locationPoint(s).distSqr(o)<m?i=s:n.locationPoint(h).distSqr(o)<m&&(i=h)}for(;Math.abs(i.lng-n.center.lng)>180;){var y=n.locationPoint(i);if(y.x>=0&&y.y>=0&&y.x<=n.width&&y.y<=n.height)break;i.lng>n.center.lng?i.lng-=360:i.lng+=360}return i}$i.prototype.down=function(i,o){this.mouseRotate.mousedown(i,o),this.mousePitch&&this.mousePitch.mousedown(i,o),U.disableDrag()},$i.prototype.move=function(i,o){var n=this.map,s=this.mouseRotate.mousemoveWindow(i,o);if(s&&s.bearingDelta&&n.setBearing(n.getBearing()+s.bearingDelta),this.mousePitch){var h=this.mousePitch.mousemoveWindow(i,o);h&&h.pitchDelta&&n.setPitch(n.getPitch()+h.pitchDelta)}},$i.prototype.off=function(){var i=this.element;U.removeEventListener(i,"mousedown",this.mousedown),U.removeEventListener(i,"touchstart",this.touchstart,{passive:!1}),U.removeEventListener(i,"touchmove",this.touchmove),U.removeEventListener(i,"touchend",this.touchend),U.removeEventListener(i,"touchcancel",this.reset),this.offTemp()},$i.prototype.offTemp=function(){U.enableDrag(),U.removeEventListener(l.window,"mousemove",this.mousemove),U.removeEventListener(l.window,"mouseup",this.mouseup)},$i.prototype.mousedown=function(i){this.down(l.extend({},i,{ctrlKey:!0,preventDefault:function(){return i.preventDefault()}}),U.mousePos(this.element,i)),U.addEventListener(l.window,"mousemove",this.mousemove),U.addEventListener(l.window,"mouseup",this.mouseup)},$i.prototype.mousemove=function(i){this.move(i,U.mousePos(this.element,i))},$i.prototype.mouseup=function(i){this.mouseRotate.mouseupWindow(i),this.mousePitch&&this.mousePitch.mouseupWindow(i),this.offTemp()},$i.prototype.touchstart=function(i){i.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=U.touchPos(this.element,i.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return i.preventDefault()}},this._startPos))},$i.prototype.touchmove=function(i){i.targetTouches.length!==1?this.reset():(this._lastPos=U.touchPos(this.element,i.targetTouches)[0],this.move({preventDefault:function(){return i.preventDefault()}},this._lastPos))},$i.prototype.touchend=function(i){i.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},$i.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var ea={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ro(i,o,n){var s=i.classList;for(var h in ea)s.remove("maplibregl-"+n+"-anchor-"+h,"mapboxgl-"+n+"-anchor-"+h);s.add("maplibregl-"+n+"-anchor-"+o,"mapboxgl-"+n+"-anchor-"+o)}var Ta,ss=function(i){function o(n,s){if(i.call(this),(n instanceof l.window.HTMLElement||s)&&(n=l.extend({element:n},s)),l.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=l.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=U.create("div"),this._element.setAttribute("aria-label","Map marker");var h=U.createNS("http://www.w3.org/2000/svg","svg");h.setAttributeNS(null,"display","block"),h.setAttributeNS(null,"height","41px"),h.setAttributeNS(null,"width","27px"),h.setAttributeNS(null,"viewBox","0 0 27 41");var m=U.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");var y=U.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"fill-rule","nonzero");var v=U.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"transform","translate(3.0, 29.0)"),v.setAttributeNS(null,"fill","#000000");for(var S=0,A=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];S<A.length;S+=1){var D=A[S],B=U.createNS("http://www.w3.org/2000/svg","ellipse");B.setAttributeNS(null,"opacity","0.04"),B.setAttributeNS(null,"cx","10.5"),B.setAttributeNS(null,"cy","5.80029008"),B.setAttributeNS(null,"rx",D.rx),B.setAttributeNS(null,"ry",D.ry),v.appendChild(B)}var R=U.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"fill",this._color);var G=U.createNS("http://www.w3.org/2000/svg","path");G.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),R.appendChild(G);var q=U.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"opacity","0.25"),q.setAttributeNS(null,"fill","#000000");var $=U.createNS("http://www.w3.org/2000/svg","path");$.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),q.appendChild($);var j=U.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"transform","translate(6.0, 7.0)"),j.setAttributeNS(null,"fill","#FFFFFF");var K=U.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"transform","translate(8.0, 8.0)");var te=U.createNS("http://www.w3.org/2000/svg","circle");te.setAttributeNS(null,"fill","#000000"),te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"cx","5.5"),te.setAttributeNS(null,"cy","5.5"),te.setAttributeNS(null,"r","5.4999962");var oe=U.createNS("http://www.w3.org/2000/svg","circle");oe.setAttributeNS(null,"fill","#FFFFFF"),oe.setAttributeNS(null,"cx","5.5"),oe.setAttributeNS(null,"cy","5.5"),oe.setAttributeNS(null,"r","5.4999962"),K.appendChild(te),K.appendChild(oe),y.appendChild(v),y.appendChild(R),y.appendChild(q),y.appendChild(j),y.appendChild(K),h.appendChild(y),h.setAttributeNS(null,"height",41*this._scale+"px"),h.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(h),this._offset=l.Point.convert(n&&n.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",function(de){de.preventDefault()}),this._element.addEventListener("mousedown",function(de){de.preventDefault()}),ro(this._element,this._anchor,"marker"),this._popup=null}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.addTo=function(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},o.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),U.remove(this._element),this._popup&&this._popup.remove(),this},o.prototype.getLngLat=function(){return this._lngLat},o.prototype.setLngLat=function(n){return this._lngLat=l.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},o.prototype.getElement=function(){return this._element},o.prototype.setPopup=function(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){var s=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[s,-1*(24.6+s)],"bottom-right":[-s,-1*(24.6+s)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},o.prototype._onKeyPress=function(n){var s=n.code,h=n.charCode||n.keyCode;s!=="Space"&&s!=="Enter"&&h!==32&&h!==13||this.togglePopup()},o.prototype._onMapClick=function(n){var s=n.originalEvent.target,h=this._element;this._popup&&(s===h||h.contains(s))&&this.togglePopup()},o.prototype.getPopup=function(){return this._popup},o.prototype.togglePopup=function(){var n=this._popup;return n?(n.isOpen()?n.remove():n.addTo(this._map),this):this},o.prototype._update=function(n){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=el(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var s="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?s="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(s="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var h="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?h="rotateX(0deg)":this._pitchAlignment==="map"&&(h="rotateX("+this._map.getPitch()+"deg)"),n&&n.type!=="moveend"||(this._pos=this._pos.round()),U.setTransform(this._element,ea[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+h+" "+s)}},o.prototype.getOffset=function(){return this._offset},o.prototype.setOffset=function(n){return this._offset=l.Point.convert(n),this._update(),this},o.prototype._onMove=function(n){if(!this._isDragging){var s=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=s}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag")))},o.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.Event("dragend")),this._state="inactive"},o.prototype._addDragHandler=function(n){this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},o.prototype.setDraggable=function(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},o.prototype.isDraggable=function(){return this._draggable},o.prototype.setRotation=function(n){return this._rotation=n||0,this._update(),this},o.prototype.getRotation=function(){return this._rotation},o.prototype.setRotationAlignment=function(n){return this._rotationAlignment=n||"auto",this._update(),this},o.prototype.getRotationAlignment=function(){return this._rotationAlignment},o.prototype.setPitchAlignment=function(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this},o.prototype.getPitchAlignment=function(){return this._pitchAlignment},o}(l.Evented),nu={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},ls=0,To=!1,ou=function(i){function o(n){i.call(this),this.options=l.extend({},nu,n),l.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.onAdd=function(n){var s;return this._map=n,this._container=U.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),s=this._setupUI,Ta!==void 0?s(Ta):l.window.navigator.permissions!==void 0?l.window.navigator.permissions.query({name:"geolocation"}).then(function(h){s(Ta=h.state!=="denied")}):s(Ta=!!l.window.navigator.geolocation),this._container},o.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(l.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),U.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ls=0,To=!1},o.prototype._isOutOfMapMaxBounds=function(n){var s=this._map.getMaxBounds(),h=n.coords;return s&&(h.longitude<s.getWest()||h.longitude>s.getEast()||h.latitude<s.getSouth()||h.latitude>s.getNorth())},o.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting")}},o.prototype._onSuccess=function(n){if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new l.Event("geolocate",n)),this._finish()}},o.prototype._updateCamera=function(n){var s=new l.LngLat(n.coords.longitude,n.coords.latitude),h=n.coords.accuracy,m=this._map.getBearing(),y=l.extend({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(s.toBounds(h),y,{geolocateSource:!0})},o.prototype._updateMarker=function(n){if(n){var s=new l.LngLat(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},o.prototype._updateCircleRadius=function(){var n=this._map._container.clientHeight/2,s=this._map.unproject([0,n]),h=this._map.unproject([1,n]),m=s.distanceTo(h),y=Math.ceil(2*this._accuracy/m);this._circleElement.style.width=y+"px",this._circleElement.style.height=y+"px"},o.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},o.prototype._onError=function(n){if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&To)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new l.Event("error",n)),this._finish()}},o.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},o.prototype._setupUI=function(n){var s=this;if(this._container.addEventListener("contextmenu",function(y){return y.preventDefault()}),this._geolocateButton=U.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),U.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",n===!1){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h)}else{var m=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=U.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new ss(this._dotElement),this._circleElement=U.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ss({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(y){y.geolocateSource||s._watchState!=="ACTIVE_LOCK"||y.originalEvent&&y.originalEvent.type==="resize"||(s._watchState="BACKGROUND",s._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),s._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),s.fire(new l.Event("trackuserlocationend")))})},o.prototype.trigger=function(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ls--,To=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var n;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++ls>1?(n={maximumAge:6e5,timeout:0},To=!0):(n=this.options.positionOptions,To=!1),this._geolocationWatchID=l.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,n)}}else l.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},o.prototype._clearWatch=function(){l.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},o}(l.Evented),au={maxWidth:100,unit:"metric"},on=function(i){this.options=l.extend({},au,i),l.bindAll(["_onMove","setUnit"],this)};function tl(i,o,n){var s=n&&n.maxWidth||100,h=i._container.clientHeight/2,m=i.unproject([0,h]),y=i.unproject([s,h]),v=m.distanceTo(y);if(n&&n.unit==="imperial"){var S=3.2808*v;S>5280?ta(o,s,S/5280,i._getUIString("ScaleControl.Miles")):ta(o,s,S,i._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?ta(o,s,v/1852,i._getUIString("ScaleControl.NauticalMiles")):v>=1e3?ta(o,s,v/1e3,i._getUIString("ScaleControl.Kilometers")):ta(o,s,v,i._getUIString("ScaleControl.Meters"))}function ta(i,o,n,s){var h,m,y,v=(h=n,(m=Math.pow(10,(""+Math.floor(h)).length-1))*(y=(y=h/m)>=10?10:y>=5?5:y>=3?3:y>=2?2:y>=1?1:function(S){var A=Math.pow(10,Math.ceil(-Math.log(S)/Math.LN10));return Math.round(S*A)/A}(y)));i.style.width=o*(v/n)+"px",i.innerHTML=v+"&nbsp;"+s}on.prototype.getDefaultPosition=function(){return"bottom-left"},on.prototype._onMove=function(){tl(this._map,this._container,this.options)},on.prototype.onAdd=function(i){return this._map=i,this._container=U.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",i.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},on.prototype.onRemove=function(){U.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},on.prototype.setUnit=function(i){this.options.unit=i,tl(this._map,this._container,this.options)};var an=function(i){this._fullscreen=!1,i&&i.container&&(i.container instanceof l.window.HTMLElement?this._container=i.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),l.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in l.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in l.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in l.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in l.window.document&&(this._fullscreenchange="MSFullscreenChange")};an.prototype.onAdd=function(i){return this._map=i,this._container||(this._container=this._map.getContainer()),this._controlContainer=U.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",l.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},an.prototype.onRemove=function(){U.remove(this._controlContainer),this._map=null,l.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},an.prototype._checkFullscreenSupport=function(){return!!(l.window.document.fullscreenEnabled||l.window.document.mozFullScreenEnabled||l.window.document.msFullscreenEnabled||l.window.document.webkitFullscreenEnabled)},an.prototype._setupUI=function(){var i=this._fullscreenButton=U.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);U.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",i).setAttribute("aria-hidden",!0),i.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),l.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},an.prototype._updateTitle=function(){var i=this._getTitle();this._fullscreenButton.setAttribute("aria-label",i),this._fullscreenButton.title=i},an.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},an.prototype._isFullscreen=function(){return this._fullscreen},an.prototype._changeIcon=function(){(l.window.document.fullscreenElement||l.window.document.mozFullScreenElement||l.window.document.webkitFullscreenElement||l.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},an.prototype._onClickFullscreen=function(){this._isFullscreen()?l.window.document.exitFullscreen?l.window.document.exitFullscreen():l.window.document.mozCancelFullScreen?l.window.document.mozCancelFullScreen():l.window.document.msExitFullscreen?l.window.document.msExitFullscreen():l.window.document.webkitCancelFullScreen&&l.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var su={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},lu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),us=function(i){function o(n){i.call(this),this.options=l.extend(Object.create(su),n),l.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return i&&(o.__proto__=i),(o.prototype=Object.create(i&&i.prototype)).constructor=o,o.prototype.addTo=function(n){return this._map&&this.remove(),this._map=n,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new l.Event("open")),this},o.prototype.isOpen=function(){return!!this._map},o.prototype.remove=function(){return this._content&&U.remove(this._content),this._container&&(U.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new l.Event("close")),this},o.prototype.getLngLat=function(){return this._lngLat},o.prototype.setLngLat=function(n){return this._lngLat=l.LngLat.convert(n),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this},o.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this},o.prototype.getElement=function(){return this._container},o.prototype.setText=function(n){return this.setDOMContent(l.window.document.createTextNode(n))},o.prototype.setHTML=function(n){var s,h=l.window.document.createDocumentFragment(),m=l.window.document.createElement("body");for(m.innerHTML=n;s=m.firstChild;)h.appendChild(s);return this.setDOMContent(h)},o.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},o.prototype.setMaxWidth=function(n){return this.options.maxWidth=n,this._update(),this},o.prototype.setDOMContent=function(n){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=U.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(n),this._createCloseButton(),this._update(),this._focusFirstElement(),this},o.prototype.addClassName=function(n){this._container&&this._container.classList.add(n)},o.prototype.removeClassName=function(n){this._container&&this._container.classList.remove(n)},o.prototype.setOffset=function(n){return this.options.offset=n,this._update(),this},o.prototype.toggleClassName=function(n){if(this._container)return this._container.classList.toggle(n)},o.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=U.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},o.prototype._onMouseUp=function(n){this._update(n.point)},o.prototype._onMouseMove=function(n){this._update(n.point)},o.prototype._onDrag=function(n){this._update(n.point)},o.prototype._update=function(n){var s=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=U.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=U.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(B){return s._container.classList.add(B)}),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=el(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||n)){var h=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat),m=this.options.anchor,y=function B(R){if(R){if(typeof R=="number"){var G=Math.round(Math.sqrt(.5*Math.pow(R,2)));return{center:new l.Point(0,0),top:new l.Point(0,R),"top-left":new l.Point(G,G),"top-right":new l.Point(-G,G),bottom:new l.Point(0,-R),"bottom-left":new l.Point(G,-G),"bottom-right":new l.Point(-G,-G),left:new l.Point(R,0),right:new l.Point(-R,0)}}if(R instanceof l.Point||Array.isArray(R)){var q=l.Point.convert(R);return{center:q,top:q,"top-left":q,"top-right":q,bottom:q,"bottom-left":q,"bottom-right":q,left:q,right:q}}return{center:l.Point.convert(R.center||[0,0]),top:l.Point.convert(R.top||[0,0]),"top-left":l.Point.convert(R["top-left"]||[0,0]),"top-right":l.Point.convert(R["top-right"]||[0,0]),bottom:l.Point.convert(R.bottom||[0,0]),"bottom-left":l.Point.convert(R["bottom-left"]||[0,0]),"bottom-right":l.Point.convert(R["bottom-right"]||[0,0]),left:l.Point.convert(R.left||[0,0]),right:l.Point.convert(R.right||[0,0])}}return B(new l.Point(0,0))}(this.options.offset);if(!m){var v,S=this._container.offsetWidth,A=this._container.offsetHeight;v=h.y+y.bottom.y<A?["top"]:h.y>this._map.transform.height-A?["bottom"]:[],h.x<S/2?v.push("left"):h.x>this._map.transform.width-S/2&&v.push("right"),m=v.length===0?"bottom":v.join("-")}var D=h.add(y[m]).round();U.setTransform(this._container,ea[m]+" translate("+D.x+"px,"+D.y+"px)"),ro(this._container,m,"popup")}},o.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var n=this._container.querySelector(lu);n&&n.focus()}},o.prototype._onClose=function(){this.remove()},o}(l.Evented),rl={version:l.version,supported:J,setRTLTextPlugin:l.setRTLTextPlugin,getRTLTextPluginStatus:l.getRTLTextPluginStatus,Map:li,NavigationControl:to,GeolocateControl:ou,AttributionControl:Wi,ScaleControl:on,FullscreenControl:an,Popup:us,Marker:ss,Style:Yn,LngLat:l.LngLat,LngLatBounds:l.LngLatBounds,Point:l.Point,MercatorCoordinate:l.MercatorCoordinate,Evented:l.Evented,config:l.config,prewarm:function(){$e().acquire(le)},clearPrewarmedResources:function(){var i=Ve;i&&(i.isPreloaded()&&i.numActive()===1?(i.release(le),Ve=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return l.config.ACCESS_TOKEN},set accessToken(i){l.config.ACCESS_TOKEN=i},get baseApiUrl(){return l.config.API_URL},set baseApiUrl(i){l.config.API_URL=i},get workerCount(){return we.workerCount},set workerCount(i){we.workerCount=i},get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(i){l.config.MAX_PARALLEL_IMAGE_REQUESTS=i},clearStorage:function(i){l.clearTileCache(i)},workerUrl:"",addProtocol:function(i,o){l.config.REGISTERED_PROTOCOLS[i]=o},removeProtocol:function(i){delete l.config.REGISTERED_PROTOCOLS[i]}};return rl}),T})})(Dy);var ox=Dy.exports;const Bh=Ly(ox);var Ry={exports:{}};function ax(c,d){var _=c.getCenter(),b=c.getZoom(),T=c.getBearing(),P=c.getPitch();d.forEach(function(l){l.jumpTo({center:_,zoom:b,bearing:T,pitch:P})})}function sx(){var c,d=arguments.length;if(d===1)c=arguments[0];else{c=[];for(var _=0;_<d;_++)c.push(arguments[_])}var b=[];c.forEach(function(J,U){b[U]=l.bind(null,J,c.filter(function(he,se){return se!==U}))});function T(){c.forEach(function(J,U){J.on("move",b[U])})}function P(){c.forEach(function(J,U){J.off("move",b[U])})}function l(J,U){P(),ax(J,U),T()}return T(),function(){P(),b=[]}}var lx=sx,vf={exports:{}},Rl=typeof Reflect=="object"?Reflect:null,Em=Rl&&typeof Rl.apply=="function"?Rl.apply:function(d,_,b){return Function.prototype.apply.call(d,_,b)},cp;Rl&&typeof Rl.ownKeys=="function"?cp=Rl.ownKeys:Object.getOwnPropertySymbols?cp=function(d){return Object.getOwnPropertyNames(d).concat(Object.getOwnPropertySymbols(d))}:cp=function(d){return Object.getOwnPropertyNames(d)};function ux(c){console&&console.warn&&console.warn(c)}var By=Number.isNaN||function(d){return d!==d};function Tr(){Tr.init.call(this)}vf.exports=Tr;vf.exports.once=fx;Tr.EventEmitter=Tr;Tr.prototype._events=void 0;Tr.prototype._eventsCount=0;Tr.prototype._maxListeners=void 0;var Tm=10;function Ap(c){if(typeof c!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof c)}Object.defineProperty(Tr,"defaultMaxListeners",{enumerable:!0,get:function(){return Tm},set:function(c){if(typeof c!="number"||c<0||By(c))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+c+".");Tm=c}});Tr.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Tr.prototype.setMaxListeners=function(d){if(typeof d!="number"||d<0||By(d))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+d+".");return this._maxListeners=d,this};function Oy(c){return c._maxListeners===void 0?Tr.defaultMaxListeners:c._maxListeners}Tr.prototype.getMaxListeners=function(){return Oy(this)};Tr.prototype.emit=function(d){for(var _=[],b=1;b<arguments.length;b++)_.push(arguments[b]);var T=d==="error",P=this._events;if(P!==void 0)T=T&&P.error===void 0;else if(!T)return!1;if(T){var l;if(_.length>0&&(l=_[0]),l instanceof Error)throw l;var J=new Error("Unhandled error."+(l?" ("+l.message+")":""));throw J.context=l,J}var U=P[d];if(U===void 0)return!1;if(typeof U=="function")Em(U,this,_);else for(var he=U.length,se=jy(U,he),b=0;b<he;++b)Em(se[b],this,_);return!0};function Fy(c,d,_,b){var T,P,l;if(Ap(_),P=c._events,P===void 0?(P=c._events=Object.create(null),c._eventsCount=0):(P.newListener!==void 0&&(c.emit("newListener",d,_.listener?_.listener:_),P=c._events),l=P[d]),l===void 0)l=P[d]=_,++c._eventsCount;else if(typeof l=="function"?l=P[d]=b?[_,l]:[l,_]:b?l.unshift(_):l.push(_),T=Oy(c),T>0&&l.length>T&&!l.warned){l.warned=!0;var J=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(d)+" listeners added. Use emitter.setMaxListeners() to increase limit");J.name="MaxListenersExceededWarning",J.emitter=c,J.type=d,J.count=l.length,ux(J)}return c}Tr.prototype.addListener=function(d,_){return Fy(this,d,_,!1)};Tr.prototype.on=Tr.prototype.addListener;Tr.prototype.prependListener=function(d,_){return Fy(this,d,_,!0)};function cx(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Uy(c,d,_){var b={fired:!1,wrapFn:void 0,target:c,type:d,listener:_},T=cx.bind(b);return T.listener=_,b.wrapFn=T,T}Tr.prototype.once=function(d,_){return Ap(_),this.on(d,Uy(this,d,_)),this};Tr.prototype.prependOnceListener=function(d,_){return Ap(_),this.prependListener(d,Uy(this,d,_)),this};Tr.prototype.removeListener=function(d,_){var b,T,P,l,J;if(Ap(_),T=this._events,T===void 0)return this;if(b=T[d],b===void 0)return this;if(b===_||b.listener===_)--this._eventsCount===0?this._events=Object.create(null):(delete T[d],T.removeListener&&this.emit("removeListener",d,b.listener||_));else if(typeof b!="function"){for(P=-1,l=b.length-1;l>=0;l--)if(b[l]===_||b[l].listener===_){J=b[l].listener,P=l;break}if(P<0)return this;P===0?b.shift():px(b,P),b.length===1&&(T[d]=b[0]),T.removeListener!==void 0&&this.emit("removeListener",d,J||_)}return this};Tr.prototype.off=Tr.prototype.removeListener;Tr.prototype.removeAllListeners=function(d){var _,b,T;if(b=this._events,b===void 0)return this;if(b.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):b[d]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete b[d]),this;if(arguments.length===0){var P=Object.keys(b),l;for(T=0;T<P.length;++T)l=P[T],l!=="removeListener"&&this.removeAllListeners(l);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(_=b[d],typeof _=="function")this.removeListener(d,_);else if(_!==void 0)for(T=_.length-1;T>=0;T--)this.removeListener(d,_[T]);return this};function Vy(c,d,_){var b=c._events;if(b===void 0)return[];var T=b[d];return T===void 0?[]:typeof T=="function"?_?[T.listener||T]:[T]:_?hx(T):jy(T,T.length)}Tr.prototype.listeners=function(d){return Vy(this,d,!0)};Tr.prototype.rawListeners=function(d){return Vy(this,d,!1)};Tr.listenerCount=function(c,d){return typeof c.listenerCount=="function"?c.listenerCount(d):Ny.call(c,d)};Tr.prototype.listenerCount=Ny;function Ny(c){var d=this._events;if(d!==void 0){var _=d[c];if(typeof _=="function")return 1;if(_!==void 0)return _.length}return 0}Tr.prototype.eventNames=function(){return this._eventsCount>0?cp(this._events):[]};function jy(c,d){for(var _=new Array(d),b=0;b<d;++b)_[b]=c[b];return _}function px(c,d){for(;d+1<c.length;d++)c[d]=c[d+1];c.pop()}function hx(c){for(var d=new Array(c.length),_=0;_<d.length;++_)d[_]=c[_].listener||c[_];return d}function fx(c,d){return new Promise(function(_,b){function T(l){c.removeListener(d,P),b(l)}function P(){typeof c.removeListener=="function"&&c.removeListener("error",T),_([].slice.call(arguments))}qy(c,d,P,{once:!0}),d!=="error"&&dx(c,T,{once:!0})})}function dx(c,d,_){typeof c.on=="function"&&qy(c,"error",d,_)}function qy(c,d,_,b){if(typeof c.on=="function")b.once?c.once(d,_):c.on(d,_);else if(typeof c.addEventListener=="function")c.addEventListener(d,function T(P){b.once&&c.removeEventListener(d,T),_(P)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof c)}var mx=vf.exports;(function(c){var d=lx,_=mx.EventEmitter;function b(T,P,l,J){if(this.options=J||{},this._mapA=T,this._mapB=P,this._horizontal=this.options.orientation==="horizontal",this._onDown=this._onDown.bind(this),this._onMove=this._onMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._ev=new _,this._swiper=document.createElement("div"),this._swiper.className=this._horizontal?"compare-swiper-horizontal":"compare-swiper-vertical",this._controlContainer=document.createElement("div"),this._controlContainer.className=this._horizontal?"maplibregl-compare maplibregl-compare-horizontal":"maplibregl-compare",this._controlContainer.className=this._controlContainer.className,this._controlContainer.appendChild(this._swiper),typeof l=="string"&&document.body.querySelectorAll){var U=document.body.querySelectorAll(l)[0];if(!U)throw new Error("Cannot find element with specified container selector.");U.appendChild(this._controlContainer)}else if(l instanceof Element&&l.appendChild)l.appendChild(this._controlContainer);else throw new Error("Invalid container specified. Must be CSS selector or HTML element.");this._bounds=P.getContainer().getBoundingClientRect();var he=(this._horizontal?this._bounds.height:this._bounds.width)/2;this._setPosition(he),this._clearSync=d(T,P),this._onResize=(function(){this._bounds=P.getContainer().getBoundingClientRect(),this.currentPosition&&this._setPosition(this.currentPosition)}).bind(this),P.on("resize",this._onResize),this.options&&this.options.mousemove&&(T.getContainer().addEventListener("mousemove",this._onMove),P.getContainer().addEventListener("mousemove",this._onMove)),this._swiper.addEventListener("mousedown",this._onDown),this._swiper.addEventListener("touchstart",this._onDown)}b.prototype={_setPointerEvents:function(T){this._controlContainer.style.pointerEvents=T,this._swiper.style.pointerEvents=T},_onDown:function(T){T.touches?(document.addEventListener("touchmove",this._onMove),document.addEventListener("touchend",this._onTouchEnd)):(document.addEventListener("mousemove",this._onMove),document.addEventListener("mouseup",this._onMouseUp))},_setPosition:function(T){T=Math.min(T,this._horizontal?this._bounds.height:this._bounds.width);var P=this._horizontal?"translate(0, "+T+"px)":"translate("+T+"px, 0)";this._controlContainer.style.transform=P,this._controlContainer.style.WebkitTransform=P;var l=this._horizontal?"rect(0, 999em, "+T+"px, 0)":"rect(0, "+T+"px, "+this._bounds.height+"px, 0)",J=this._horizontal?"rect("+T+"px, 999em, "+this._bounds.height+"px,0)":"rect(0, 999em, "+this._bounds.height+"px,"+T+"px)";this._mapA.getContainer().style.clip=l,this._mapB.getContainer().style.clip=J,this.currentPosition=T},_onMove:function(T){this.options&&this.options.mousemove&&this._setPointerEvents(T.touches?"auto":"none"),this._horizontal?this._setPosition(this._getY(T)):this._setPosition(this._getX(T))},_onMouseUp:function(){document.removeEventListener("mousemove",this._onMove),document.removeEventListener("mouseup",this._onMouseUp),this.fire("slideend",{currentPosition:this.currentPosition})},_onTouchEnd:function(){document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onTouchEnd),this.fire("slideend",{currentPosition:this.currentPosition})},_getX:function(T){T=T.touches?T.touches[0]:T;var P=T.clientX-this._bounds.left;return P<0&&(P=0),P>this._bounds.width&&(P=this._bounds.width),P},_getY:function(T){T=T.touches?T.touches[0]:T;var P=T.clientY-this._bounds.top;return P<0&&(P=0),P>this._bounds.height&&(P=this._bounds.height),P},setSlider:function(T){this._setPosition(T)},on:function(T,P){return this._ev.on(T,P),this},fire:function(T,P){return this._ev.emit(T,P),this},off:function(T,P){return this._ev.removeListener(T,P),this},remove:function(){this._clearSync(),this._mapB.off("resize",this._onResize);var T=this._mapA.getContainer();T&&(T.style.clip=null,T.removeEventListener("mousemove",this._onMove));var P=this._mapB.getContainer();P&&(P.style.clip=null,P.removeEventListener("mousemove",this._onMove)),this._swiper.removeEventListener("mousedown",this._onDown),this._swiper.removeEventListener("touchstart",this._onDown),this._controlContainer.remove()}},window.maplibregl?maplibregl.Compare=b:c.exports=b})(Ry);var yx=Ry.exports;const gx=Ly(yx);const _x=wp({name:"MapComponent",props:{beforeStyle:{type:String,required:!0},beforeStyleAccessToken:{type:String,required:!0},beforeStyleBeforeLayerId:{type:String,required:!0},sourceTiles:{type:String,required:!0},sourceTileScheme:{type:String,required:!0},sourceTileSize:{type:Number,required:!0},sourceMinZoom:{type:Number,required:!0},sourceMaxZoom:{type:Number,required:!0},sourceBounds:{type:Array,required:!0},showLabels:{type:Boolean,required:!0},showCompare:{type:Boolean,required:!0},uiPadding:{type:Object,required:!0}},data:()=>({beforeMap:null,beforeMapLabelBackups:[],afterMap:null,afterMapLabelBackups:[],compareMap:null,compareMapLastPosition:0,compareMapMinimumPosition:.1}),watch:{showLabels(){this.beforeMap!==null&&this.afterMap!==null&&(this.showLabels?(this.addLabels(this.beforeMap,this.beforeMapLabelBackups),this.addLabels(this.afterMap,this.afterMapLabelBackups)):(this.beforeMapLabelBackups=this.removeLabels(this.beforeMap),this.afterMapLabelBackups=this.removeLabels(this.afterMap)))},showCompare(){this.compareMap!==null&&(this.showCompare?this.addCompare(this.compareMap):this.removeCompare(this.compareMap))}},mounted(){let c=[-180,-90,180,90];this.sourceBounds.length===4&&(c=this.sourceBounds),Bh.accessToken=this.beforeStyleAccessToken;const d=new Bh.Map({container:"before",style:this.beforeStyle,bounds:c}),_=new Bh.Map({container:"after",style:this.beforeStyle,bounds:c});d.fitBounds(c,{padding:this.uiPadding}),_.fitBounds(c,{padding:this.uiPadding}),this.afterMap=_,this.beforeMap=d,d.once("sourcedata",()=>{if(this.beforeMap===null)throw new Error("beforeMap is null when it should not be");this.showLabels||(this.beforeMapLabelBackups=this.removeLabels(this.beforeMap))}),_.once("sourcedata",()=>{if(this.afterMap===null)throw new Error("afterMap is null when it should not be");this.afterMap.addSource("map-tile-source",{type:"raster",tiles:[this.sourceTiles],scheme:this.sourceTileScheme,minzoom:this.sourceMinZoom,maxzoom:this.sourceMaxZoom,tileSize:this.sourceTileSize,bounds:c}),this.afterMap.addLayer({id:"map-tile-layer",type:"raster",source:"map-tile-source",paint:{}},this.beforeStyleBeforeLayerId),this.showLabels||(this.afterMapLabelBackups=this.removeLabels(this.afterMap))}),this.compareMap=new gx(d,_,"#comparison-container"),this.compareMap!==null&&(this.showCompare?this.addCompare(this.compareMap):this.removeCompare(this.compareMap))},methods:{addLabels(c,d){d.forEach(_=>{_.beforeLayer!==null?c.addLayer(_.layer,_.beforeLayer):c.addLayer(_.layer)})},removeLabels(c){const{layers:d}=c.getStyle();if(d===void 0)throw new Error("Unexpected undefined layers found in style");const _=[];for(let b=d.length-1;b>0;b-=1)(d[b].type==="symbol"||d[b].type==="line")&&(c.removeLayer(d[b].id),_.push({layer:d[b],beforeLayer:b===d.length-1?null:d[b+1].id}));return _},addCompare(c){this.compareMapLastPosition>=window.innerWidth&&(this.compareMapLastPosition=window.innerWidth/2),c.setSlider(this.compareMapLastPosition)},removeCompare(c){this.compareMapLastPosition=c.currentPosition,c.setSlider(this.compareMapMinimumPosition)}}});const Pp=(c,d)=>{const _=c.__vccOpts||c;for(const[b,T]of d)_[b]=T;return _},vx=mi("div",{id:"before",class:"absolute top-0 bottom-0 w-full"},null,-1),xx=mi("div",{id:"after",class:"absolute top-0 bottom-0 w-full"},null,-1),bx=[vx,xx];function wx(c,d,_,b,T,P){return di(),Mi("div",{id:"comparison-container",class:Xu({showCompare:c.showCompare})},bx,2)}const Sx=Pp(_x,[["render",wx]]),Ex=wp({name:"MapControls",props:{showLabels:{type:Boolean,required:!0},showCompare:{type:Boolean,required:!0}},emits:["update:showLabels","update:showCompare"],data:()=>({mountedShowLabels:!1,mountedShowCompare:!1}),watch:{mountedShowLabels(){this.$emit("update:showLabels",this.mountedShowLabels)},mountedShowCompare(){this.$emit("update:showCompare",this.mountedShowCompare)}},mounted(){this.mountedShowLabels=this.showLabels,this.mountedShowCompare=this.showCompare}}),Tx="/assets/show-labels-active-0f91ed16.svg",Ix="/assets/show-labels-inactive-aa8f3f9e.svg",Cx="/assets/show-compare-active-8e527d58.svg",Ax="/assets/show-compare-inactive-071ddea6.svg",Px={class:"text-white flex flex-col space-y-2"},zx={class:"bg-gray-800 bg-opacity-70 backdrop-filter backdrop-blur-xl rounded-xl text-center shadow-lg"},Mx={key:0,src:Tx,alt:"Labels are enabled","aria-hidden":"true"},kx={key:1,src:Ix,alt:"labels are disabled","aria-hidden":"true"},Lx=mi("div",{class:"bg-gray-800 bg-opacity-50 w-12 h-px backdrop-filter backdrop-blur-xl backdrop-brightness-200"},null,-1),Dx={key:0,src:Cx,alt:"Compare mode is enabled","aria-hidden":"true"},Rx={key:1,src:Ax,alt:"Compare mode is disabled","aria-hidden":"true"};function Bx(c,d,_,b,T,P){return di(),Mi("div",Px,[mi("div",zx,[mi("button",{type:"button",tabindex:"4",class:"px-3 py-3 w-12 h-12 group","aria-label":"Toggle labels",title:"Toggle labels",onClick:d[0]||(d[0]=l=>c.mountedShowLabels=!c.mountedShowLabels)},[c.mountedShowLabels?(di(),Mi("img",Mx)):(di(),Mi("img",kx))]),Lx,mi("button",{type:"button",tabindex:"5",class:"px-3 py-3 w-12 h-12","aria-label":"Toggle compare mode",title:"Toggle compare mode",onClick:d[1]||(d[1]=l=>c.mountedShowCompare=!c.mountedShowCompare)},[c.mountedShowCompare?(di(),Mi("img",Dx)):(di(),Mi("img",Rx))])])])}const Ox=Pp(Ex,[["render",Bx]]),Fx=wp({name:"ReferencePhoto",props:{imageUrl:{type:String,required:!0},expanded:{type:Boolean,required:!0},maxHeight:{type:String,required:!0},showResizeButton:{type:Boolean,required:!0}},emits:["update:expanded","update:imageLoaded"],data:()=>({mountedExpanded:!1}),watch:{expanded(){this.mountedExpanded=this.expanded},mountedExpanded(){this.mountedExpanded!==this.expanded&&this.$emit("update:expanded",this.mountedExpanded)},maxHeight(){this.resizeImage()}},mounted(){this.mountedExpanded=this.expanded,this.resizeImage()},methods:{resizeImage(){const c=this.$refs.image;c!==null&&(c.style.maxHeight=this.maxHeight)},openImageExternally(){window.open(this.imageUrl,"_blank")}}}),Ux="/assets/close-7bdf1d8b.svg",Vx="/assets/open-external-8fab748b.svg",Nx="/assets/expand-e2eaaca7.svg";const jx={class:"flex justify-center pointer-events-none"},qx={class:"rounded-xl flex flex-col shadow-lg relative self-center items-center pointer-events-auto"},Zx={key:0,class:"absolute top-2 right-2"},Gx={key:0,"aria-hidden":"true",src:Ux,alt:"Close reference photo",class:"w-5"},Hx=mi("div",{class:"h-2"},null,-1),Xx={key:0,"aria-hidden":"true",src:Vx,alt:"Open reference photo in new window",class:"w-5"},Wx={key:0,"aria-hidden":"true",src:Nx,alt:"Expand reference photo",class:"w-3"},Kx=["src"];function $x(c,d,_,b,T,P){return di(),Mi("div",jx,[mi("div",qx,[qi(mp,{name:"button-fade",mode:"out-in"},{default:jh(()=>[c.showResizeButton&&c.mountedExpanded?(di(),Mi("div",Zx,[mi("button",{type:"button",tabindex:"2",class:"bg-gray-800 bg-opacity-70 backdrop-filter backdrop-blur-xl rounded-lg p-2","aria-label":"Close reference photo",title:"Close reference photo",onClick:d[0]||(d[0]=l=>c.mountedExpanded=!c.mountedExpanded)},[c.mountedExpanded?(di(),Mi("img",Gx)):pa("",!0)]),Hx,mi("button",{type:"button",tabindex:"3","aria-label":"Open reference photo in new window",title:"Open reference photo in new window",class:"bg-gray-800 bg-opacity-70 backdrop-filter backdrop-blur-xl rounded-lg p-2",onClick:d[1]||(d[1]=(...l)=>c.openImageExternally&&c.openImageExternally(...l))},[c.mountedExpanded?(di(),Mi("img",Xx)):pa("",!0)])])):pa("",!0)]),_:1}),qi(mp,{name:"button-fade",mode:"out-in"},{default:jh(()=>[c.showResizeButton&&!c.mountedExpanded?(di(),Mi("button",{key:0,type:"button",tabindex:"1",class:"bg-gray-800 bg-opacity-70 backdrop-filter backdrop-blur-xl rounded-lg absolute top-1 right-1 p-1","aria-label":"Expand reference photo",title:"Expand reference photo",onClick:d[2]||(d[2]=l=>c.mountedExpanded=!c.mountedExpanded)},[c.mountedExpanded?pa("",!0):(di(),Mi("img",Wx))])):pa("",!0)]),_:1}),mi("img",{ref:"image",class:"rounded-xl shadow-md bg-gray-300 dark:bg-gray-800 bg-opacity-50 cursor-pointer",alt:"Reference photo associated with the map",src:c.imageUrl,onLoad:d[3]||(d[3]=l=>c.$emit("update:imageLoaded")),onClick:d[4]||(d[4]=l=>c.mountedExpanded=!c.mountedExpanded),onKeyup:d[5]||(d[5]=Y0(l=>c.mountedExpanded=!c.mountedExpanded,["space"]))},null,40,Kx)])])}const Jx=Pp(Fx,[["render",$x]]);document.addEventListener("gesturestart",c=>{c.preventDefault()});document.addEventListener("gesturechange",c=>{c.preventDefault()});document.addEventListener("gestureend",c=>{c.preventDefault()});const Yx=wp({name:"App",components:{MapComponent:Sx,MapControls:Ox,ReferencePhoto:Jx},data:()=>({name:"",beforeStyle:"",beforeStyleAccessToken:"",beforeStyleBeforeLayerId:"",sourceTiles:"",sourceTileScheme:"xyz",sourceTileSize:256,sourceMinZoom:1,sourceMaxZoom:10,sourceBounds:[-180,-90,180,90],referencePhotoImageUrl:"",referencePhotoExpanded:!0,referencePhotoTouchStartWidth:0,referencePhotoTouchStartIdentifier:0,referencePhotoTouchStartX:0,referencePhotoTouchEndX:0,windowHeight:window.innerHeight,splashScreenButtonHeight:48,showMap:!1,showLabels:!1,showCompare:!1,uiPadding:{left:0,right:0,top:0,bottom:0}}),computed:{referencePhotoShowResizeButton(){return this.showMap},referencePhotoMaxHeight(){const c="1rem";if(this.showMap){const d="1rem";return`calc(${this.windowHeight}px - ${c} - ${c} - ${d} - ${c})`}return`calc(${this.windowHeight}px - ${c} - ${c} - ${this.splashScreenButtonHeight}px - ${c} - env(safe-area-inset-bottom) - env(safe-area-inset-top))`}},async mounted(){await this.loadConfig(),this.windowHeight=window.innerHeight,this.uiPadding=this.computeUiPadding(),setTimeout(()=>{this.resizeSplashScreen()},300),window.addEventListener("resize",()=>{this.windowHeight=window.innerHeight,this.uiPadding=this.computeUiPadding(),setTimeout(()=>{this.resizeSplashScreen()},300)}),this.addReferencePhotoTouchEventListeners()},methods:{async loadConfig(){const c=window.location.hash.substring(1),d=decodeURIComponent(c),_=await fetch(d).then(b=>b.json());this.name=_.name,this.beforeStyle=_.beforeStyle,this.beforeStyleAccessToken=_.beforeStyleAccessToken,this.beforeStyleBeforeLayerId=_.beforeStyleBeforeLayerId,this.sourceTiles=_.sourceTiles,this.sourceTileScheme=_.sourceTileScheme,this.sourceTileSize=_.sourceTileSize,this.sourceMinZoom=_.sourceMinZoom,this.sourceMaxZoom=_.sourceMaxZoom,this.sourceBounds=_.sourceBounds,this.referencePhotoImageUrl=_.referencePhotoImageUrl},resizeSplashScreen(){this.showMap||window.requestAnimationFrame(()=>{const c=this.$refs.splashScreenButton;c!==null&&(this.splashScreenButtonHeight=c.clientHeight);const _=this.$refs.referencePhotoContainer.clientHeight,b=window.innerHeight-_,T=this.$refs.splashScreenContainer;T!==null&&(T.style.height=`calc(${b}px + 1rem)`)})},computeUiPadding(){const c=parseFloat(getComputedStyle(document.documentElement).fontSize),d=c*(1+7/2+1),_=c*(1+3+1),b=window.innerWidth-d-_,T=c*(1+3+3+1),P=c*3;return window.innerHeight-T-P>b?{left:c,right:c,top:T,bottom:P}:{left:d,right:_,top:c,bottom:P}},addReferencePhotoTouchEventListeners(){const c=parseFloat(getComputedStyle(document.documentElement).fontSize),d=this.$refs.referencePhotoContainer;d.addEventListener("touchstart",_=>{const b=_.touches[0];this.referencePhotoTouchStartIdentifier=b.identifier,this.referencePhotoTouchStartX=b.clientX,this.referencePhotoTouchEndX=b.clientX,this.referencePhotoTouchStartWidth=d.clientWidth,d.style.maxWidth=`${window.innerWidth+30}px`,d.style.minWidth=`${c*7-30}px`}),d.addEventListener("touchmove",_=>{const b=this.findTouchByIdentifier(_.touches,this.referencePhotoTouchStartIdentifier);if(b===null)return;this.referencePhotoTouchEndX=b.clientX;const T=this.referencePhotoTouchEndX-this.referencePhotoTouchStartX;let P=this.referencePhotoTouchStartWidth+T;P=Math.min(P,window.innerWidth+30),P=Math.max(P,c*7-30),d.style.width=`${P}px`,!this.showMap&&T<-30&&(this.showMap=!this.showMap)}),d.addEventListener("touchcancel",()=>{this.referencePhotoTouchEndX=0,this.referencePhotoTouchStartX=0,d.style.width="",d.style.maxWidth="",d.style.minWidth=""}),d.addEventListener("touchend",()=>{const _=this.referencePhotoTouchEndX-this.referencePhotoTouchStartX;(this.referencePhotoExpanded&&_<-30||!this.referencePhotoExpanded&&_>30)&&(this.referencePhotoExpanded=!this.referencePhotoExpanded),d.style.width="",d.style.maxWidth="",d.style.minWidth=""})},findTouchByIdentifier(c,d){for(let _=0;_<c.length;_+=1)if(c[_].identifier===d)return c[_];return null}}}),Qx={key:1,class:"absolute top-0 right-0"},e1={class:"p-4"},t1={class:"p-4 pointer-events-none"},r1={key:3,ref:"splashScreenContainer",class:"absolute bottom-0 left-0 w-screen transition-all east-out duration-300"},i1={class:"p-4 h-full"},n1={class:"h-full flex justify-center items-center"},o1={key:0},a1={class:"font-bold"},s1=mi("span",{class:"whitespace-nowrap"},"Click to Load Map",-1),l1={key:1};function u1(c,d,_,b,T,P){const l=Ch("MapComponent"),J=Ch("MapControls"),U=Ch("ReferencePhoto");return di(),Mi(lo,null,[c.showMap?(di(),Cy(l,{key:0,"before-style":c.beforeStyle,"before-style-access-token":c.beforeStyleAccessToken,"before-style-before-layer-id":c.beforeStyleBeforeLayerId,"source-tiles":c.sourceTiles,"source-tile-scheme":c.sourceTileScheme,"source-tile-size":c.sourceTileSize,"source-min-zoom":c.sourceMinZoom,"source-max-zoom":c.sourceMaxZoom,"source-bounds":c.sourceBounds,"show-labels":c.showLabels,"show-compare":c.showCompare,"ui-padding":c.uiPadding},null,8,["before-style","before-style-access-token","before-style-before-layer-id","source-tiles","source-tile-scheme","source-tile-size","source-min-zoom","source-max-zoom","source-bounds","show-labels","show-compare","ui-padding"])):pa("",!0),c.showMap?(di(),Mi("div",Qx,[mi("div",e1,[qi(J,{"show-labels":c.showLabels,"show-compare":c.showCompare,"onUpdate:showLabels":d[0]||(d[0]=he=>c.showLabels=he),"onUpdate:showCompare":d[1]||(d[1]=he=>c.showCompare=he)},null,8,["show-labels","show-compare"])])])):pa("",!0),c.referencePhotoImageUrl!==""?(di(),Mi("div",{key:2,ref:"referencePhotoContainer",class:Xu(["absolute top-0 left-0 w-28 md:w-40 transition-all ease-out duration-300 pointer-events-none",{"w-screen":c.referencePhotoExpanded,"md:w-screen":c.referencePhotoExpanded}])},[mi("div",t1,[qi(U,{"image-url":c.referencePhotoImageUrl,expanded:c.referencePhotoExpanded,"max-height":c.referencePhotoMaxHeight,"show-resize-button":c.referencePhotoShowResizeButton,"onUpdate:expanded":d[2]||(d[2]=he=>{c.referencePhotoExpanded=he,c.showMap=!0}),"onUpdate:imageLoaded":d[3]||(d[3]=he=>c.resizeSplashScreen())},null,8,["image-url","expanded","max-height","show-resize-button"])])],2)):pa("",!0),c.showMap?pa("",!0):(di(),Mi("div",r1,[mi("div",i1,[mi("div",n1,[mi("button",{ref:"splashScreenButton",type:"button",class:"bg-gray-300 dark:bg-gray-600 bg-opacity-70 backdrop-filter backdrop-blur-xl text-black dark:text-gray-200 rounded-xl px-4 py-3",onClick:d[4]||(d[4]=he=>{c.showMap=!0,c.referencePhotoExpanded=!1})},[c.name!==""?(di(),Mi("span",o1,[mi("span",a1,Lm(c.name),1),Py(" - "),s1])):(di(),Mi("span",l1," Click to Load Map "))],512)])])],512))],64)}const c1=Pp(Yx,[["render",u1]]);tx(c1).mount("#app");
